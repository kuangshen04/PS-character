{"version":3,"file":"index.js","sources":["../src/utils/get.js","../src/character/PScharacter/data.js","../src/character/PScharacter/index.js"],"sourcesContent":["import { lib, game, ui, get, ai, _status } from \"noname\";\r\n\r\n/* <-------------------------获取花色数-------------------------> */\r\n/**\r\n * 获取牌的花色数\r\n * @param { object[] } cards 一堆牌\r\n * @param { object } player 可选参数，是否以该角色来判断花色\r\n * @returns { number } 返回花色数\r\n */\r\nexport function getCardsSuitsLen(cards, player) {\r\n    const suits = [];\r\n    for (let i = 0; i < cards.length; i++) {\r\n        const suit = get.suit(cards[i], player);\r\n        if (!lib.suit.includes(suit) || suits.includes(suit)) continue;\r\n        suits.add(suit);\r\n        if (lib.suit.length === suits.length) break;\r\n    }\r\n    return suits.length;\r\n}\r\n\r\n\r\n\r\n","import { lib, game, ui, get, ai, _status } from 'noname'\r\nimport { getCardsSuitsLen } from \"../../utils/get.js\"\r\nimport { getPingZe } from \"../../features/definePingZe.js\"\r\n\r\nconst sort = {\r\n    PScharacter_wei: ['PScharacter_wei', '<span style=\"color:#0054ff;font-family:xingkai;font-size:24px\">建安风骨</span>'],\r\n    PScharacter_shu: ['PScharacter_shu', '<span style=\"color:#ff453e;font-family:xingkai;font-size:24px\">汉祚延绵</span>'],\r\n    PScharacter_wu: ['PScharacter_wu', '<span style=\"color:#338c00;font-family:xingkai;font-size:24px\">江东铁壁</span>'],\r\n    PScharacter_qun: ['PScharacter_qun', '<span style=\"color:#8c8c8c;font-family:xingkai;font-size:24px\">群雄并起</span>'],\r\n    PScharacter_jin: ['PScharacter_jin', '<span style=\"color:#991cff;font-family:xingkai;font-size:24px\">三分归晋</span>'],\r\n    PScharacter_shen: ['PScharacter_shen', '<span style=\"color:#dc9e18;font-family:xingkai;font-size:24px\">诸神降临</span>'],\r\n    PScharacter_db: ['PScharacter_db', `<style>\r\n                        #双势力{\r\n                            animation:changeS 8s linear 4s infinite;\r\n                        }\r\n                        @keyframes changeS{\r\n                            0% { color: #0054ff; }\r\n                            35%{ color: #ff453e; }\r\n                            65%{ color: #338c00; }\r\n                            100% { color: #0054ff; }\r\n                        }\r\n                    </style>\r\n                    <body>\r\n                        <span id='双势力' style=\"display: block; position: unset; transition: unset;\">\r\n                            <span style='font-family:xingkai;font-size:24px'>双势力</span>\r\n                        </span>\r\n                    </body>`]\r\n}\r\n\r\nconst rank = {\r\n    junk: ['junk', '垃圾'],\r\n    rare: ['rare', '稀有'],\r\n    epic: ['epic', '史诗'],\r\n    legend: ['legend', '传说']\r\n}\r\n\r\nexport const pack = {\r\n    name: 'PScharacter',\r\n    translate: 'PS武将'\r\n};\r\n\r\nexport const data = {\r\n    PSshouyige: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"shen\",\r\n            hp: 8,\r\n            skills: [\r\n                \"PSshuangquan\"\r\n            ],\r\n            dieAudios: [\r\n                \"shen_lvbu\"\r\n            ],\r\n            isBossAllowed: true,\r\n            isBoss: true,\r\n            trashBin: []\r\n        },\r\n        intro: \"由“九个芒果”设计\",\r\n        skills: {\r\n            PSshuangquan: {\r\n                mod: {\r\n                    selectTarget: function (card, player, range) {\r\n                        if (card.name == 'sha' && range[1] != -1) {\r\n                            range[1]++;\r\n                        }\r\n                        if (card.name == 'tiesuo' && range[1] != -1) {\r\n                            range[1] += 2;\r\n                        }\r\n                    },\r\n                    cardUsable: function (card, player, num) {\r\n                        if (card.name == 'sha') return num + 1;\r\n                    },\r\n                    globalFrom: function (from, to, distance) {\r\n                        return distance - 1;\r\n                    },\r\n                    globalTo: function (from, to, distance) {\r\n                        return distance + 1;\r\n                    }\r\n                },\r\n                trigger: {\r\n                    global: \"phaseBefore\",\r\n                    player: \"enterGame\"\r\n                },\r\n                forced: true,\r\n                filter: function (event, player) {\r\n                    return (event.name != 'phase' || game.phaseNumber == 0) && player.hasEnabledSlot(2);\r\n                },\r\n                content: function () {\r\n                    const equips = ['equip1', 'equip2', 'equip3', 'equip4', 'equip5'];\r\n                    let num;\r\n                    let expand;\r\n                    for (let equip of equips) {\r\n                        expand = 0;\r\n                        num = player.countEnabledSlot(equip) + player.countDisabledSlot(equip);\r\n                        while (expand < num) {\r\n                            player.expandEquip(equip);\r\n                            expand++;\r\n                        }\r\n                    }\r\n                },\r\n                _priority: -1,\r\n                group: [\r\n                    \"wushuang1\",\r\n                    \"wushuang2\",\r\n                    \"PSshuangquan_phase\",\r\n                    \"PSshuangquan_niepan\",\r\n                    \"PSshuangquan_damage\",\r\n                    \"PSshuangquan_again\",\r\n                    \"PSshuangquan_add\",\r\n                    \"PSshuangquan_clear\",\r\n                    \"PSshuangquan_more\",\r\n                    \"PSshuangquan_use\"\r\n                ],\r\n                preHidden: [\r\n                    \"wushuang1\",\r\n                    \"wushuang2\",\r\n                    \"PSshuangquan_phase\",\r\n                    \"PSshuangquan_niepan\",\r\n                    \"PSshuangquan_damage\",\r\n                    \"PSshuangquan_again\",\r\n                    \"PSshuangquan_add\",\r\n                    \"PSshuangquan_clear\",\r\n                    \"PSshuangquan_more\",\r\n                    \"PSshuangquan_use\"\r\n                ],\r\n                subSkill: {\r\n                    phase: {\r\n                        audio: \"botu\",\r\n                        trigger: {\r\n                            player: \"phaseAfter\"\r\n                        },\r\n                        filter: function (event, player) {\r\n                            return player.storage.PSshuangquan_phase != 1;\r\n                        },\r\n                        priority: -50,\r\n                        forced: true,\r\n                        content: function () {\r\n                            player.insertPhase();\r\n                            player.storage.PSshuangquan_phase = 1;\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    clear: {\r\n                        trigger: {\r\n                            global: \"phaseZhunbeiBegin\"\r\n                        },\r\n                        filter: function (event, player) {\r\n\r\n                            return player.storage.PSshuangquan_phase == 1 && event.player != player;\r\n                        },\r\n                        priority: -50,\r\n                        forced: true,\r\n                        content: function () {\r\n                            player.storage.PSshuangquan_phase = 0;\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    use: {\r\n                        trigger: {\r\n                            player: \"useCard1\"\r\n                        },\r\n                        direct: true,\r\n                        filter: function (event, player) {\r\n                            var info = get.info(event.card, false);\r\n                            if (info.allowMultiple == false) return false;\r\n                            if (get.type(event.card) != 'trick') return false;\r\n                            if (event.card.name == 'tiesuo') return false;\r\n                            if (event.targets && !info.multitarget) {\r\n                                if (game.hasPlayer(function (current) {\r\n                                    return !event.targets.includes(current) && lib.filter.targetEnabled2(event.card, player, current) && lib.filter.targetInRange(event.card, player, current);\r\n                                })) {\r\n                                    return true;\r\n                                }\r\n                            }\r\n                            return false;\r\n                        },\r\n                        content: function () {\r\n                            'step 0'\r\n                            var num = game.countPlayer(function (current) {\r\n                                return !trigger.targets.includes(current) && lib.filter.targetEnabled2(trigger.card, player, current) && lib.filter.targetInRange(trigger.card, player, current);\r\n                            });\r\n                            player.chooseTarget('双全：是否为' + get.translation(trigger.card) + '增加一个目标？', 1, function (card, player, target) {\r\n                                var trigger = _status.event.getTrigger();\r\n                                var card = trigger.card;\r\n                                return !trigger.targets.includes(target) && lib.filter.targetEnabled2(card, player, target) && lib.filter.targetInRange(card, player, target);\r\n                            }).set('ai', function (target) {\r\n                                var player = _status.event.player;\r\n                                var card = _status.event.getTrigger().card;\r\n                                return get.effect(target, card, player, player);\r\n                            });\r\n                            'step 1'\r\n                            if (result.bool) {\r\n                                if (player != game.me && !player.isOnline()) game.delayx();\r\n                            }\r\n                            else event.finish();\r\n                            'step 2'\r\n                            var targets = result.targets.sortBySeat();\r\n                            trigger.targets.addArray(targets);\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    niepan: {\r\n                        audio: \"niepan\",\r\n                        unique: true,\r\n                        trigger: {\r\n                            player: \"dieBefore\"\r\n                        },\r\n                        forced: true,\r\n                        mark: true,\r\n                        skillAnimation: true,\r\n                        animationStr: \"涅槃\",\r\n                        limited: true,\r\n                        animationColor: \"orange\",\r\n                        filter: function (event, player) {\r\n                            return !player.storage.PSshuangquan_niepan;\r\n                        },\r\n                        content: function () {\r\n                            'step 0'\r\n                            trigger.cancel();\r\n                            player.awakenSkill('PSshuangquan_niepan');\r\n                            player.storage.PSshuangquan_niepan = true;\r\n                            'step 1'\r\n                            player.maxHp = 8;\r\n                            player.update();\r\n                            if (player.hp < player.maxHp) {\r\n                                player.recoverTo(player.maxHp);\r\n                            }\r\n\r\n                        },\r\n                        ai: {\r\n                            order: 1,\r\n                            skillTagFilter: function (player, arg, target) {\r\n                                if (player != target || player.storage.PSshuangquan_niepan) return false;\r\n                            },\r\n                            save: true,\r\n                            result: {\r\n                                player: function (player) {\r\n                                    if (player.hp <= 0) return 10;\r\n                                    if (player.hp <= 2 && player.countCards('he') <= 1) return 10;\r\n                                    return 0;\r\n                                }\r\n                            },\r\n                            threaten: function (player, target) {\r\n                                if (!target.storage.PSshuangquan_niepan) return 0.6;\r\n                            }\r\n                        },\r\n                        intro: {\r\n                            content: \"limited\"\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    more: {\r\n                        trigger: {\r\n                            global: \"gameDrawBegin\"\r\n                        },\r\n                        forced: true,\r\n                        popup: false,\r\n                        silent: true,\r\n                        content: function () {\r\n                            var num = typeof trigger.num == 'function' ? trigger.num(player) : trigger.num;\r\n                            num = num * 2;\r\n                            event.num = trigger.num;\r\n                            trigger.num = function (target) {\r\n                                if (target == player) return num;\r\n                                else if (typeof event.num == 'function') return event.num(target);\r\n                                else return event.num;\r\n                            };\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    damage: {\r\n                        audio: \"ol_wuqian\",\r\n                        trigger: {\r\n                            source: \"damageBegin1\",\r\n                            player: [\r\n                                \"recoverBegin\",\r\n                                \"damageBegin4\"\r\n                            ]\r\n                        },\r\n                        forced: true,\r\n                        content: function () {\r\n                            if (event.triggername == 'damageBegin4') trigger.num = Math.floor(trigger.num / 2);\r\n                            else trigger.num += trigger.num;\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    again: {\r\n                        trigger: {\r\n                            player: \"useCardAfter\"\r\n                        },\r\n                        filter: function (event, player, name) {\r\n                            if (event.getParent(2).name == 'PSshuangquan_again') return false;\r\n                            if (!event.card || event.card.length == 0) return false;\r\n                            var type = get.type(event.card);\r\n\r\n                            if (['shan', 'wuxie'].includes(event.card.name)) return false;\r\n                            return game.findPlayer2(target => {\r\n                                var info = lib.card[event.card.name];\r\n                                if (info.autoViewAs) {\r\n                                    if (player.canUse({ card: event.card, name: info.autoViewAs }, target, false)) return true;\r\n                                }\r\n                                else if (player.canUse(event.card, target, false)) return true;\r\n                                return false;\r\n                            });\r\n                        },\r\n                        forced: true,\r\n                        content: function () {\r\n                            var createCard = game.createCard2(trigger.card);\r\n                            var info = lib.card[createCard.name];\r\n                            if (info.autoViewAs) player.chooseUseTarget([createCard], { name: info.autoViewAs }, false);\r\n                            else player.chooseUseTarget(createCard, false);\r\n                        },\r\n                        ai: {\r\n                            threaten: 2\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    add: {\r\n                        audio: \"reyingzi\",\r\n                        trigger: {\r\n                            player: \"phaseDrawBegin\"\r\n                        },\r\n                        forced: true,\r\n                        filter: function (event, player) {\r\n                            return !event.numFixed;\r\n                        },\r\n                        content: function () {\r\n                            trigger.num += trigger.num;\r\n                        },\r\n                        ai: {\r\n                            threaten: 1.3\r\n                        },\r\n                        sub: true\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_shen,\r\n        translate: {\r\n            PSshouyige: \"双倍收益哥\",\r\n            PSshuangquan: \"双全\",\r\n            PSshuangquan_info: \"锁定技。<br/>①你视为拥有技能〖马术〗〖飞影〗和〖无双〗。<br/>②你使用【杀】可以额外指定一名目标。<br/>③你造成的所有伤害翻倍，你受到的所有伤害减半（向上取整）。<br/>④你拥有双倍的初始手牌。摸牌阶段，你额外摸等量的牌。<br/>⑤你使用牌后，额外使用对应实体卡牌（不嵌套触发）。<br/>⑥当你不因此技能获得的回合结束后，你执行一个额外的回合。<br/>⑦限定技，当你即将阵亡时，终止此次结算，然后你将体力上限调整为8，再将体力值回复至体力上限。<br/>⑧游戏开始时，你获得等量的装备区副类别栏。<br/>⑨你回复体力时，回复效果翻倍。<br/>⑩你使用【铁索连环】时可额外指定两名目标，使用单体普通锦囊牌时可额外指定一名目标。\"\r\n        },\r\n        rank: rank.legend\r\n    },\r\n    PSrexusheng: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"wu\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PSpojun\"\r\n            ],\r\n            dieAudios: [\r\n                \"re_xusheng\"\r\n            ],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“九个芒果”设计\",\r\n        skills: {\r\n            PSpojun: {\r\n                shaRelated: true,\r\n                audio: \"repojun\",\r\n                trigger: {\r\n                    player: \"useCardToPlayered\"\r\n                },\r\n                direct: true,\r\n                filter: function (event, player) {\r\n                    return event.card.name == 'sha' && event.target.hp > 0 && event.target.countCards('he') > 0;\r\n                },\r\n                content: function () {\r\n                    // player.emotion('zhenji_emotion', 1);\r\n                    player.say([\"闹够了没有？\", \"你犯大吴疆土了！\"].randomGet());\r\n                    var next = player.gainPlayerCard(trigger.target, 'he', [1, Math.min(trigger.target.hp, trigger.target.countCards('he'))], get.prompt('repojun', trigger.target), 'visibleMove');\r\n                    next.set('ai', function (button) {\r\n                        if (!_status.event.goon) return 0;\r\n                        var val = get.value(button.link);\r\n                        if (button.link == _status.event.target.getEquip(2)) return 2 * (val + 3);\r\n                        return val;\r\n                    });\r\n                    next.set('goon', get.attitude(player, trigger.target) <= 0);\r\n                    next.set('forceAuto', true);\r\n                },\r\n                group: \"repojun3\"\r\n            }\r\n        },\r\n        sort: sort.PScharacter_wu,\r\n        translate: {\r\n            PSrexusheng: \"PS徐盛\",\r\n            PSpojun: \"破军\",\r\n            PSpojun_info: \"当你使用【杀】指定目标后，你可以获得其至多X张牌（X为其体力值）。当你因执行【杀】的效果而对一名角色造成伤害时，若该角色的手牌数和装备区内的牌数均不大于你，则此伤害+1。\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PSsunquan: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"wu\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PSzhiheng\",\r\n                \"rejiuyuan\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“九个芒果”设计\",\r\n        replace: [\r\n            \"PSsunquan\",\r\n            \"PShw_sunquan\",\r\n            \"PSquansun\",\r\n            \"db_PSdaweiwuwang\",\r\n            \"PSxie_sunquan\"\r\n        ],\r\n        skills: {\r\n            PSzhiheng: {\r\n                audio: \"rezhiheng\",\r\n                inherit: \"rezhiheng\",\r\n                group: \"PSzhiheng_else\",\r\n                subSkill: {\r\n                    else: {\r\n                        trigger: {\r\n                            target: \"useCardToTarget\"\r\n                        },\r\n                        popup: false,\r\n                        log: false,\r\n                        usable: 1,\r\n                        prompt2: function () {\r\n                            return lib.translate.PSzhiheng_info;\r\n                        },\r\n                        check: function () {\r\n                            return true;\r\n                        },\r\n                        filter: function (event, player) {\r\n                            if (event.addedTargets) return false;\r\n                            return event.targets.length == 1 && player.countDiscardableCards(player, 'he') > 0;\r\n                        },\r\n                        async cost(event, trigger, player) {\r\n                            const { cards, bool } = await player.chooseToDiscard([1, Infinity], 'he', false)\r\n                                .set('ai', () => 1)\r\n                                .set('prompt', get.prompt('PSzhiheng'))\r\n                                .forResult();\r\n                            event.result = {\r\n                                bool,\r\n                                cards,\r\n                                cost_data: {\r\n                                    hs: player.getCards('h')\r\n                                }\r\n                            }\r\n                        },\r\n                        async content(event, trigger, player) {\r\n                            const hs = event.cost_data.hs;\r\n                            player.logSkill('PSzhiheng');\r\n                            let num = 0;\r\n                            if (hs.every(card => event.cards.includes(card))) num = 1;\r\n                            await player.draw(event.cards.length + num);\r\n                        },\r\n                        sub: true\r\n                    }\r\n                },\r\n                ai: {\r\n                    order: 1,\r\n                    result: {\r\n                        player: 1\r\n                    },\r\n                    threaten: 1.55\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_wu,\r\n        translate: {\r\n            PSsunquan: \"PS孙权\",\r\n            PSzhiheng: \"制衡\",\r\n            PSzhiheng_info: \"①出牌阶段限一次/②每回合限一次，当你成为一名角色使用牌的唯一目标时，你可以弃置任意张牌并摸等量的牌，若你在发动此技能时弃置了所有手牌，则你多摸一张牌。\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PScaocao: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"wei\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PSjianxiong\",\r\n                \"rehujia\"\r\n            ],\r\n            isZhugong: true,\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“九个芒果”设计\",\r\n        replace: [\r\n            \"PScacao\",\r\n            \"PShr_caocao\"\r\n        ],\r\n        skills: {\r\n            PSjianxiong: {\r\n                audio: \"rejianxiong\",\r\n                audioname: [\r\n                    \"shen_caopi\"\r\n                ],\r\n                trigger: {\r\n                    target: \"useCardToAfter\"\r\n                },\r\n                filter: function (event, player) {\r\n                    return event.player != player && event.cards.length && ['o', 'd'].includes(get.position(event.cards[0]));\r\n                },\r\n                content: function () {\r\n                    \"step 0\"\r\n                    if (get.itemtype(trigger.cards) == 'cards' && get.position(trigger.cards[0], true) == 'o') {\r\n                        player.gain(trigger.cards, \"gain2\");\r\n                    }\r\n                    player.draw('nodelay');\r\n                },\r\n                ai: {\r\n                    maixie: true,\r\n                    maixie_hp: true,\r\n                    effect: {\r\n                        target: function (card, player, target) {\r\n                            if (player.hasSkillTag('jueqing', false, target)) return [1, -1];\r\n                            if (get.tag(card, 'damage') && player != target) {\r\n                                var cards = card.cards, evt = _status.event;\r\n                                if (evt.player == target && card.name == 'damage' && evt.getParent().type == 'card') cards = evt.getParent().cards.filterInD();\r\n                                if (target.hp <= 1) return;\r\n                                if (get.itemtype(cards) != 'cards') return;\r\n                                for (var i of cards) {\r\n                                    if (get.name(i, target) == 'tao') return [1, 5];\r\n                                }\r\n                                if (get.value(cards, target) >= (7 + target.getDamagedHp())) return [1, 3];\r\n                                return [1, 0.6];\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_wei,\r\n        translate: {\r\n            PScaocao: \"PS曹操\",\r\n            PSjianxiong: \"奸雄\",\r\n            PSjianxiong_info: \"当一名其他角色使用牌指定你为目标，你可以于此牌对你结算后从处理区/弃牌堆中获得此牌并摸一张牌。\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PSdianwei: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"wei\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PSqiangxi\",\r\n                \"PSsizhan\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“九个芒果”设计\",\r\n        skills: {\r\n            PSqiangxi: {\r\n                audio: \"qiangxi_ol_dianwei\",\r\n                enable: \"phaseUse\",\r\n                usable: 2,\r\n                mark: true,\r\n                intro: {\r\n                    content: function (storage, player) {\r\n                        return `强袭造成${lib.skill.PSqiangxi.getUseSkillTime(player) + 1}点伤害`;\r\n                    }\r\n                },\r\n                getUseSkillTime(player) {\r\n                    return player.getAllHistory('useSkill', evt => evt.skill == 'PSqiangxi').length;\r\n                },\r\n                filter: function (event, player) {\r\n                    if (player.hp < 1 && !player.hasCard((card) => lib.skill.PSqiangxi.filterCard(card), 'he')) return false;\r\n                    return game.hasPlayer((current) => lib.skill.PSqiangxi.filterTarget(null, player, current));\r\n                },\r\n                filterCard: function (card) {\r\n                    return get.subtype(card) == 'equip1';\r\n                },\r\n                position: \"he\",\r\n                filterTarget: function (card, player, target) {\r\n                    if (target == player) return false;\r\n                    var stat = player.getStat()._PSqiangxi;\r\n                    return !stat || !stat.includes(target);\r\n                },\r\n                selectCard: function () {\r\n                    if (_status.event.player.hp < 1) return 1;\r\n                    return [0, 1];\r\n                },\r\n                content: function () {\r\n                    'step 0'\r\n                    var stat = player.getStat();\r\n                    if (!stat._PSqiangxi) stat._PSqiangxi = [];\r\n                    stat._PSqiangxi.push(target);\r\n                    if (!cards.length) player.damage('nosource', 'nocard');\r\n                    'step 1'\r\n                    const num = lib.skill.PSqiangxi.getUseSkillTime(player);\r\n                    target.damage('nocard', num);\r\n                    player.markSkill(event.name);\r\n                },\r\n                ai: {\r\n                    damage: true,\r\n                    order: 8,\r\n                    result: {\r\n                        player: function (player, target) {\r\n                            if (player.hasSkill('buqu') && player.hasSkill('xinjuejing')) return 0;\r\n                            if (ui.selected.cards.length) return 0;\r\n                            if (player.hp >= target.hp) return -0.9;\r\n                            if (player.hp <= 2) return -2;\r\n                            return get.damageEffect(player, player, player);\r\n                        },\r\n                        target: function (player, target) {\r\n                            const num = get.damageEffect(target, player, target) * lib.skill.PSqiangxi.getUseSkillTime(player)\r\n                            if (player.hasSkill('buqu') && player.hasSkill('xinjuejing')) return num;\r\n                            if (!ui.selected.cards.length) {\r\n                                if (player.hp < 2) return 0;\r\n                            }\r\n                            return num;\r\n                        }\r\n                    },\r\n                    threaten: 1.5\r\n                }\r\n            },\r\n            PSsizhan: {\r\n                audio: \"cuijue\",\r\n                dutySkill: true,\r\n                locked: false,\r\n                derivation: [\r\n                    \"buqu\",\r\n                    \"xinjuejing\"\r\n                ],\r\n                init: function () {\r\n                    game.changeSkillAudio('buqu', 'PSdianwei', 'juanjia');\r\n                    game.changeSkillAudio('xinjuejing', 'PSdianwei', 'qiexie');\r\n                },\r\n                group: [\r\n                    \"PSsizhan_achieve\",\r\n                    \"PSsizhan_fail\",\r\n                    \"PSsizhan_defend\"\r\n                ],\r\n                subSkill: {\r\n                    defend: {\r\n                        audio: \"cuijue\",\r\n                        trigger: {\r\n                            player: \"damageBegin4\"\r\n                        },\r\n                        usable: 1,\r\n                        filter: function (event, player) {\r\n                            return lib.skill.PSqiangxi.getUseSkillTime(player) > 0;\r\n                        },\r\n                        check: function (event, player) {\r\n                            if (event.num > 1) return true;\r\n                            if (player.hp <= 1) return true;\r\n                            return false;\r\n                        },\r\n                        prompt: \"是否令此伤害-1，然后本局游戏〖强袭〗的发动次数-1？\",\r\n                        content: function () {\r\n                            trigger.num--;\r\n                            const history = player.actionHistory;\r\n                            for (let i = history.length - 1; i >= 0; i--) {\r\n                                if (history[i].useSkill.some(evt => evt.skill.includes('PSqiangxi'))) {\r\n                                    const index = history[i].useSkill.findLastIndex(evt => evt.skill.includes('PSqiangxi'));\r\n                                    history[i].useSkill.splice(index, 1);\r\n                                    break;\r\n                                }\r\n                            }\r\n                            if (_status.currentPhase === player) {\r\n                                player.getStat().skill.PSqiangxi--;\r\n                            }\r\n                            player.markSkill('PSqiangxi');\r\n                        },\r\n                        sub: true,\r\n                        _priority: 0\r\n                    },\r\n                    achieve: {\r\n                        audio: \"cuijue\",\r\n                        trigger: {\r\n                            source: \"dieAfter\"\r\n                        },\r\n                        forced: true,\r\n                        skillAnimation: true,\r\n                        animationColor: \"fire\",\r\n                        filter: function (event, player) {\r\n                            return true;\r\n                        },\r\n                        content: function () {\r\n                            game.log(player, '成功完成使命');\r\n                            player.awakenSkill('PSsizhan');\r\n                            player.loseMaxHp(2);\r\n                            player.addSkills(['buqu', 'xinjuejing']);\r\n                        },\r\n                        sub: true,\r\n                        _priority: 0\r\n                    },\r\n                    fail: {\r\n                        audio: \"cuijue\",\r\n                        trigger: {\r\n                            player: \"dying\"\r\n                        },\r\n                        forced: true,\r\n                        content: function () {\r\n                            game.log(player, '使命失败');\r\n                            player.awakenSkill('PSsizhan');\r\n                            player.recoverTo(player.maxHp);\r\n                            for (let i = 0; i < player.actionHistory.length; i++) {\r\n                                player.actionHistory[i].useSkill = player.actionHistory[i].useSkill.filter(evt => evt.skill != 'PSqiangxi');\r\n                            }\r\n                            if (_status.currentPhase === player) {\r\n                                delete player.getStat().skill.PSqiangxi;\r\n                            }\r\n                            player.markSkill('PSqiangxi');\r\n                        },\r\n                        sub: true,\r\n                        _priority: 0\r\n                    }\r\n                },\r\n                _priority: 0\r\n            }\r\n        },\r\n        sort: sort.PScharacter_wei,\r\n        translate: {\r\n            PSdianwei: \"PS典韦\",\r\n            PSqiangxi: \"强袭\",\r\n            PSqiangxi_info: \"出牌阶段限两次。你可以弃置一张武器牌或受到1点无来源伤害，然后对一名本回合内未成为过〖强袭〗目标的其他角色造成X点伤害。（X为你本局游戏发动此技能的次数）\",\r\n            PSsizhan: \"死战\",\r\n            PSsizhan_info: \"使命技。①每回合限一次，当你受到伤害时，若你本局发动过〖强袭〗的次数不为0，你可以令此伤害-1，然后本局游戏〖强袭〗发动次数-1。②使命:杀死一名角色。③成功：你减2点体力上限，然后获得技能〖不屈〗和〖绝境〗。④失败:当你于使命达成前进入濒死状态，你将体力值回复至体力上限，然后重置〖强袭〗的发动次数。\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PSzhangjiao: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"qun\",\r\n            hp: 3,\r\n            skills: [\r\n                \"PSleiji\",\r\n                \"guidao\",\r\n                \"huangtian\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“九个芒果”设计\",\r\n        skills: {\r\n            PSleiji: {\r\n                audio: \"releiji\",\r\n                audioname: [\r\n                    \"boss_qinglong\"\r\n                ],\r\n                trigger: {\r\n                    global: [\r\n                        \"useCard\",\r\n                        \"respond\"\r\n                    ]\r\n                },\r\n                filter: function (event, player) {\r\n                    return event.card.name == 'shan';\r\n                },\r\n                direct: true,\r\n                content: function () {\r\n                    \"step 0\";\r\n                    player.chooseTarget(get.prompt2('releiji'), function (card, player, target) {\r\n                        return target != player;\r\n                    }).ai = function (target) {\r\n                        if (target.hasSkill('hongyan')) return 0;\r\n                        return get.damageEffect(target, _status.event.player, _status.event.player, 'thunder');\r\n                    };\r\n                    \"step 1\"\r\n                    if (result.bool) {\r\n                        player.logSkill('releiji', result.targets, 'thunder');\r\n                        event.target = result.targets[0];\r\n                        event.target.judge(function (card) {\r\n                            var suit = get.suit(card);\r\n                            if (suit == 'spade') return -4;\r\n                            if (suit == 'club') return -2;\r\n                            return 0;\r\n                        }).judge2 = function (result) {\r\n                            return result.bool == false ? true : false;\r\n                        };\r\n                    }\r\n                    else {\r\n                        event.finish();\r\n                    }\r\n                    \"step 2\"\r\n                    if (result.suit == 'club') {\r\n                        event.target.damage('thunder');\r\n                        player.recover();\r\n                    }\r\n                    else if (result.suit == 'spade') {\r\n                        event.target.damage(2, 'thunder');\r\n                    }\r\n                },\r\n                ai: {\r\n                    useShan: true,\r\n                    effect: {\r\n                        target: function (card, player, target, current) {\r\n                            if (get.tag(card, 'respondShan')) {\r\n                                var hastarget = game.hasPlayer(function (current) {\r\n                                    return get.attitude(target, current) < 0;\r\n                                });\r\n                                var be = target.countCards('e', { color: 'black' });\r\n                                if (target.countCards('h', 'shan') && be) {\r\n                                    if (!target.hasSkill('guidao')) return 0;\r\n                                    return [0, hastarget ? target.countCards('he') / 2 : 0];\r\n                                }\r\n                                if (target.countCards('h', 'shan') && target.countCards('h') > 2) {\r\n                                    if (!target.hasSkill('guidao')) return 0;\r\n                                    return [0, hastarget ? target.countCards('h') / 4 : 0];\r\n                                }\r\n                                if (target.countCards('h') > 3 || (be && target.countCards('h') >= 2)) {\r\n                                    return [0, 0];\r\n                                }\r\n                                if (target.countCards('h') == 0) {\r\n                                    return [1.5, 0];\r\n                                }\r\n                                if (target.countCards('h') == 1 && !be) {\r\n                                    return [1.2, 0];\r\n                                }\r\n                                if (!target.hasSkill('guidao')) return [1, 0.05];\r\n                                return [1, Math.min(0.5, (target.countCards('h') + be) / 4)];\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_qun,\r\n        translate: {\r\n            PSzhangjiao: \"PS张角\",\r\n            PSleiji: \"雷击\",\r\n            PSleiji_info: \"当一名角色使用或打出一张【闪】时，你可令一名其他角色进行一次判定：若结果为梅花，其受到一点雷电伤害，然后你回复一点体力；若结果为黑桃，其受到两点雷电伤害。\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PSsunshangxiang: {\r\n        info: {\r\n            sex: \"female\",\r\n            group: \"wu\",\r\n            hp: 3,\r\n            skills: [\r\n                \"PSxiaoji\",\r\n                \"PSjieyin\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“九个鲨雕”设计\",\r\n        replace: [\r\n            \"PSsunshangxiang\",\r\n            \"PSshu_sunshangxiang\"\r\n        ],\r\n        skills: {\r\n            PSxiaoji: {\r\n                audio: \"ext:PS武将/audio/skill:2\",\r\n                trigger: {\r\n                    player: \"loseAfter\",\r\n                    global: [\r\n                        \"equipAfter\",\r\n                        \"addJudgeAfter\",\r\n                        \"gainAfter\",\r\n                        \"loseAsyncAfter\",\r\n                        \"addToExpansionAfter\"\r\n                    ]\r\n                },\r\n                frequent: true,\r\n                filter: function (event, player, name) {\r\n                    if (name == \"equipAfter\" && event.player == player) return true;\r\n                    var evt = event.getl(player);\r\n                    return evt && evt.player == player && evt.es && evt.es.length > 0;\r\n                },\r\n                content: function () {\r\n                    \"step 0\"\r\n                    if (event.triggername == \"equipAfter\" && trigger.player == player) player.draw(_status.currentPhase == player ? 1 : 3);\r\n                    event.count = trigger.getl(player).es.length;\r\n                    if (!event.count) event.finish();\r\n                    \"step 1\"\r\n                    event.count--;\r\n                    player.draw(_status.currentPhase == player ? 1 : 3);\r\n                    \"step 2\"\r\n                    if (event.count > 0) {\r\n                        player.chooseBool(get.prompt2('xiaoji')).set('frequentSkill', 'xiaoji').ai = lib.filter.all;\r\n                    }\r\n                    \"step 3\"\r\n                    if (result.bool) {\r\n                        player.logSkill('xiaoji');\r\n                        event.goto(1);\r\n                    }\r\n                },\r\n                ai: {\r\n                    noe: true,\r\n                    reverseEquip: true,\r\n                    effect: {\r\n                        target: function (card, player, target, current) {\r\n                            if (get.type(card) == 'equip' && !get.cardtag(card, 'gifts')) return [1, 3];\r\n                        }\r\n                    }\r\n                },\r\n                _priority: 0\r\n            },\r\n            PSjieyin: {\r\n                audio: \"rejieyin\",\r\n                enable: \"phaseUse\",\r\n                filterCard: true,\r\n                usable: 1,\r\n                position: \"he\",\r\n                filter: function (event, player) {\r\n                    return player.countCards('he') > 0;\r\n                },\r\n                check: function (card) {\r\n                    var player = _status.event.player;\r\n                    if (get.position(card) == 'e') {\r\n                        var subtype = get.subtype(card);\r\n                        if (!game.hasPlayer(function (current) {\r\n                            return current != player && current.hp != player.hp && get.attitude(player, current) > 0 && !current.countCards('e', { subtype: subtype });\r\n                        })) {\r\n                            return 0;\r\n                        }\r\n                        if (player.countCards('h', { subtype: subtype })) return 20 - get.value(card);\r\n                        return 10 - get.value(card);\r\n                    }\r\n                    else {\r\n                        if (player.countCards('e')) return 0;\r\n                        if (player.countCards('h', { type: 'equip' })) return 0;\r\n                        return 8 - get.value(card);\r\n                    }\r\n                },\r\n                filterTarget: function (card, player, target) {\r\n                    if (!target.hasSex('male')) return false;\r\n                    var card = ui.selected.cards[0];\r\n                    if (!card) return false;\r\n                    if (get.position(card) == 'e' && !target.canEquip(card)) return false;\r\n                    return true;\r\n                },\r\n                discard: false,\r\n                delay: false,\r\n                lose: false,\r\n                content: function () {\r\n                    'step 0'\r\n                    if (get.position(cards[0]) == 'e') event._result = { index: 0 };\r\n                    else if (get.type(cards[0]) != 'equip' || !target.canEquip(cards[0])) event._result = { index: 1 };\r\n                    else player.chooseControl().set('choiceList', [\r\n                        '将' + get.translation(cards[0]) + '置入' + get.translation(target) + '的装备区',\r\n                        '弃置' + get.translation(cards[0]),\r\n                    ]).ai = function () { return 1 };\r\n                    'step 1'\r\n                    if (result.index == 0) {\r\n                        player.$give(cards, target, false);\r\n                        target.equip(cards[0]);\r\n                    }\r\n                    else {\r\n                        player.discard(cards);\r\n                    }\r\n                    'step 2'\r\n                    let players = [player, target];\r\n                    players.forEach(current => {\r\n                        if (current.hp < current.maxHp) current.recover();\r\n                        else current.draw();\r\n                    });\r\n                },\r\n                ai: {\r\n                    order: function () {\r\n                        var player = _status.event.player;\r\n                        var es = player.getCards('e');\r\n                        for (var i = 0; i < es.length; i++) {\r\n                            if (player.countCards('h', { subtype: get.subtype(es[i]) })) return 10;\r\n                        }\r\n                        return 2;\r\n                    },\r\n                    result: {\r\n                        target: function (player, target) {\r\n                            var goon = function () {\r\n                                var es = player.getCards('e');\r\n                                for (var i = 0; i < es.length; i++) {\r\n                                    if (player.countCards('h', { subtype: get.subtype(es[i]) })) return true;\r\n                                }\r\n                                return false;\r\n                            }\r\n                            if (player.hp < target.hp) {\r\n                                if (player.isHealthy()) {\r\n                                    if (!player.needsToDiscard(1) || goon()) return 0.1;\r\n                                    return 0;\r\n                                }\r\n                                return 1.5;\r\n                            }\r\n                            if (player.hp > target.hp) {\r\n                                if (target.isHealthy()) {\r\n                                    if (!player.needsToDiscard(1) || goon()) return 0.1;\r\n                                    return 0;\r\n                                }\r\n                                return 1;\r\n                            }\r\n                            return 0;\r\n                        }\r\n                    }\r\n                },\r\n                _priority: 0\r\n            }\r\n        },\r\n        sort: sort.PScharacter_wu,\r\n        translate: {\r\n            PSsunshangxiang: \"PS孙尚香\",\r\n            PSxiaoji: \"枭姬\",\r\n            PSxiaoji_info: \"当一张装备牌进入或离开你的装备区后，你可以摸一张牌，若当前回合角色不是你，你改为摸三张牌。\",\r\n            PSjieyin: \"结姻\",\r\n            PSjieyin_info: \"出牌阶段限一次，你可以选择一名男性角色并弃置一张手牌或将装备区内的一张装备牌置于其装备区，你与其之中体力值等于体力上限的角色摸一张牌，体力值小于体力上限的角色摸一张牌的角色回复1点体力。\",\r\n            \"#ext:PS武将/audio/skill/PSxiaoji1\": \"小女就爱这舞刀弄枪。\",\r\n            \"#ext:PS武将/audio/skill/PSxiaoji2\": \"小看我，你可是要吃亏的。\"\r\n        },\r\n        rank: rank.junk\r\n    },\r\n    PSliuzan: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"wu\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PSfenyin\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“九个芒果”设计\",\r\n        skills: {\r\n            PSfenyin: {\r\n                audio: \"fenyin\",\r\n                trigger: {\r\n                    player: \"useCard\"\r\n                },\r\n                frequent: true,\r\n                locked: false,\r\n                preHidden: true,\r\n                filter: function (event, player) {\r\n                    if (_status.currentPhase != player) return false;\r\n                    return player.getHistory('useCard').length <= 5;\r\n                },\r\n                content: function () {\r\n                    player.draw(player.getHistory('useCard').length);\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_wu,\r\n        translate: {\r\n            PSliuzan: \"PS留赞\",\r\n            PSfenyin: \"奋音\",\r\n            PSfenyin_info: \" 你的回合内，当你使用第X张牌时，你摸X张牌。（X最多为5）\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PSyuanshu: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"qun\",\r\n            hp: 4,\r\n            skills: [\r\n                \"rewangzun\",\r\n                \"retongji\",\r\n                \"PSjiwei\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“梦舞灬愁”设计\",\r\n        skills: {\r\n            PSjiwei: {\r\n                audio: \"weidi\",\r\n                trigger: {\r\n                    source: \"damageAfter\"\r\n                },\r\n                forced: true,\r\n                skillAnimation: true,\r\n                animationColor: \"thunder\",\r\n                filter: function (event, player) {\r\n                    return player.identity != 'zhu' && event.player.identity == 'zhu' && game.zhu && game.zhu.isZhu && event.card.name == 'sha';\r\n                },\r\n                logTarget: function () {\r\n                    return [game.zhu];\r\n                },\r\n                content: function () {\r\n                    'step 0'\r\n                    var sf = player.identity;\r\n                    game.zhu.identity = sf;\r\n                    game.zhu.setIdentity(sf);\r\n                    game.zhu.identityShown = false;\r\n                    game.zhu.update();\r\n                    player.identity = 'zhu';\r\n                    player.showIdentity();\r\n                    player.update();\r\n                    var target = game.zhu;\r\n                    delete target.isZhu;\r\n                    game.zhu = player;\r\n                    'step 1'\r\n                    player.gainMaxHp();\r\n                    player.recover();\r\n                }\r\n            },\r\n            PSqifan: {\r\n                mode: [\r\n                    \"identity\"\r\n                ],\r\n                trigger: {\r\n                    global: \"gameStart\"\r\n                },\r\n                forced: true,\r\n                content: function () {\r\n                    'step 0'\r\n                    var target = game.zhu;\r\n                    delete target.isZhu;\r\n                    player.identity = 'zhu';\r\n                    player.setIdentity('zhu');\r\n                    player.identityShown = true;\r\n                    game.zhu = player;\r\n                    'step 1'\r\n                    var players = get.players(false, true);\r\n                    for (var i = 0; i < players.length; i++) {\r\n                        if (players[i] != player) {\r\n                            players[i].identity = 'fan';\r\n                            players[i].setIdentity('fan');\r\n                            players[i].identityShown = true;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_qun,\r\n        translate: {\r\n            PSyuanshu: \"骷髅王\",\r\n            PSjiwei: \"继位\",\r\n            PSjiwei_info: \"锁定技，当你对主公使用【杀】造成伤害后，若你的身份不是主公，你与主公交换身份，然后增加一点体力上限并回复一点体力。\",\r\n            PSqifan: \"七反\",\r\n            PSqifan_info: \"锁定技，游戏开始时，你的身份更改为主公，你令其他角色的身份更改为反贼且明置。\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PSzhanghe: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"wei\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PSqiaobian\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“神鬼高达”设计\",\r\n        skills: {\r\n            PSqiaobian: {\r\n                audio: \"reqiaobian\",\r\n                group: [\r\n                    \"PSqiaobian_judge\",\r\n                    \"PSqiaobian_draw\",\r\n                    \"PSqiaobian_use\",\r\n                    \"PSqiaobian_discard\"\r\n                ],\r\n                preHidden: true,\r\n                subSkill: {\r\n                    judge: {\r\n                        audio: 2,\r\n                        trigger: {\r\n                            player: \"phaseJudgeBefore\"\r\n                        },\r\n                        prompt: \"###是否发动【巧变·判定】？###摸一张牌跳过判定阶段\",\r\n                        filter: function (event, player) {\r\n                            if (!event.isOnline() && (!event.isMine())) return false;\r\n                            return true;\r\n                        },\r\n                        content: function () {\r\n                            player.draw();\r\n                            player.logSkill('qiaobian');\r\n                            trigger.cancel();\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    draw: {\r\n                        audio: 2,\r\n                        trigger: {\r\n                            player: \"phaseDrawBegin1\"\r\n                        },\r\n                        prompt: \"###是否发动【巧变·摸牌】？###摸一张牌跳过摸牌阶段，并选择获得其他一至两名角色的各一张手牌\",\r\n                        filter: function (event, player) {\r\n                            return !event.numFixed;\r\n                        },\r\n                        content: function () {\r\n                            \"step 0\"\r\n                            var check;\r\n                            var i, num = game.countPlayer(function (current) {\r\n                                return current != player && current.countCards('h') && get.attitude(player, current) <= 0;\r\n                            });\r\n                            check = (num >= 2);\r\n                            player.draw();\r\n                            player.chooseTarget('获得其他一至两名角色的各一张手牌', [1, 2], function (card, player, target) {\r\n                                return target.countCards('h') > 0 && player != target;\r\n                            }, function (target) {\r\n                                if (!_status.event.aicheck) return 0;\r\n                                var att = get.attitude(_status.event.player, target);\r\n                                if (target.hasSkill('tuntian')) return att / 10;\r\n                                return 1 - att;\r\n                            }).set('aicheck', check);\r\n                            \"step 1\"\r\n                            if (result.bool) {\r\n                                player.logSkill('reqiaobian', result.targets);\r\n                                player.gainMultiple(result.targets);\r\n                                trigger.cancel();\r\n                            }\r\n                            else {\r\n                                event.finish();\r\n                            }\r\n                            \"step 2\"\r\n                            game.delay();\r\n                        },\r\n                        ai: {\r\n                            threaten: 2,\r\n                            expose: 0.3\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    use: {\r\n                        audio: 2,\r\n                        trigger: {\r\n                            player: \"phaseUseBefore\"\r\n                        },\r\n                        prompt: \"###是否发动【巧变·出牌】？###摸一张牌跳过出牌阶段，并选择移动场上一张牌\",\r\n                        content: function () {\r\n                            \"step 0\"\r\n                            var check;\r\n                            if (!player.canMoveCard()) {\r\n                                check = false;\r\n                            }\r\n                            else {\r\n                                check = game.hasPlayer(function (current) {\r\n                                    return get.attitude(player, current) > 0 && current.countCards('j');\r\n                                });\r\n                                if (!check) {\r\n                                    if (player.countCards('h') > player.hp + 1) {\r\n                                        check = false;\r\n                                    }\r\n                                    else if (player.countCards('h', { name: ['wuzhong'] })) {\r\n                                        check = false;\r\n                                    }\r\n                                    else {\r\n                                        check = true;\r\n                                    }\r\n                                }\r\n                            }\r\n                            player.draw();\r\n                            trigger.cancel();\r\n                            player.moveCard();\r\n                            player.logSkill('qiaobian');\r\n                        },\r\n                        ai: {\r\n                            expose: 0.2\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    discard: {\r\n                        audio: 2,\r\n                        trigger: {\r\n                            player: \"phaseDiscardBefore\"\r\n                        },\r\n                        prompt: \"###是否发动【巧变·弃牌】？###摸一张牌跳过弃牌阶段\",\r\n                        content: function () {\r\n                            player.draw();\r\n                            player.logSkill('reqiaobian');\r\n                            trigger.cancel();\r\n                        },\r\n                        sub: true\r\n                    }\r\n                },\r\n                ai: {\r\n                    threaten: 3\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_wei,\r\n        translate: {\r\n            PSzhanghe: \"PS张郃\",\r\n            PSqiaobian: \"巧变\",\r\n            PSqiaobian_info: \"你可以摸一张牌并跳过自己的一个阶段(准备阶段和结束阶段除外)；若你以此法跳过了摸牌阶段，则你可以获得至多两名其他角色的各一张手牌；若你以此法跳过了出牌阶段，则你可以移动场上的一张牌。\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PSsh_zhangfei: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"shu\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PSshihuang\",\r\n                \"PSpaoxiao\"\r\n            ],\r\n            dieAudios: [\r\n                \"zhangfei\"\r\n            ],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“风龙散人”设计\",\r\n        skills: {\r\n            PSshihuang: {\r\n                audio: \"sbpaoxiao\",\r\n                trigger: {\r\n                    global: [\r\n                        \"loseAfter\",\r\n                        \"loseAsyncAfter\"\r\n                    ]\r\n                },\r\n                frequent: true,\r\n                filter: function (event, player) {\r\n                    if (event.player === player || ['useCard', 'respond'].includes(event.getParent().name)) return false;\r\n                    for (var i of event.cards) {\r\n                        if (get.position(i, true) == \"d\") return true;\r\n                    }\r\n                    return false;\r\n                },\r\n                content: function () {\r\n                    \"step 0\"\r\n                    if (trigger.delay == false) game.delay();\r\n                    \"step 1\"\r\n                    var cards = [];\r\n                    for (var i = 0; i < trigger.cards.length; i++) {\r\n                        if (get.position(trigger.cards[i]) == 'd') {\r\n                            cards.push(trigger.cards[i]);\r\n                        }\r\n                    }\r\n                    if (cards.length) {\r\n                        player.gain(cards, 'gain2', 'log');\r\n                    }\r\n                },\r\n                ai: {\r\n                    effect: {\r\n                        target: function (card, player, target) {\r\n                            if (get.tag(card, 'respond') && target.countCards('h') > 1) return [1, 0.2];\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            PSpaoxiao: {\r\n                audio: \"paoxiao\",\r\n                firstDo: true,\r\n                audioname: [\r\n                    \"re_zhangfei\",\r\n                    \"guanzhang\",\r\n                    \"xiahouba\"\r\n                ],\r\n                trigger: {\r\n                    player: \"useCard1\"\r\n                },\r\n                forced: true,\r\n                intro: {\r\n                    content: \"本回合已使用#张杀\"\r\n                },\r\n                onremove: true,\r\n                init: function (player, skill) {\r\n                    if (!player.storage[skill]) player.storage[skill] = 1;\r\n                },\r\n                filter: function (event, player) {\r\n                    return !event.audioed && event.card.name == 'sha' && player.countUsed('sha', true) > 1 && event.getParent().type == 'phase';\r\n                },\r\n                content: function () {\r\n                    player.addMark('PSpaoxiao', 1);\r\n                    trigger.audioed = true;\r\n                },\r\n                mod: {\r\n                    cardUsable: function (card, player, num) {\r\n                        if (card.name == 'sha') return Infinity;\r\n                    }\r\n                },\r\n                group: [\r\n                    \"PSpaoxiao_cancel\",\r\n                    \"PSpaoxiao_remove\"\r\n                ],\r\n                subSkill: {\r\n                    cancel: {\r\n                        audio: \"keji\",\r\n                        audioname: [\r\n                            \"re_lvmeng\",\r\n                            \"sp_lvmeng\"\r\n                        ],\r\n                        trigger: {\r\n                            player: \"phaseDiscardBefore\"\r\n                        },\r\n                        forced: true,\r\n                        frequent: function (event, player) {\r\n                            return player.needsToDiscard();\r\n                        },\r\n                        filter: function (event, player) {\r\n                            return player.countUsed('sha', true) <= game.countPlayer();\r\n                        },\r\n                        content: function () {\r\n                            trigger.cancel();\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    remove: {\r\n                        trigger: {\r\n                            player: \"phaseJieshuBegin\"\r\n                        },\r\n                        forced: true,\r\n                        filter: function (event, player) {\r\n                            return player.countMark('PSpaoxiao') >= 1;\r\n                        },\r\n                        content: function () {\r\n                            player.storage.PSpaoxiao = 0;\r\n                        },\r\n                        sub: true\r\n                    }\r\n                },\r\n                ai: {\r\n                    unequip: true,\r\n                    skillTagFilter: function (player, tag, arg) {\r\n                        if (!get.zhu(player, 'shouyue')) return false;\r\n                        if (arg && arg.name == 'sha') return true;\r\n                        return false;\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_shu,\r\n        translate: {\r\n            PSsh_zhangfei: \"拾荒张飞\",\r\n            PSshihuang: \"拾荒\",\r\n            PSshihuang_info: \"每当其他角色有牌非因使用或打出进入弃牌堆时，你可以获得之。\",\r\n            PSpaoxiao: \"咆哮\",\r\n            PSpaoxiao_info: \"锁定技，出牌阶段，你使用【杀】没有数量限制。当你于回合内使用的【杀】数量不大于X，则你跳过你的弃牌阶段。（X为当前场上存活的人数）\"\r\n        },\r\n        rank: rank.epic\r\n    },\r\n    PStongxiangge: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"shu\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PStongxiang\"\r\n            ],\r\n            dieAudios: [\r\n                \"maliang\"\r\n            ],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“九个芒果”设计\",\r\n        skills: {\r\n            PStongxiang: {\r\n                audio: \"zishu\",\r\n                trigger: {\r\n                    global: \"gainAfter\"\r\n                },\r\n                frequent: true,\r\n                filter: function (event, player) {\r\n                    var evt = event.getParent('phaseDraw');\r\n                    if (evt && evt.name == 'phaseDraw') return false;\r\n                    return event.player != player;\r\n                },\r\n                content: function () {\r\n                    player.draw('nodelay', trigger.cards.length);\r\n                },\r\n                group: \"PStongxiang_discard\",\r\n                subSkill: {\r\n                    discard: {\r\n                        audio: \"zishu\",\r\n                        frequent: false,\r\n                        trigger: {\r\n                            player: \"loseAfter\"\r\n                        },\r\n                        filter: function (event, player) {\r\n                            if (event.type != 'discard') return false;\r\n                            for (var i of event.cards) {\r\n                                if (get.position(i, true) == \"d\") return true;\r\n                            }\r\n                            return false;\r\n                        },\r\n                        filterTarget: function (card, player, target) {\r\n                            return player != target && target.countCards('he') >= 1;\r\n                        },\r\n                        selectTarget: 1,\r\n                        content: function () {\r\n                            'step 0'\r\n                            player.chooseTarget('令一名其他角色弃置等量的牌', function (card, player, target) {\r\n                                if (player == target) return false;\r\n                                return target.countDiscardableCards(player, 'he');\r\n                            }).set('ai', function (target) {\r\n                                return get.attitude(_status.event.player, target) < 0;\r\n                            });\r\n                            'step 1'\r\n                            if (result.bool) {\r\n\r\n                                result.targets[0].chooseToDiscard(true, 'he', trigger.cards.length);\r\n                            }\r\n                            else event.finish();\r\n                        },\r\n                        sub: true\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_shu,\r\n        translate: {\r\n            PStongxiangge: \"同甘共苦哥\",\r\n            PStongxiang: \"同享\",\r\n            PStongxiang_info: \"当其他角色于摸牌阶段外获得牌后，你可以摸等量的牌；当你的牌因弃置进入弃牌堆时，你可以令一名其他角色弃置等量的牌。\"\r\n        },\r\n        rank: rank.epic\r\n    },\r\n    PSrs_wolong: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"shu\",\r\n            hp: 3,\r\n            skills: [\r\n                \"PSranshang\",\r\n                \"bazhen\",\r\n                \"rehuoji\",\r\n                \"rekanpo\",\r\n                \"cangzhuo\"\r\n            ],\r\n            dieAudios: [\r\n                \"sp_zhugeliang\"\r\n            ],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“宫愿合”设计\",\r\n        skills: {\r\n            PSranshang: {\r\n                audio: \"ranshang\",\r\n                trigger: {\r\n                    source: \"damageEnd\"\r\n                },\r\n                filter: function (event, player) {\r\n                    return event.hasNature('fire') && event.player.isAlive();\r\n                },\r\n                prompt: \"是否令目标获得等量的“燃”标记\",\r\n                check: function (event, player) {\r\n                    return get.attitude(player, event.player) < 0;\r\n                },\r\n                content: function () {\r\n                    trigger.player.randomDiscard();\r\n                    trigger.player.addMark('PSranshang', trigger.num);\r\n                    trigger.player.addSkill('PSranshang_lose', trigger.num);\r\n                },\r\n                intro: {\r\n                    name2: \"燃\",\r\n                    content: \"mark\"\r\n                },\r\n                ai: {\r\n                    effect: {\r\n                        player: function (card, player, target, current) {\r\n                            if (card.name == 'sha') {\r\n                                if (game.hasNature(card, 'fire') || player.hasSkill('zhuque_skill')) return 2;\r\n                            }\r\n                            if (get.tag(card, 'fireDamage') && current < 0) return 2;\r\n                        }\r\n                    }\r\n                },\r\n                marktext: \"燃\",\r\n                subSkill: {\r\n                    lose: {\r\n                        audio: \"ranshang2\",\r\n                        trigger: {\r\n                            player: \"phaseJieshuBegin\"\r\n                        },\r\n                        forced: true,\r\n                        filter: function (event, player) {\r\n                            return player.countMark('PSranshang') > 0;\r\n                        },\r\n                        content: function () {\r\n                            player.loseHp(player.countMark('PSranshang'));\r\n                        },\r\n                        sub: true\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_shu,\r\n        translate: {\r\n            PSrs_wolong: \"燃伤卧龙\",\r\n            PSranshang: \"燃伤\",\r\n            PSranshang_info: \"当你对一名角色造成火焰伤害后，你可以令目标随机弃置一张牌，并获得等同于伤害数的“燃”标记；有“燃”的角色结束阶段开始时，其失去X点体力。（X为“燃”标记的数量）\"\r\n        },\r\n        rank: rank.junk\r\n    },\r\n    PShuanggai: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"wu\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PSkurou\",\r\n                \"zhaxiang\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“闹够没有界徐盛”设计\",\r\n        skills: {\r\n            PSkurou: {\r\n                audio: \"rekurou\",\r\n                enable: \"phaseUse\",\r\n                filterCard: true,\r\n                check: function (card) {\r\n                    return 8 - get.value(card);\r\n                },\r\n                position: \"he\",\r\n                content: function () {\r\n                    player.loseHp();\r\n                },\r\n                ai: {\r\n                    order: 8,\r\n                    result: {\r\n                        player: function (player) {\r\n                            return get.effect(player, { name: 'losehp' }, player, player);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_wu,\r\n        translate: {\r\n            PShuanggai: \"PS黄盖\",\r\n            PSkurou: \"苦肉\",\r\n            PSkurou_info: \"出牌阶段，你可以弃置一张牌，然后失去1点体力。\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PSxushao: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"qun\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PSpingjian\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“宫愿合”设计\",\r\n        replace: [\r\n            \"PSsb_xushao\",\r\n            \"PSxushao\"\r\n        ],\r\n        skills: {\r\n            PSpingjian: {\r\n                audio: \"pingjian\",\r\n                trigger: {\r\n                    player: [\r\n                        \"phaseZhunbeiBegin\",\r\n                        \"phaseDrawBegin2\",\r\n                        \"damageEnd\",\r\n                        \"phaseJieshuBegin\",\r\n                        \"dying\"\r\n                    ]\r\n                },\r\n                initList: function () {\r\n                    var list = [];\r\n                    if (_status.connectMode) var list = get.charactersOL();\r\n                    else {\r\n                        var list = [];\r\n                        for (var i in lib.character) {\r\n                            if (lib.filter.characterDisabled2(i) || lib.filter.characterDisabled(i)) continue;\r\n                            list.push(i);\r\n                        }\r\n                    }\r\n                    game.countPlayer2(function (current) {\r\n                        list.remove(current.name);\r\n                        list.remove(current.name1);\r\n                        list.remove(current.name2);\r\n                        if (current.storage.rehuashen && current.storage.rehuashen.character) list.removeArray(current.storage.rehuashen.character)\r\n                    });\r\n                    _status.characterlist = list;\r\n                },\r\n                frequent: true,\r\n                content: function () {\r\n                    'step 0'\r\n                    if (!player.storage.PSpingjian) player.storage.PSpingjian = [];\r\n                    event._result = { bool: true };\r\n                    'step 1'\r\n                    if (result.bool) {\r\n                        if (!_status.characterlist) {\r\n                            lib.skill.PSpingjian.initList();\r\n                        }\r\n                        var list = [];\r\n                        var skills = [];\r\n                        var map = [];\r\n                        _status.characterlist.randomSort();\r\n                        var name2 = event.triggername;\r\n                        for (var i = 0; i < _status.characterlist.length; i++) {\r\n                            var name = _status.characterlist[i];\r\n                            if (name.indexOf('zuoci') != -1 || name.indexOf('xushao') != -1) continue;\r\n                            var skills2 = lib.character[name][3];\r\n                            for (var j = 0; j < skills2.length; j++) {\r\n                                if (player.storage.PSpingjian.includes(skills2[j])) continue;\r\n                                if (skills.includes(skills2[j]) && lib.skill.PSfushi.characterList().includes(name)) {\r\n                                    list.add(name);\r\n                                    if (!map[name]) map[name] = [];\r\n                                    map[name].push(skills2[j]);\r\n                                    skills.add(skills2[j]);\r\n                                    continue;\r\n                                }\r\n                                var list2 = [skills2[j]];\r\n                                game.expandSkills(list2);\r\n                                for (var k = 0; k < list2.length; k++) {\r\n                                    var info = lib.skill[list2[k]];\r\n                                    if (!info || !info.trigger || !info.trigger.player || info.silent || info.limited || info.juexingji || info.zhuanhuanji || info.hiddenSkill || info.dutySkill) continue;\r\n                                    if ((info.trigger.player == name2 || Array.isArray(info.trigger.player) && info.trigger.player.includes(name2)) && lib.skill.PSfushi.characterList().includes(name)) {\r\n                                        if (info.init || info.ai && (info.ai.combo || info.ai.notemp || info.ai.neg)) continue;\r\n                                        if (info.filter) {\r\n                                            try {\r\n                                                var bool = info.filter(trigger, player, name2);\r\n                                                if (!bool) continue;\r\n                                            }\r\n                                            catch (e) {\r\n                                                continue;\r\n                                            }\r\n                                        }\r\n                                        list.add(name);\r\n                                        if (!map[name]) map[name] = [];\r\n                                        map[name].push(skills2[j]);\r\n                                        skills.add(skills2[j]);\r\n                                        break;\r\n                                    }\r\n                                }\r\n                            }\r\n                            if (list.length > 2) break;\r\n                        }\r\n                        if (!skills.length) {\r\n                            //player.draw();\r\n                            event.finish();\r\n                        }\r\n                        else {\r\n                            //skills.unshift('摸一张牌');\r\n                            player.chooseControl(skills).set('dialog', ['请选择要发动的技能', [list, 'character']]).set('ai', function () { return 0 });\r\n                        }\r\n                    }\r\n                    else event.finish();\r\n                    'step 2'\r\n                    if (result.control == '摸一张牌') {\r\n                        player.draw();\r\n                        return;\r\n                    }\r\n                    player.storage.PSpingjian.add(result.control);\r\n                    if (event.triggername == 'phaseDrawBegin2') {\r\n                        player.addTempSkill(result.control, 'phaseDrawEnd');\r\n                    }\r\n                    else if (event.triggername == 'phaseZhunbeiBegin') {\r\n                        player.addTempSkill(result.control, 'phaseZhunbei');\r\n                    }\r\n                    else if (event.triggername == 'damageEnd') {\r\n                        player.addTempSkill(result.control, 'damageAfter');\r\n                    }\r\n                    else if (event.triggername == 'phaseJieshuBegin') {\r\n                        player.addTempSkill(result.control, 'phaseJieshu');\r\n                    }\r\n                    else {\r\n                        player.addTempSkill(result.control, 'dyingAfter');\r\n                    }\r\n                },\r\n                group: \"pingjian_use\",\r\n                phaseUse_special: [\r\n                    \"xinfu_lingren\"\r\n                ]\r\n            }\r\n        },\r\n        sort: sort.PScharacter_qun,\r\n        translate: {\r\n            PSxushao: \"PS许劭\",\r\n            PSpingjian: \"评荐\",\r\n            PSpingjian_info: \"准备阶段开始时/摸牌阶段开始时/结束阶段开始时/当你受到伤害后/当你进入濒死状态时/出牌阶段限一次，你可以令系统随机从剩余武将牌堆中检索出三张拥有发动时机为准备阶段开始时/摸牌阶段开始时/结束阶段开始时/当你受到伤害后/进入濒死状态时/出牌阶段的技能的武将牌。然后你可以选择尝试发动其中一个技能。每个技能每局只能选择一次。\",\r\n            PSpingjian_use: \"评荐\"\r\n        },\r\n        rank: rank.epic\r\n    },\r\n    PScaoxiu: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"wei\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PSqianju\",\r\n                \"PSqingxi\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“SC雁微凉”设计\",\r\n        skills: {\r\n            PSqianju: {\r\n                mod: {\r\n                    globalFrom: function (from, to, distance) {\r\n                        return distance - Math.max(1, from.getDamagedHp());\r\n                    },\r\n                    globalTo: function (from, to, distance) {\r\n                        return distance + Math.max(1, to.getDamagedHp());\r\n                    },\r\n                    cardname: function (card, player, name) {\r\n                        if (lib.card[card.name].subtype == 'equip3' || lib.card[card.name].subtype == 'equip4' || lib.card[card.name].subtype == 'equip6') return 'sha';\r\n                    },\r\n                    cardnature: function (card) {\r\n                        if (lib.card[card.name].subtype == 'equip3' || lib.card[card.name].subtype == 'equip4' || lib.card[card.name].subtype == 'equip6') return false;\r\n                    }\r\n                },\r\n                trigger: {\r\n                    global: \"phaseBefore\",\r\n                    player: \"enterGame\"\r\n                },\r\n                forced: true,\r\n                filter: function (event, player) {\r\n                    return event.name != 'phase' || game.phaseNumber == 0;\r\n                },\r\n                content: function () {\r\n                    if (player.hasEnabledSlot(3)) player.disableEquip(3);\r\n                    if (player.hasEnabledSlot(4)) player.disableEquip(4);\r\n                }\r\n            },\r\n            PSqingxi: {\r\n                audio: \"reqingxi\",\r\n                trigger: {\r\n                    player: \"useCardToPlayer\"\r\n                },\r\n                intro: {\r\n                    content: \"本回合已发动#次【倾袭】\"\r\n                },\r\n                init: function (player) {\r\n                    player.storage.PSqingxi_damage = [];\r\n                },\r\n                filter: function (event, player) {\r\n                    if (player.storage.PSqingxi >= player.getAttackRange()) return false;\r\n                    return event.card.name == 'sha' || (get.type(event.card, false) == 'trick' && get.tag(event.card, 'damage') > 0);\r\n                },\r\n                check: function (event, player) {\r\n                    return get.attitude(player, event.target) < 0;\r\n                },\r\n                logTarget: \"target\",\r\n                content: function () {\r\n                    for (var i = 0; i < trigger.targets.length; i++) {\r\n                        player.discardPlayerCard(trigger.targets[i], 'he', false);\r\n                    }\r\n                    player.addMark('PSqingxi', 1);\r\n                    player.storage.PSqingxi_damage.add(trigger.card);\r\n                    game.log(trigger.card, '对', trigger.target, '造成的伤害+1');\r\n                    game.delayx();\r\n                },\r\n                group: [\r\n                    \"PSqingxi_remove\",\r\n                    \"PSqingxi_damage\",\r\n                    \"PSqingxi_summer\"\r\n                ],\r\n                subSkill: {\r\n                    damage: {\r\n                        trigger: {\r\n                            source: \"damageBegin1\"\r\n                        },\r\n                        forced: true,\r\n                        filter: function (event, player) {\r\n                            return event.card && player.storage.PSqingxi_damage.includes(event.card);\r\n                        },\r\n                        content: function () {\r\n                            trigger.num++;\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    remove: {\r\n                        trigger: {\r\n                            player: \"phaseUseEnd\"\r\n                        },\r\n                        filter: function (event, player) {\r\n                            return player.hasMark('PSqingxi') && player.isAlive();\r\n                        },\r\n                        forced: true,\r\n                        content: function () {\r\n                            player.removeMark('PSqingxi', player.countMark('PSqingxi'));\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    summer: {\r\n                        sub: true,\r\n                        trigger: {\r\n                            player: \"useCardAfter\"\r\n                        },\r\n                        silent: true,\r\n                        filter: function (event, player) {\r\n                            return player == _status.currentPhase && player.storage.PSqingxi_damage.includes(event.card);\r\n                        },\r\n                        content: function () {\r\n                            player.storage.PSqingxi_damage.remove(trigger.card);\r\n                        },\r\n                        forced: true,\r\n                        popup: false\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_wei,\r\n        translate: {\r\n            PScaoxiu: \"PS曹休\",\r\n            PSqianju: \"千驹\",\r\n            PSqianju_info: \"锁定技，游戏开始时，废除你的一个攻击马栏和防御马栏；你计算与其他角色之间的距离减X，其他角色计算与你之间的距离+X；你的坐骑牌均视为杀。（X为你当前已损失的体力值且至少为1）\",\r\n            PSqingxi: \"倾袭\",\r\n            PSqingxi_info: \"当你使用伤害类锦囊或杀指定一名其他角色时，你可以弃置其1张牌，若此牌造成伤害，该伤害+1；若本回合此技能的发动次数等于你的攻击范围，你令此技能失效直到本回合结束。\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PSshen_zhuge: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"shen\",\r\n            hp: 3,\r\n            skills: [\r\n                \"PSqixing\",\r\n                \"PSkuangfeng\",\r\n                \"PSdawu\"\r\n            ],\r\n            dieAudios: [\r\n                \"shen_zhugeliang\"\r\n            ],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“欧文哈尔”设计\",\r\n        skills: {\r\n            PSqixing: {\r\n                audio: \"qixing\",\r\n                unique: true,\r\n                trigger: {\r\n                    global: \"phaseBefore\",\r\n                    player: [\r\n                        \"enterGame\",\r\n                        \"phaseZhunbeiBegin\"\r\n                    ]\r\n                },\r\n                forced: true,\r\n                filter: function (event, player) {\r\n                    return player.getExpansions('PSqixing').length < 7 && (event.name != 'phase' || game.phaseNumber == 0);\r\n                },\r\n                content: function () {\r\n                    \"step 0\"\r\n                    var num = player.getExpansions('PSqixing').length;\r\n                    player.addToExpansion(get.cards(7 - num), 'draw').gaintag.add('PSqixing');\r\n                    \"step 1\"\r\n                    var cards = player.getExpansions('PSqixing');\r\n                    if (!cards.length || !player.countCards('h')) {\r\n                        event.finish();\r\n                        return;\r\n                    }\r\n                    var next = player.chooseToMove('七星：是否交换“星”和手牌？');\r\n                    next.set('list', [\r\n                        [get.translation(player) + '（你）的星', cards],\r\n                        ['手牌区', player.getCards('h')],\r\n                    ]);\r\n                    next.set('filterMove', function (from, to) {\r\n                        return typeof to != 'number';\r\n                    });\r\n                    next.set('processAI', function (list) {\r\n                        var player = _status.event.player, cards = list[0][1].concat(list[1][1]).sort(function (a, b) {\r\n                            return get.useful(a) - get.useful(b);\r\n                        }), cards2 = cards.splice(0, player.getExpansions('PSqixing').length);\r\n                        return [cards2, cards];\r\n                    });\r\n                    \"step 2\"\r\n                    if (result.bool) {\r\n                        var pushs = result.moved[0], gains = result.moved[1];\r\n                        pushs.removeArray(player.getExpansions('PSqixing'));\r\n                        gains.removeArray(player.getCards('h'));\r\n                        if (!pushs.length || pushs.length != gains.length) return;\r\n                        player.addToExpansion(pushs, player, 'giveAuto').gaintag.add('PSqixing');\r\n                        game.log(player, '将', pushs, '作为“星”置于武将牌上');\r\n                        player.gain(gains, 'gain2');\r\n                    }\r\n                },\r\n                intro: {\r\n                    markcount: \"expansion\",\r\n                    mark: function (dialog, content, player) {\r\n                        var content = player.getExpansions('PSqixing');\r\n                        if (content && content.length) {\r\n                            if (player == game.me || player.isUnderControl()) {\r\n                                dialog.addAuto(content);\r\n                            }\r\n                            else {\r\n                                return '共有' + get.cnNumber(content.length) + '张星';\r\n                            }\r\n                        }\r\n                    },\r\n                    content: function (content, player) {\r\n                        var content = player.getExpansions('PSqixing');\r\n                        if (content && content.length) {\r\n                            if (player == game.me || player.isUnderControl()) {\r\n                                return get.translation(content);\r\n                            }\r\n                            return '共有' + get.cnNumber(content.length) + '张星';\r\n                        }\r\n                    }\r\n                },\r\n                group: [\r\n                    \"PSqixing_draw\"\r\n                ],\r\n                ai: {\r\n                    combo: \"PSdawu\"\r\n                },\r\n                subSkill: {\r\n                    draw: {\r\n                        trigger: {\r\n                            player: \"phaseDrawAfter\"\r\n                        },\r\n                        direct: true,\r\n                        filter: function (event, player) {\r\n                            return player.getExpansions('PSqixing').length > 0 && player.countCards('h') > 0;\r\n                        },\r\n                        content: function () {\r\n                            \"step 0\"\r\n                            var cards = player.getExpansions('PSqixing');\r\n                            if (!cards.length || !player.countCards('h')) {\r\n                                event.finish();\r\n                                return;\r\n                            }\r\n                            var next = player.chooseToMove('七星：是否交换“星”和手牌？');\r\n                            next.set('list', [\r\n                                [get.translation(player) + '（你）的星', cards],\r\n                                ['手牌区', player.getCards('h')],\r\n                            ]);\r\n                            next.set('filterMove', function (from, to) {\r\n                                return typeof to != 'number';\r\n                            });\r\n                            next.set('processAI', function (list) {\r\n                                var player = _status.event.player, cards = list[0][1].concat(list[1][1]).sort(function (a, b) {\r\n                                    return get.value(a) - get.value(b);\r\n                                }), cards2 = cards.splice(0, player.getExpansions('PSqixing').length);\r\n                                return [cards2, cards];\r\n                            });\r\n                            \"step 1\"\r\n                            if (result.bool) {\r\n                                var pushs = result.moved[0], gains = result.moved[1];\r\n                                pushs.removeArray(player.getExpansions('PSqixing'));\r\n                                gains.removeArray(player.getCards('h'));\r\n                                if (!pushs.length || pushs.length != gains.length) return;\r\n                                player.logSkill('PSqixing_draw');\r\n                                player.addToExpansion(pushs, player, 'giveAuto').gaintag.add('PSqixing');\r\n                                game.log(player, '将', pushs, '作为“星”置于武将牌上');\r\n                                player.gain(gains, 'gain2');\r\n                            }\r\n                        },\r\n                        sub: true\r\n                    }\r\n                }\r\n            },\r\n            PSkuangfeng: {\r\n                audio: \"kuangfeng\",\r\n                trigger: {\r\n                    player: \"phaseJieshuBegin\"\r\n                },\r\n                direct: true,\r\n                filter: function (event, player) {\r\n                    return player.getExpansions('PSqixing').length;\r\n                },\r\n                content: function () {\r\n                    \"step 0\"\r\n                    var num = Math.min(game.countPlayer(), player.getExpansions('PSqixing').length);\r\n                    player.chooseTarget(get.prompt('PSkuangfeng'), '令至多' + get.cnNumber(num) + '名角色获得“狂风”标记',\r\n                        [1, num]).ai = function (target) {\r\n                            return -1;\r\n                        }\r\n                    \"step 1\"\r\n                    if (result.bool) {\r\n                        var targets = result.targets.sortBySeat();\r\n                        player.logSkill('PSkuangfeng', targets, 'fire');\r\n                        var length = targets.length;\r\n                        targets.forEach(target => {\r\n                            target.addAdditionalSkill(`PSkuangfeng_${player.playerid}`, 'PSkuangfeng_storage');\r\n                            target.markAuto('PSkuangfeng_storage', [player]);\r\n                        });\r\n                        player.addTempSkill('PSkuangfeng_damage', { player: 'phaseUseEnd' })\r\n                        player.chooseCardButton('选择弃置' + get.cnNumber(length) + '张“星”', length, player.getExpansions('PSqixing'), true);\r\n                    }\r\n                    else {\r\n                        event.finish();\r\n                    }\r\n                    \"step 2\"\r\n                    player.loseToDiscardpile(result.links);\r\n                },\r\n                ai: {\r\n                    combo: \"PSqixing\"\r\n                },\r\n                subSkill: {\r\n                    storage: {\r\n                        charlotte: true,\r\n                        intro: {\r\n                            content: function (storage) {\r\n                                return `共有${storage.length}枚标记`;\r\n                            }\r\n                        },\r\n                        ai: {\r\n                            effect: {\r\n                                target: function (card, player, target, current) {\r\n                                    if (get.tag(card, 'fireDamage') && current < 0) return 1.5;\r\n                                }\r\n                            }\r\n                        },\r\n                        _priority: 0\r\n                    },\r\n                    damage: {\r\n                        trigger: {\r\n                            global: \"damageBegin3\"\r\n                        },\r\n                        filter: function (event, player) {\r\n                            return event.hasNature('fire') && event.player.getStorage('PSkuangfeng_storage').includes(player);\r\n                        },\r\n                        charlotte: true,\r\n                        forced: true,\r\n                        logTarget: \"player\",\r\n                        content: function () {\r\n                            trigger.num++;\r\n                        },\r\n                        onremove: function (player) {\r\n                            game.countPlayer2(current => {\r\n                                if (current.getStorage('PSkuangfeng_storage').includes(player)) {\r\n                                    current.unmarkAuto('PSkuangfeng_storage', player);\r\n                                    current.removeAdditionalSkill(`PSkuangfeng_${player.playerid}`);\r\n                                }\r\n                            }, true);\r\n                        },\r\n                        _priority: 0\r\n                    }\r\n                }\r\n            },\r\n            PSdawu: {\r\n                trigger: {\r\n                    player: \"phaseJieshuBegin\"\r\n                },\r\n                direct: true,\r\n                filter: function (event, player) {\r\n                    return player.getExpansions('PSqixing').length;\r\n                },\r\n                audio: \"dawu\",\r\n                content: function () {\r\n                    \"step 0\"\r\n                    var num = Math.min(game.countPlayer(), player.getExpansions('PSqixing').length);\r\n                    player.chooseTarget(get.prompt('PSdawu'), '令至多' + get.cnNumber(num) + '名角色获得“大雾”标记',\r\n                        [1, num]).set('ai', function (target) {\r\n                            if (target.isMin()) return 0;\r\n                            if (target.hasSkill('biantian2')) return 0;\r\n                            var att = get.attitude(player, target);\r\n                            if (att >= 4) {\r\n                                if (_status.event.allUse) return att;\r\n                                if (target.hp == 1) return att;\r\n                                if (target.hp == 2 && target.countCards('he') <= 2) return att * 0.7;\r\n                                return 0;\r\n                            }\r\n                            return -1;\r\n                        }).set('allUse', player.getExpansions('PSqixing').length >= game.countPlayer(function (current) {\r\n                            return get.attitude(player, current) > 4;\r\n                        }) * 2);\r\n                    \"step 1\"\r\n                    if (result.bool) {\r\n                        var targets = result.targets.sortBySeat();\r\n                        player.logSkill('PSdawu', result.targets, 'thunder');\r\n                        var length = targets.length;\r\n                        targets.forEach(target => {\r\n                            target.addAdditionalSkill(`PSdawu_${player.playerid}`, 'PSdawu_storage');\r\n                            target.markAuto('PSdawu_storage', [player]);\r\n                        });\r\n                        player.addTempSkill('PSdawu_damage', { player: 'phaseUseEnd' })\r\n                        player.chooseCardButton('选择弃置' + get.cnNumber(length) + '张“星”', length, player.getExpansions('PSqixing'), true);\r\n                    }\r\n                    else {\r\n                        event.finish();\r\n                    }\r\n                    \"step 2\"\r\n                    player.loseToDiscardpile(result.links);\r\n                },\r\n                ai: {\r\n                    combo: \"PSqixing\"\r\n                },\r\n                subSkill: {\r\n                    storage: {\r\n                        charlotte: true,\r\n                        ai: {\r\n                            nofire: true,\r\n                            nodamage: true,\r\n                            effect: {\r\n                                target: function (card, player, target, current) {\r\n                                    if (get.tag(card, 'damage') && !get.tag(card, 'thunderDamage')) return 'zeroplayertarget';\r\n                                }\r\n                            }\r\n                        },\r\n                        intro: {\r\n                            content: function (storage) {\r\n                                return `共有${storage.length}枚标记`;\r\n                            }\r\n                        },\r\n                        _priority: 0\r\n                    },\r\n                    damage: {\r\n                        trigger: {\r\n                            global: \"damageBegin4\"\r\n                        },\r\n                        filter: function (event, player) {\r\n                            return !event.hasNature('thunder') && event.player.getStorage('PSdawu_storage').includes(player);\r\n                        },\r\n                        forced: true,\r\n                        charlotte: true,\r\n                        logTarget: \"player\",\r\n                        content: function () {\r\n                            trigger.cancel();\r\n                        },\r\n                        onremove: function (player) {\r\n                            game.countPlayer2(current => {\r\n                                if (current.getStorage('PSdawu_storage').includes(player)) {\r\n                                    current.unmarkAuto('PSdawu_storage', player);\r\n                                    current.removeAdditionalSkill(`PSdawu_${player.playerid}`);\r\n                                }\r\n                            }, true);\r\n                        },\r\n                        _priority: 0\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_shen,\r\n        translate: {\r\n            PSshen_zhuge: \"PS神诸葛亮\",\r\n            PSqixing: \"七星\",\r\n            PSqixing_info: \"游戏开始时/准备阶段开始时，若你的“星”少于7，你将牌堆顶的牌至于你的武将牌上，称之为“星”，你的“星”至多为7。然后/摸牌阶段结束后，你可用任意数量的手牌等量交换这些“星”。\",\r\n            PSkuangfeng: \"狂风\",\r\n            PSkuangfeng_info: \"结束阶段，你可以弃置X张“星”并指定等量的角色：直到你的出牌阶段结束，该角色受到火焰伤害时，此伤害+1。\",\r\n            PSdawu: \"大雾\",\r\n            PSdawu_info: \"结束阶段，你可以弃置X张“星”并指定等量的角色：直到你的出牌阶段结束，当这些角色受到非雷电伤害时，防止此伤害。\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PShuangyueying: {\r\n        info: {\r\n            sex: \"female\",\r\n            group: \"shu\",\r\n            hp: 3,\r\n            skills: [\r\n                \"PSjizhi\",\r\n                \"PSqicai\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“九个陈皮”设计\",\r\n        skills: {\r\n            PSjizhi: {\r\n                audio: \"rejizhi\",\r\n                audioname: [\r\n                    \"lukang\"\r\n                ],\r\n                locked: false,\r\n                trigger: {\r\n                    player: \"useCard\"\r\n                },\r\n                forced: true,\r\n                filter: function (event) {\r\n                    return get.cardNameLength(event.card) >= 3;\r\n                },\r\n                content: function () {\r\n                    'step 0'\r\n                    event.cards = get.cards(2);\r\n                    player.showCards(event.cards, '集智');\r\n                    \"step 1\"\r\n                    let cardsx = [cards[0]];\r\n                    for (var i = 1; i < cards.length; i++) {\r\n                        if (get.cardNameLength(cards[i]) > get.cardNameLength(cardsx[0])) cardsx = [cards[i]];\r\n                        else if (get.cardNameLength(cards[i]) == get.cardNameLength(cardsx[0])) cardsx.push(cards[i]);\r\n                    }\r\n                    const card = cardsx.randomGet();\r\n                    player.gain(card, 'gain2');\r\n                    game.cardsDiscard(cards.filter(c => c !== card));\r\n                },\r\n                ai: {\r\n                    threaten: 1.4,\r\n                    noautowuxie: true\r\n                },\r\n                mod: {\r\n                    aiOrder: function (player, card, num) {\r\n                        if (get.cardNameLength(card) >= 3) return 13;\r\n                    }\r\n                }\r\n            },\r\n            PSqicai: {\r\n                isUse: function (event) {\r\n                    if (event.name != 'cardsDiscard') return false;\r\n                    var evtx = event.getParent();\r\n                    if (evtx.name != 'orderingDiscard') return false;\r\n                    var evt2 = (evtx.relatedEvent || evtx.getParent());\r\n                    return (evt2.name == 'phaseJudge' || evt2.name == 'useCard');\r\n                },\r\n                mod: {\r\n                    targetInRange: function (card, player, target, now) {\r\n                        if (get.cardNameLength(card) >= 2) return true;\r\n                    },\r\n                    cardUsable: function (card, player, num) {\r\n                        if (get.cardNameLength(card) >= 1) return Infinity;\r\n                    },\r\n                    maxHandcard: function (player, numx) {\r\n                        var num = 0;\r\n                        var history = game.getGlobalHistory('cardMove', function (evt) {\r\n                            if (evt.name == 'lose') return evt.position == ui.discardPile;\r\n                            return evt.name == 'cardsDiscard';\r\n                        });\r\n                        for (var i = history.length - 1; i >= 0; i--) {\r\n                            var evt = history[i];\r\n                            var cards2 = evt.cards;\r\n                            if (cards2.length && !lib.skill.PSqicai.isUse(evt)) {\r\n                                num += cards2.length;\r\n                            }\r\n                        }\r\n                        return numx + num;\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_shu,\r\n        translate: {\r\n            PShuangyueying: \"PS黄月英\",\r\n            PSjizhi: \"集智\",\r\n            PSjizhi_info: \"锁定技，当你使用字数不小于3的牌时，你展示牌堆顶两张牌，获得其中字数较多的一张，若字数相同则改为随机获得其中一张，然后将其余的牌置入弃牌堆。\",\r\n            PSqicai: \"奇才\",\r\n            PSqicai_info: \"锁定技，你使用字数不小于2的牌无距离限制，使用字数不小于1的牌无次数限制，你的手牌上限+X。（X为本回合不因使用而进入弃牌堆的牌数）\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PSshen_ganning: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"shen\",\r\n            hp: 3,\r\n            maxHp: 6,\r\n            skills: [\r\n                \"drlt_poxi\",\r\n                \"PSjieying\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“神鬼高达”设计\",\r\n        skills: {\r\n            PSjieying: {\r\n                audio: \"drlt_jieying\",\r\n                locked: false,\r\n                global: \"PSjieying_mark\",\r\n                group: [\r\n                    \"PSjieying_1\",\r\n                    \"PSjieying_2\",\r\n                    \"PSjieying_3\"\r\n                ],\r\n                subSkill: {\r\n                    1: {\r\n                        audio: \"drlt_jieying\",\r\n                        trigger: {\r\n                            player: \"phaseZhunbeiBegin\"\r\n                        },\r\n                        forced: true,\r\n                        filter: function (event, player) {\r\n                            return !game.hasPlayer(function (current) {\r\n                                return current.hasMark('PSjieying_mark');\r\n                            });\r\n                        },\r\n                        content: function () {\r\n                            player.addMark('PSjieying_mark', 1);\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    2: {\r\n                        audio: \"drlt_jieying\",\r\n                        trigger: {\r\n                            player: \"phaseJieshuBegin\"\r\n                        },\r\n                        direct: true,\r\n                        filter: function (event, player) {\r\n                            return player.hasMark('PSjieying_mark');\r\n                        },\r\n                        content: function () {\r\n                            'step 0'\r\n                            player.chooseTarget(get.prompt('drlt_jieying'), \"将“营”交给一名角色；其摸牌阶段多摸一张牌，出牌阶段使用【杀】的次数上限+1且手牌上限+1。该角色回合结束后，其移去“营”标记，然后你获得其所有手牌。\", function (card, player, target) {\r\n                                return target != player;\r\n                            }).ai = function (target) {\r\n                                if (get.attitude(player, target) > 0)\r\n                                    return 0.1;\r\n                                if (get.attitude(player, target) < 1 && (target.isTurnedOver() || target.countCards('h') < 1))\r\n                                    return 0.2;\r\n                                if (get.attitude(player, target) < 1 && target.countCards('h') > 0 && target.countCards('j', { name: 'lebu' }) > 0)\r\n                                    return target.countCards('h') * 0.8 + target.getHandcardLimit() * 0.7 + 2;\r\n                                if (get.attitude(player, target) < 1 && target.countCards('h') > 0)\r\n                                    return target.countCards('h') * 0.8 + target.getHandcardLimit() * 0.7;\r\n                                return 1;\r\n                            };\r\n                            'step 1'\r\n                            if (result.bool) {\r\n                                var target = result.targets[0];\r\n                                player.line(target);\r\n                                player.logSkill('drlt_jieying', target);\r\n                                var mark = player.countMark('PSjieying_mark');\r\n                                player.removeMark('PSjieying_mark', mark);\r\n                                target.addMark('PSjieying_mark', mark);\r\n                            };\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    3: {\r\n                        audio: \"drlt_jieying\",\r\n                        trigger: {\r\n                            global: \"phaseUseBegin\"\r\n                        },\r\n                        forced: true,\r\n                        filter: function (event, player) {\r\n                            return player != event.player && event.player.hasMark('PSjieying_mark') && event.player.isAlive();\r\n                        },\r\n                        logTarget: \"player\",\r\n                        content: function () {\r\n                            if (trigger.player.countCards('h') > 0) {\r\n                                trigger.player.give(trigger.player.getCards('h'), player);\r\n                            }\r\n                            trigger.player.removeMark('PSjieying_mark', trigger.player.countMark('PSjieying_mark'));\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    mark: {\r\n                        marktext: \"营\",\r\n                        intro: {\r\n                            name: \"营\",\r\n                            content: \"mark\"\r\n                        },\r\n                        mod: {\r\n                            cardUsable: function (card, player, num) {\r\n                                if (player.hasMark('PSjieying_mark') && card.name == 'sha') return num + game.countPlayer(function (current) {\r\n                                    return current.hasSkill('PSjieying');\r\n                                });\r\n                            },\r\n                            maxHandcard: function (player, num) {\r\n                                if (player.hasMark('PSjieying_mark')) return num + game.countPlayer(function (current) {\r\n                                    return current.hasSkill('PSjieying');\r\n                                });\r\n                            }\r\n                        },\r\n                        audio: \"drlt_jieying\",\r\n                        trigger: {\r\n                            player: \"phaseDrawBegin2\"\r\n                        },\r\n                        forced: true,\r\n                        filter: function (event, player) {\r\n                            return !event.numFixed && player.hasMark('PSjieying_mark') && game.hasPlayer(function (current) {\r\n                                return current.hasSkill('PSjieying');\r\n                            });\r\n                        },\r\n                        content: function () {\r\n                            trigger.num += game.countPlayer(function (current) {\r\n                                return current.hasSkill('PSjieying');\r\n                            });\r\n                        },\r\n                        ai: {\r\n                            nokeep: true,\r\n                            skillTagFilter: function (player) {\r\n                                if (!player.hasMark('PSjieying_mark')) return false;\r\n                            }\r\n                        },\r\n                        sub: true\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_shen,\r\n        translate: {\r\n            PSshen_ganning: \"PS神甘宁\",\r\n            PSjieying: \"劫营\",\r\n            PSjieying_info: \"回合开始时，若场上没有拥有“营”标记的角色，你获得1个“营”标记；结束阶段，你可以将你的一个“营”标记交给一名角色；有“营”标记的角色摸牌阶段多摸一张牌，出牌阶段使用【杀】的次数上限+1，手牌上限+1。有“营”的其他角色出牌阶段开始时，其移去“营”标记，然后你获得其所有手牌。\"\r\n        },\r\n        rank: rank.epic\r\n    },\r\n    PSguanning: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"qun\",\r\n            hp: 3,\r\n            maxHp: 7,\r\n            skills: [\r\n                \"PSdunshi\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“杯糕萍琪派”设计\",\r\n        skills: {\r\n            PSdunshi: {\r\n                audio: \"dunshi\",\r\n                enable: [\r\n                    \"chooseToUse\",\r\n                    \"chooseToRespond\"\r\n                ],\r\n                usable: 1,\r\n                hiddenCard: function (player, name) {\r\n                    return (!player.getStorage('PSdunshi').includes(name) && !player.getStat('skill').PSdunshi && lib.inpile.includes(name));\r\n                },\r\n                init: function (player, skill) {\r\n                    if (!player.storage[skill]) player.storage[skill] = [[], 0];\r\n                },\r\n                marktext: \"席\",\r\n                mark: true,\r\n                intro: {\r\n                    markcount: function (storage) {\r\n                        return storage[1];\r\n                    },\r\n                    content: function (storage, player) {\r\n                        if (!storage) return;\r\n                        var str = '<li>';\r\n                        if (storage[0].length) {\r\n                            if (lib.inpile.length === storage[0].length) str += '已删除所有牌名';\r\n                            else str += `已删除牌名：${get.translation(storage[0])}`;\r\n                        } else {\r\n                            str += '暂无已删除牌名';\r\n                        }\r\n                        str += '<br><li>“席”标记数量：';\r\n                        str += (storage[1]);\r\n                        return str;\r\n                    }\r\n                },\r\n                chooseButton: {\r\n                    dialog: function (event, player) {\r\n                        var list = [];\r\n                        for (var i = 0; i < lib.inpile.length; i++) {\r\n                            var name = lib.inpile[i];\r\n                            if (player.storage.PSdunshi[0].includes(name)) continue;\r\n                            if (name == 'sha') {\r\n                                list.push(['基本', '', 'sha']);\r\n                                for (var j of lib.inpile_nature) list.push(['基本', '', 'sha', j]);\r\n                            }\r\n                            else if (get.type(name) == 'trick') list.push(['锦囊', '', name]);\r\n                            else if (get.type(name) == 'basic') list.push(['基本', '', name]);\r\n                        }\r\n                        if (list.length == 0) {\r\n                            return ui.create.dialog('遁世已无可用牌');\r\n                        }\r\n                        return ui.create.dialog('遁世', [list, 'vcard']);\r\n                    },\r\n                    filter: function (button, player) {\r\n                        var evt = _status.event.getParent();\r\n                        return evt.filterCard({ name: button.link[2], isCard: true }, player, evt);\r\n                    },\r\n                    check: function (button) {\r\n                        var player = _status.event.player;\r\n                        if (player.countCards('hs', button.link[2]) > 0) return 0;\r\n                        if (button.link[2] == 'wugu') return 0;\r\n                        var effect = player.getUseValue(button.link[2]);\r\n                        if (effect > 0) return effect;\r\n                        return 0;\r\n                    },\r\n                    backup: function (links, player) {\r\n                        return {\r\n                            audio: 'dunshi',\r\n                            filterCard: function () { return false },\r\n                            popname: true,\r\n                            viewAs: {\r\n                                name: links[0][2],\r\n                                isCard: true,\r\n                            },\r\n                            selectCard: -1,\r\n                            precontent: function () {\r\n                                player.addTempSkill('PSdunshi_damage');\r\n                                player.storage.PSdunshi_damage = event.result.card.name;\r\n                            },\r\n                        }\r\n                    }\r\n                },\r\n                initList: function (player) {\r\n                    var list, skills = [];\r\n                    if (get.mode() == 'guozhan') {\r\n                        list = [];\r\n                        for (var i in lib.characterPack.mode_guozhan) list.push(i);\r\n                    }\r\n                    else if (_status.connectMode) list = get.charactersOL();\r\n                    else {\r\n                        list = [];\r\n                        for (var i in lib.character) {\r\n                            if (lib.filter.characterDisabled2(i) || lib.filter.characterDisabled(i)) continue;\r\n                            list.push(i);\r\n                        }\r\n                    }\r\n                    for (var i of list) {\r\n                        if (i.indexOf('gz_jun') == 0) continue;\r\n                        for (var j of lib.character[i][3]) {\r\n                            if (j == 'bolan') continue;\r\n                            var skill = lib.skill[j];\r\n                            if (!skill || skill.zhuSkill || skill.dutySkill || lib.skill.bolan.banned.includes(j)) continue;\r\n                            if (skill.init || skill.ai && (skill.ai.combo || skill.ai.notemp || skill.ai.neg)) continue;\r\n                            var info = lib.translate[j + '_info'];\r\n                            if (info && info.indexOf('出牌', '受伤', '结束') != -1) skills.add(j);\r\n\r\n                        }\r\n                    }\r\n                    _status.PSdunshi_list = skills;\r\n                },\r\n                ai: {\r\n                    respondSha: true,\r\n                    respondShan: true,\r\n                    skillTagFilter: function (player, tag, arg) {\r\n                        if (player.getStat('skill').dunshi) return false;\r\n                        switch (tag) {\r\n                            case 'respondSha': return (_status.event.type != 'phase' || (player == game.me || player.isUnderControl() || player.isOnline()));\r\n                            case 'respondShan': return;\r\n                            case 'save':\r\n                                if (arg == player) return true;\r\n                                return;\r\n                        }\r\n                    },\r\n                    order: 2,\r\n                    result: {\r\n                        player: function (player) {\r\n                            if (_status.event.type == 'dying') {\r\n                                return get.attitude(player, _status.event.dying);\r\n                            }\r\n                            return 1;\r\n                        }\r\n                    }\r\n                },\r\n                subSkill: {\r\n                    backup: {\r\n                        audio: \"dunshi\",\r\n                        sub: true\r\n                    },\r\n                    damage: {\r\n                        audio: \"dunshi\",\r\n                        trigger: {\r\n                            global: \"damageBegin2\"\r\n                        },\r\n                        forced: true,\r\n                        charlotte: true,\r\n                        filter: function (event, player) {\r\n                            return event.source == _status.currentPhase;\r\n                        },\r\n                        onremove: true,\r\n                        logTarget: \"source\",\r\n                        content: function () {\r\n                            'step 0'\r\n                            event.cardname = player.storage.PSdunshi_damage;\r\n                            player.removeSkill('PSdunshi_damage');\r\n                            event.target = trigger.source;\r\n                            event.videoId = lib.status.videoId++;\r\n                            var func = function (card, id, card2, card3) {\r\n                                var list = [\r\n                                    '防止即将对' + card3 + '造成的伤害，并令' + card + '获得一个技能描述中包含“出牌/受伤/结束”的技能',\r\n                                    '从〖遁世〗中删除【' + card2 + '】并获得一枚“席”',\r\n                                    '减1点体力上限，然后摸等同于“席”数的牌',\r\n                                ];\r\n                                var choiceList = ui.create.dialog('遁世：请选择两项');\r\n                                choiceList.videoId = id;\r\n                                for (var i = 0; i < list.length; i++) {\r\n                                    var str = '<div class=\"popup text\" style=\"width:calc(100% - 10px);display:inline-block\">';\r\n                                    str += list[i];\r\n                                    str += '</div>';\r\n                                    var next = choiceList.add(str);\r\n                                    next.firstChild.addEventListener(lib.config.touchscreen ? 'touchend' : 'click', ui.click.button);\r\n                                    next.firstChild.link = i;\r\n                                    /* for (var j in lib.element.button) {\r\n                                        next[j] = lib.element.button[j];\r\n                                    } */\r\n                                    Object.setPrototypeOf(next, lib.element.Button.prototype);\r\n                                    choiceList.buttons.add(next.firstChild);\r\n                                }\r\n                                return choiceList;\r\n                            };\r\n                            if (player.isOnline2()) {\r\n                                player.send(func, get.translation(trigger.source), event.videoId, get.translation(event.cardname), get.translation(trigger.player));\r\n                            }\r\n                            event.dialog = func(get.translation(trigger.source), event.videoId, get.translation(event.cardname), get.translation(trigger.player));\r\n                            if (player != game.me || _status.auto) {\r\n                                event.dialog.style.display = 'none';\r\n                            }\r\n                            var next = player.chooseButton();\r\n                            next.set('dialog', event.videoId);\r\n                            next.set('forced', true);\r\n                            next.set('selectButton', 2);\r\n                            next.set('ai', function (button) {\r\n                                var player = _status.event.player;\r\n                                switch (button.link) {\r\n                                    case 0:\r\n                                        if (get.attitude(player, _status.currentPhase) > 0) return 3;\r\n                                        return 0;\r\n                                    case 1:\r\n                                        return 1;\r\n                                    case 2:\r\n                                        var num = player.storage.PSdunshi[1];\r\n                                        for (var i of ui.selected.buttons) {\r\n                                            if (i.link == 1) num++;\r\n                                        }\r\n                                        if (num > 0 && player.isDamaged()) return 2;\r\n                                        return 0;\r\n                                }\r\n                            });\r\n                            'step 1'\r\n                            if (player.isOnline2()) {\r\n                                player.send('closeDialog', event.videoId);\r\n                            }\r\n                            event.dialog.close();\r\n                            event.links = result.links.sort();\r\n                            for (var i of event.links) {\r\n                                game.log(player, '选择了', '#g【遁世】', '的', '#y选项' + get.cnNumber(i + 1, true));\r\n                            }\r\n                            if (event.links.includes(0)) {\r\n                                trigger.cancel();\r\n                                if (!_status.PSdunshi_list) lib.skill.PSdunshi.initList();\r\n                                var list = _status.PSdunshi_list.filter(function (i) {\r\n                                    return !target.hasSkill(i, null, null, false);\r\n                                }).randomGets(4);\r\n                                if (list.length == 0) event.goto(3);\r\n                                else {\r\n                                    event.videoId = lib.status.videoId++;\r\n                                    var func = function (skills, id, target) {\r\n                                        var dialog = ui.create.dialog('forcebutton');\r\n                                        dialog.videoId = id;\r\n                                        dialog.add('令' + get.translation(target) + '获得一个技能');\r\n                                        for (var i = 0; i < skills.length; i++) {\r\n                                            dialog.add('<div class=\"popup pointerdiv\" style=\"width:80%;display:inline-block\"><div class=\"skill\">【' + get.translation(skills[i]) + '】</div><div>' + lib.translate[skills[i] + '_info'] + '</div></div>');\r\n                                        }\r\n                                        dialog.addText(' <br> ');\r\n                                    }\r\n                                    if (player.isOnline()) player.send(func, list, event.videoId, target);\r\n                                    else if (player == game.me) func(list, event.videoId, target);\r\n                                    player.chooseControl(list).set('ai', function () {\r\n                                        var controls = _status.event.controls;\r\n                                        if (controls.includes('cslilu')) return 'cslilu';\r\n                                        return controls[0];\r\n                                    });\r\n                                }\r\n                            }\r\n                            else event.goto(3);\r\n                            'step 2'\r\n                            game.broadcastAll('closeDialog', event.videoId);\r\n                            target.addSkills(result.control);\r\n                            'step 3'\r\n                            var storage = player.storage.PSdunshi;\r\n                            if (event.links.includes(1)) {\r\n                                storage[0].add(event.cardname);\r\n                                storage[1]++;\r\n                                player.markSkill('PSdunshi');\r\n                            }\r\n                            if (event.links.includes(2)) {\r\n                                player.loseMaxHp();\r\n                                if (storage[1] > 0) player.draw(storage[1]);\r\n                            }\r\n                        },\r\n                        sub: true\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_qun,\r\n        translate: {\r\n            PSguanning: \"PS管宁\",\r\n            PSdunshi: \"遁世\",\r\n            PSdunshi_info: \"每回合限一次。你可以视为使用或打出一张即时牌，然后当前回合角色于本回合内下一次造成伤害时，你选择两项：<br/>⒈防止此伤害。系统从技能描述中包含“出牌/受伤/结束”字样的技能中随机选择4个其未拥有的技能，然后你令当前回合角色获得其中一个技能。<br/>⒉从〖遁世〗中删除你本次使用或打出的牌并获得一个“席”。<br/>⒊减1点体力上限并摸X张牌（X为你的“席”数）。\"\r\n        },\r\n        rank: rank.epic\r\n    },\r\n    PSzhaoxiang: {\r\n        info: {\r\n            sex: \"female\",\r\n            group: \"shu\",\r\n            hp: 4,\r\n            skills: [\r\n                \"refanghun\",\r\n                \"PSfushi\"\r\n            ],\r\n            dieAudios: [\r\n                \"ext:PS武将/audio/die:true\"\r\n            ],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“神鬼高达”设计\",\r\n        substitute: [\r\n            [\r\n                \"PSzhaoxiang2\",\r\n                [\r\n                    \"ext:PS武将/image/character/PSzhaoxiang2.jpg\",\r\n                    \"die:ext:PS武将/audio/die:true\"\r\n                ]\r\n            ]\r\n        ],\r\n        skills: {\r\n            PSfushi: {\r\n                audio: \"ext:PS武将/audio/skill:2\",\r\n                trigger: {\r\n                    player: \"phaseJieshuBegin\"\r\n                },\r\n                skillAnimation: true,\r\n                animationColor: \"orange\",\r\n                filter: function (event, player) {\r\n                    // const list = [];\r\n                    /* game.players.concat(game.dead).forEach(cur => list.add(cur.group));\r\n                    if (player.getAllHistory('useSkill', evt => evt.skill === 'PSfushi').length >= list.length) return false; */\r\n                    return player.countMark('fanghun') >= 0;\r\n                },\r\n                characterList: function () {//此函数的作用是将武将包名称数组转化为武将id数组      \r\n                    lib.config.extension_PS武将_PScharacters = lib.config.extension_PS武将_PScharacters || [];\r\n                    lib.config.extension_PS武将_PSremoveCharacters = lib.config.extension_PS武将_PSremoveCharacters || [];\r\n                    lib.config.extension_PS武将_PSaddCharacter = lib.config.extension_PS武将_PSaddCharacter || [];\r\n                    lib.config.extension_PS武将_PSremoveCharacter = lib.config.extension_PS武将_PSremoveCharacter || [];\r\n                    function removeHTML(text) {//正则表达式，去除HTML标签\r\n                        return text.replace(/<[^>]+>/g, '');\r\n                    }\r\n                    function getAllCharacters(pack = false) {//返回全武将（包）id数组 函数\r\n                        if (pack) {\r\n                            let allPack = [];\r\n                            for (let a in lib.characterPack) {\r\n                                //lib.characterPack  所有武将包\r\n                                if (lib.characterPack.hasOwnProperty(a)) allPack.push(a);\r\n                            }\r\n                            return allPack;\r\n                        }\r\n                        else {\r\n                            let allList = [];\r\n                            for (let b in lib.character) {\r\n                                if (lib.character.hasOwnProperty(b)) allList.push(b);\r\n                            }\r\n                            return allList;\r\n                        }\r\n                    }\r\n                    function getPackIdArray(uname = []) {//武将包名称数组转化为武将包id数组函数\r\n                        let listx = [];\r\n                        for (let i of uname) {\r\n                            for (let j in lib.characterPack) {\r\n                                if (lib.characterPack.hasOwnProperty(j)) {\r\n                                    if (removeHTML(lib.translate[`${j}_character_config`]) === i || lib.translate[`${j}_character_config`].includes('extension/') && lib.translate[`${j}_character_config`].includes(i)) {\r\n                                        //lib.translate[`${j}_character_config`] 武将包翻译名\r\n                                        listx.push(j);\r\n                                        break;\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                        return listx;\r\n                    }\r\n                    let pack = [];//pack 武将包id数组\r\n                    let list = [];//list 武将id数组\r\n                    if (!lib.config.extension_PS武将_PScharacters.length) {//不编辑将池默认全扩武将包\r\n                        //lib.config.extension_PS武将_PScharacters 添加的武将包名称数组\r\n                        pack = getAllCharacters(true);\r\n                    }\r\n                    else pack = getPackIdArray(lib.config.extension_PS武将_PScharacters);\r\n                    let shed = getPackIdArray(lib.config.extension_PS武将_PSremoveCharacters);//lib.config.extension_PS武将_PSremoveCharacters 移除的武将包名称数组          \r\n                    pack.removeArray(shed);// 去除被移除的武将包数组\r\n                    for (let k of pack) {//提取武将包的武将id，放入list数组\r\n                        for (let l in lib.characterPack[k]) {\r\n                            if (lib.characterPack[k].hasOwnProperty(l)) list.push(l);\r\n                        }\r\n                    }\r\n                    list.addArray(lib.config.extension_PS武将_PSaddCharacter);\r\n                    list.removeArray(lib.config.extension_PS武将_PSremoveCharacter);\r\n                    if (!list.length) list = getAllCharacters();\r\n                    list.removeArray(lib.skill.PShuashen.banned);\r\n                    return list;\r\n                },\r\n                chooseToFuHan: function () {\r\n                    'step 0'\r\n                    var list1 = event.list1,\r\n                        list2 = event.list2;\r\n                    var switchToAuto = function () {\r\n                        _status.imchoosing = false;\r\n                        var newList = list2.flat();\r\n                        for (var i = 0; i < newList.length; i++) {\r\n                            if (lib.skill[newList[i]].ai && lib.skill[newList[i]].ai.combo) newList.remove(newList[i]);\r\n                        }\r\n                        event._result = {\r\n                            bool: true,\r\n                            skills: newList.randomGets(event.total),\r\n                        };\r\n                        if (event.initbg) event.initbg.close();\r\n                        if (event.control) event.control.close();\r\n                    };\r\n                    var chooseButton = function (list1, list2) {\r\n                        var event = _status.event;\r\n                        if (!event._result) event._result = {};\r\n                        event._result.skills = [];\r\n                        if (game.TLHasExt('十周年')) {\r\n                            var con = document.getElementById('dui-controls');\r\n                            if (con) con.classList.add('Tlao_confirmdown2');\r\n                        }\r\n                        event.initbg = ui.create.div('.Tlao_initbg', document.body);\r\n                        event.initbg.addEventListener(lib.config.touchscreen ? 'touchend' : 'click', function () {\r\n                            game.TLremoveSkillInfo();\r\n                        }, true)\r\n                        var initDialog = ui.create.div('.Tlao_init', event.initbg);\r\n                        initDialog.addEventListener(lib.config.touchscreen ? 'touchend' : 'click', function () {\r\n                            game.TLremoveSkillInfo();\r\n                        }, true)\r\n                        if (!game.TLHasExt('十周年')) initDialog.style.transform = 'translate(-50%,-90%)';\r\n                        var initTopic = ui.create.div('.Tlao_inittishi', initDialog);\r\n                        initTopic.textContent = event.topic;\r\n                        game.TLCreateStand(player, initDialog, 266, 1);\r\n                        var initBord = ui.create.div('', initDialog);\r\n                        initBord.style.cssText = 'width:586px;height:216px;top:33px;right:60px;positon:\"absolute\";';\r\n                        var skills = event.list2.flat(), num = 0;\r\n                        for (var i = 0; i < event.list1.length; i++) {\r\n                            var x = i * (104 - list1.length * 4) + (8 - list1.length) * 35 + 35;\r\n                            game.TLCreateHead(event.list1[i], initBord, 68, x, 12);\r\n                            for (var j = 0; j < event.list2[i].length; j++) {\r\n                                var td = ui.create.div('.Tlao_skillnode', initBord);\r\n                                if (get.info(list2[i][j]).limited || get.info(list2[i][j]).juexingji) td.classList.add('Tlao_skillnodelimit');\r\n                                td.link = skills[num];\r\n                                num++;\r\n                                td.textContent = get.translation(event.list2[i][j]);\r\n                                td.style.left = (x - 3) + 'px';\r\n                                td.style.top = (84 + j * 40) + 'px';\r\n                                td.addEventListener(lib.config.touchscreen ? 'touchend' : 'click', function () {\r\n                                    this.style.animation = 'initbutton 0.2s forwards';\r\n                                    this.addEventListener('animationend', function () { this.style.animation = ''; });\r\n                                    game.TLremoveSkillInfo();\r\n                                    if (this.classList.contains('Tlao_initselected')) {\r\n                                        this.classList.remove('Tlao_initselected');\r\n                                        event._result.skills.remove(this.link);\r\n                                    } else if (this.classList.contains('Tlao_initselected2')) {\r\n                                        this.classList.remove('Tlao_initselected2');\r\n                                        event._result.skills.remove(this.link);\r\n                                    } else {\r\n                                        if (event._result.skills.length < event.total) {\r\n                                            if (this.classList.contains('Tlao_skillnodelimit')) this.classList.add('initselected2');\r\n                                            else this.classList.add('Tlao_initselected');\r\n                                            event._result.skills.push(this.link);\r\n                                        }\r\n                                        game.TLcreateSkillInfo(this.link, event.initbg);\r\n                                    }\r\n                                }, true)\r\n                            }\r\n                        }\r\n                        var prompt = ui.create.div('', initDialog);\r\n                        prompt.style.cssText = 'width:100%;height:20px;left:0;bottom:0;text-align:center;font-family:\"yuanli\";font-size:20px;line-height:18px;color:#f1dfcc;filter: drop-shadow(1px 0 0 #664934) drop-shadow(-1px 0 0 #664934) drop-shadow(0 1px 0 #664934) drop-shadow(0 -1px 0 #664934);transform:translateY(220%);letter-spacing:3px;pointer-events:none;';\r\n                        prompt.textContent = '请选择' + get.cnNumber(event.total) + '个武将技能';\r\n                        event.switchToAuto = function () {\r\n                            if (game.TLHasExt('十周年')) {\r\n                                var con = document.getElementById('dui-controls');\r\n                                if (con) con.classList.remove('Tlao_confirmdown2');\r\n                            }\r\n                            event.initbg.remove();\r\n                            event.control.close();\r\n                            game.resume();\r\n                            _status.imchoosing = false;\r\n                        };\r\n                        event.control = ui.create.control('ok', function (link) {\r\n                            if (game.TLHasExt('十周年')) {\r\n                                var con = document.getElementById('dui-controls');\r\n                                if (con) con.classList.remove('Tlao_confirmdown2');\r\n                            }\r\n                            event.initbg.remove();\r\n                            event.control.close();\r\n                            game.resume();\r\n                            _status.imchoosing = false;\r\n                        });\r\n                        game.pause();\r\n                        game.countChoose();\r\n                    };\r\n                    if (event.isMine()) {\r\n                        chooseButton(list1, list2);\r\n                    }\r\n                    else if (event.isOnline()) {\r\n                        event.player.send(chooseButton, list1, list2);\r\n                        event.player.wait();\r\n                        game.pause();\r\n                    }\r\n                    else {\r\n                        switchToAuto();\r\n                    }\r\n                    'step 1'\r\n                    var map = event.result || result;\r\n                    if (map && map.skills && map.skills.length) {\r\n                        for (var i of map.skills) player.addSkills(i);\r\n                    }\r\n                    game.broadcastAll(function (list) {\r\n                        game.expandSkills(list);\r\n                        for (var i of list) {\r\n                            var info = lib.skill[i];\r\n                            if (!info) continue;\r\n                            if (!info.audioname2) info.audioname2 = {};\r\n                            info.audioname2.old_yuanshu = 'weidi';\r\n                        }\r\n                    }, map.skills);\r\n                },\r\n                content: function () {\r\n                    'step 0'\r\n                    player.changeSkin(\"PSfushi\", \"PSzhaoxiang2\");\r\n                    lib.character.PSzhaoxiang.dieAudios = ['ext:PS武将/audio/die/PSzhaoxiang2.mp3'];\r\n                    event.num = player.storage.fanghun;\r\n                    player.draw(event.num);\r\n                    player.removeMark('fanghun', player.storage.fanghun);\r\n                    'step 1'\r\n                    var list;\r\n                    if (_status.characterlist) {\r\n                        list = [];\r\n                        for (var i = 0; i < _status.characterlist.length; i++) {\r\n                            var name = _status.characterlist[i];\r\n                            if (lib.skill.PSfushi.characterList().includes(name)) list.push(name);\r\n                        }\r\n                    }\r\n                    else if (_status.connectMode) {\r\n                        list = get.charactersOL(function (i) {\r\n                            return !lib.skill.PSfushi.characterList().includes(i);\r\n                        });\r\n                    }\r\n                    else {\r\n                        list = get.gainableCharacters(function (info, i) {\r\n                            return lib.skill.PSfushi.characterList().includes(i);\r\n                        });\r\n                    }\r\n                    var players = game.players.concat(game.dead);\r\n                    for (var i = 0; i < players.length; i++) {\r\n                        list.remove(players[i].name);\r\n                        list.remove(players[i].name1);\r\n                        list.remove(players[i].name2);\r\n                    }\r\n                    list.remove('zhaoyun');\r\n                    list.remove('re_zhaoyun');\r\n                    list.remove('ol_zhaoyun');\r\n                    list.remove('JX_zhaoxiang');\r\n                    list.remove('zhaoxiang');\r\n                    list.remove('tw_zhaoxiang');\r\n                    list = list.randomGets(8);\r\n                    var skills = [];\r\n                    if (player.isUnderControl()) {\r\n                        game.swapPlayerAuto(player);\r\n                    }\r\n                    if (false/* lib.config.extensions && lib.config.extensions.includes('天牢令') && lib.config['extension_天牢令_enable'] && game.TLHasExt */) {\r\n                        for (var i = 0; i < list.length; i++) {\r\n                            skills[i] = (lib.character[list[i]][3] || []);\r\n                        }\r\n                        if (!list.length || !skills.length) { event.finish(); return; }\r\n                        var next = game.createEvent('chooseToFuHan');\r\n                        next.player = player;\r\n                        next.list1 = list;\r\n                        next.list2 = skills;\r\n                        next.topic = '扶世';\r\n                        next.total = 3;\r\n                        next.setContent(lib.skill.PSfushi.chooseToFuHan);\r\n                        if (player.isMinHp()) player.recover();\r\n                        event.finish();\r\n                        return;\r\n                    }\r\n                    for (var i of list) {\r\n                        skills.addArray(lib.character[i][3] || []);\r\n                    }\r\n                    if (!list.length || !skills.length) { event.finish(); return; }\r\n                    var switchToAuto = function () {\r\n                        _status.imchoosing = false;\r\n                        event._result = {\r\n                            bool: true,\r\n                            skills: skills.randomGets(3),\r\n                        };\r\n                        if (event.dialog) event.dialog.close();\r\n                        if (event.control) event.control.close();\r\n                    };\r\n                    var chooseButton = function (list, skills) {\r\n                        var event = _status.event;\r\n                        if (!event._result) event._result = {};\r\n                        event._result.skills = [];\r\n                        var rSkill = event._result.skills;\r\n                        var dialog = ui.create.dialog(`请选择获得至多${get.cnNumber(3)}个技能`, [list, 'character'], 'hidden');\r\n                        event.dialog = dialog;\r\n                        var table = document.createElement('div');\r\n                        table.classList.add('add-setting');\r\n                        table.style.margin = '0';\r\n                        table.style.width = '100%';\r\n                        table.style.position = 'relative';\r\n                        for (var i = 0; i < skills.length; i++) {\r\n                            var td = ui.create.div('.shadowed.reduce_radius.pointerdiv.tdnode');\r\n                            td.link = skills[i];\r\n                            table.appendChild(td);\r\n                            td.innerHTML = '<span>' + get.translation(skills[i]) + '</span>';\r\n                            td.addEventListener(lib.config.touchscreen ? 'touchend' : 'click', function () {\r\n                                if (_status.dragged) return;\r\n                                if (_status.justdragged) return;\r\n                                _status.tempNoButton = true;\r\n                                setTimeout(function () {\r\n                                    _status.tempNoButton = false;\r\n                                }, 500);\r\n                                var link = this.link;\r\n                                if (!this.classList.contains('bluebg')) {\r\n                                    if (rSkill.length >= 3) return;\r\n                                    rSkill.add(link);\r\n                                    this.classList.add('bluebg');\r\n                                }\r\n                                else {\r\n                                    this.classList.remove('bluebg');\r\n                                    rSkill.remove(link);\r\n                                }\r\n                            });\r\n                        }\r\n                        dialog.content.appendChild(table);\r\n                        dialog.add('　　');\r\n                        dialog.open();\r\n\r\n                        event.switchToAuto = function () {\r\n                            event.dialog.close();\r\n                            event.control.close();\r\n                            game.resume();\r\n                            _status.imchoosing = false;\r\n                        };\r\n                        event.control = ui.create.control('ok', function (link) {\r\n                            event.dialog.close();\r\n                            event.control.close();\r\n                            game.resume();\r\n                            _status.imchoosing = false;\r\n                        });\r\n                        for (var i = 0; i < event.dialog.buttons.length; i++) {\r\n                            event.dialog.buttons[i].classList.add('selectable');\r\n                        }\r\n                        game.pause();\r\n                        game.countChoose();\r\n                    };\r\n                    if (event.isMine()) {\r\n                        chooseButton(list, skills);\r\n                    }\r\n                    else if (event.isOnline()) {\r\n                        event.player.send(chooseButton, list, skills);\r\n                        event.player.wait();\r\n                        game.pause();\r\n                    }\r\n                    else {\r\n                        switchToAuto();\r\n                    }\r\n                    'step 2'\r\n                    var map = event.result || result;\r\n                    if (map && map.skills && map.skills.length) {\r\n                        for (var i of map.skills) player.addSkills(i);\r\n                    }\r\n                    game.broadcastAll(function (list) {\r\n                        game.expandSkills(list);\r\n                        for (var i of list) {\r\n                            var info = lib.skill[i];\r\n                            if (!info) continue;\r\n                            if (!info.audioname2) info.audioname2 = {};\r\n                            info.audioname2.old_yuanshu = 'weidi';\r\n                        }\r\n                    }, map.skills);\r\n                    'step 3'\r\n                    if (player.isMinHp()) player.recover();\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_shu,\r\n        translate: {\r\n            PSzhaoxiang: \"PS赵襄\",\r\n            PSfushi: \"扶世\",\r\n            PSfushi_info: \"结束阶段开始时，你可以移去所有“梅影”标记并摸等量张牌，然后从8张武将牌中选择并获得至多3个技能。若此时你是体力值最低的角色，你回复1点体力。\",\r\n            \"#ext:PS武将/audio/skill/PSfanghun1\": \"凝傲雪之梅为魄，英魂长存，独耀山河万古明！\",\r\n            \"#ext:PS武将/audio/skill/PSfanghun2\": \"铸凌霜之寒成剑，青锋出鞘，斩尽天下不臣贼！\",\r\n            \"#ext:PS武将/audio/skill/PSfushi1\": \"逝者如斯，亘古长流，唯英烈之魂悬北斗而长存！\",\r\n            \"#ext:PS武将/audio/skill/PSfushi2\": \"赵氏之女，跪祈诸公勿渡黄泉，暂留人间，佑大汉万年！\",\r\n            \"#ext:PS武将/audio/die/PSzhaoxiang:die\": \"世受国恩，今当以身殉国。\",\r\n            \"#ext:PS武将/audio/skill/PSfanghun_PSzhaoxiang21\": \"当年明月凝霜刃，此日送尔渡黄泉！\",\r\n            \"#ext:PS武将/audio/skill/PSfanghun_PSzhaoxiang22\": \"已识万里乾坤大，何虑千山草木青。\",\r\n            \"#ext:PS武将/audio/skill/PSfushi_PSzhaoxiang21\": \"龙凤在侧，五虎在前，天命在汉，既寿永昌！\",\r\n            \"#ext:PS武将/audio/skill/PSfushi_PSzhaoxiang22\": \"人言为信，日月为明，言日月为证，佑大汉长明！\",\r\n            \"#ext:PS武将/audio/die/PSzhaoxiang2:die\": \"大厦将倾，空余泪两行。\"\r\n        },\r\n        rank: rank.epic\r\n    },\r\n    PSlukang: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"wu\",\r\n            hp: 4,\r\n            skills: [\r\n                \"drlt_qianjie\",\r\n                \"PSjueyan\",\r\n                \"drlt_poshi\"\r\n            ],\r\n            clans: [\r\n                \"吴郡陆氏\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“待我白衣为卿相”设计\",\r\n        skills: {\r\n            PSjueyan: {\r\n                audio: \"drlt_jueyan\",\r\n                enable: \"phaseUse\",\r\n                usable: 1,\r\n                init: function (player, skill) {\r\n                    game.changeSkillAudio('PSjizhi', player.name, 'rejizhi_lukang');\r\n                },\r\n                derivation: \"PSjizhi\",\r\n                filter: function (event, player) {\r\n                    return player.hasEnabledSlot(1) || player.hasEnabledSlot(2) || player.hasEnabledSlot(5) || player.hasEnabledSlot('horse');\r\n                },\r\n                content: function () {\r\n                    'step 0'\r\n                    player.chooseToDisable(true).set('ai', function (event, player, list) {\r\n                        if (list.includes('equip2')) return 'equip2';\r\n                        if (list.includes('equip1') && (player.countCards('h', function (card) {\r\n                            return get.name(card, player) == 'sha' && player.hasUseTarget(card);\r\n                        }) - player.getCardUsable('sha')) > 1) return 'equip1';\r\n                        if (list.includes('equip5') && player.countCards('h', function (card) {\r\n                            return get.type2(card, player) == 'trick' && player.hasUseTarget(card);\r\n                        }) > 1) return 'equip5';\r\n                    });\r\n                    'step 1'\r\n                    switch (result.control) {\r\n                        case 'equip1':\r\n                            player.addSkills('drlt_jueyan1');\r\n                            break;\r\n                        case 'equip2':\r\n                            player.draw(3);\r\n                            player.addSkills('drlt_jueyan3');\r\n                            break;\r\n                        case 'equip3_4':\r\n                            player.addSkills('drlt_jueyan2');\r\n                            break;\r\n                        case 'equip5':\r\n                            player.addSkills('PSjizhi');\r\n                            break;\r\n                    }\r\n                },\r\n                ai: {\r\n                    order: 13,\r\n                    result: {\r\n                        player: function (player) {\r\n                            if (!player.isDisabled('equip2')) return 1;\r\n                            if (!player.isDisabled('equip1') && (player.countCards('h', function (card) {\r\n                                return get.name(card, player) == 'sha' && player.hasValueTarget(card);\r\n                            }) - player.getCardUsable('sha')) > 1) return 1;\r\n                            if (!player.isDisabled('equip5') && player.countCards('h', function (card) {\r\n                                return get.type2(card, player) == 'trick' && player.hasUseTarget(card);\r\n                            }) > 1) return 1;\r\n                            return -1;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_wu,\r\n        translate: {\r\n            PSlukang: \"PS陆抗\",\r\n            PSjueyan: \"决堰\",\r\n            PSjueyan_info: \"出牌阶段限一次，你可以废除一种装备栏，然后执行对应一项：武器栏，你使用【杀】的次数上限+3；防具栏，你摸三张牌，且手牌上限+3；坐骑栏，你使用牌无距离限制；宝物栏，你获得〖集智〗。\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PSliru: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"qun\",\r\n            hp: 3,\r\n            skills: [\r\n                \"PSjuece\",\r\n                \"remieji\",\r\n                \"xinfencheng\"\r\n            ],\r\n            dieAudios: [\r\n                \"re_liru\"\r\n            ],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“欧文哈尔”设计\",\r\n        skills: {\r\n            PSjuece: {\r\n                audio: \"rejuece\",\r\n                enable: \"phaseUse\",\r\n                filter: function (event, player) {\r\n                    if (!player.awakenedSkills.includes('xinfencheng') && !player.awakenedSkills.includes('fencheng') && !player.awakenedSkills.includes('dcfencheng')) return false;\r\n                    return player.hasCard(function (card) {\r\n                        return (get.name(card) == 'sha' && game.hasNature(card, 'fire')) || get.name(card) == \"huogong\"\r\n                    }, 'h');\r\n                },\r\n                filterCard: function (card) {\r\n                    return (get.name(card) == 'sha' && game.hasNature(card, 'fire')) || get.name(card) == \"huogong\";\r\n                },\r\n                selectCard: 1,\r\n                discard: true,\r\n                content: function () {\r\n                    if (player.awakenedSkills.includes('xinfencheng')) player.restoreSkill('xinfencheng');\r\n                    if (player.awakenedSkills.includes('fencheng')) player.restoreSkill('fencheng');\r\n                    if (player.awakenedSkills.includes('dcfencheng')) player.restoreSkill('dcfencheng');\r\n                    game.log(player, '重置了', '#g【焚城】');\r\n                },\r\n                group: \"rejuece\"\r\n            }\r\n        },\r\n        sort: sort.PScharacter_qun,\r\n        translate: {\r\n            PSliru: \"PS李儒\",\r\n            PSjuece: \"绝策\",\r\n            PSjuece_info: \"出牌阶段，你可以弃置一张【火杀】或【火攻】，然后重置技能〖焚城〗。结束阶段，你可以对一名本回合内失去过牌的角色造成1点伤害。\"\r\n        },\r\n        rank: rank.junk\r\n    },\r\n    PScaoang: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"wei\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PSkangkai\"\r\n            ],\r\n            isAiForbidden: true,\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“10万原石”设计\",\r\n        skills: {\r\n            PSkangkai: {\r\n                audio: \"kaikang\",\r\n                trigger: {\r\n                    global: \"useCardToTargeted\"\r\n                },\r\n                filter: function (event, player) {\r\n                    return get.tag(event.card, 'damage') > 0 && event.target.isIn();\r\n                },\r\n                check: function (event, player) {\r\n                    return get.attitude(player, event.target) >= 0;\r\n                },\r\n                logTarget: \"target\",\r\n                content: function () {\r\n                    \"step 0\"\r\n                    player.draw();\r\n                    player.chooseTarget(1, \"选择一名角色，令其将一张牌交给\" + get.translation(trigger.target), true, function (card, player, target) {\r\n                        return target != trigger.target;\r\n                    }).ai = function (target) {\r\n                        if (!_status.event.aicheck) return 0;\r\n                        return -get.attitude(player, target);\r\n                    };\r\n                    \"step 1\"\r\n                    if (result.bool && result.targets && result.targets.length) {\r\n                        event.targets = result.targets;\r\n                        event.targets[0].chooseCard('he', false, 1, '选择交给' + get.translation(trigger.target) + get.cnNumber(1) + '张牌' + '，或失去一点体力').set('ai', function (card) {\r\n                            if (get.position(card) == 'e') return -1;\r\n                            if (card.name == 'shan') return 1;\r\n                            if (get.type(card) == 'equip') return 0.5;\r\n                            return 0;\r\n                        });\r\n                    }\r\n                    \"step 2\"\r\n                    if (result.bool && result.cards && result.cards.length) {\r\n                        event.targets[0].give(result.cards, trigger.target);\r\n                        event.card = result.cards[0];\r\n                    }\r\n                    else {\r\n                        event.targets[0].loseHp();\r\n                    }\r\n                    \"step 3\"\r\n                    if (trigger.target.getCards('h').includes(card) && get.type(card) == 'equip') {\r\n                        trigger.target.chooseUseTarget(card);\r\n                    }\r\n                },\r\n                ai: {\r\n                    threaten: 1.1\r\n                },\r\n                audioname2: {\r\n                    old_yuanshu: \"weidi\"\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_wei,\r\n        translate: {\r\n            PScaoang: \"PS曹昂\",\r\n            PSkangkai: \"慷慨\",\r\n            PSkangkai_info: \"当一名角色成为伤害类牌的目标后，你可以摸一张牌。若如此做，你选择一名除其外的角色，除非该角色交一张牌给对方，否则失去一点体力。若交出的是装备牌，该角色可以使用此牌。\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PSzuoci: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"qun\",\r\n            hp: 3,\r\n            skills: [\r\n                \"PShuashen\",\r\n                \"PSxinsheng\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        filter: function (mode) {\r\n            return mode != \"guozhan\";\r\n        },\r\n        intro: \"由“九个芒果”设计\",\r\n        replace: [\r\n            \"PSzuoci\",\r\n            \"PSshen_zuoci\"\r\n        ],\r\n        skills: {\r\n            PShuashen: {\r\n                unique: true,\r\n                audio: \"rehuashen\",\r\n                trigger: {\r\n                    global: \"phaseBefore\",\r\n                    player: [\r\n                        \"enterGame\",\r\n                        \"phaseBegin\",\r\n                        \"phaseEnd\",\r\n                        \"PShuashen\"\r\n                    ]\r\n                },\r\n                filter: function (event, player, name) {\r\n                    if (event.name != 'phase') return true;\r\n                    if (name == 'phaseBefore') return game.phaseNumber == 0;\r\n                    return player.storage.PShuashen && player.storage.PShuashen.character.length > 0;\r\n                },\r\n                direct: true,\r\n                content: function () {\r\n                    /* \r\n                    player.storage.PShuashen.current //当前化身牌武将id\r\n                    player.storage.PShuashen.current2 //当前化身的技能id数组\r\n                    event.card //选中的化身牌（新化身牌）\r\n                    event.videoId //窗口对话框id\r\n                    event.aiChoice //ai根据优先度选择的技能\r\n                    event.logged //true则为已经log过这个技能了 \r\n                    event.num //选择技能的次数\r\n                    event.aiSkills //ai的化身技能数组\r\n                    */\r\n                    \"step 0\"\r\n                    event.num = 1;\r\n                    var name = event.triggername;\r\n                    //游戏开始时获得三张化身牌\r\n                    if (trigger.name != 'phase' || (name == 'phaseBefore' && game.phaseNumber == 0)) {\r\n                        player.logSkill('PShuashen');\r\n                        lib.skill.PShuashen.addHuashens(player, 3);\r\n                        event.logged = true;\r\n                    }\r\n                    _status.noclearcountdown = true;\r\n                    event.videoId = lib.status.videoId++;\r\n                    var cards = player.storage.PShuashen.character.slice(0);\r\n                    var skills = [];\r\n                    var sto = player.storage.PShuashen;\r\n                    for (var i in player.storage.PShuashen.map) {\r\n                        skills.addArray(player.storage.PShuashen.map[i]);\r\n                    }\r\n                    event.cond = 'out';\r\n                    if (event.triggername == 'phaseBegin') {\r\n                        event.cond = 'in';\r\n                    }\r\n                    skills.randomSort();\r\n                    //技能根据优先度排序\r\n                    skills.sort(function (a, b) {\r\n                        return get.skillRank(b, event.cond) - get.skillRank(a, event.cond);\r\n                    });\r\n                    event.aiSkills = skills.slice();\r\n                    event.aiChoice = skills[0];\r\n                    var choice = '更换技能';\r\n                    if (event.aiChoice == player.storage.PShuashen.current2 || get.skillRank(event.aiChoice, event.cond) < 1 || Math.random() < 0.3) choice = '制衡化身';\r\n                    if (player.isOnline2()) {\r\n                        player.send(function (cards, id) {\r\n                            var dialog = ui.create.dialog('是否发动【化身】？', [cards, (item, type, position, noclick, node) => lib.skill.PShuashen.$createButton(item, type, position, noclick, node)]);\r\n                            dialog.videoId = id;\r\n                        }, cards, event.videoId);\r\n                    }\r\n                    //创建对话框\r\n                    event.dialog = ui.create.dialog(get.prompt('PShuashen'), [cards, (item, type, position, noclick, node) => lib.skill.PShuashen.$createButton(item, type, position, noclick, node)]);\r\n                    event.dialog.videoId = event.videoId;\r\n                    if (!event.isMine()) {\r\n                        event.dialog.style.display = 'none';\r\n                    }\r\n\r\n                    if (event.logged && !event.isMine() && !event.isOnline()) event._result = { control: '更换技能' };// 在托管状态\r\n                    // if (event.logged) event._result = { control: '更换技能' };\r\n                    else player.chooseControl('制衡化身', '更换技能', 'cancel2').set('ai', function () {\r\n                        return _status.event.choice;\r\n                    }).set('choice', choice);\r\n                    \"step 1\"\r\n                    event.control = result.control;\r\n                    if (event.control == 'cancel2') {\r\n                        if (player.isOnline2()) {\r\n                            player.send('closeDialog', event.videoId);\r\n                        }\r\n                        delete _status.noclearcountdown;\r\n                        if (!_status.noclearcountdown) {\r\n                            game.stopCountChoose();\r\n                        }\r\n                        event.dialog.close();\r\n                        event.finish(); return;\r\n                    }\r\n                    if (!event.logged) { player.logSkill('PShuashen'); event.logged = true }\r\n                    var next = player.chooseButton(false).set('dialog', event.videoId);\r\n                    if (event.control == '制衡化身') {\r\n                        next.set('selectButton', [1, 2]);\r\n                        next.set('filterButton', function (button) {\r\n                            // return button.link != _status.event.current;\r\n                            return true;\r\n                        });\r\n                        next.set('current', player.storage.PShuashen.current);\r\n                    }\r\n                    else {\r\n                        next.set('ai', function (button) {\r\n                            return player.storage.PShuashen.map[button.link].includes(_status.event.choice) ? 2.5 : 1 + Math.random();\r\n                        });\r\n                        next.set('choice', event.aiChoice);\r\n                    }\r\n                    var prompt = event.control == '制衡化身' ? '选择制衡至多两张化身' : `选择要获得的第${get.cnNumber(event.num, true)}个技能`;\r\n                    var func = function (id, prompt) {\r\n                        var dialog = get.idDialog(id);\r\n                        if (dialog) {\r\n                            dialog.content.childNodes[0].innerHTML = prompt;\r\n                        }\r\n                    }\r\n                    if (player.isOnline2()) {\r\n                        player.send(func, event.videoId, prompt);\r\n                    }\r\n                    else if (event.isMine()) {\r\n                        func(event.videoId, prompt);\r\n                    }\r\n                    \"step 2\"\r\n                    if (!result.bool) {\r\n                        if (player.isOnline2()) {\r\n                            player.send('closeDialog', event.videoId);\r\n                        }\r\n                        event.dialog.close();\r\n                        delete _status.noclearcountdown;\r\n                        if (!_status.noclearcountdown) {\r\n                            game.stopCountChoose();\r\n                        }\r\n                        event.finish();\r\n                        return;\r\n                    }\r\n                    if (result.bool && event.control === '更换技能') {\r\n                        event.card = result.links[0];\r\n                        var func = function (card, id) {\r\n                            var dialog = get.idDialog(id);\r\n                            if (dialog) {\r\n                                for (var i = 0; i < dialog.buttons.length; i++) {\r\n                                    if (dialog.buttons[i].link == card) {\r\n                                        dialog.buttons[i].classList.add('selectedx');\r\n                                    }\r\n                                    else {\r\n                                        dialog.buttons[i].classList.add('unselectable');\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                        if (player.isOnline2()) {\r\n                            player.send(func, event.card, event.videoId);\r\n                        }\r\n                        else if (event.isMine()) {\r\n                            func(event.card, event.videoId);\r\n                        }\r\n                        var list = player.storage.PShuashen.map[event.card].slice(0).filter((skill) => {\r\n                            if (event.num === 1) return true;\r\n                            return !player.additionalSkills.PShuashen.includes(skill);\r\n                        });\r\n                        list.push('返回');\r\n                        player.chooseControl(list).set('choice', event.aiChoice).set('ai', function () {\r\n                            return _status.event.choice;\r\n                        });\r\n                    }\r\n                    else {\r\n                        lib.skill.PShuashen.removeHuashen(player, result.links.slice(0));\r\n                        lib.skill.PShuashen.addHuashens(player, result.links.length + 1);\r\n                    }\r\n                    \"step 3\"\r\n                    let defaultDialog = function () {\r\n                        let func = function (id) {\r\n                            var dialog = get.idDialog(id);\r\n                            if (dialog) {\r\n                                for (var i = 0; i < dialog.buttons.length; i++) {\r\n                                    dialog.buttons[i].classList.remove('selectedx');\r\n                                    dialog.buttons[i].classList.remove('unselectable');\r\n                                }\r\n                            }\r\n                        }\r\n                        if (player.isOnline2()) {\r\n                            player.send(func, event.videoId);\r\n                        }\r\n                        else if (event.isMine()) {\r\n                            func(event.videoId);\r\n                        }\r\n                    }\r\n                    if (result.control == '返回') {\r\n                        defaultDialog();\r\n                        event._result = { control: '更换技能' };\r\n                        event.goto(1);\r\n                        return;\r\n                    }\r\n\r\n                    let closeDialog = function () {\r\n                        if (player.isOnline2()) {\r\n                            player.send('closeDialog', event.videoId);\r\n                        }\r\n                        event.dialog.close();\r\n                        delete _status.noclearcountdown;\r\n                        if (!_status.noclearcountdown) {\r\n                            game.stopCountChoose();\r\n                        }\r\n                    }\r\n                    if (event.control == '制衡化身') {\r\n                        closeDialog();\r\n                        event.finish();\r\n                        return;\r\n                    } else {\r\n                        event.num++;\r\n                        var link = result.control;\r\n                        if (event.num === 2) {\r\n                            const old2 = player.storage.PShuashen.current2;\r\n                            player.storage.PShuashen.current2 = [link];\r\n                            player.removeAdditionalSkill('PShuashen');\r\n                            //清除文字颜色\r\n                            const dialog = get.idDialog(event.videoId);\r\n                            if (dialog) {\r\n                                dialog.buttons.forEach(btn => {\r\n                                    const textNode = btn.querySelector('.caption>.text');\r\n                                    if (textNode.innerHTML.includes('✓</span>')) {\r\n                                        textNode.innerHTML = textNode.innerHTML\r\n                                            .replaceAll('<span style=\"color:#0a9b43; text-shadow: rgba(0, 0, 0, 0.6) 0 0 2px, rgba(0, 0, 0, 0.6) 0 0 5px, rgba(0, 0, 0, 0.6) 0 0 5px, rgba(0, 0, 0, 0.6) 0 0 5px, black 0 0 1px\">', '')\r\n                                            .replaceAll('✓</span>', '');\r\n                                    };\r\n                                });\r\n                            }\r\n                        } else {\r\n                            player.storage.PShuashen.current2.add(link);\r\n                        }\r\n                        //更改文字颜色\r\n                        const dialog = get.idDialog(event.videoId);\r\n                        if (dialog) {\r\n                            const button = dialog.buttons.find(btn => btn.link === event.card);\r\n                            if (button) {\r\n                                const textNode = button.querySelector('.caption>.text');\r\n                                const skillName = '[' + get.translation(result.control) + ']';\r\n                                textNode.innerHTML = textNode.innerHTML.replace(skillName, `<span style=\"color:#0a9b43; text-shadow: rgba(0, 0, 0, 0.6) 0 0 2px, rgba(0, 0, 0, 0.6) 0 0 5px, rgba(0, 0, 0, 0.6) 0 0 5px, rgba(0, 0, 0, 0.6) 0 0 5px, black 0 0 1px\">${skillName}✓</span>`);\r\n                            }\r\n                        }\r\n                        if (!player.additionalSkills.PShuashen || !player.additionalSkills.PShuashen.includes(link)) {\r\n                            player.addAdditionalSkill('PShuashen', link, true);\r\n                            game.log(player, '获得了技能', '#g【' + get.translation(link) + '】');\r\n                            player.popup(link);\r\n                            player.syncStorage('PShuashen');\r\n                            player.updateMarks('PShuashen');\r\n                            if (event.num <= 3) {\r\n                                event._result = { control: '更换技能' };\r\n                                defaultDialog();\r\n\r\n                                event.aiSkills.remove(link);\r\n                                if (!event.aiSkills.length) event.aiChoice = link;\r\n                                else {\r\n                                    event.aiSkills.randomSort();\r\n                                    event.aiSkills.sort(function (a, b) {\r\n                                        return get.skillRank(b, event.cond) - get.skillRank(a, event.cond);\r\n                                    });\r\n                                    event.aiChoice = event.aiSkills[0];\r\n                                }\r\n\r\n                                event.goto(1);\r\n                            } else {\r\n                                closeDialog();\r\n                            }\r\n                            // lib.skill.PShuashen.createAudio(event.card,link,'re_zuoci');\r\n                        }\r\n                    }\r\n\r\n                    /* if (player.storage.PShuashen.current != event.card) {\r\n                        const old = player.storage.PShuashen.current;\r\n                        player.storage.PShuashen.current = event.card;\r\n                        game.broadcastAll(function (player, character, old) {\r\n                        player.tempname.remove(old);\r\n                        player.tempname.add(character);\r\n                        player.sex = lib.character[event.card][0];\r\n                        }, player, event.card, old);\r\n                        game.log(player, '将性别变为了', '#y' + get.translation(lib.character[event.card][0]) + '性');\r\n                        player.changeGroup(lib.character[event.card][1]);\r\n                    } */\r\n\r\n\r\n                },\r\n                init: function (player, skill) {\r\n                    if (!player.storage[skill]) player.storage[skill] = {\r\n                        character: [],\r\n                        map: {},\r\n                    }\r\n                    lib.skill.PShuashen.player = player;\r\n                },\r\n                banned: [\r\n                    \"lisu\",\r\n                    \"sp_xiahoudun\",\r\n                    \"PSxushao\",\r\n                    \"PSsb_xushao\",\r\n                    \"db_PSdaweiwuwang\",\r\n                    \"PSzhaoxiang\",\r\n                    \"PSmeng_liubei\",\r\n                    \"xushao\",\r\n                    \"jsrg_xushao\",\r\n                    \"zhoutai\",\r\n                    \"old_zhoutai\",\r\n                    \"shixie\",\r\n                    \"xin_zhoutai\",\r\n                    \"dc_shixie\",\r\n                    \"old_shixie\"\r\n                ],\r\n                bannedType: [],\r\n                addHuashen: function (player) {\r\n                    if (!player.storage.PShuashen) return;\r\n                    if (!_status.characterlist) {\r\n                        lib.skill.pingjian.initList();\r\n                    }\r\n                    _status.characterlist.randomSort();\r\n                    for (let i = 0; i < _status.characterlist.length; i++) {\r\n                        let name = _status.characterlist[i];\r\n                        if (!lib.skill.PSfushi.characterList().includes(name)) continue; // 必须是“编辑将池”里的武将\r\n                        if (name.indexOf('zuoci') != -1 || name.indexOf('key_') == 0 || name.indexOf('sp_key_') == 0 /* || get.is.double(name) */ || lib.skill.PShuashen.banned.includes(name) || player.storage.PShuashen.character.includes(name)) continue;\r\n                        let skills = lib.character[name][3].filter(skill => {\r\n                            const categories = get.skillCategoriesOf(skill);\r\n                            return !categories.some(type => lib.skill.PShuashen.bannedType.includes(type));\r\n                        })\r\n                        if (skills.length) {\r\n                            player.storage.PShuashen.character.push(name);\r\n                            player.storage.PShuashen.map[name] = skills;\r\n                            _status.characterlist.remove(name);\r\n                            return name;\r\n                        }\r\n                    }\r\n                },\r\n                addHuashens: function (player, num) {\r\n                    var list = [];\r\n                    for (var i = 0; i < num; i++) {\r\n                        var name = lib.skill.PShuashen.addHuashen(player);\r\n                        if (name) list.push(name);\r\n                    }\r\n                    if (list.length) {\r\n                        player.syncStorage('PShuashen');\r\n                        player.updateMarks('PShuashen');\r\n                        game.log(player, '获得了', get.cnNumber(list.length) + '张', '#g化身');\r\n                        lib.skill.PShuashen.drawCharacter(player, list);\r\n                    }\r\n                },\r\n                removeHuashen: function (player, links) {\r\n                    player.storage.PShuashen.character.removeArray(links);\r\n                    _status.characterlist.addArray(links);\r\n                    game.log(player, '移去了', get.cnNumber(links.length) + '张', '#g化身')\r\n                },\r\n                drawCharacter: function (player, list) {\r\n                    game.broadcastAll(function (player, list) {\r\n                        if (player.isUnderControl(true)) {\r\n                            var cards = [];\r\n                            for (var i = 0; i < list.length; i++) {\r\n                                var cardname = 'PShuashen_card_' + list[i];\r\n                                lib.card[cardname] = {\r\n                                    fullimage: true,\r\n                                    image: 'character:' + list[i]\r\n                                }\r\n                                lib.translate[cardname] = get.rawName2(list[i]);\r\n                                cards.push(game.createCard(cardname, '', ''));\r\n                            }\r\n                            player.$draw(cards, 'nobroadcast');\r\n                        }\r\n                    }, player, list);\r\n                },\r\n                \"$createButton\": function (item, type, position, noclick, node) {\r\n                    node = ui.create.buttonPresets.character(item, 'character', position, noclick);\r\n                    const info = lib.character[item];\r\n                    const skills = info[3].filter(function (skill) {\r\n                        const categories = get.skillCategoriesOf(skill);\r\n                        return !categories.some(type => lib.skill.PShuashen.bannedType.includes(type));\r\n                    });\r\n                    if (skills.length) {\r\n                        const skillstr = skills.map(i => {\r\n                            const player = lib.skill.PShuashen.player;\r\n                            if (player.additionalSkills.PShuashen && player.additionalSkills.PShuashen.includes(i)) return `<span style=\"color:#0a9b43; text-shadow: rgba(0, 0, 0, 0.6) 0 0 2px, rgba(0, 0, 0, 0.6) 0 0 5px, rgba(0, 0, 0, 0.6) 0 0 5px, rgba(0, 0, 0, 0.6) 0 0 5px, black 0 0 1px\">[${get.translation(i)}]✓</span>`;\r\n                            return `[${get.translation(i)}]`;\r\n                        }).join('<br>');\r\n                        const skillnode = ui.create.caption(\r\n                            `<div class=\"text\" data-nature=${get.groupnature(info[1], 'raw')\r\n                            }m style=\"font-family: ${(lib.config.name_font || 'xinwei')\r\n                            },xinwei\">${skillstr}</div>`, node);\r\n                        skillnode.style.left = '2px';\r\n                        skillnode.style.bottom = '2px';\r\n                    }\r\n                    node._customintro = function (uiintro, evt) {\r\n                        const character = node.link, characterInfo = get.character(node.link);\r\n                        let capt = get.translation(character);\r\n                        if (characterInfo) {\r\n                            capt += `&nbsp;&nbsp;${get.translation(characterInfo[0])}`;\r\n                            let charactergroup;\r\n                            const charactergroups = get.is.double(character, true);\r\n                            if (charactergroups) charactergroup = charactergroups.map(i => get.translation(i)).join('/');\r\n                            else charactergroup = get.translation(characterInfo[1]);\r\n                            capt += `&nbsp;&nbsp;${charactergroup}`;\r\n                        }\r\n                        uiintro.add(capt);\r\n\r\n                        if (lib.characterTitle[node.link]) {\r\n                            uiintro.addText(get.colorspan(lib.characterTitle[node.link]));\r\n                        }\r\n                        for (let i = 0; i < skills.length; i++) {\r\n                            if (lib.translate[skills[i] + '_info']) {\r\n                                let translation = lib.translate[skills[i] + '_ab'] || get.translation(skills[i]).slice(0, 2);\r\n                                if (lib.skill[skills[i]] && lib.skill[skills[i]].nobracket) {\r\n                                    uiintro.add('<div><div class=\"skilln\">' + get.translation(skills[i]) + '</div><div>' + get.skillInfoTranslation(skills[i]) + '</div></div>');\r\n                                }\r\n                                else {\r\n                                    uiintro.add('<div><div class=\"skill\">【' + translation + '】</div><div>' + get.skillInfoTranslation(skills[i]) + '</div></div>');\r\n                                }\r\n                                if (lib.translate[skills[i] + '_append']) {\r\n                                    uiintro._place_text = uiintro.add('<div class=\"text\">' + lib.translate[skills[i] + '_append'] + '</div>')\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                    return node;\r\n                },\r\n                mark: true,\r\n                intro: {\r\n                    onunmark: function (storage, player) {\r\n                        _status.characterlist.addArray(storage.character);\r\n                        storage.character = [];\r\n                    },\r\n                    mark: function (dialog, storage, player) {\r\n                        if (storage && storage.current) dialog.addSmall([[storage.current], (item, type, position, noclick, node) => lib.skill.PShuashen.$createButton(item, type, position, noclick, node)]);\r\n                        if (storage && storage.current2) {\r\n                            for (var i = 0; i < storage.current2.length; i++) {\r\n                                dialog.add('<div><div class=\"skill\">【' + get.translation(lib.translate[storage.current2[i] + '_ab'] || get.translation(storage.current2[i]).slice(0, 2)) + '】</div><div>' + get.skillInfoTranslation(storage.current2[i], player) + '</div></div>');\r\n                            }\r\n                        }\r\n                        if (storage && storage.character.length) {\r\n                            if (player.isUnderControl(true)) {\r\n                                dialog.addSmall([storage.character, (item, type, position, noclick, node) => lib.skill.PShuashen.$createButton(item, type, position, noclick, node)]);\r\n                            }\r\n                            else {\r\n                                dialog.addText('共有' + get.cnNumber(storage.character.length) + '张“化身”');\r\n                            }\r\n                        }\r\n                        else {\r\n                            return '没有化身';\r\n                        }\r\n                    },\r\n                    content: function (storage, player) {\r\n                        return '共有' + get.cnNumber(storage.character.length) + '张“化身”'\r\n                    },\r\n                    markcount: function (storage, player) {\r\n                        if (storage && storage.character) return storage.character.length;\r\n                        return 0;\r\n                    }\r\n                },\r\n                group: \"PShuashen_change\",\r\n                subSkill: {\r\n                    change: {\r\n                        audio: \"rehuashen\",\r\n                        enable: \"phaseUse\",\r\n                        usable: 1,\r\n                        async content(event, trigger, player) {\r\n                            _status.noclearcountdown = true;\r\n                            event.videoId = lib.status.videoId++;\r\n                            const cards = player.storage.PShuashen.character.slice(0);\r\n                            const prompt = '是否将性别和势力改为与一张“化身牌”相同？';\r\n                            if (player.isOnline2()) {\r\n                                player.send(function (cards, id) {\r\n                                    var dialog = ui.create.dialog('是否将性别和势力改为与一张“化身牌”相同？', [cards, (item, type, position, noclick, node) => lib.skill.PShuashen.$createButton(item, type, position, noclick, node)]);\r\n                                    dialog.videoId = id;\r\n                                }, cards, event.videoId);\r\n                            }\r\n                            event.dialog = ui.create.dialog(prompt, [cards, (item, type, position, noclick, node) => lib.skill.PShuashen.$createButton(item, type, position, noclick, node)]);\r\n                            event.dialog.videoId = event.videoId;\r\n                            if (!event.isMine()) {\r\n                                event.dialog.style.display = 'none';\r\n                            }\r\n                            const next = player.chooseButton(false);\r\n                            next.set('dialog', event.videoId);\r\n                            next.set('filterButton', function (button) {\r\n                                const { gender, group } = get.character(button.link);\r\n                                const gender2 = player.sex;\r\n                                const group2 = player.group;\r\n                                return gender !== gender2 || group !== group2;\r\n                            });\r\n                            next.set('current', player.storage.PShuashen.current);\r\n                            next.set('ai', function (button) {\r\n                                const character = lib.character[button.link];\r\n                                const gender = character[0];\r\n                                const group = character[1];\r\n                                let num = 1;\r\n                                if (player.sex !== gender) num++;\r\n                                if (player.group !== group) num++;\r\n                                return num;\r\n                            });\r\n                            const { bool, links } = await next.forResult();\r\n                            if (player.isOnline2()) {\r\n                                player.send('closeDialog', event.videoId);\r\n                            }\r\n                            event.dialog.close();\r\n                            delete _status.noclearcountdown;\r\n                            if (!_status.noclearcountdown) {\r\n                                game.stopCountChoose();\r\n                            }\r\n                            if (bool) {\r\n                                event.card = links[0];\r\n                                const old = player.storage.PShuashen.current;\r\n                                const sex = get.character(event.card).sex;\r\n                                player.storage.PShuashen.current = event.card;\r\n                                game.broadcastAll(function (player, character, old) {\r\n                                    player.tempname.remove(old);\r\n                                    player.tempname.add(character);\r\n                                    player.sex = sex;\r\n                                }, player, event.card, old, sex);\r\n                                player.flashAvatar('PShuashen', event.card);\r\n                                game.log(player, '将性别变为了', '#y' + get.translation(sex) + '性');\r\n                                let group = get.character(event.card).group;\r\n                                if (get.is.double(event.card)) {\r\n                                    const { control } = await player.chooseControl(get.is.double(name, true)).set(\"prompt\", \"请选择你的势力\");\r\n                                    group = control;\r\n                                }\r\n                                await player.changeGroup(group);\r\n                            }\r\n                        },\r\n                        sub: true\r\n                    }\r\n                },\r\n                _priority: 0\r\n            },\r\n            PSxinsheng: {\r\n                unique: true,\r\n                audio: \"rexinsheng\",\r\n                trigger: {\r\n                    player: \"damageEnd\"\r\n                },\r\n                frequent: true,\r\n                content: function () {\r\n                    'step 0'\r\n                    event.num = trigger.num;\r\n                    'step 1'\r\n                    lib.skill.PShuashen.addHuashens(player, 1);\r\n                    'step 2'\r\n                    if (--event.num > 0 && player.hasSkill(event.name) && !get.is.blocked(event.name, player)) {\r\n                        player.chooseBool(get.prompt2('PSxinsheng')).set('frequentSkill', event.name);\r\n                    }\r\n                    else event.finish();\r\n                    'step 3'\r\n                    if (result.bool && player.hasSkill('PSxinsheng')) {\r\n                        player.logSkill('PSxinsheng');\r\n                        event.goto(1);\r\n                    }\r\n                },\r\n                _priority: 0\r\n            }\r\n        },\r\n        sort: sort.PScharacter_qun,\r\n        translate: {\r\n            PSzuoci: \"PS左慈\",\r\n            PShuashen: \"化身\",\r\n            PShuashen_info: \"①游戏开始时，你随机获得三张未加入游戏的武将牌（均称为“化身牌”），然后你选择一项：1、制衡化身：弃置至多两张化身牌并获得等量+1张化身牌；2、更换技能：移除上次因化身获得的所有技能（若有），然后重新挑选化身牌上的至多三个技能。准备阶段或回合结束阶段开始时，你可以选择“制衡化身”或“更换技能”。<br/>②出牌阶段限一次，你可以将性别和势力改为与一张“化身牌”相同。\",\r\n            PSxinsheng: \"新生\",\r\n            PSxinsheng_info: \"当你受到一点伤害后，你可以获得一张“化身牌”。\"\r\n        },\r\n        rank: rank.epic\r\n    },\r\n    PSzhoutai: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"wu\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PSbuqu\",\r\n                \"PSfenji\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“欧文哈尔”设计\",\r\n        skills: {\r\n            PSbuqu: {\r\n                audio: \"buqu\",\r\n                audioname: [\r\n                    \"key_yuri\"\r\n                ],\r\n                trigger: {\r\n                    player: \"chooseToUseBefore\"\r\n                },\r\n                forced: true,\r\n                preHidden: true,\r\n                filter: function (event, player) {\r\n                    return event.type == 'dying' && player.isDying() && event.dying == player && !event.getParent()._PSbuqu;\r\n                },\r\n                content: function () {\r\n                    \"step 0\"\r\n                    trigger.getParent()._PSbuqu = true;\r\n                    var card = get.cards()[0];\r\n                    event.card = card;\r\n                    player.addToExpansion(card, 'gain2').gaintag.add('PSbuqu');\r\n                    \"step 1\"\r\n                    var cards = player.getExpansions('PSbuqu'), num = get.number(card);\r\n                    player.showCards(cards, '不屈')\r\n                    for (var i = 0; i < cards.length; i++) {\r\n                        if (cards[i] != card && get.number(cards[i]) == num) {\r\n                            player.loseToDiscardpile(card);\r\n                            return;\r\n                        };\r\n                    }\r\n                    trigger.cancel();\r\n                    trigger.result = { bool: true };\r\n                    if (player.hp <= 0) {\r\n                        player.recoverTo(1);\r\n                    }\r\n                },\r\n                mod: {\r\n                    maxHandcard: function (player, num) {\r\n                        if (player.getExpansions('PSbuqu').length) return num + player.getExpansions('PSbuqu').length;\r\n                    },\r\n                    cardUsable: function (card, player, num) {\r\n                        if (card.name == 'sha' && player.getExpansions('PSbuqu').length) return num + player.getExpansions('PSbuqu').length;\r\n                    }\r\n                },\r\n                group: \"PSbuqu_draw\",\r\n                subSkill: {\r\n                    draw: {\r\n                        audio: \"buqu\",\r\n                        audioname: [\r\n                            \"sp_lvmeng\"\r\n                        ],\r\n                        trigger: {\r\n                            player: \"phaseDrawBegin2\"\r\n                        },\r\n                        frequent: true,\r\n                        filter: function (event, player) {\r\n                            return !event.numFixed && player.getExpansions('PSbuqu').length;\r\n                        },\r\n                        content: function () {\r\n                            trigger.num += player.getExpansions('PSbuqu').length;\r\n                        },\r\n                        ai: {\r\n                            threaten: 1.3\r\n                        },\r\n                        sub: true\r\n                    }\r\n                },\r\n                ai: {\r\n                    save: true,\r\n                    mingzhi: true,\r\n                    skillTagFilter: function (player, tag, target) {\r\n                        if (player != target) return false;\r\n                    }\r\n                },\r\n                intro: {\r\n                    content: \"expansion\",\r\n                    markcount: \"expansion\"\r\n                }\r\n            },\r\n            PSfenji: {\r\n                audio: \"fenji\",\r\n                trigger: {\r\n                    global: [\r\n                        \"gainAfter\",\r\n                        \"loseAfter\",\r\n                        \"loseAsyncAfter\"\r\n                    ]\r\n                },\r\n                direct: true,\r\n                filter: function (event, player) {\r\n                    if (event.name == 'lose') {\r\n                        if (event.type != 'discard' || !event.player.isIn()) return false;\r\n                        if ((event.discarder || event.getParent(2).player) == event.player) return false;\r\n                        if (!event.getl(event.player).hs.length) return false;\r\n                        return true;\r\n                    }\r\n                    else if (event.name == 'gain') {\r\n                        if (event.giver || event.getParent().name == '_yongjian_zengyu') return false;\r\n                        var cards = event.getg(event.player);\r\n                        if (!cards.length) return false;\r\n                        return game.hasPlayer(function (current) {\r\n                            if (current == event.player) return false;\r\n                            var hs = event.getl(current).hs;\r\n                            for (var i of hs) {\r\n                                if (cards.includes(i)) return true;\r\n                            }\r\n                            return false;\r\n                        });\r\n                    }\r\n                    else if (event.type == 'gain') {\r\n                        if (event.giver || !event.player || !event.player.isIn()) return false;\r\n                        var hs = event.getl(event.player);\r\n                        return game.hasPlayer(function (current) {\r\n                            if (current == event.player) return false;\r\n                            var cards = event.getg(current);\r\n                            for (var i of cards) {\r\n                                if (hs.includes(i)) return true;\r\n                            }\r\n                        });\r\n                    }\r\n                    else if (event.type == 'discard') {\r\n                        if (!event.discarder) return false;\r\n                        return game.hasPlayer(function (current) {\r\n                            return current != event.discarder && event.getl(current).hs.length > 0;\r\n                        });\r\n                    }\r\n                    return false;\r\n                },\r\n                content: function () {\r\n                    'step 0'\r\n                    var targets = [];\r\n                    if (trigger.name == 'gain') {\r\n                        var cards = trigger.getg(trigger.player);\r\n                        targets.addArray(game.filterPlayer(function (current) {\r\n                            if (current == trigger.player) return false;\r\n                            var hs = trigger.getl(current).hs;\r\n                            for (var i of hs) {\r\n                                if (cards.includes(i)) return true;\r\n                            }\r\n                            return false;\r\n                        }));\r\n                    }\r\n                    else if (trigger.name == 'loseAsync' && trigger.type == 'discard') {\r\n                        targets.addArray(game.filterPlayer(function (current) {\r\n                            return current != trigger.discarder && trigger.getl(current).hs.length > 0;\r\n                        }));\r\n                    }\r\n                    else targets.push(trigger.player);\r\n                    event.targets = targets.sortBySeat();\r\n                    if (!event.targets.length) event.finish();\r\n                    'step 1'\r\n                    var target = targets.shift();\r\n                    event.target = target;\r\n                    var num = player.getExpansions('PSbuqu').length ? player.getExpansions('PSbuqu').length + 2 : 2;\r\n                    if (target.isIn()) player.chooseBool(get.prompt('fenji', target), '失去1点体力，令该角色摸' + get.cnNumber(num) + '张牌').set('ai', function () {\r\n                        var evt = _status.event.getParent();\r\n                        return get.attitude(evt.player, evt.target) > 4;\r\n                    });\r\n                    else {\r\n                        if (targets.length > 0) event.goto(1);\r\n                        else event.finish();\r\n                    }\r\n                    'step 2'\r\n                    if (result.bool) {\r\n                        player.logSkill('fenji', target);\r\n                        player.loseHp();\r\n                    }\r\n                    else {\r\n                        if (targets.length > 0) event.goto(1);\r\n                        else event.finish();\r\n                    }\r\n                    'step 3'\r\n                    var num = player.getExpansions('PSbuqu').length ? player.getExpansions('PSbuqu').length + 2 : 2;\r\n                    target.draw(num);\r\n                    if (targets.length > 0) event.goto(1);\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_wu,\r\n        translate: {\r\n            PSzhoutai: \"PS周泰\",\r\n            PSbuqu: \"不屈\",\r\n            PSbuqu_info: \"锁定技，当你处于濒死状态时，你亮出牌堆顶的一张牌并置于你的武将牌上，称之为“创”。若此牌的点数与你武将牌上已有的“创”点数均不同，则你回复至1点体力。若点数相同，则将此牌置入弃牌堆。只要你的武将牌上有“创”，你的手牌上限/摸牌阶段摸牌数/〖奋激〗摸牌数/【杀】使用次数便+X（X为“创”的数量）。\",\r\n            PSfenji: \"奋激\",\r\n            PSfenji_info: \"当一名角色的手牌不因赠予或交给而被其他角色获得后，或一名角色的手牌被其他角色弃置后，你可以令其摸两张牌。\"\r\n        },\r\n        dynamicTranslate: {\r\n            PSfenji: function (player) {\r\n                var num = 2;\r\n                if (player.getExpansions(\"PSbuqu\").length)\r\n                    num += player.getExpansions(\"PSbuqu\").length;\r\n                return (\r\n                    \"当一名角色的手牌不因赠予或交给而被其他角色获得后，或一名角色的手牌被其他角色弃置后，你可以令其摸\" +\r\n                    get.cnNumber(num) +\r\n                    \"张牌。\"\r\n                );\r\n            }\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PSerciyuan: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"qun\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PSzanhe\"\r\n            ],\r\n            dieAudios: [\r\n                \"yuantanyuanshang\"\r\n            ],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“曙光乘舟访人间”设计\",\r\n        skills: {\r\n            PSzanhe: {\r\n                audio: \"neifa\",\r\n                trigger: {\r\n                    source: \"dieAfter\"\r\n                },\r\n                direct: true,\r\n                mark: true,\r\n                init: function (player, skill) {\r\n                    if (!player.storage[skill]) player.storage[skill] = 0;\r\n                },\r\n                intro: {\r\n                    content: \"本轮已杀死#人\"\r\n                },\r\n                content: function () {\r\n                    player.storage.PSzanhe++;\r\n                },\r\n                mod: {\r\n                    cardUsable: function (card, player, num) {\r\n                        if (card.name == 'sha') return num += 5;\r\n                    },\r\n                    selectTarget: function (card, player, range) {\r\n                        if (card.name == 'sha' && range[1] != -1) {\r\n                            range[1]++;\r\n                        }\r\n                        if (get.type(card) == 'trick' && range[1] != -1) {\r\n                            range[1] += Infinity;\r\n                        }\r\n                    }\r\n                },\r\n                group: [\r\n                    \"PSzanhe_1\",\r\n                    \"PSzanhe_2\",\r\n                    \"PSzanhe_lose\",\r\n                    \"PSzanhe_add\"\r\n                ],\r\n                subSkill: {\r\n                    1: {\r\n                        trigger: {\r\n                            player: \"useCardAfter\"\r\n                        },\r\n                        filter: function (event, player) {\r\n                            if (_status.currentPhase != player) return false;\r\n                            return true;\r\n                        },\r\n                        direct: true,\r\n                        content: function () {\r\n                            \"step 0\"\r\n                            if (!player.countCards('he')) event.finish();\r\n                            else player.chooseCard('he', '是否重铸至多两张牌', [1, 2]).set('filterCard', (card, player) => player.canRecast(card)).set('ai', function (card) {\r\n                                var player = _status.event.player;\r\n                                if (card.name != 'tao' && card.name != 'wuxie') return 1;\r\n                                return 5 - get.value(card);\r\n                            });\r\n                            'step 1'\r\n                            if (result.bool) {\r\n                                player.recast(result.cards);\r\n                                player.logSkill('PSzanhe');\r\n                            }\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    2: {\r\n                        trigger: {\r\n                            player: \"loseAfter\",\r\n                            global: [\r\n                                \"equipAfter\",\r\n                                \"addJudgeAfter\",\r\n                                \"gainAfter\",\r\n                                \"loseAsyncAfter\",\r\n                                \"addToExpansionAfter\"\r\n                            ]\r\n                        },\r\n                        direct: true,\r\n                        filter: function (event, player) {\r\n                            if (event.getParent(2).name == 'PSzanhe_2') return false;\r\n                            if (player == _status.currentPhase) return false;\r\n                            if (event.name == 'gain' && event.player == player) return false;\r\n                            var evt = event.getl(player);\r\n                            return evt && evt.cards2 && evt.cards2.length > 0;\r\n                        },\r\n                        content: function () {\r\n                            \"step 0\"\r\n                            if (!player.countCards('he')) event.finish();\r\n                            else player.chooseCard('he', '是否重铸至多两张牌', [1, 2]).set('filterCard', (card, player) => player.canRecast(card)).set('ai', function (card) {\r\n                                var player = _status.event.player;\r\n                                if (card.name != 'tao' && card.name != 'wuxie') return 1;\r\n                                return 5 - get.value(card);\r\n                            });\r\n                            'step 1'\r\n                            if (result.bool) {\r\n                                player.recast(result.cards);\r\n                                player.logSkill('PSzanhe');\r\n                            }\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    lose: {\r\n                        trigger: {\r\n                            global: \"roundStart\"\r\n                        },\r\n                        direct: true,\r\n                        filter: function (event, player) {\r\n                            return player.storage.PSzanhe > 0;\r\n                        },\r\n                        content: function () {\r\n                            'step 0'\r\n                            player.logSkill('PSzanhe');\r\n                            player.storage.PSzanhe = 0;\r\n                            if (player.countCards('he') < 2) {\r\n                                player.loseHp();\r\n                                event.finish();\r\n                            }\r\n                            else {\r\n                                player.chooseBool('暂和:弃置两张牌，或点击取消失去一点体力');\r\n                            }\r\n                            'step 1'\r\n                            if (result.bool) {\r\n                                player.chooseToDiscard('he', 2, true);\r\n                            }\r\n                            else { player.loseHp(); }\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    add: {\r\n                        trigger: {\r\n                            player: \"useCard1\"\r\n                        },\r\n                        direct: true,\r\n                        filter: function (event, player) {\r\n                            var info = get.info(event.card, false);\r\n                            if (info.allowMultiple == false) return false;\r\n                            if (event.card.name != 'wuzhong') return false;\r\n                            if (event.targets && !info.multitarget) {\r\n                                if (game.hasPlayer(function (current) {\r\n                                    return !event.targets.includes(current) && lib.filter.targetEnabled2(event.card, player, current) && lib.filter.targetInRange(event.card, player, current);\r\n                                })) {\r\n                                    return true;\r\n                                }\r\n                            }\r\n                            return false;\r\n                        },\r\n                        content: function () {\r\n                            'step 0'\r\n                            var num = game.countPlayer(function (current) {\r\n                                return !trigger.targets.includes(current) && lib.filter.targetEnabled2(trigger.card, player, current) && lib.filter.targetInRange(trigger.card, player, current);\r\n                            });\r\n                            player.chooseTarget('暂和：是否为' + get.translation(trigger.card) + '增加任意个目标？', [1, Infinity], function (card, player, target) {\r\n                                var trigger = _status.event.getTrigger();\r\n                                var card = trigger.card;\r\n                                return !trigger.targets.includes(target) && lib.filter.targetEnabled2(card, player, target) && lib.filter.targetInRange(card, player, target);\r\n                            }).set('ai', function (target) {\r\n                                var player = _status.event.player;\r\n                                var card = _status.event.getTrigger().card;\r\n                                return get.effect(target, card, player, player);\r\n                            });\r\n                            'step 1'\r\n                            if (result.bool) {\r\n                                if (player != game.me && !player.isOnline()) game.delayx();\r\n                            }\r\n                            else event.finish();\r\n                            'step 2'\r\n                            var targets = result.targets.sortBySeat();\r\n                            player.logSkill('guowu_add', targets);\r\n                            trigger.targets.addArray(targets);\r\n                            //if(get.mode()=='guozhan') player.removeSkill('guowu_add');\r\n                        },\r\n                        sub: true\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_qun,\r\n        translate: {\r\n            PSerciyuan: \"二次袁\",\r\n            PSzanhe: \"暂和\",\r\n            PSzanhe_info: \"①你于回合内使用牌或于回合外失去牌后，可以重铸两张牌；<br/>②你每阶段使用杀的次数＋5且目标＋1，你使用普通锦囊牌时目标可以指定任意名角色；<br/>③每轮结束时，若你杀死过其他角色，则你须流失一点体力或弃置两张牌。\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PSdahantianzi: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"qun\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PSshengshi\",\r\n                \"PSluanshi\",\r\n                \"PSshanrang\"\r\n            ],\r\n            dieAudios: [\r\n                \"liuxie\"\r\n            ],\r\n            isAiForbidden: true,\r\n            trashBin: []\r\n        },\r\n        intro: \"由“一剑光寒19州”设计\",\r\n        skills: {\r\n            PSshengshi: {\r\n                audio: \"sphuangen\",\r\n                trigger: {\r\n                    global: \"recoverAfter\"\r\n                },\r\n                forced: true,\r\n                filter: function (event, player) {\r\n                    if (_status.dying.length) return false;\r\n                    return true;\r\n                },\r\n                content: function () {\r\n                    \"step 0\"\r\n                    var targets = game.filterPlayer();\r\n                    for (var i = 0; i < targets.length; i++) {\r\n                        targets[i].loseHp();\r\n                        game.delay();\r\n                    }\r\n                    targets.sort(lib.sort.seat);\r\n                    event.targets = targets;\r\n                    event.num = 0;\r\n                    player.line(targets, 'green');\r\n                    \"step 1\"\r\n                    if (num < event.targets.length) {\r\n                        var he = event.targets[num].getCards('he');\r\n                        if (he.length) {\r\n                            player.discardPlayerCard('he', event.targets[num], true);\r\n                        }\r\n                        else {\r\n                            event.targets[num].loseHp();\r\n                        }\r\n                        event.num++;\r\n                        event.redo();\r\n                    }\r\n                },\r\n                ai: {\r\n                    threaten: 4\r\n                }\r\n            },\r\n            PSluanshi: {\r\n                audio: \"shiyuan\",\r\n                trigger: {\r\n                    target: \"useCardToTarget\"\r\n                },\r\n                forced: true,\r\n                filter: function (event, player) {\r\n                    if (event.card.storage && event.card.storage.PSluanshi) return false;\r\n                    return get.tag(event.card, 'damage') > 0 && player.isIn();\r\n                },\r\n                content: function () {\r\n                    \"step 0\"\r\n                    var cards = get.cards(3), sum = 0, str = '失去体力';\r\n                    game.cardsGotoOrdering(cards);\r\n                    for (var i of cards) {\r\n                        sum += i.number;\r\n                    }\r\n                    game.log(cards, '点数和为', sum);\r\n                    if (sum != 21) str = sum > 21 ? '回复体力' : '反弹效果';\r\n                    player.showCards(cards, '乱世：点数和为' + sum + '，' + get.translation(player) + str);\r\n                    game.delay(2);\r\n                    if (sum > 21) {\r\n                        player.recover();\r\n                    }\r\n                    else if (sum == 21) {\r\n                        player.loseHp();\r\n                    }\r\n                    else {\r\n                        game.log(trigger.player)\r\n                        var target = trigger.player;\r\n                        var evt = trigger.getParent();\r\n                        evt.triggeredTargets2.remove(player);\r\n                        evt.targets.remove(player);\r\n                        evt.targets.push(target);\r\n                    }\r\n                },\r\n                ai: {\r\n                    threaten: 3\r\n                }\r\n            },\r\n            PSshanrang: {\r\n                audio: \"sphantong\",\r\n                trigger: {\r\n                    player: [\r\n                        \"dying\"\r\n                    ]\r\n                },\r\n                unique: true,\r\n                forced: true,\r\n                skillAnimation: true,\r\n                animationStr: \"禅让\",\r\n                animationColor: \"orange\",\r\n                zhuSkill: true,\r\n                filter: function (event, player) {\r\n                    return player.hasZhuSkill('PSshanrang');\r\n                },\r\n                content: function () {\r\n                    'step 0'\r\n                    player.draw(2);\r\n                    'step 1'\r\n                    var num = game.countPlayer(function (current) {\r\n                        return player != current && current.countCards('h') > 0;\r\n                    });\r\n                    if (num == 0) player.chooseTarget('禅让：选择一名角色进行“禅让”仪式', true, function (card, player, target) {\r\n                        return player != target;\r\n                    }).set(\"ai\", function (target) {\r\n                        var player = _status.event.player;\r\n                        var eff = -get.attitude(player, target) - get.attitude(player, player);\r\n                        return eff;\r\n\r\n                    });\r\n                    else event.goto(3);\r\n                    'step 2'\r\n                    if (result.bool) {\r\n                        event.target = result.targets[0];\r\n                        event.bool = true;\r\n                        event.goto(5);\r\n                    }\r\n                    'step 3'\r\n                    player.chooseTarget('禅让：选择一名角色进行拼点', true, function (card, player, target) {\r\n                        return player.canCompare(target);\r\n                    }).set(\"ai\", function (target) {\r\n                        var player = _status.event.player;\r\n                        var eff = -get.attitude(player, target) - get.attitude(player, player);\r\n                        var playerExpect = ((_status.event.num - 1) / 13) ** target.countCards('h');\r\n                        eff += 2 * playerExpect * (get.attitude(player, player)) + 2 * (1 - playerExpect) * (get.attitude(player, target)) + 1;\r\n                        return eff;\r\n\r\n                    }).set(\"num\", num);\r\n                    'step 4'\r\n                    if (result.bool) {\r\n                        event.target = result.targets[0];\r\n                        player.chooseToCompare(event.target);\r\n                    }\r\n                    'step 5'\r\n                    if (result.bool || event.bool) {\r\n                        var target = event.target, skills = ['PSshengshi', 'PSluanshi', 'PSshanrang'];\r\n                        for (var i of skills) {\r\n                            target.addSkills(i);\r\n                        }\r\n                        target.storage.zhuSkill_PSshanrang = 'PSshanrang';\r\n                        target.identity = 'zhu';\r\n                        target.setIdentity('zhu');\r\n                        target.identityShown = true;\r\n                        game.zhu = target;\r\n                        game.zhu.update();\r\n                        player.die();\r\n                    }\r\n                    else {\r\n                        var targets = game.filterPlayer();\r\n                        for (var i = 0; i < targets.length; i++) {\r\n                            targets[i].loseHp();\r\n                            game.delay();\r\n                        }\r\n                        player.die();\r\n                    }\r\n                },\r\n                ai: {\r\n                    threaten: 3\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_qun,\r\n        translate: {\r\n            PSdahantianzi: \"大汉天子\",\r\n            PSshengshi: \"盛世\",\r\n            PSshengshi_info: \"锁定技，每当有角色回复体力后，若场上没有处于濒死状态的角色，你令每名角色失去一点体力并弃置其一张牌（若其没有牌，则改为其失去一点体力）。\",\r\n            PSluanshi: \"乱世\",\r\n            PSluanshi_info: \"锁定技，每当你成为伤害类牌的目标后，展示并弃置牌堆顶三张牌，若点数之和：<br/>① 大于21，你恢复一点体力；<br/>②等于21 ，你流失一点体力；<br/>③小于21，你令来源承受此效果。\",\r\n            PSshanrang: \"禅让\",\r\n            PSshanrang_info: \"主公技，锁定技，当你濒死时摸两张牌并与一名角色拼点，①若你赢则令其成为主公并获得〖盛世、乱世、禅让〗技能且你阵亡；②若你没赢则令全场流失一点体力且你阵亡。（若无法拼点则你选择一名其他角色令其执行效果① ）​\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PSnanhualaoxian: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"qun\",\r\n            hp: 3,\r\n            skills: [\r\n                \"PSyufeng\",\r\n                \"PStianshu\",\r\n                \"PSyinshi\"\r\n            ],\r\n            isAiForbidden: true,\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“一顿七只屑狐狸”设计\",\r\n        replace: [\r\n            \"PSnanhualaoxian\",\r\n            \"PSshen_nanhualaoxian\"\r\n        ],\r\n        skills: {\r\n            PSyufeng: {\r\n                audio: \"yufeng\",\r\n                enable: \"phaseUse\",\r\n                usable: 2,\r\n                filter: function (event, player) {\r\n                    return game.roundNumber > 0;\r\n                },\r\n                content: function () {\r\n                    'step 0'\r\n                    event.videoId = lib.status.videoId++;\r\n                    var func = function (player, id) {\r\n                        var list = [\r\n                            '选项一：令一名角色摸五张牌，再将手牌弃置至体力上限数',\r\n                            '选项二：选择两名角色调换座次',\r\n                            '选项三：摸两张牌',\r\n                            '选项四：选择至多三名角色各弃置其两张牌',\r\n                        ];\r\n                        var num = Math.min(4, game.roundNumber);\r\n                        var choiceList = ui.create.dialog('御风：请选择一' + (game.roundNumber > 1 ? ('至' + get.cnNumber(num)) : '') + '项');\r\n                        choiceList.videoId = id;\r\n                        for (var i = 0; i < list.length; i++) {\r\n                            var str = '<div class=\"popup text\" style=\"width:calc(100% - 10px);display:inline-block\">';\r\n                            str += list[i];\r\n                            str += '</div>';\r\n                            var next = choiceList.add(str);\r\n                            next.firstChild.addEventListener(lib.config.touchscreen ? 'touchend' : 'click', ui.click.button);\r\n                            next.firstChild.link = i;\r\n                            /* for (var j in lib.element.button) {\r\n                                next[j] = lib.element.button[j];\r\n                            } */\r\n                            Object.setPrototypeOf(next, lib.element.Button.prototype);\r\n                            choiceList.buttons.add(next.firstChild);\r\n                        }\r\n                        return choiceList;\r\n                    };\r\n                    if (player.isOnline2()) {\r\n                        player.send(func, player, event.videoId);\r\n                    }\r\n                    event.dialog = func(player, event.videoId);\r\n                    if (player != game.me || _status.auto) {\r\n                        event.dialog.style.display = 'none';\r\n                    }\r\n                    var next = player.chooseButton();\r\n                    next.set('dialog', event.videoId);\r\n                    next.set('forced', true);\r\n                    next.set('ai', function (button) {\r\n                        var player = _status.event.player;\r\n                        switch (button.link) {\r\n                            case 0:\r\n                                return 2;\r\n                                break;\r\n                            case 1:\r\n                                return Math.max(0.5, player.countCards('hs', function (card) {\r\n                                    return get.name(card) == 'sha' && player.hasValueTarget(card);\r\n                                }) - player.getCardUsable({ name: 'sha' })) + Math.max.apply(Math, game.filterPlayer(function (current) {\r\n                                    return current != player;\r\n                                }).map(function (target) {\r\n                                    return get.damageEffect(target, player, player);\r\n                                }));\r\n                                break;\r\n                            case 2:\r\n                                return player.needsToDiscard() / 4;\r\n                                break;\r\n                            case 3:\r\n                                var num = 0;\r\n                                return 0.8 * Math.max.apply(Math, game.filterPlayer(function (current) {\r\n                                    return current != player && current.hasCard((card) => lib.filter.canBeGained(card, current, player), 'hej');\r\n                                }).map(function (target) {\r\n                                    return get.effect(target, { name: 'shunshou_copy' }, player, player);\r\n                                }));\r\n                                break;\r\n\r\n                        }\r\n                    });\r\n                    if (game.roundNumber > 1) next.set('selectButton', [1, game.roundNumber]);\r\n                    'step 1'\r\n                    if (player.isOnline2()) {\r\n                        player.send('closeDialog', event.videoId);\r\n                    }\r\n                    event.dialog.close();\r\n                    result.links.sort();\r\n                    for (var i of result.links) game.log(player, '选择了', '#g【御风】', '的', '#y选项' + get.cnNumber(1 + i, true))\r\n                    event.links = result.links;\r\n                    var count = -1;\r\n                    event.count = count;\r\n                    'step 2'\r\n                    event.count++;\r\n                    switch (event.links[event.count]) {\r\n                        case 0:\r\n                            event.goto(3);\r\n                            break;\r\n                        case 1:\r\n                            event.goto(6);\r\n                            break;\r\n                        case 2:\r\n                            event.goto(8);\r\n                            break;\r\n                        case 3:\r\n                            event.goto(9);\r\n                            break;\r\n                        default:\r\n                            event.finish();\r\n                    }\r\n                    'step 3'\r\n                    player.chooseTarget('御风：令一名角色摸五张牌，再将手牌弃置至其体力上限数', false).set('ai', function (target) {\r\n                        var att = get.attitude(_status.event.player, target);\r\n                        var draw = 5 - target.countCards('h');\r\n                        if (draw >= 0) {\r\n                            if (target.hasSkillTag('nogain')) att /= 6;\r\n                            if (att > 2) {\r\n                                return Math.sqrt(draw + 1) * att;\r\n                            }\r\n                            return att / 3;\r\n                        }\r\n                        if (draw < -1) {\r\n                            if (target.hasSkillTag('nogain')) att *= 6;\r\n                            if (att < -2) {\r\n                                return -Math.sqrt(1 - draw) * att;\r\n                            }\r\n                        }\r\n                        return 0;\r\n                    });\r\n                    'step 4'\r\n                    if (result.bool) {\r\n                        var target = result.targets[0];\r\n                        event.target = target;\r\n                        target.draw(5);\r\n                    }\r\n                    else {\r\n                        event.goto(2);\r\n                    }\r\n                    'step 5'\r\n                    var num = target.countCards('h') - target.maxHp;\r\n                    if (num > 0) target.chooseToDiscard('h', true, num);\r\n                    event.goto(2);\r\n                    'step 6'\r\n                    player.chooseTarget(2, '选择两名角色，交换座次', false, function (card, player, target) {\r\n                        return true;\r\n                    }).set('ai', function (target) {\r\n                        var player = _status.event.player;\r\n                        var att = get.attitude(player, target);\r\n                        if (att < 0) {\r\n                            return att - 1;\r\n                        }\r\n                        return att;\r\n                    }).set('targetprompt', ['', '']);\r\n                    'step 7'\r\n                    if (result.targets) {\r\n                        var targets = result.targets;\r\n                        game.broadcastAll(function (target1, target2) {\r\n                            game.swapSeat(target1, target2);\r\n                        }, targets[0], targets[1]);\r\n                        event.goto(2);\r\n                    } else {\r\n                        event.goto(2);\r\n                    }\r\n                    'step 8'\r\n                    player.draw(2);\r\n                    event.goto(2);\r\n                    'step 9'\r\n                    player.chooseTarget([1, 3], '弃置至多三名角色各两张牌', false, function (card, player, target) {\r\n                        return true;\r\n                    }).set('ai', function (target) {\r\n                        var player = _status.event.player;\r\n                        var att = get.attitude(player, target);\r\n                        if (att < 0) {\r\n                            return att - 1;\r\n                        }\r\n                        return att;\r\n                    });\r\n                    'step 10'\r\n                    if (result.targets) {\r\n                        var targets = result.targets;\r\n                        for (var i of targets) {\r\n                            if (i.countCards('he') > 0) {\r\n                                player.discardPlayerCard('he', i, [1, 2], true);\r\n                            }\r\n                        }\r\n                    } else {\r\n                        event.finish();\r\n                    }\r\n                },\r\n                group: \"PSyufeng_change\",\r\n                subSkill: {\r\n                    change: {\r\n                        audio: \"yufeng\",\r\n                        trigger: {\r\n                            player: \"changeHp\"\r\n                        },\r\n                        prompt: \"是否发动【御风】？\",\r\n                        content: function () {\r\n                            'step 0'\r\n                            event.videoId = lib.status.videoId++;\r\n                            var func = function (player, id) {\r\n                                var list = [\r\n                                    '选项一：令一名角色摸五张牌，再将手牌弃置至体力上限数',\r\n                                    '选项二：选择两名角色调换座次',\r\n                                    '选项三：摸两张牌',\r\n                                    '选项四：选择至多三名角色各弃置其两张牌',\r\n                                ];\r\n                                var choiceList = ui.create.dialog('御风：请选择一项发动两次');\r\n                                choiceList.videoId = id;\r\n                                for (var i = 0; i < list.length; i++) {\r\n                                    var str = '<div class=\"popup text\" style=\"width:calc(100% - 10px);display:inline-block\">';\r\n                                    str += list[i];\r\n                                    str += '</div>';\r\n                                    var next = choiceList.add(str);\r\n                                    next.firstChild.addEventListener(lib.config.touchscreen ? 'touchend' : 'click', ui.click.button);\r\n                                    next.firstChild.link = i;\r\n                                    /* for (var j in lib.element.button) {\r\n                                        next[j] = lib.element.button[j];\r\n                                    } */\r\n                                    Object.setPrototypeOf(next, lib.element.Button.prototype);\r\n                                    choiceList.buttons.add(next.firstChild);\r\n                                }\r\n                                return choiceList;\r\n                            };\r\n                            if (player.isOnline2()) {\r\n                                player.send(func, player, event.videoId);\r\n                            }\r\n                            event.dialog = func(player, event.videoId);\r\n                            if (player != game.me || _status.auto) {\r\n                                event.dialog.style.display = 'none';\r\n                            }\r\n                            var next = player.chooseButton();\r\n                            next.set('dialog', event.videoId);\r\n                            next.set('forced', true);\r\n                            next.set('ai', function (button) {\r\n                                var player = _status.event.player;\r\n                                switch (button.link) {\r\n                                    case 0:\r\n                                        return 2;\r\n                                        break;\r\n                                    case 1:\r\n                                        return Math.max(0.5, player.countCards('hs', function (card) {\r\n                                            return get.name(card) == 'sha' && player.hasValueTarget(card);\r\n                                        }) - player.getCardUsable({ name: 'sha' })) + Math.max.apply(Math, game.filterPlayer(function (current) {\r\n                                            return current != player;\r\n                                        }).map(function (target) {\r\n                                            return get.damageEffect(target, player, player);\r\n                                        }));\r\n                                        break;\r\n                                    case 2:\r\n                                        return player.needsToDiscard() / 4;\r\n                                        break;\r\n                                    case 3:\r\n                                        var num = 0;\r\n                                        return 0.8 * Math.max.apply(Math, game.filterPlayer(function (current) {\r\n                                            return current != player && current.hasCard((card) => lib.filter.canBeGained(card, current, player), 'hej');\r\n                                        }).map(function (target) {\r\n                                            return get.effect(target, { name: 'shunshou_copy' }, player, player);\r\n                                        }));\r\n                                        break;\r\n\r\n                                }\r\n                            });\r\n                            'step 1'\r\n                            if (player.isOnline2()) {\r\n                                player.send('closeDialog', event.videoId);\r\n                            }\r\n                            event.dialog.close();\r\n                            result.links.sort();\r\n                            for (var i of result.links) game.log(player, '选择了', '#g【御风】', '的', '#y选项' + get.cnNumber(1 + i, true))\r\n                            event.links = result.links;\r\n                            event.links.sort();\r\n                            var count = 0;\r\n                            event.count = count;\r\n                            'step 2'\r\n                            event.count++;\r\n                            if (event.count > 2 || !player.isAlive()) event.finish();\r\n                            switch (event.links[0]) {\r\n                                case 0:\r\n                                    event.goto(3);\r\n                                    break;\r\n                                case 1:\r\n                                    event.goto(6);\r\n                                    break;\r\n                                case 2:\r\n                                    event.goto(8);\r\n                                    break;\r\n                                case 3:\r\n                                    event.goto(9);\r\n                                    break;\r\n                                default:\r\n                                    event.finish();\r\n                            }\r\n                            'step 3'\r\n                            player.chooseTarget('御风：令一名角色摸五张牌，再将手牌弃置至其体力上限数', false).set('ai', function (target) {\r\n                                var att = get.attitude(_status.event.player, target);\r\n                                var draw = 5 - target.countCards('h');\r\n                                if (draw >= 0) {\r\n                                    if (target.hasSkillTag('nogain')) att /= 6;\r\n                                    if (att > 2) {\r\n                                        return Math.sqrt(draw + 1) * att;\r\n                                    }\r\n                                    return att / 3;\r\n                                }\r\n                                if (draw < -1) {\r\n                                    if (target.hasSkillTag('nogain')) att *= 6;\r\n                                    if (att < -2) {\r\n                                        return -Math.sqrt(1 - draw) * att;\r\n                                    }\r\n                                }\r\n                                return 0;\r\n                            });\r\n                            'step 4'\r\n                            if (result.bool) {\r\n                                var target = result.targets[0];\r\n                                event.target = target;\r\n                                target.draw(5);\r\n                            }\r\n                            else {\r\n                                event.goto(2);\r\n                            }\r\n                            'step 5'\r\n                            var num = target.countCards('h') - target.maxHp;\r\n                            if (num > 0) target.chooseToDiscard('h', true, num);\r\n                            event.goto(2);\r\n                            'step 6'\r\n                            player.chooseTarget(2, '选择两名角色，交换座次', false, function (card, player, target) {\r\n                                return true;\r\n                            }).set('ai', function (target) {\r\n                                var player = _status.event.player;\r\n                                var att = get.attitude(player, target);\r\n                                if (att < 0) {\r\n                                    return att - 1;\r\n                                }\r\n                                return att;\r\n                            }).set('targetprompt', ['', '']);\r\n                            'step 7'\r\n                            if (result.targets) {\r\n                                var targets = result.targets;\r\n                                game.broadcastAll(function (target1, target2) {\r\n                                    game.swapSeat(target1, target2);\r\n                                }, targets[0], targets[1]);\r\n                                event.goto(2);\r\n                            } else {\r\n                                event.goto(2);\r\n                            }\r\n                            'step 8'\r\n                            player.draw(2);\r\n                            event.goto(2);\r\n                            'step 9'\r\n                            player.chooseTarget([1, 3], '弃置至多三名角色各两张牌', false, function (card, player, target) {\r\n                                return true;\r\n                            }).set('ai', function (target) {\r\n                                var player = _status.event.player;\r\n                                var att = get.attitude(player, target);\r\n                                if (att < 0) {\r\n                                    return att - 1;\r\n                                }\r\n                                return att;\r\n                            });\r\n                            'step 10'\r\n                            if (result.targets) {\r\n                                var targets = result.targets;\r\n                                for (var i of targets) {\r\n                                    if (i.countCards('he') > 0) {\r\n                                        player.discardPlayerCard('he', i, [1, 2], true);\r\n                                    }\r\n                                }\r\n                                event.goto(2);\r\n                            } else {\r\n                                event.goto(2);\r\n                            }\r\n                        },\r\n                        sub: true\r\n                    }\r\n                }\r\n            },\r\n            PStianshu: {\r\n                audio: \"tianshu\",\r\n                equipSkill: false,\r\n                noHidden: true,\r\n                inherit: \"taipingyaoshu\",\r\n                derivation: \"taipingyaoshu\",\r\n                mod: {\r\n                    maxHandcard: function (player, num) {\r\n                        if (get.mode() == 'guozhan') {\r\n                            return num + game.countPlayer(function (current) {\r\n                                return current.isFriendOf(player);\r\n                            });\r\n                        }\r\n                        return num + game.countGroup() - 1;\r\n                    }\r\n                },\r\n                trigger: {\r\n                    player: \"damageBegin4\"\r\n                },\r\n                filter: function (event, player) {\r\n                    if (!lib.skill.taipingyaoshu.filter.apply(this, arguments)) return false;\r\n                    if (player.hasSkillTag('unequip2')) return false;\r\n                    if (event.source && event.source.hasSkillTag('unequip', false, {\r\n                        name: event.card ? event.card.name : null,\r\n                        target: player,\r\n                        card: event.card\r\n                    })) return false;\r\n                    if (event.hasNature()) return true;\r\n                },\r\n                forced: true,\r\n                content: function () {\r\n                    trigger.cancel();\r\n                },\r\n                ai: {\r\n                    nofire: true,\r\n                    nothunder: true,\r\n                    effect: {\r\n                        target: function (card, player, target, current) {\r\n\r\n                            if (target.hasSkillTag('unequip2')) return;\r\n                            if (player.hasSkillTag('unequip', false, {\r\n                                name: card ? card.name : null,\r\n                                target: target,\r\n                                card: card\r\n                            }) || player.hasSkillTag('unequip_ai', false, {\r\n                                name: card ? card.name : null,\r\n                                target: target,\r\n                                card: card\r\n                            })) return;\r\n                            if (get.tag(card, 'natureDamage')) return 'zerotarget';\r\n                            if (card.name == 'tiesuo') {\r\n                                return [0, 0];\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            PSyinshi: {\r\n                audio: \"ext:PS武将/audio/skill:2\",\r\n                trigger: {\r\n                    player: \"phaseBegin\"\r\n                },\r\n                forced: true,\r\n                priority: 99,\r\n                filter: function (event, player) {\r\n                    return event.phaseList.length;\r\n                },\r\n                content: function () {\r\n                    trigger.phaseList = ['phaseDraw', 'phaseUse', 'phaseDiscard'];\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_qun,\r\n        translate: {\r\n            PSnanhualaoxian: \"PS南华老仙\",\r\n            PSyufeng: \"御风\",\r\n            PSyufeng_info: \"出牌阶段限两次，你可以选择X项（X为当前游戏轮数）:<br/>1.你可以选择一名角色让其摸5张牌，再将手牌弃置为X（X为其体力上限）。<br/>2.你选择2名角色调换座位。<br/>3.摸两张牌。<br/>4.选择至多3名角色各弃置其2张牌。<br/>当你的体力值变动时，你可令其中一项发动两次。\",\r\n            PStianshu: \"天书\",\r\n            PStianshu_info: \"锁定技，你的宝物区视为装备【太平要术】。\",\r\n            PSyinshi: \"隐士\",\r\n            PSyinshi_info: \"锁定技，你只有摸牌阶段、出牌阶段和弃牌阶段。\"\r\n        },\r\n        rank: rank.epic\r\n    },\r\n    PSzhangsong: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"shu\",\r\n            hp: 3,\r\n            skills: [\r\n                \"PSqiangzhi\",\r\n                \"PSxiantu\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“子夜、night”设计\",\r\n        skills: {\r\n            PSqiangzhi: {\r\n                audio: \"qiangzhi\",\r\n                trigger: {\r\n                    player: \"phaseUseBegin\"\r\n                },\r\n                direct: true,\r\n                filter: function (event, player) {\r\n                    return game.hasPlayer(function (current) {\r\n                        return current != player && current.countCards('h') > 0;\r\n                    });\r\n                },\r\n                subfrequent: [\r\n                    \"draw\"\r\n                ],\r\n                content: function () {\r\n                    'step 0'\r\n                    player.chooseTarget(get.prompt2('qiangzhi'), function (card, player, target) {\r\n                        return target != player && target.countCards('h') > 0;\r\n                    }).set('ai', function () {\r\n                        return Math.random();\r\n                    });\r\n                    'step 1'\r\n                    if (result.bool) {\r\n                        var target = result.targets[0];\r\n                        player.logSkill('qiangzhi', target);\r\n                        player.choosePlayerCard(target, 'h', true, 'visible');\r\n                    }\r\n                    else event.finish();\r\n                    'step 2'\r\n                    var card = result.cards[0];\r\n                    player.showCards(card);\r\n                    player.storage.PSqiangzhi_draw = get.type(card, 'trick');\r\n                    game.addVideo('storage', player, ['PSqiangzhi_draw', player.storage.PSqiangzhi_draw]);\r\n                    player.addTempSkill('PSqiangzhi_draw', 'phaseUseEnd');\r\n                },\r\n                subSkill: {\r\n                    draw: {\r\n                        trigger: {\r\n                            player: \"useCard\"\r\n                        },\r\n                        frequent: true,\r\n                        popup: false,\r\n                        charlotte: true,\r\n                        prompt: \"是否执行【强识】的效果摸一张牌？\",\r\n                        filter: function (event, player) {\r\n                            return get.type(event.card, 'trick') == player.storage.PSqiangzhi_draw;\r\n                        },\r\n                        content: function () {\r\n                            player.draw();\r\n                            player.logSkill('qiangzhi');\r\n                        },\r\n                        onremove: true,\r\n                        mark: true,\r\n                        intro: {\r\n                            content: function (type) {\r\n                                return get.translation(type) + '牌';\r\n                            }\r\n                        },\r\n                        sub: true\r\n                    }\r\n                }\r\n            },\r\n            PSxiantu: {\r\n                audio: \"xiantu1\",\r\n                group: \"xiantu2\",\r\n                trigger: {\r\n                    global: \"phaseUseBegin\"\r\n                },\r\n                filter: function (event, player) {\r\n                    return event.player != player;\r\n                },\r\n                logTarget: \"player\",\r\n                check: function (event, player) {\r\n\r\n                    if (player.maxHp - player.hp >= 2) return false;\r\n                    if (player.hp == 1) return false;\r\n                    if (player.hp == 2 && player.countCards('h') < 2) return false;\r\n\r\n                    return true;\r\n                },\r\n                content: function () {\r\n                    \"step 0\"\r\n                    player.draw(2);\r\n                    \"step 1\"\r\n                    player.chooseCard(1, 'he', true, '交给' + get.translation(trigger.player) + '一张牌').set('ai', function (card) {\r\n                        if (ui.selected.cards.length && card.name == ui.selected.cards[0].name) return -1;\r\n                        if (get.tag(card, 'damage')) return 1;\r\n                        if (get.type(card) == 'equip') return 1;\r\n                        return 0;\r\n                    });\r\n                    \"step 2\"\r\n                    player.give(result.cards, trigger.player);\r\n                    player.gainPlayerCard(2, 'he', trigger.player, false, 'visible');\r\n                    trigger.player.addSkill('xiantu4');\r\n                    trigger.player.storage.xiantu4.push(player);\r\n                },\r\n                ai: {\r\n                    threaten: 1.1,\r\n                    expose: 0.3\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_shu,\r\n        translate: {\r\n            PSzhangsong: \"PS张松\",\r\n            PSqiangzhi: \"强识\",\r\n            PSqiangzhi_info: \"出牌阶段开始时，你可以观看并展示一名其他角色的一张手牌。若如此做，当你于此阶段内使用与此牌类别相同的牌时，你可以摸一张牌。\",\r\n            PSxiantu: \"献图\",\r\n            PSxiantu_info: \"一名其他角色的出牌阶段开始时，你可以摸两张牌，然后交给其一张牌，再获得其两张牌。若如此做，此阶段结束时，若该角色未于此阶段内杀死过角色，则你失去1点体力。\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PSquansun: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"wu\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PShengzhi\",\r\n                \"PSnengwan\"\r\n            ],\r\n            dieAudios: [\r\n                \"re_sunquan\"\r\n            ],\r\n            isZhugong: true,\r\n            trashBin: []\r\n        },\r\n        intro: \"由“神鬼高达”设计\",\r\n        skills: {\r\n            PShengzhi: {\r\n                audio: \"rezhiheng\",\r\n                audioname: [\r\n                    \"shen_caopi\"\r\n                ],\r\n                enable: \"phaseUse\",\r\n                discard: false,\r\n                lose: false,\r\n                delay: false,\r\n                filter: function (card, player) {\r\n                    var num = 0;\r\n                    var count = Math.max(1, player.getDamagedHp());\r\n                    num = player.countCards('he');\r\n                    if (num == 0) return false;\r\n                    if (player.countSkill('PShengzhi') >= count) return false;\r\n                    return true;\r\n                },\r\n                content: function () {\r\n                    'step 0'\r\n                    var num = 0;\r\n                    num = player.countCards('he');\r\n                    if (num == 0) event.finish();\r\n                    player.draw(num);\r\n                    player.chooseToDiscard(num, 'he', true, '衡制：请弃置' + get.cnNumber(num) + '张牌');\r\n                },\r\n                ai: {\r\n                    threaten: 1,\r\n                    order: 15,\r\n                    result: {\r\n                        player: 1\r\n                    }\r\n                }\r\n            },\r\n            PSnengwan: {\r\n                audio: \"PShuiwan\",\r\n                trigger: {\r\n                    player: [\r\n                        \"phaseDrawSkipped\",\r\n                        \"phaseDrawCancelled\",\r\n                        \"phaseUseSkipped\",\r\n                        \"phaseUseCancelled\"\r\n                    ]\r\n                },\r\n                forced: true,\r\n                content: function () {\r\n                    var str = ([\"phaseDrawSkipped\", \"phaseDrawCancelled\"].includes(event.triggername)) ? '摸牌阶段' : '出牌阶段';\r\n                    game.log(player, '恢复了', str);\r\n                    player[trigger.name]();\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_wu,\r\n        translate: {\r\n            PSquansun: \"PS权孙\",\r\n            PShengzhi: \"衡制\",\r\n            PShengzhi_info: \"出牌阶段限X次，你可以摸你手牌区和装备区牌数量的牌，然后弃置等量的牌。（X为你已损失的体力值且至少为1）\",\r\n            PSnengwan: \"能玩\",\r\n            PSnengwan_info: \"锁定技，你的摸牌阶段和出牌阶段阶段不能被跳过。\"\r\n        },\r\n        rank: rank.junk\r\n    },\r\n    PSjiesuanjie: {\r\n        info: {\r\n            sex: \"female\",\r\n            group: \"wu\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PSzailaiyici\"\r\n            ],\r\n            dieAudios: [\r\n                \"zhangxuan\"\r\n            ],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“CuberPR”设计\",\r\n        skills: {\r\n            PSzailaiyici: {\r\n                audio: \"tongli\",\r\n                trigger: {\r\n                    global: \"useCard\"\r\n                },\r\n                prompt2: function (event, player) {\r\n                    return '令' + get.translation(event.player) + \"的\" + get.translation(event.card) + \"额外结算\";\r\n                },\r\n                check: function (event, player) {\r\n                    return get.attitude(player, event.player) > 0 && !get.tag(event.card, 'norepeat');\r\n                },\r\n                filter: function (event, player) {\r\n                    if (event.parent.name == 'PSzailaiyici') return false;\r\n                    if (!event.targets || !event.card) return false;\r\n                    var type = get.type(event.card);\r\n                    if (type != 'basic' && type != 'trick') return false;\r\n                    if (['shan', 'wuxie'].includes(get.name(event.card, event.player))) return false;\r\n                    for (var i = 0; i < event.targets.length; i++) {\r\n                        if (!event.targets[i].isAlive()) return false;\r\n                        if (!event.player.canUse({ name: event.card.name }, event.targets[i], false, false)) {\r\n                            return false;\r\n                        }\r\n                    }\r\n                    return true;\r\n                },\r\n                content: function () {\r\n                    trigger.effectCount++;\r\n                },\r\n                ai: {\r\n                    threaten: 2\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_wu,\r\n        translate: {\r\n            PSjiesuanjie: \"额外结算姐\",\r\n            PSzailaiyici: \"再来\",\r\n            PSzailaiyici_info: \"一名角色使用即时牌指定第一个目标后，你可令此牌额外结算一次。\"\r\n        },\r\n        rank: rank.epic\r\n    },\r\n    PSguanyunchang: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"shu\",\r\n            hp: 4,\r\n            skills: [\r\n                \"wusheng\",\r\n                \"PSweizhen\"\r\n            ],\r\n            dieAudios: [\r\n                \"re_guanyu\"\r\n            ],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“你想去哪儿呢”设计\",\r\n        skills: {\r\n            PSweizhen: {\r\n                mod: {\r\n                    targetInRange: function (card, player, target) {\r\n                        var info = lib.skill.PSweizhen.getInfo(player);\r\n                        if (card.name == 'sha' && get.color(card) == 'red') {\r\n                            if (get.distance(player, target) <= 1 + info[0]) return true;\r\n                        }\r\n                    },\r\n                    selectTarget: function (card, player, range) {\r\n                        var info = lib.skill.PSweizhen.getInfo(player);\r\n                        if (card.name == 'sha' && get.color(card) == 'red' && range[1] != -1) {\r\n                            range[1] += info[2];\r\n                        }\r\n                    },\r\n                    cardUsable: function (card, player, num) {\r\n                        var info = lib.skill.PSweizhen.getInfo(player);\r\n                        if (card.name == 'sha' && (get.color(card) == 'red' || get.color(card) == 'none')) return num += info[3];\r\n\r\n                    }\r\n                },\r\n                init: function (player) {\r\n                    if (!player.storage.PSweizhen) player.storage.PSweizhen = [0, 0, 0, 0, 0];\r\n                },\r\n                getInfo: function (player) {\r\n                    if (!player.storage.PSweizhen) player.storage.PSweizhen = [0, 0, 0, 0, 0];\r\n                    return player.storage.PSweizhen;\r\n                },\r\n                mark: true,\r\n                intro: {\r\n                    content: function (storage, player) {\r\n                        var info = lib.skill.PSweizhen.getInfo(player);\r\n                        return '<div class=\"text center\"><span class=thundertext>距离：' + info[0] + '</span>　<span class=firetext>伤害：' + info[1] + '</span><br><span class=greentext>目标：' + info[2] + '</span>　<span class=bluetext>次数：' + info[3] + '</span><br><span class=whitetext>强命：' + info[4] + '</span></div>'\r\n                    }\r\n                },\r\n                audio: \"ext:PS武将/audio/skill:4\",\r\n                trigger: {\r\n                    source: \"damageBegin1\"\r\n                },\r\n                filter: function (event) {\r\n                    return event.card && event.card.name == 'sha' && get.color(event.card) == 'red' && event.notLink();\r\n                },\r\n                direct: true,\r\n                priority: -1,\r\n                content: function () {\r\n                    var info = lib.skill.PSweizhen.getInfo(_status.event.player);\r\n                    trigger.num += info[1];\r\n                },\r\n                ai: {\r\n                    damageBonus: true\r\n                },\r\n                group: [\r\n                    \"PSweizhen_hit\",\r\n                    \"PSweizhen_add\",\r\n                    \"PSweizhen_chongzhu\"\r\n                ],\r\n                subSkill: {\r\n                    hit: {\r\n                        audio: 2,\r\n                        shaRelated: true,\r\n                        trigger: {\r\n                            player: \"useCardToPlayered\"\r\n                        },\r\n                        filter: function (event, player) {\r\n                            var info = lib.skill.PSweizhen.getInfo(player);\r\n                            if (info[4] <= 0) return false;\r\n                            if (!event.card || event.card.name != 'sha' && get.color(event.card) != 'red') return false;\r\n                            return player.getHistory('useCard', function (evt) {\r\n                                return get.name(evt.card) == 'sha' && get.color(evt.card) == 'red';\r\n                            }).length <= info[4];\r\n                        },\r\n                        forced: true,\r\n                        logTarget: \"target\",\r\n                        content: function () {\r\n                            trigger.getParent().directHit.add(trigger.target);\r\n                        },\r\n                        ai: {\r\n                            directHit_ai: true,\r\n                            skillTagFilter: function (player, tag, arg) {\r\n                                var info = lib.skill.PSweizhen.getInfo(player);\r\n                                if (info[4] <= 0) return false;\r\n                                if (!event.card || event.card.name != 'sha' && get.color(event.card) != 'red') return false;\r\n                                return player.getHistory('useCard', function (evt) {\r\n                                    return get.name(evt.card) == 'sha' && get.color(evt.card) == 'red';\r\n                                }).length <= info[4];\r\n                            }\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    discard: {\r\n                        audio: 2,\r\n                        trigger: {\r\n                            source: \"damageAfter\"\r\n                        },\r\n                        logTarget: \"event.player\",\r\n                        prompt2: function (event, player) {\r\n                            var info = lib.skill.PSweizhen.getInfo(_status.event.player);\r\n                            return \"弃置\" + get.translation(event.player) + \"一\" + (info[4] > 1 ? \"至\" + get.cnNumber(info[4]) : \"\") + \"张牌\";\r\n                        },\r\n                        filter: function (event, player) {\r\n                            var info = lib.skill.PSweizhen.getInfo(_status.event.player);\r\n                            if (info[4] <= 0) return false;\r\n                            if (!event.player.isAlive() || event.player.countCards('he') == 0) return false;\r\n                            return event.card && event.card.name == 'sha' && get.color(event.card) == 'red';\r\n                        },\r\n                        check: function (event, player) {\r\n                            return get.attitude(player, event.player) <= 0;\r\n                        },\r\n                        content: function () {\r\n                            var info = lib.skill.PSweizhen.getInfo(_status.event.player);\r\n                            player.discardPlayerCard('he', trigger.player, [1, info[4]], false);\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    add: {\r\n                        audio: 2,\r\n                        trigger: {\r\n                            player: [\r\n                                \"phaseZhunbeiBegin\",\r\n                                \"phaseJieshuBegin\"\r\n                            ],\r\n                            global: \"damageSource\"\r\n                        },\r\n                        priority: 10,\r\n                        direct: true,\r\n                        filter: function (event, player) {\r\n                            if (event.name == 'damage') {\r\n                                if (lib.skill.PSweizhen.getInfo(player) == [5, 5, 5, 5, 5]) return false;\r\n                                return event.card && event.card.name == 'sha' && get.color(event.card) == 'red';\r\n                            }\r\n                            else return true;\r\n                        },\r\n                        content: function () {\r\n                            'step 0'\r\n                            event.num = trigger.num;\r\n                            'step 1'\r\n                            event.num--;\r\n                            var list = lib.skill.PSweizhen.getInfo(_status.event.player);\r\n                            var slist = ['距离(' + list[0] + ')', '伤害(' + list[1] + ')', '目标(' + list[2] + ')', '次数(' + list[3] + ')', '强命(' + list[4] + ')', 'cancel2'];\r\n                            player.chooseControl(slist).set('prompt', get.prompt('PSweizhen')).set('prompt2', '令〖威震〗中的一个数字+1').set('ai', function () {\r\n                                var player = _status.event.player, info = lib.skill.PSweizhen.getInfo(player);\r\n                                if (info[0] < info[3] && game.countPlayer(function (current) {\r\n                                    return get.distance(player, current) <= info[0];\r\n                                }) < Math.min(3, game.countPlayer())) return 0;\r\n                                if (info[3] < info[1] - 1) return 3;\r\n                                if (info[1] < 5) return 1;\r\n                                if (info[0] < 5 && game.hasPlayer(function (current) {\r\n                                    return current != player && get.distance(player, current) > info[0];\r\n                                })) return 0;\r\n                                return 2;\r\n                            });\r\n                            'step 2'\r\n                            if (result.control != 'cancel2') {\r\n                                player.logSkill('PSweizhen');\r\n                                var list = lib.skill.PSweizhen.getInfo(player);\r\n                                list[result.index] = Math.min(5, list[result.index] + 1);\r\n                                game.log(player, '将', result.control, '数字改为', '#y' + list[result.index])\r\n                                player.markSkill('PSweizhen');\r\n                            }\r\n                            if (event.num > 0) event.goto(1);\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    chongzhu: {\r\n                        audio: \"danji\",\r\n                        enable: \"phaseUse\",\r\n                        filterCard: (card, player) => get.color(card) == 'black' && player.canRecast(card),\r\n                        filter: function (card, player) {\r\n                            return player.countCards('he', function (card, player) {\r\n                                return get.color(card) == 'black';\r\n                            }) > 0;\r\n                        },\r\n                        position: \"he\",\r\n                        selectCard: [\r\n                            1,\r\n                            Infinity\r\n                        ],\r\n                        prompt: \"请选择要重铸的牌\",\r\n                        discard: false,\r\n                        lose: false,\r\n                        delay: false,\r\n                        content: function () {\r\n                            player.recast(cards);\r\n                        },\r\n                        sub: true\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_shu,\r\n        translate: {\r\n            PSguanyunchang: \"关云长\",\r\n            PSweizhen: \"威震\",\r\n            PSweizhen_info: \"①你拥有以下效果：<br/>1：使用红色杀的距离+0 ；<br/>2：使用红色杀造成伤害+0；<br/> 3：使用红色杀可以额外指定0名目标；<br/>4：使用红色杀的次数+0；<br/>5：每回合使用第0张红色杀不能被响应。<br/>当一名角色使用红色杀造成一点伤害后，或你的准备阶段/回合结束阶段开始时，你选择上述中的一个数字+1。<br/>②出牌阶段，你可以重铸黑色牌。\",\r\n            \"#ext:PS武将/audio/skill/PSweizhen1\": \"狂徒！天下英雄闻我名无不丧胆，可惜我这青龙偃月刀，竟斩你这鼠辈的首级。\",\r\n            \"#ext:PS武将/audio/skill/PSweizhen2\": \"我cnm。\",\r\n            \"#ext:PS武将/audio/skill/PSweizhen3\": \"狂徒！我这青龙偃月刀竟斩你这鼠辈的首级。\",\r\n            \"#ext:PS武将/audio/skill/PSweizhen4\": \"回去吧，你太老了。\"\r\n        },\r\n        rank: rank.epic\r\n    },\r\n    PSshen_zhaoyun: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"shen\",\r\n            hp: 2,\r\n            skills: [\r\n                \"PSjuejing\",\r\n                \"relonghun\"\r\n            ],\r\n            isAiForbidden: true,\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“神鬼高达”设计\",\r\n        skills: {\r\n            PSjuejing: {\r\n                mod: {\r\n                    maxHandcard: function (player, num) {\r\n                        return 2 + num;\r\n                    }\r\n                },\r\n                audio: \"xinjuejing\",\r\n                trigger: {\r\n                    player: \"loseAfter\",\r\n                    global: [\r\n                        \"equipAfter\",\r\n                        \"addJudgeAfter\",\r\n                        \"gainAfter\",\r\n                        \"loseAsyncAfter\",\r\n                        \"addToExpansionAfter\"\r\n                    ]\r\n                },\r\n                forced: true,\r\n                filter: function (event, player) {\r\n                    if (event.name == 'gain' && event.player == player) return false;\r\n                    var evt = event.getl(player);\r\n                    return evt && evt.hs && evt.hs.length;\r\n                },\r\n                content: function () {\r\n                    player.draw();\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_shen,\r\n        translate: {\r\n            PSshen_zhaoyun: \"PS神赵云\",\r\n            PSjuejing: \"绝境\",\r\n            PSjuejing_info: \"锁定技，你的手牌上限+2；当你失去手牌时，你摸一张牌。\"\r\n        },\r\n        rank: rank.legend\r\n    },\r\n    PSzhangxuan: {\r\n        info: {\r\n            sex: \"female\",\r\n            group: \"wu\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PStongli\"\r\n            ],\r\n            isAiForbidden: true,\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“看透一切的军师”设计\",\r\n        replace: [\r\n            \"PSzhangxuan\",\r\n            \"PSfuzhijie\",\r\n            \"PSjiesuanjie\"\r\n        ],\r\n        skills: {\r\n            PStongli: {\r\n                audio: \"tongli\",\r\n                trigger: {\r\n                    player: \"useCardToPlayered\"\r\n                },\r\n                filter: function (event, player) {\r\n                    if (!event.isFirstTarget || (event.card.storage && event.card.storage.PStongli)) return false;\r\n                    var type = get.type(event.card);\r\n                    if (type != 'basic' && type != 'trick') return false;\r\n                    var hs = player.getCards('h');\r\n                    if (!hs.length) return false;\r\n                    var evt = event.getParent('phaseUse');\r\n                    if (!evt || evt.player != player) return false;\r\n                    var num1 = player.getHistory('useCard', function (evtx) {\r\n                        if (evtx.getParent('phaseUse') != evt) return false;\r\n                        return !evtx.card.storage || !evtx.card.storage.PStongli;\r\n                    }).length;\r\n                    return player.countCards('h') > 0;\r\n                },\r\n                prompt2: function (event, player) {\r\n                    var evt = event.getParent('phaseUse');\r\n                    var num = player.getHistory('useCard', function (evtx) {\r\n                        if (evtx.getParent('phaseUse') != evt) return false;\r\n                        return !evtx.card.storage || !evtx.card.storage.PStongli;\r\n                    }).length;\r\n                    return '令' + get.translation(event.card) + '额外结算' + get.cnNumber(player.countCards('h')) + '次';\r\n                },\r\n                check: function (event, player) {\r\n                    return !get.tag(event.card, 'norepeat')\r\n                },\r\n                content: function () {\r\n                    var num = player.countCards('h');\r\n                    game.log(trigger.card, '额外结算', get.cnNumber(num), '次');\r\n                    trigger.getParent().effectCount += num;\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_wu,\r\n        translate: {\r\n            PSzhangxuan: \"PS张嫙\",\r\n            PStongli: \"同礼\",\r\n            PStongli_info: \"出牌阶段，当你使用即时牌指定第一个目标后，你可令此牌效果额外执行X次（X为你的手牌数）。\"\r\n        },\r\n        rank: rank.legend\r\n    },\r\n    PScenhun: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"wu\",\r\n            hp: 4,\r\n            skills: [\r\n                \"jishe\",\r\n                \"PSlianhuo\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“欧文哈尔”设计\",\r\n        skills: {\r\n            PSlianhuo: {\r\n                audio: \"lianhuo\",\r\n                trigger: {\r\n                    player: \"damageBegin3\"\r\n                },\r\n                forced: true,\r\n                filter: function (event, player) {\r\n                    return player.isLinked() && event.notLink() && event.hasNature('fire');\r\n                },\r\n                content: function () {\r\n                    var num = game.countPlayer(current => current.isLinked());\r\n                    trigger.num += num;\r\n                },\r\n                group: \"PSlianhuo_source\",\r\n                subSkill: {\r\n                    source: {\r\n                        trigger: {\r\n                            global: \"damageBegin3\"\r\n                        },\r\n                        filter: function (event, player) {\r\n                            return event.player != player && player.isLinked() && event.player.isLinked() && event.hasNature('fire');\r\n                        },\r\n                        direct: true,\r\n                        content: function () {\r\n                            player.logSkill('PSlianhuo', trigger.player);\r\n                            trigger.player = player;\r\n                        },\r\n                        sub: true\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_wu,\r\n        translate: {\r\n            PScenhun: \"PS岑昏\",\r\n            PSlianhuo: \"链祸\",\r\n            PSlianhuo_info: \"锁定技，当你受到火焰伤害时，若你的武将牌处于横置状态且此伤害不为连环伤害，则此伤害+X。(X为处于横置状态的角色数)。你是所有铁索连环伤害的源头。\"\r\n        },\r\n        rank: rank.junk\r\n    },\r\n    PSshiniangongzhu: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"wei\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PSshanjia\"\r\n            ],\r\n            dieAudios: [\r\n                \"caoang\"\r\n            ],\r\n            trashBin: []\r\n        },\r\n        intro: \"由\\\"Kaesar”设计\",\r\n        skills: {\r\n            PSshanjia: {\r\n                group: [\r\n                    \"PSshanjia_count\",\r\n                    \"PSshanjia_number\",\r\n                    \"PSshanjia_damage\"\r\n                ],\r\n                locked: false,\r\n                mod: {\r\n                    aiValue: function (player, card, num) {\r\n                        if ((player.storage.PSshanjia || 0) < 3 && get.type(card) == 'equip' && !get.cardtag(card, 'gifts')) {\r\n                            return num / player.hp;\r\n                        }\r\n                    }\r\n                },\r\n                subSkill: {\r\n                    count: {\r\n                        forced: true,\r\n                        silent: true,\r\n                        popup: false,\r\n                        trigger: {\r\n                            player: \"loseEnd\"\r\n                        },\r\n                        filter: function (event, player) {\r\n                            return event.cards2 && event.cards2.length > 0;\r\n                        },\r\n                        content: function () {\r\n                            lib.skill.PSshanjia.sync(player);\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    number: {\r\n                        trigger: {\r\n                            source: \"damageEnd\"\r\n                        },\r\n                        init: function (player) {\r\n                            if (!player.storage.PSshanjia_number) player.storage.PSshanjia_number = 0;\r\n                        },\r\n                        forced: true,\r\n                        filter: function (event, player) {\r\n                            return event.parent.parent.parent.name == 'PSshanjia';\r\n                        },\r\n                        content: function () {\r\n                            player.storage.PSshanjia_number++;\r\n                            player.markSkill('PSshanjia');\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    damage: {\r\n                        trigger: {\r\n                            source: \"damageBegin1\"\r\n                        },\r\n                        filter: function (event) {\r\n                            return event.parent.parent.parent.name == 'PSshanjia';\r\n                        },\r\n                        direct: true,\r\n                        priority: -1,\r\n                        content: function () {\r\n                            trigger.num += player.storage.PSshanjia_number;\r\n                        },\r\n                        sub: true\r\n                    }\r\n                },\r\n                audio: \"shanjia\",\r\n                trigger: {\r\n                    player: \"phaseUseBegin\"\r\n                },\r\n                intro: {\r\n                    markcount: function (storage) {\r\n                        return storage;\r\n                    },\r\n                    content: function (storage, player) {\r\n                        if (!storage) return;\r\n                        var str = '<li>';\r\n                        str += '本局游戏内已失去过' + storage + '张装备牌';\r\n                        str += '<br><li>“缮甲”摸牌和伤害数+';\r\n                        str += (player.storage.PSshanjia_number);\r\n                        return str;\r\n                    }\r\n                },\r\n                frequent: true,\r\n                sync: function (player) {\r\n                    var history = player.actionHistory;\r\n                    var num = 0;\r\n                    for (var i = 0; i < history.length; i++) {\r\n                        for (var j = 0; j < history[i].lose.length; j++) {\r\n                            if (history[i].lose[j].parent.name == 'useCard') continue;\r\n                            num += history[i].lose[j].cards2.filter(function (card) {\r\n                                return get.type(card, false) == 'equip';\r\n                            }).length;\r\n                        }\r\n                    }\r\n                    player.storage.PSshanjia = num;\r\n                    if (num > 0) player.markSkill('PSshanjia');\r\n                    player.updateMark('PSshanjia');\r\n                },\r\n                content: function () {\r\n                    'step 0'\r\n                    var num = player.storage.PSshanjia_number;\r\n                    player.draw(3 + num);\r\n                    'step 1'\r\n                    lib.skill.PSshanjia.sync(player);\r\n                    var num = 3 - player.storage.PSshanjia;\r\n                    if (num > 0) {\r\n                        player.chooseToDiscard('he', true, num).ai = get.disvalue;\r\n                    }\r\n                    'step 2'\r\n                    var bool = true;\r\n                    if (result.cards) {\r\n                        for (var i = 0; i < result.cards.length; i++) {\r\n                            if (['delay'].includes(get.type(result.cards[i], null, result.cards[i].original == 'h' ? player : false))) {\r\n                                bool = false; break;\r\n                            }\r\n                        }\r\n                    }\r\n                    if (bool) {\r\n                        player.chooseTarget('是否视为使用一张【杀】？').set('filterTarget', function (card, player, target) {\r\n                            return player.canUse({ name: 'sha' }, target, false);\r\n                        }).set('ai', function (target) {\r\n                            const player = get.event().player;\r\n                            return get.attitude(player, target) <= 0\r\n                        });\r\n                    }\r\n                    'step 3'\r\n                    if (result.targets && result.targets.length > 0) {\r\n                        var target = result.targets[0];\r\n                        var card = { name: 'sha', isCard: true };\r\n                        player.addTempSkill('unequip', { player: 'shaAfter' });\r\n                        player.useCard(card, target, false);\r\n                    }\r\n                },\r\n                ai: {\r\n                    threaten: 3,\r\n                    noe: true,\r\n                    reverseOrder: true,\r\n                    skillTagFilter: function (player) {\r\n                        if (player.storage.PSshanjia > 2) return false;\r\n                    },\r\n                    effect: {\r\n                        target: function (card, player, target) {\r\n                            if (player.storage.PSshanjia < 3 && get.type(card) == 'equip' && !get.cardtag(card, 'gifts')) return [1, 3];\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_wei,\r\n        translate: {\r\n            PSshiniangongzhu: \"十年公主\",\r\n            PSshanjia: \"缮甲\",\r\n            PSshanjia_info: \"出牌阶段开始时，你可以摸三张牌，然后弃置3-X张牌(X为你本局游戏内不因使用而失去过的装备牌的数目且至多为3)。若你没有以此法弃置延时锦囊牌，则你可以视为使用了一张无距离限制且不计入出牌阶段使用次数且无视防具的【杀】，若此杀造成伤害，本局游戏“缮甲”摸牌数和伤害+1。\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PScaojinyu: {\r\n        info: {\r\n            sex: \"female\",\r\n            group: \"wei\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PSyuqi\",\r\n                \"PSshanshen\",\r\n                \"PSxianjing\"\r\n            ],\r\n            dieAudios: [\r\n                \"ext:PS武将/audio/die:true\"\r\n            ],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“一顿七只屑狐狸”设计\",\r\n        skills: {\r\n            PSyuqi: {\r\n                audio: \"ext:PS武将/audio/skill:2\",\r\n                trigger: {\r\n                    global: \"damageEnd\"\r\n                },\r\n                init: function (player) {\r\n                    if (!player.storage.PSyuqi) player.storage.PSyuqi = [0, 3, 1, 1];\r\n                },\r\n                getInfo: function (player) {\r\n                    if (!player.storage.PSyuqi) player.storage.PSyuqi = [0, 3, 1, 1];\r\n                    return player.storage.PSyuqi;\r\n                },\r\n                onremove: true,\r\n                usable: 3,\r\n                filter: function (event, player) {\r\n                    var list = lib.skill.PSyuqi.getInfo(player);\r\n                    return event.player.isIn() && get.distance(player, event.player) <= list[0];\r\n                },\r\n                logTarget: \"player\",\r\n                content: function () {\r\n                    'step 0'\r\n                    event.list = lib.skill.PSyuqi.getInfo(player);\r\n                    var cards = get.cards(event.list[1]);\r\n                    event.cards = cards;\r\n                    game.cardsGotoOrdering(cards);\r\n                    var next = player.chooseToMove(true, '隅泣（若对话框显示不完整，可下滑操作）');\r\n                    next.set('list', [\r\n                        ['牌堆顶的牌', cards],\r\n                        ['交给' + get.translation(trigger.player) + '（至少一张' + (event.list[2] > 1 ? ('，至多' + get.cnNumber(event.list[2]) + '张') : '') + '）'],\r\n                        ['交给自己（至多' + get.cnNumber(event.list[3]) + '张）'],\r\n                    ]);\r\n                    next.set('filterMove', function (from, to, moved) {\r\n                        var info = lib.skill.PSyuqi.getInfo(_status.event.player);\r\n                        if (to == 1) return moved[1].length < info[2];\r\n                        if (to == 2) return moved[2].length < info[3];\r\n                        return true;\r\n                    });\r\n                    next.set('processAI', function (list) {\r\n                        var cards = list[0][1].slice(0).sort(function (a, b) {\r\n                            return get.value(b, 'raw') - get.value(a, 'raw');\r\n                        }), player = _status.event.player, target = _status.event.getTrigger().player;\r\n                        var info = lib.skill.PSyuqi.getInfo(_status.event.player);\r\n                        var cards1 = cards.splice(0, Math.min(info[3], cards.length - 1));\r\n                        var card2;\r\n                        if (get.attitude(player, target) > 0) card2 = cards.shift();\r\n                        else card2 = cards.pop();\r\n                        return [cards, [card2], cards1];\r\n                    });\r\n                    next.set('filterOk', function (moved) {\r\n                        return moved[1].length > 0;\r\n                    });\r\n                    'step 1'\r\n                    if (result.bool) {\r\n                        var moved = result.moved;\r\n                        cards.removeArray(moved[1]);\r\n                        cards.removeArray(moved[2]);\r\n                        while (cards.length) {\r\n                            ui.cardPile.insertBefore(cards.pop().fix(), ui.cardPile.firstChild);\r\n                        }\r\n                        var list = [[trigger.player, moved[1]]];\r\n                        if (moved[2].length) list.push([player, moved[2]]);\r\n                        game.loseAsync({\r\n                            gain_list: list,\r\n                            giver: player,\r\n                            animate: 'gain2',\r\n                        }).setContent('gaincardMultiple');\r\n                    }\r\n                },\r\n                mark: true,\r\n                intro: {\r\n                    content: function (storage, player) {\r\n                        var info = lib.skill.PSyuqi.getInfo(player);\r\n                        return '<div class=\"text center\"><span class=thundertext>蓝色：' + info[0] + '</span>　<span class=firetext>红色：' + info[1] + '</span><br><span class=greentext>绿色：' + info[2] + '</span>　<span class=yellowtext>黄色：' + info[3] + '</span></div>'\r\n                    }\r\n                },\r\n                ai: {\r\n                    threaten: 8.8\r\n                }\r\n            },\r\n            PSshanshen: {\r\n                audio: \"ext:PS武将/audio/skill:2\",\r\n                trigger: {\r\n                    global: \"die\"\r\n                },\r\n                direct: true,\r\n                content: function () {\r\n                    'step 0'\r\n                    event.goon = !player.hasAllHistory('sourceDamage', function (evt) {\r\n                        return evt.player == trigger.player;\r\n                    });\r\n                    var list = lib.skill.PSyuqi.getInfo(player);\r\n                    player.chooseControl('确定', 'cancel2').set('prompt', get.prompt('PSshanshen')).set('prompt2', '令〖隅泣〗中的所有数字+2' + (event.goon ? '并回复1点体力' : '')).set('ai', function () {\r\n                        return 0;\r\n                    });\r\n                    'step 1'\r\n                    if (result.control != 'cancel2') {\r\n                        player.logSkill('PSshanshen', trigger.player);\r\n                        var list = lib.skill.PSyuqi.getInfo(player);\r\n                        for (var i = 0; i < list.length; i++) {\r\n                            list[i] += 2;\r\n                        }\r\n                        game.log(player, '将〖隅泣〗中的所有数字+', '#y' + 2);\r\n                        player.markSkill('PSyuqi');\r\n                        if (event.goon) player.recover();\r\n                    }\r\n                }\r\n            },\r\n            PSxianjing: {\r\n                audio: \"ext:PS武将/audio/skill:2\",\r\n                trigger: {\r\n                    player: \"phaseZhunbeiBegin\"\r\n                },\r\n                direct: true,\r\n                content: function () {\r\n                    'step 0'\r\n                    var list = lib.skill.PSyuqi.getInfo(player);\r\n                    player.chooseControl('确定', 'cancel2').set('prompt', '是否令〖隅泣〗中的所有数字+1？').set('ai', function () {\r\n                        return 0;\r\n                    });\r\n                    'step 1'\r\n                    if (result.control != 'cancel2') {\r\n                        player.logSkill('PSxianjing');\r\n                        var list = lib.skill.PSyuqi.getInfo(player);\r\n                        for (var i = 0; i < list.length; i++) {\r\n                            list[i]++;\r\n                        }\r\n                        game.log(player, '将〖隅泣〗中的所有数字+', '#y' + 1);\r\n                        player.markSkill('PSyuqi');\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_wei,\r\n        translate: {\r\n            PScaojinyu: \"PS曹金玉\",\r\n            PSyuqi: \"隅泣\",\r\n            PSyuqi_info: \"每回合限三次。当有角色受到伤害后，若你至其的距离不大于<span class=thundertext>0</span>，则你可以观看牌堆顶的<span class=firetext>3</span>张牌。你将其中至多<span class=greentext>1</span>张牌交给受伤角色，然后可以获得剩余牌中的至多<span class=yellowtext>1</span>张牌，并将其余牌以原顺序放回牌堆顶。\",\r\n            PSshanshen: \"善身\",\r\n            PSshanshen_info: \"当有角色死亡时，你可令你的〖隅泣〗中的所有数字+2。然后若你未对该角色造成过伤害，则你回复1点体力。\",\r\n            PSxianjing: \"娴静\",\r\n            PSxianjing_info: \"准备阶段，你可令你的〖隅泣〗中的所有数字+1。\",\r\n            \"#ext:PS武将/audio/skill/PSshanshen1\": \"人家只想做安安静静的小淑女。\",\r\n            \"#ext:PS武将/audio/skill/PSshanshen2\": \"雪花纷飞，独存寒冬。\",\r\n            \"#ext:PS武将/audio/skill/PSxianjing1\": \"得父母之爱，享公主之礼遇。\",\r\n            \"#ext:PS武将/audio/skill/PSxianjing2\": \"哼，可不要小瞧女孩子啊。\",\r\n            \"#ext:PS武将/audio/skill/PSyuqi1\": \"玉儿摔倒了，要阿娘抱抱。\",\r\n            \"#ext:PS武将/audio/skill/PSyuqi2\": \"这么漂亮的雪花，为什么只能在寒冬呢。\",\r\n            \"#ext:PS武将/audio/die/PScaojinyu:die\": \"娘亲，雪人不怕冷吗？\"\r\n        },\r\n        rank: rank.epic\r\n    },\r\n    PSzhaoyun: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"shu\",\r\n            hp: 5,\r\n            skills: [\r\n                \"longdan\",\r\n                \"PShuwei\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“不想再说也许可以”设计\",\r\n        replace: [\r\n            \"PSzhaoyun\",\r\n            \"PSqun_zhaoyun\"\r\n        ],\r\n        skills: {\r\n            PShuwei: {\r\n                audio: \"ext:PS武将/audio/skill:2\",\r\n                trigger: {\r\n                    player: [\r\n                        \"phaseBefore\",\r\n                        \"changeHp\"\r\n                    ]\r\n                },\r\n                forced: true,\r\n                popup: false,\r\n                init: function (player) {\r\n                    if (game.online) return;\r\n                    player.removeAdditionalSkill('PShuwei');\r\n                    var list = [];\r\n                    if (player.hp <= 4) {\r\n                        list.push('new_yajiao');\r\n                    }\r\n                    if (player.hp <= 3) {\r\n                        list.push('chongzhen');\r\n                    }\r\n                    if (player.hp <= 2) {\r\n                        list.push('relonghun');\r\n                    }\r\n                    if (player.hp <= 1) {\r\n                        var num = 4 - player.countCards('h');\r\n                        if (num != 0) player.logSkill('boss_juejing');\r\n                        if (num > 0) player.draw(num);\r\n                        if (num < 0) player.chooseToDiscard('h', true, -num);\r\n                        list.push('boss_juejing');\r\n                    }\r\n                    if (list.length) {\r\n                        player.addAdditionalSkill('PShuwei', list);\r\n                    }\r\n                },\r\n                derivation: [\r\n                    \"new_yajiao\",\r\n                    \"chongzhen\",\r\n                    \"relonghun\",\r\n                    \"boss_juejing\"\r\n                ],\r\n                content: function () {\r\n                    player.removeAdditionalSkill('PShuwei');\r\n                    var list = [];\r\n                    if (player.hp <= 4) {\r\n                        if (trigger.num != undefined && trigger.num < 0 && player.hp - trigger.num > 1) player.logSkill('PShuwei');\r\n                        list.push('new_yajiao');\r\n                    }\r\n                    if (player.hp <= 3) {\r\n                        list.push('chongzhen');\r\n                    }\r\n                    if (player.hp <= 2) {\r\n                        list.push('relonghun');\r\n                    }\r\n                    if (player.hp <= 1) {\r\n                        var num = 4 - player.countCards('h');\r\n                        if (num != 0) player.logSkill('boss_juejing');\r\n                        if (num > 0) player.draw(num);\r\n                        if (num < 0) player.chooseToDiscard('h', true, -num);\r\n                        list.push('boss_juejing');\r\n                    }\r\n                    if (list.length) {\r\n                        player.addAdditionalSkill('PShuwei', list);\r\n                    }\r\n                },\r\n                ai: {\r\n                    maixie: true,\r\n                    effect: {\r\n                        target: function (card, player, target) {\r\n                            if (get.tag(card, 'damage')) {\r\n                                if (!target.hasFriend()) return;\r\n                                if (target.hp >= 4) return [0, 1];\r\n                            }\r\n                            if (get.tag(card, 'recover') && player.hp >= player.maxHp - 1) return [0, 0];\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_shu,\r\n        translate: {\r\n            PSzhaoyun: \"PS赵云\",\r\n            PShuwei: \"虎威\",\r\n            PShuwei_info: \"锁定技，若你的体力值：为4或更少，你视为拥有技能〖涯角〗；为3或更少，你视为拥有技能〖冲阵〗；为2或更少，你视为拥有技能〖龙魂〗；为1或更少，你视为拥有技能〖绝境〗。\",\r\n            \"#ext:PS武将/audio/skill/PShuwei1\": \"和我一起活着离开此地。\",\r\n            \"#ext:PS武将/audio/skill/PShuwei2\": \"让我了结此战。\"\r\n        },\r\n        rank: rank.epic\r\n    },\r\n    PScaochun: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"wei\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PSreshanjia\",\r\n                \"PSxiaorui\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“你想去哪儿呢”设计\",\r\n        replace: [\r\n            \"PSshiniangongzhu\",\r\n            \"PScaochun\"\r\n        ],\r\n        skills: {\r\n            PSreshanjia: {\r\n                locked: false,\r\n                audio: \"shanjia\",\r\n                trigger: {\r\n                    player: \"phaseUseBegin\"\r\n                },\r\n                frequent: true,\r\n                init: function (player) {\r\n                    if (!player.storage.PSreshanjia) player.storage.PSreshanjia = 0;\r\n                },\r\n                intro: {\r\n                    content: \"“缮甲”摸牌数+#\"\r\n                },\r\n                content: function () {\r\n                    'step 0'\r\n                    player.draw(3 + player.storage.PSreshanjia);\r\n                    player.chooseToDiscard('he', true, 3).ai = get.disvalue;\r\n                    'step 1'\r\n                    var bool = [false, false, false];\r\n                    if (result.cards) {\r\n                        var list = ['basic', 'trick', 'equip'];\r\n                        for (var i = 0; i < bool.length; i++) {\r\n                            for (var j = 0; j < result.cards.length; j++) {\r\n                                if ([list[i]].includes(get.type(result.cards[j], 'trick', result.cards[j].original == 'h' ? player : false))) {\r\n                                    bool[i] = true; break;\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                    event.bool = bool;\r\n                    game.log(bool)\r\n                    'step 2'\r\n                    if (event.bool[0]) {\r\n                        player.chooseUseTarget({ name: 'sha' }, '是否视为使用一张【杀】？', false, 'nodistance');\r\n                    }\r\n                    'step 3'\r\n                    if (event.bool[1]) {\r\n                        var list = [];\r\n                        for (var i of lib.inpile) {\r\n                            if (get.type({ name: i }) != 'trick') continue;\r\n                            if (lib.filter.cardUsable({ name: i }, player, event.getParent('chooseToUse')) && player.hasUseTarget({ name: i })) {\r\n                                list.push([get.translation(get.type({ name: i })), '', i]);\r\n                            }\r\n                        }\r\n                        if (list.length) {\r\n                            player.chooseButton(['是否视为使用一张普通锦囊牌？', [list, 'vcard']]).set('ai', function (button) {\r\n                                var player = _status.event.player;\r\n                                var card = { name: button.link[2], nature: button.link[3] };\r\n                                return player.getUseValue(card);\r\n                            });\r\n                        }\r\n                    }\r\n                    else event.goto(5);\r\n                    'step 4'\r\n                    if (result && result.bool && result.links[0]) {\r\n                        var card = {\r\n                            name: result.links[0][2],\r\n                            nature: result.links[0][3],\r\n                            isCard: true,\r\n                            storage: {\r\n                                nowuxie: true,\r\n                            },\r\n                        };\r\n                        player.chooseUseTarget(card, true);\r\n                    }\r\n                    'step 5'\r\n                    if (event.bool[2]) {\r\n                        player.storage.PSreshanjia++;\r\n                        player.markSkill('PSreshanjia');\r\n                    }\r\n                },\r\n                ai: {\r\n                    threaten: 3,\r\n                    noe: true\r\n                }\r\n            },\r\n            PSxiaorui: {\r\n                audio: \"qingxi\",\r\n                enable: \"phaseUse\",\r\n                usable: 1,\r\n                selectTarget: 1,\r\n                filterTarget: true,\r\n                prompt: \"失去一点体力并获得一名角色两张牌，再对其造成一点伤害，若其中有装备牌，你回复一点体力\",\r\n                content: function () {\r\n                    \"step 0\"\r\n                    player.loseHp(1);\r\n                    \"step 1\"\r\n                    if (target.countCards('he') > 0) player.gainPlayerCard(target, [1, 2], 'he', false);\r\n                    target.damage('nocard', 1, player);\r\n                    \"step 2\"\r\n                    if (result.cards) {\r\n                        for (var i of result.cards) {\r\n                            if (get.type(i) == 'equip') {\r\n                                player.recover();\r\n                                break;\r\n                            }\r\n                        }\r\n                    }\r\n                },\r\n                ai: {\r\n                    basic: {\r\n                        order: 1\r\n                    },\r\n                    result: {\r\n                        player: function (player) {\r\n                            if (player.countCards('h') >= player.hp - 1) return -1;\r\n                            if (player.hp < 3) return -1;\r\n                            return 1;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_wei,\r\n        translate: {\r\n            PScaochun: \"PS曹纯\",\r\n            PSreshanjia: \"缮甲\",\r\n            PSreshanjia_info: \"出牌阶段开始时，你可以摸3张牌,然后弃置3张牌，若弃置的牌包含：基本牌，视为对一名角色使用一张【杀】（无距离限制且不计入次数）；锦囊牌，视为使用一张不能被无懈的普通锦囊牌；装备牌，“缮甲”摸牌数+1。\",\r\n            PSxiaorui: \"骁锐\",\r\n            PSxiaorui_info: \"出牌阶段限一次，你可以失去一点体力获得一名角色两张牌并对其造成一点伤害，若获得牌中有装备你恢复一点体力。\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PScaoshuang: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"wei\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PStuogu\",\r\n                \"shanzhuan\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“九个芒果”设计\",\r\n        skills: {\r\n            PStuogu: {\r\n                audio: \"tuogu\",\r\n                trigger: {\r\n                    global: \"die\"\r\n                },\r\n                frequent: true,\r\n                filter: function (event, player) {\r\n                    return event.player.getStockSkills('鸡', '你').filter(function (skill) {\r\n                        var info = get.info(skill);\r\n                        return info;\r\n                    }).length > 0;\r\n                },\r\n                logTarget: \"player\",\r\n                content: function () {\r\n                    'step 0'\r\n                    var list = trigger.player.getStockSkills('太', '美').filter(function (skill) {\r\n                        var info = get.info(skill);\r\n                        return info;\r\n                    });\r\n                    list.push('cancel2');\r\n                    player.chooseControl(list).set('prompt', '选择获得' + get.translation(trigger.player) + '的一个技能').set('forceDie', true).set('ai', function () {\r\n                        return list.randomGet();\r\n                    });\r\n                    'step 1'\r\n                    if (result.control != 'cancel2') {\r\n                        player.storage.PStuogu.push(result.control);\r\n                        player.markSkill('PStuogu');\r\n                        player.addSkills(result.control);\r\n                        game.broadcastAll(function (skill) {\r\n                            var list = [skill];\r\n                            game.expandSkills(list);\r\n                            for (var i of list) {\r\n                                var info = lib.skill[i];\r\n                                if (!info) continue;\r\n                                if (!info.audioname2) info.audioname2 = {};\r\n                                info.audioname2.caoshuang = 'tuogu';\r\n                            }\r\n                        }, result.control);\r\n                    }\r\n                },\r\n                mark: true,\r\n                init: function (player) {\r\n                    if (!player.storage.PStuogu) player.storage.PStuogu = [];\r\n                },\r\n                intro: {\r\n                    content: \"已获得的托孤技能：$\"\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_wei,\r\n        translate: {\r\n            PScaoshuang: \"PS曹爽\",\r\n            PStuogu: \"托孤\",\r\n            PStuogu_info: \"一名角色死亡时，你可以获得其武将牌上的一个技能。\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PSxian_caozhi: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"shen\",\r\n            hp: 3,\r\n            skills: [\r\n                \"PSluoying\",\r\n                \"PSjiushi\"\r\n            ],\r\n            dieAudios: [\r\n                \"re_caozhi\"\r\n            ],\r\n            trashBin: []\r\n        },\r\n        intro: \"由\\\"Kaesar”设计\",\r\n        skills: {\r\n            PSluoying: {\r\n                mod: {\r\n                    ignoredHandcard: function (card, player) {\r\n                        if (card.hasGaintag('PSluoying')) return true;\r\n                    },\r\n                    cardDiscardable: function (card, player, name) {\r\n                        if (name == 'phaseDiscard' && card.hasGaintag('PSluoying')) return false;\r\n                    }\r\n                },\r\n                onremove: function (player) {\r\n                    player.removeGaintag('PSluoying');\r\n                },\r\n                audio: \"reluoying\",\r\n                trigger: {\r\n                    global: [\r\n                        \"loseAfter\",\r\n                        \"cardsDiscardAfter\"\r\n                    ]\r\n                },\r\n                filter: function (event, player) {\r\n                    switch (event.name) {\r\n                        case 'lose':\r\n                            for (var i = 0; i < event.cards2.length; i++) {\r\n                                if (get.suit(event.cards2[i], event.player) == 'club' && get.position(event.cards2[i], true) == 'd' && event.player != player) return true;\r\n                            }\r\n                            return false;\r\n                            break;\r\n                        case 'cardsDiscard':\r\n                            var evt = event.getParent().relatedEvent;\r\n                            if (get.position(event.cards[0], true) != 'd' || evt.player == player) return false;\r\n                            return (get.suit(event.cards[0]) == 'club');\r\n                            break;\r\n                    }\r\n                },\r\n                forced: true,\r\n                content: function () {\r\n                    var cards = (trigger.name == 'lose' ? trigger.cards2 : trigger.cards);\r\n                    cards = cards.filter(function (card) {\r\n                        return get.suit(card) == 'club' && get.position(card, true) == 'd';\r\n                    });\r\n                    player.gain(cards, 'gain2').gaintag.add('PSluoying');\r\n                }\r\n            },\r\n            PSjiushi: {\r\n                trigger: {\r\n                    global: \"gameStart\",\r\n                    player: \"enterGame\"\r\n                },\r\n                forced: true,\r\n                audio: \"rejiushi\",\r\n                filter: function (event, player) {\r\n                    return !player.hasSkill('jiu');\r\n                },\r\n                init: function (player, skill) {\r\n                    if (!player.hasSkill('jiu')) {\r\n                        player.addSkill('jiu');\r\n                        if (!player.storage.jiu || player.storage.jiu == 0) player.storage.jiu = 1;\r\n                        if (!player.node.jiu && lib.config.jiu_effect) {\r\n                            player.node.jiu = ui.create.div('.playerjiu', player.node.avatar);\r\n                            player.node.jiu2 = ui.create.div('.playerjiu', player.node.avatar2);\r\n                        }\r\n                    }\r\n                },\r\n                content: function () {\r\n                    player.addSkill('jiu');\r\n                    if (!player.storage.jiu || player.storage.jiu == 0) player.storage.jiu = 1;\r\n                    if (!player.node.jiu && lib.config.jiu_effect) {\r\n                        player.node.jiu = ui.create.div('.playerjiu', player.node.avatar);\r\n                        player.node.jiu2 = ui.create.div('.playerjiu', player.node.avatar2);\r\n                    }\r\n                },\r\n                mod: {\r\n                    cardUsable: function (card, player, num) {\r\n                        if (card.name == 'jiu') return Infinity;\r\n                    }\r\n                },\r\n                group: [\r\n                    \"PSjiushi_maintain\",\r\n                    \"PSjiushi_use\"\r\n                ],\r\n                subSkill: {\r\n                    maintain: {\r\n                        trigger: {\r\n                            global: [\r\n                                \"useCardAfter\",\r\n                                \"phaseAfter\",\r\n                                \"useCard1\"\r\n                            ]\r\n                        },\r\n                        lastDo: true,\r\n                        priority: 1,\r\n                        popup: false,\r\n                        silent: true,\r\n                        charlotte: true,\r\n                        filter: function (event, player) {\r\n                            return !player.hasSkill('jiu');\r\n                        },\r\n                        content: function () {\r\n                            player.addSkill('jiu');\r\n                            if (!player.storage.jiu || player.storage.jiu == 0) player.storage.jiu = 1;\r\n                            if (!player.node.jiu && lib.config.jiu_effect) {\r\n                                player.node.jiu = ui.create.div('.playerjiu', player.node.avatar);\r\n                                player.node.jiu2 = ui.create.div('.playerjiu', player.node.avatar2);\r\n                            }\r\n                        },\r\n                        sub: true,\r\n                        forced: true\r\n                    },\r\n                    use: {\r\n                        audio: \"rejiushi\",\r\n                        enable: \"chooseToUse\",\r\n                        locked: true,\r\n                        filterCard: true,\r\n                        viewAs: {\r\n                            name: \"jiu\"\r\n                        },\r\n                        position: \"hes\",\r\n                        viewAsFilter: function (player) {\r\n                            if (!player.countCards('hes')) return false;\r\n                            return true;\r\n                        },\r\n                        prompt: \"将一张牌当酒使用\",\r\n                        check: function (card) {\r\n                            if (_status.event.type == 'dying') return 1 / Math.max(0.1, get.value(card));\r\n                            return 4 - get.value(card);\r\n                        },\r\n                        ai: {\r\n                            threaten: 1.5,\r\n                            basic: {\r\n                                useful: function (card, i) {\r\n                                    if (_status.event.player.hp > 1) {\r\n                                        if (i == 0) return 4;\r\n                                        return 1;\r\n                                    }\r\n                                    if (i == 0) return 7.3;\r\n                                    return 3;\r\n                                },\r\n                                value: function (card, player, i) {\r\n                                    if (player.hp > 1) {\r\n                                        if (i == 0) return 5;\r\n                                        return 1;\r\n                                    }\r\n                                    if (i == 0) return 7.3;\r\n                                    return 3;\r\n                                }\r\n                            },\r\n                            order: function () {\r\n                                return get.order({ name: 'sha' }) + 0.2;\r\n                            },\r\n                            result: {\r\n                                target: function (player, target) {\r\n                                    if (target && target.isDying()) return 2;\r\n                                    if (target && !target.isPhaseUsing()) return 0;\r\n                                    if (lib.config.mode == 'stone' && !player.isMin()) {\r\n                                        if (player.getActCount() + 1 >= player.actcount) return 0;\r\n                                    }\r\n                                    var shas = player.getCards('h', 'sha');\r\n                                    if (shas.length > 1 && (player.getCardUsable('sha') > 1 || player.countCards('h', 'zhuge'))) {\r\n                                        return 0;\r\n                                    }\r\n                                    shas.sort(function (a, b) {\r\n                                        return get.order(b) - get.order(a);\r\n                                    })\r\n                                    var card;\r\n                                    if (shas.length) {\r\n                                        for (var i = 0; i < shas.length; i++) {\r\n                                            if (lib.filter.filterCard(shas[i], target)) {\r\n                                                card = shas[i]; break;\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                    else if (player.hasSha() && player.needsToDiscard()) {\r\n                                        if (player.countCards('h', 'hufu') != 1) {\r\n                                            card = { name: 'sha' };\r\n                                        }\r\n                                    }\r\n                                    if (card) {\r\n                                        if (game.hasPlayer(function (current) {\r\n                                            return (get.attitude(target, current) < 0 &&\r\n                                                target.canUse(card, current, null, true) &&\r\n                                                !current.hasSkillTag('filterDamage', null, {\r\n                                                    player: player,\r\n                                                    card: card,\r\n                                                    jiu: true,\r\n                                                }) &&\r\n                                                get.effect(current, card, target) > 0);\r\n                                        })) {\r\n                                            return 1;\r\n                                        }\r\n                                    }\r\n                                    return 0;\r\n                                }\r\n                            },\r\n                            tag: {\r\n                                save: 1,\r\n                                recover: 0.1\r\n                            }\r\n                        },\r\n                        sub: true\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_shen,\r\n        translate: {\r\n            PSxian_caozhi: \"仙界曹植\",\r\n            PSluoying: \"落英\",\r\n            PSluoying_info: \"锁定技：你立即获得任何方式进入弃牌堆的♣牌（自己的牌除外），以此法获得牌不计入手牌上限。\",\r\n            PSjiushi: \"酒诗\",\r\n            PSjiushi_info: \"锁定技，你永久处于喝酒状态，你可以将一张牌当『酒』使用，你使用『酒』无次数限制\"\r\n        },\r\n        rank: rank.legend\r\n    },\r\n    PSsunben: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"wu\",\r\n            hp: 4,\r\n            skills: [\r\n                \"oljiang\",\r\n                \"PSbaiban\",\r\n                \"PSbb_hunzi\",\r\n                \"olzhiba\"\r\n            ],\r\n            dieAudios: [\r\n                \"re_sunben\"\r\n            ],\r\n            isZhugong: true,\r\n            trashBin: []\r\n        },\r\n        intro: \"由“你想去哪儿呢”设计\",\r\n        replace: [\r\n            \"PSqun_sunce\",\r\n            \"PSsunben\"\r\n        ],\r\n        skills: {\r\n            PSbaiban: {\r\n                audio: \"ext:PS武将/audio/skill:2\",\r\n                trigger: {\r\n                    player: \"damageBegin4\"\r\n                },\r\n                filter: function (event, player) {\r\n                    return player.hp == 2 && event.num < 2;\r\n                },\r\n                forced: true,\r\n                content: function () {\r\n                    trigger.cancel();\r\n                }\r\n            },\r\n            PSbb_hunzi: {\r\n                skillAnimation: true,\r\n                animationColor: \"wood\",\r\n                audio: \"rehunzi\",\r\n                juexingji: true,\r\n                derivation: [\r\n                    \"PSbb_yingzi\",\r\n                    \"PSbb_yinghun\"\r\n                ],\r\n                unique: true,\r\n                trigger: {\r\n                    player: \"phaseZhunbeiBegin\"\r\n                },\r\n                filter: function (event, player) {\r\n                    return player.hp <= 1 && !player.storage.PSbb_hunzi;\r\n                },\r\n                forced: true,\r\n                content: function () {\r\n                    player.loseMaxHp();\r\n                    player.addSkills('PSbb_yingzi');\r\n                    player.addSkills('PSbb_yinghun');\r\n                    player.removeSkills('PSbaiban');\r\n                    game.log(player, '获得了技能', '#g【英姿】和【英魂】');\r\n                    game.log(player, '失去了技能', '#g【白板】');\r\n                    player.awakenSkill(event.name);\r\n                    player.storage[event.name] = true;\r\n                },\r\n                ai: {\r\n                    threaten: function (player, target) {\r\n                        if (target.hp == 1) return 2;\r\n                        return 0.5;\r\n                    },\r\n                    maixie: true,\r\n                    effect: {\r\n                        target: function (card, player, target) {\r\n                            if (!target.hasFriend()) return;\r\n                            if (get.tag(card, 'damage') == 1 && target.hp == 2 && !target.isTurnedOver() &&\r\n                                _status.currentPhase != target && get.distance(_status.currentPhase, target, 'absolute') <= 3) return [0.5, 1];\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_wu,\r\n        translate: {\r\n            PSsunben: \"PS孙笨\",\r\n            PSbaiban: \"白板\",\r\n            PSbaiban_info: \"锁定技，若你的体力值为2时，你防止受到小于2的伤害。\",\r\n            PSbb_hunzi: \"魂姿\",\r\n            PSbb_hunzi_info: \"觉醒技，准备阶段，若你的体力值为1，你减1点体力上限，并获得技能〖英姿〗和〖英魂〗。\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PSduyu: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"qun\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PSmiewu\",\r\n                \"PSqiyang\"\r\n            ],\r\n            dieAudios: [\r\n                \"sp_duyu\"\r\n            ],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“神鬼高达”设计\",\r\n        replace: [\r\n            \"PSjin_duyu\",\r\n            \"PSduyu\"\r\n        ],\r\n        skills: {\r\n            PSmiewu: {\r\n                audio: \"spmiewu\",\r\n                enable: [\r\n                    \"chooseToUse\",\r\n                    \"chooseToRespond\"\r\n                ],\r\n                filter: function (event, player) {\r\n                    if (player.hasSkill('PSmiewu_failure')) return false;\r\n                    if (!player.countCards('hse')) return false;\r\n                    for (var i of lib.inpile) {\r\n                        var type = get.type(i);\r\n                        if ((type == 'basic' || type == 'trick' || type == 'delay') && event.filterCard({ name: i }, player, event)) return true;\r\n                    }\r\n                    return false;\r\n                },\r\n                chooseButton: {\r\n                    dialog: function (event, player) {\r\n                        var list = [];\r\n                        for (var i = 0; i < lib.inpile.length; i++) {\r\n                            var name = lib.inpile[i];\r\n                            if (name == 'sha') {\r\n                                if (event.filterCard({ name: name }, player, event)) list.push(['基本', '', 'sha']);\r\n                                for (var j of lib.inpile_nature) {\r\n                                    if (event.filterCard({ name: name, nature: j }, player, event)) list.push(['基本', '', 'sha', j]);\r\n                                }\r\n                            }\r\n                            else if (get.type(name) == 'trick' && event.filterCard({ name: name }, player, event)) list.push(['锦囊', '', name]);\r\n                            else if (get.type(name) == 'delay' && event.filterCard({ name: name }, player, event)) list.push(['延时锦囊', '', name]);\r\n                            else if (get.type(name) == 'basic' && event.filterCard({ name: name }, player, event)) list.push(['基本', '', name]);\r\n                        }\r\n                        return ui.create.dialog('灭吴', [list, 'vcard']);\r\n                    },\r\n                    filter: function (button, player) {\r\n                        return _status.event.getParent().filterCard({ name: button.link[2] }, player, _status.event.getParent());\r\n                    },\r\n                    check: function (button) {\r\n                        if (_status.event.getParent().type != 'phase') return 1;\r\n                        var player = _status.event.player;\r\n                        if (['wugu', 'zhulu_card', 'yiyi', 'lulitongxin', 'lianjunshengyan', 'diaohulishan'].includes(button.link[2])) return 0;\r\n                        return player.getUseValue({\r\n                            name: button.link[2],\r\n                            nature: button.link[3],\r\n                        });\r\n                    },\r\n                    backup: function (links, player) {\r\n                        return {\r\n                            filterCard: true,\r\n                            audio: 'spmiewu',\r\n                            popname: true,\r\n                            check: function (card) {\r\n                                return 8 - get.value(card);\r\n                            },\r\n                            position: 'hse',\r\n                            viewAs: { name: links[0][2], nature: links[0][3] },\r\n                            precontent: function () {\r\n                                player.addTempSkill('PSmiewu_failure');\r\n                            },\r\n                        }\r\n                    },\r\n                    prompt: function (links, player) {\r\n                        return '将一张牌当做' + (get.translation(links[0][3]) || '') + get.translation(links[0][2]) + '使用';\r\n                    }\r\n                },\r\n                hiddenCard: function (player, name) {\r\n                    if (!lib.inpile.includes(name)) return false;\r\n                    var type = get.type(name);\r\n                    return (type == 'basic' || type == 'trick' || type == 'delay') && !player.hasSkill('PSmiewu_failure') && player.countCards('she') > 0\r\n                },\r\n                ai: {\r\n                    fireAttack: true,\r\n                    respondSha: true,\r\n                    respondShan: true,\r\n                    skillTagFilter: function (player) {\r\n                        if (!player.countCards('hse') || player.hasSkill('PSmiewu_failure')) return false;\r\n                    },\r\n                    order: 1,\r\n                    result: {\r\n                        player: function (player) {\r\n                            if (_status.event.dying) return get.attitude(player, _status.event.dying);\r\n                            return 1;\r\n                        }\r\n                    }\r\n                },\r\n                group: \"PSmiewu_draw\",\r\n                subSkill: {\r\n                    draw: {\r\n                        trigger: {\r\n                            player: [\r\n                                \"useCardAfter\",\r\n                                \"respondAfter\"\r\n                            ]\r\n                        },\r\n                        forced: true,\r\n                        charlotte: true,\r\n                        popup: false,\r\n                        filter: function (event, player) {\r\n                            return event.skill == 'PSmiewu_backup';\r\n                        },\r\n                        content: function () {\r\n                            player.draw();\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    failure: {\r\n                        sub: true\r\n                    }\r\n                }\r\n            },\r\n            PSqiyang: {\r\n                trigger: {\r\n                    player: \"gainEnd\"\r\n                },\r\n                audio: \"pkwuku\",\r\n                filter: function (event, player) {\r\n                    if (_status.currentPhase == player) return false;\r\n                    return event.getParent(2).name != 'PSmiewu_draw';\r\n                },\r\n                forced: true,\r\n                content: function () {\r\n                    var cards = trigger.cards || trigger.cards2;\r\n                    player.discard(cards);\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_qun,\r\n        translate: {\r\n            PSduyu: \"PS杜预\",\r\n            PSmiewu: \"灭吴\",\r\n            PSmiewu_info: \"每回合限一次，你可以将一张牌当做任意一张基本牌或锦囊牌使用或打出，然后你摸一张牌。\",\r\n            PSqiyang: \"弃养\",\r\n            PSqiyang_info: \"锁定技，你的回合外，若你不因〖灭吴〗获得牌时，弃置之。\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PSshen_jiangweix: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"shen\",\r\n            hp: 3,\r\n            skills: [\r\n                \"PSjiufa\",\r\n                \"PSkefu\",\r\n                \"PSwantian\"\r\n            ],\r\n            dieAudios: [\r\n                \"shen_jiangwei\"\r\n            ],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“我最爱的雨雨”设计\",\r\n        skills: {\r\n            PSjiufa: {\r\n                audio: \"jiufa\",\r\n                trigger: {\r\n                    player: \"useCardToPlayered\"\r\n                },\r\n                filter: function (event, player) {\r\n                    if (!event.addedTargets && event.targets.length == 1 && event.targets.includes(player)) return false;\r\n                    return event.targets && event.targets.length > 0;\r\n                },\r\n                init: function (player) {\r\n                    if (!player.storage.PSjiufa) player.storage.PSjiufa = 0;\r\n                },\r\n                mark: true,\r\n                marktext: \"伐\",\r\n                intro: {\r\n                    name: \"九伐\",\r\n                    content: \"mark\"\r\n                },\r\n                forced: true,\r\n                content: function () {\r\n                    player.storage.PSjiufa++;\r\n                    player.markSkill('PSjiufa');\r\n                    player.syncStorage('PSjiufa');\r\n                },\r\n                group: \"PSjiufa_gain\",\r\n                subSkill: {\r\n                    gain: {\r\n                        audio: \"jiufa\",\r\n                        trigger: {\r\n                            player: [\r\n                                \"useCardAfter\",\r\n                                \"respondAfter\"\r\n                            ]\r\n                        },\r\n                        priority: -1,\r\n                        forced: true,\r\n                        usable: 1,\r\n                        filter: function (event, player) {\r\n                            return player.storage.PSjiufa >= 9;\r\n                        },\r\n                        prompt2: \"展示牌堆顶九张牌，获得其中较多的同色牌\",\r\n                        content: function () {\r\n                            \"step 0\"\r\n                            player.storage.PSjiufa -= 9;\r\n                            player.markSkill('PSjiufa');\r\n                            var cards = get.cards(9);\r\n                            game.cardsGotoOrdering(cards);\r\n                            player.showCards(cards, '九伐');\r\n                            var cardsx = [];\r\n                            var cardsy = [];\r\n                            for (var i = 0; i < cards.length; i++) {\r\n                                if (get.color(cards[i]) == \"red\") {\r\n                                    cardsx.push(cards[i]);\r\n                                }\r\n                                else cardsy.push(cards[i]);\r\n                            }\r\n                            event.cards = cardsx.length > cardsy.length ? cardsx : cardsy;\r\n                            \"step 1\"\r\n                            if (event.cards.length) player.gain(event.cards, 'gain2');\r\n                            //game.cardsDiscard(cards2);\r\n                        },\r\n                        sub: true\r\n                    }\r\n                }\r\n            },\r\n            PSkefu: {\r\n                audio: \"tianren\",\r\n                enable: [\r\n                    \"chooseToRespond\",\r\n                    \"chooseToUse\"\r\n                ],\r\n                filterCard: true,\r\n                filter: function (event, player) {\r\n                    var num = player.hp;\r\n                    return player.countCards('hes') >= num;\r\n                },\r\n                selectCard: function (player) {\r\n                    var player = _status.event.player;\r\n                    var num = player.hp;\r\n                    return num;\r\n                },\r\n                position: \"hes\",\r\n                viewAs: {\r\n                    name: \"sha\",\r\n                    isCard: true,\r\n                    storage: {\r\n                        PSkefu: true\r\n                    }\r\n                },\r\n                viewAsFilter: function (player) {\r\n                    var num = player.hp;\r\n                    if (!player.countCards('hes' < num)) return false;\r\n                },\r\n                mod: {\r\n                    cardUsable: function (card) {\r\n                        if (card.storage && card.storage.PSkefu) return Infinity;\r\n                    }\r\n                },\r\n                prompt: function (event, player) {\r\n                    var player = _status.event.player;\r\n                    var num = player.hp;\r\n                    return \"将\" + get.cnNumber(num) + \"张牌当【杀】使用或打出\";\r\n                },\r\n                check: function (card) {\r\n                    var val = get.value(card);\r\n                    if (_status.event.name == 'chooseToRespond') return 1 / Math.max(0.1, val);\r\n                    return 5 - val;\r\n                },\r\n                ai: {\r\n                    skillTagFilter: function (player) {\r\n                        if (get.zhu(player, 'shouyue')) {\r\n                            if (!player.countCards('hes')) return false;\r\n                        }\r\n                        else {\r\n                            if (!player.countCards('hes', { color: 'red' })) return false;\r\n                        }\r\n                    },\r\n                    respondSha: true,\r\n                    yingbian: function (card, player, targets, viewer) {\r\n                        if (get.attitude(viewer, player) <= 0) return 0;\r\n                        var base = 0, hit = false;\r\n                        if (get.cardtag(card, 'yingbian_hit')) {\r\n                            hit = true;\r\n                            if (targets.filter(function (target) {\r\n                                return target.hasShan() && get.attitude(viewer, target) < 0 && get.damageEffect(target, player, viewer, get.nature(card)) > 0;\r\n                            })) base += 5;\r\n                        }\r\n                        if (get.cardtag(card, 'yingbian_all')) {\r\n                            if (game.hasPlayer(function (current) {\r\n                                return !targets.includes(current) && lib.filter.targetEnabled2(card, player, current) && get.effect(current, card, player, player) > 0;\r\n                            })) base += 5;\r\n                        }\r\n                        if (get.cardtag(card, 'yingbian_damage')) {\r\n                            if (targets.filter(function (target) {\r\n                                return get.attitude(player, target) < 0 && (hit || !target.mayHaveShan() || player.hasSkillTag('directHit_ai', true, {\r\n                                    target: target,\r\n                                    card: card,\r\n                                }, true)) && !target.hasSkillTag('filterDamage', null, {\r\n                                    player: player,\r\n                                    card: card,\r\n                                    jiu: true,\r\n                                })\r\n                            })) base += 5;\r\n                        }\r\n                        return base;\r\n                    },\r\n                    canLink: function (player, target, card) {\r\n                        if (!target.isLinked() && !player.hasSkill('wutiesuolian_skill')) return false;\r\n                        if (target.mayHaveShan() && !player.hasSkillTag('directHit_ai', true, {\r\n                            target: target,\r\n                            card: card,\r\n                        }, true)) return false;\r\n                        if (player.hasSkill('jueqing') || player.hasSkill('gangzhi') || target.hasSkill('gangzhi')) return false;\r\n                        return true;\r\n                    },\r\n                    basic: {\r\n                        useful: [\r\n                            5,\r\n                            3,\r\n                            1\r\n                        ],\r\n                        value: [\r\n                            5,\r\n                            3,\r\n                            1\r\n                        ]\r\n                    },\r\n                    order: function (item, player) {\r\n                        if (player.hasSkillTag('presha', true, null, true)) return 10;\r\n                        if (lib.linked.includes(get.nature(item))) {\r\n                            if (game.hasPlayer(function (current) {\r\n                                return current != player && current.isLinked() && player.canUse(item, current, null, true) && get.effect(current, item, player, player) > 0 && lib.card.sha.ai.canLink(player, current, item);\r\n                            }) && game.countPlayer(function (current) {\r\n                                return current.isLinked() && get.damageEffect(current, player, player, get.nature(item)) > 0;\r\n                            }) > 1) return 3.1;\r\n                            return 3;\r\n                        }\r\n                        return 3.05;\r\n                    },\r\n                    result: {\r\n                        target: function (player, target, card, isLink) {\r\n                            var eff = function () {\r\n                                if (!isLink && player.hasSkill('jiu')) {\r\n                                    if (!target.hasSkillTag('filterDamage', null, {\r\n                                        player: player,\r\n                                        card: card,\r\n                                        jiu: true,\r\n                                    })) {\r\n                                        if (get.attitude(player, target) > 0) {\r\n                                            return -7;\r\n                                        }\r\n                                        else {\r\n                                            return -4;\r\n                                        }\r\n                                    }\r\n                                    return -0.5;\r\n                                }\r\n                                return -1.5;\r\n                            }();\r\n                            if (!isLink && target.mayHaveShan() && !player.hasSkillTag('directHit_ai', true, {\r\n                                target: target,\r\n                                card: card,\r\n                            }, true)) return eff / 1.2;\r\n                            return eff;\r\n                        }\r\n                    },\r\n                    tag: {\r\n                        respond: 1,\r\n                        respondShan: 1,\r\n                        damage: function (card) {\r\n                            if (game.hasNature(card, 'poison')) return;\r\n                            return 1;\r\n                        },\r\n                        natureDamage: function (card) {\r\n                            if (game.hasNature(card)) return 1;\r\n                        },\r\n                        fireDamage: function (card, nature) {\r\n                            if (game.hasNature(card, 'fire')) return 1;\r\n                        },\r\n                        thunderDamage: function (card, nature) {\r\n                            if (game.hasNature(card, 'thunder')) return 1;\r\n                        },\r\n                        poisonDamage: function (card, nature) {\r\n                            if (game.hasNature(card, 'poison')) return 1;\r\n                        }\r\n                    }\r\n                },\r\n                group: [\r\n                    \"PSkefu_clear\",\r\n                    \"PSkefu_recover\"\r\n                ],\r\n                subSkill: {\r\n                    clear: {\r\n                        trigger: {\r\n                            player: \"useCardAfter\"\r\n                        },\r\n                        forced: true,\r\n                        silent: true,\r\n                        charlotte: true,\r\n                        filter: function (event, player) {\r\n                            return event.skill == 'PSkefu' && event.addCount != false;\r\n                        },\r\n                        content: function () {\r\n                            trigger.addCount = false;\r\n                            if (player.stat[player.stat.length - 1].card.sha > 0) {\r\n                                player.stat[player.stat.length - 1].card.sha--;\r\n                            }\r\n                        },\r\n                        popup: false,\r\n                        sub: true\r\n                    },\r\n                    recover: {\r\n                        trigger: {\r\n                            source: \"damageAfter\"\r\n                        },\r\n                        forced: true,\r\n                        popup: false,\r\n                        filter: function (event, player) {\r\n                            return event.card && event.card.storage && event.card.storage.PSkefu;\r\n                        },\r\n                        content: function () {\r\n                            if (player.hp == player.maxHp) player.gainMaxHp();\r\n                            else player.recover();\r\n                        },\r\n                        sub: true\r\n                    }\r\n                }\r\n            },\r\n            PSwantian: {\r\n                audio: \"pingxiang\",\r\n                enable: \"phaseUse\",\r\n                usable: 1,\r\n                filter: function (event, player) {\r\n                    return player.maxHp > 1;\r\n                },\r\n                content: function () {\r\n                    var num1 = player.hp - 1, num2 = player.maxHp - 1;\r\n                    if (num1 < 0) num1 = 0;\r\n                    player.loseMaxHp(num2);\r\n                    player.draw(num1 + num2);\r\n                },\r\n                ai: {\r\n                    order: 1.5\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_shen,\r\n        translate: {\r\n            PSshen_jiangweix: \"PS神姜维\",\r\n            PSjiufa: \"九伐\",\r\n            PSjiufa_info: \"锁定技，当你使用牌指定其他角色时，你获得等同于目标数的“伐”标记。每回合限一次，当你的“伐”不小于九时，你移去九个“伐”并展示牌堆顶的九张牌，获得其中较多的同色牌。\",\r\n            PSkefu: \"克复\",\r\n            PSkefu_info: \"你可以将X张牌当作不计入次数且无次数限制的【杀】使用或打出（X为你当前体力值），此【杀】造成伤害后你回复一点体力，若不能回复则增加一点体力上限。\",\r\n            PSwantian: \"挽天\",\r\n            PSwantian_info: \"出牌阶段限一次，你可以将体力上限调整为一，你每以此法失去一点体力或体力上限摸一张牌。\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PShs_zhonghui: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"wei\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PSmn_quanji\",\r\n                \"PSmn_paiyi\"\r\n            ],\r\n            clans: [\r\n                \"颍川钟氏\"\r\n            ],\r\n            dieAudios: [\r\n                \"xin_zhonghui\"\r\n            ],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“sc蓝晨跃”设计\",\r\n        replace: [\r\n            \"PShs_zhonghui\",\r\n            \"PSzhonghui\"\r\n        ],\r\n        skills: {\r\n            PSmn_quanji: {\r\n                group: \"PSmn_quanji_phase\",\r\n                audio: \"quanji\",\r\n                trigger: {\r\n                    player: \"damageEnd\"\r\n                },\r\n                filter: function (event, player) {\r\n                    return event.num > 0;\r\n                },\r\n                frequent: true,\r\n                locked: false,\r\n                prompt2: \"摸两张牌\",\r\n                content: function () {\r\n                    'step 0'\r\n                    event.count = trigger.num;\r\n                    'step 1'\r\n                    event.count--;\r\n                    player.draw(2);\r\n                    'step 2'\r\n                    if (event.count > 0) player.chooseBool(get.prompt('PSmn_quanji'), '摸两张牌').set('frequentSkill', 'PSmn_quanji');\r\n                    else event.finish();\r\n                    'step 3'\r\n                    if (result.bool) {\r\n                        player.logSkill('PSmn_quanji');\r\n                        event.goto(1);\r\n                    }\r\n                },\r\n                onremove: function (player, skill) {\r\n                    var cards = player.getExpansions('quanji');\r\n                    if (cards.length) player.loseToDiscardpile(cards);\r\n                },\r\n                mod: {\r\n                    maxHandcard: function (player, num) {\r\n                        return num + player.getExpansions('quanji').length;\r\n                    },\r\n                    maxHandcardBase: function (player) {\r\n                        return 0;\r\n                    }\r\n                },\r\n                subSkill: {\r\n                    phase: {\r\n                        audio: \"quanji\",\r\n                        enable: \"phaseUse\",\r\n                        filter: function (event, player) {\r\n                            return player.countCards('h');\r\n                        },\r\n                        prompt: \"将任意张手牌置于武将牌上\",\r\n                        selectCard: [\r\n                            1,\r\n                            Infinity\r\n                        ],\r\n                        filterCard: true,\r\n                        delay: false,\r\n                        discard: false,\r\n                        lose: false,\r\n                        check: function (card) {\r\n                            var player = _status.event.player, num = player.needsToDiscard();\r\n                            if (!player.getExpansions('quanji').length || num - ui.selected.cards.length - (player.getExpansions('quanji').length + ui.selected.cards.length) > 0) return 5 - get.value(card);\r\n                            return -1;\r\n                        },\r\n                        content: function () {\r\n                            player.addToExpansion(cards, player, 'give').gaintag.add('quanji');\r\n                        },\r\n                        ai: {\r\n                            order: 5,\r\n                            result: {\r\n                                player: 1\r\n                            }\r\n                        },\r\n                        sub: true\r\n                    }\r\n                }\r\n            },\r\n            PSmn_paiyi: {\r\n                enable: \"phaseUse\",\r\n                audio: \"paiyi\",\r\n                audioname: [\r\n                    \"re_zhonghui\"\r\n                ],\r\n                filter: function (event, player) {\r\n                    var num = game.countPlayer(function (current) {\r\n                        return get.distance(current, player) <= 1;\r\n                    });\r\n                    if (player.getStat().skill.PSmn_paiyi >= num) return false;\r\n                    return player.getExpansions('quanji').length > 0;\r\n                },\r\n                chooseButton: {\r\n                    dialog: function (event, player) {\r\n                        return ui.create.dialog('排异', player.getExpansions('quanji'), 'hidden')\r\n                    },\r\n                    backup: function (links, player) {\r\n                        return {\r\n                            audio: 'paiyi',\r\n                            audioname: ['re_zhonghui'],\r\n                            filterTarget: true,\r\n                            filterCard: function () { return false },\r\n                            direct: true,\r\n                            selectCard: -1,\r\n                            card: links[0],\r\n                            delay: false,\r\n                            content: lib.skill.PSmn_paiyi.contentx,\r\n                            ai: {\r\n                                order: 10,\r\n                                result: {\r\n                                    target: function (player, target) {\r\n                                        if (player != target) return 0;\r\n                                        if (player.hasSkill('PSmn_quanji') || (player.countCards('h') + 2 <= player.hp + player.getExpansions('quanji').length)) return 1;\r\n                                        return 0;\r\n                                    }\r\n                                },\r\n                            },\r\n                        }\r\n                    },\r\n                    prompt: function () { return '请选择〖排异〗的目标' }\r\n                },\r\n                contentx: function () {\r\n                    \"step 0\"\r\n                    player.logSkill('PSmn_paiyi', target);\r\n                    var card = lib.skill.PSmn_paiyi_backup.card;\r\n                    player.loseToDiscardpile(card);\r\n                    \"step 1\"\r\n                    target.draw(2);\r\n                    \"step 2\"\r\n                    if (target.countCards('h') > player.countCards('h')) {\r\n                        target.damage();\r\n                    }\r\n                },\r\n                ai: {\r\n                    order: 1,\r\n                    combo: \"PSmn_quanji\",\r\n                    result: {\r\n                        player: 1\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_wei,\r\n        translate: {\r\n            PShs_zhonghui: \"PS欢杀钟会\",\r\n            PSmn_quanji: \"权计\",\r\n            PSmn_quanji_info: \"你的手牌上限基数为0。当你受到1点伤害后，你可以摸两张牌。出牌阶段，你可以将任意张手牌置于武将牌上，称为“权”。你的手牌上限+X（X为武将牌上“权”的数量）。\",\r\n            PSmn_paiyi: \"排异\",\r\n            PSmn_paiyi_info: \"出牌阶段限X次，你可以移去一张“权”并选择一名角色，令其摸两张牌，然后若其手牌数大于你，你对其造成1伤害。（X为场上与你距离不大于1的角色数）\",\r\n            PSmn_paiyi_backup: \"排异\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PSzhuangbeidashi: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"shu\",\r\n            hp: 4,\r\n            skills: [\r\n                \"pytianjiang\",\r\n                \"pyzhuren\",\r\n                \"xinfu_jingxie1\",\r\n                \"PSshenzhu\"\r\n            ],\r\n            dieAudios: [\r\n                \"puyuan\"\r\n            ],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“10万原石”和“遇见鲲啊”设计\",\r\n        skills: {\r\n            PSshenzhu: {\r\n                audio: \"qiaosi\",\r\n                enable: \"phaseUse\",\r\n                filter: function (event, player) {\r\n                    var he = player.getCards('he');\r\n                    var num = 0;\r\n                    for (var i = 0; i < he.length; i++) {\r\n                        var info = lib.card[he[i].name];\r\n                        if (info.type == 'equip') {\r\n                            num++;\r\n                            if (num >= 2) return true;\r\n                        }\r\n                    }\r\n                },\r\n                filterCard: function (card) {\r\n                    if (ui.selected.cards.length && card.name == ui.selected.cards[0].name) return false;\r\n                    var info = get.info(card);\r\n                    return info.type == 'equip';\r\n                },\r\n                selectCard: 2,\r\n                position: \"hes\",\r\n                prompt: \"请选择需要合成的两张装备牌，装备类型以先选择的牌为准\",\r\n                check: function (card) {\r\n                    return get.value(card);\r\n                },\r\n                content: function () {\r\n                    var name = cards[0].name + '_' + cards[1].name;\r\n                    var info1 = get.info(cards[0]), info2 = get.info(cards[1]);\r\n                    if (!lib.card[name]) {\r\n                        var info = {\r\n                            enable: true,\r\n                            type: 'equip',\r\n                            subtype: get.subtype(cards[0]),\r\n                            vanish: true,\r\n                            cardimage: info1.cardimage || cards[0].name,\r\n                            filterTarget: function (card, player, target) {\r\n                                return target == player;\r\n                            },\r\n                            selectTarget: -1,\r\n                            modTarget: true,\r\n                            content: lib.element.content.equipCard,\r\n                            legend: true,\r\n                            source: [cards[0].name, cards[1].name],\r\n                            onEquip: [],\r\n                            onLose: [],\r\n                            skills: [],\r\n                            distance: {},\r\n                            ai: {\r\n                                order: 8.9,\r\n                                equipValue: 10,\r\n                                useful: 2.5,\r\n                                value: function (card, player) {\r\n                                    var value = 0;\r\n                                    var info = get.info(card);\r\n                                    var current = player.getEquip(info.subtype);\r\n                                    if (current && card != current) {\r\n                                        value = get.value(current, player);\r\n                                    }\r\n                                    var equipValue = info.ai.equipValue || info.ai.basic.equipValue;\r\n                                    if (typeof equipValue == 'function') return equipValue(card, player) - value;\r\n                                    return equipValue - value;\r\n                                },\r\n                                result: {\r\n                                    target: function (player, target) {\r\n                                        return get.equipResult(player, target, name);\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                        for (var i in info1.distance) {\r\n                            info.distance[i] = info1.distance[i];\r\n                        }\r\n                        for (var i in info2.distance) {\r\n                            if (typeof info.distance[i] == 'number') {\r\n                                info.distance[i] += info2.distance[i];\r\n                            }\r\n                            else {\r\n                                info.distance[i] = info2.distance[i];\r\n                            }\r\n                        }\r\n                        if (info1.skills) {\r\n                            info.skills = info.skills.concat(info1.skills);\r\n                        }\r\n                        if (info2.skills) {\r\n                            info.skills = info.skills.concat(info2.skills);\r\n                        }\r\n                        if (info1.onEquip) {\r\n                            if (Array.isArray(info1.onEquip)) {\r\n                                info.onEquip = info.onEquip.concat(info1.onEquip);\r\n                            }\r\n                            else {\r\n                                info.onEquip.push(info1.onEquip);\r\n                            }\r\n                        }\r\n                        if (info2.onEquip) {\r\n                            if (Array.isArray(info2.onEquip)) {\r\n                                info.onEquip = info.onEquip.concat(info2.onEquip);\r\n                            }\r\n                            else {\r\n                                info.onEquip.push(info2.onEquip);\r\n                            }\r\n                        }\r\n                        if (info1.onLose) {\r\n                            if (Array.isArray(info1.onLose)) {\r\n                                info.onLose = info.onLose.concat(info1.onLose);\r\n                            }\r\n                            else {\r\n                                info.onLose.push(info1.onLose);\r\n                            }\r\n                        }\r\n                        if (info2.onLose) {\r\n                            if (Array.isArray(info2.onLose)) {\r\n                                info.onLose = info.onLose.concat(info2.onLose);\r\n                            }\r\n                            else {\r\n                                info.onLose.push(info2.onLose);\r\n                            }\r\n                        }\r\n                        if (info.onEquip.length == 0) delete info.onEquip;\r\n                        if (info.onLose.length == 0) delete info.onLose;\r\n                        lib.card[name] = info;\r\n                        lib.translate[name] = get.translation(cards[0].name, 'skill') + get.translation(cards[1].name, 'skill');\r\n                        var str = lib.translate[cards[0].name + '_info'];\r\n                        if (str[str.length - 1] == '.' || str[str.length - 1] == '。') {\r\n                            str = str.slice(0, str.length - 1);\r\n                        }\r\n                        lib.translate[name + '_info'] = str + '；' + lib.translate[cards[1].name + '_info'];\r\n                        try {\r\n                            game.addVideo('newcard', null, {\r\n                                name: name,\r\n                                translate: lib.translate[name],\r\n                                info: lib.translate[name + '_info'],\r\n                                card: cards[0].name,\r\n                                legend: true,\r\n                            });\r\n                        }\r\n                        catch (e) {\r\n                            console.log(e);\r\n                        }\r\n                    }\r\n                    player.gain(game.createCard({ name: name, suit: cards[0].suit, number: cards[0].number }), 'gain2');\r\n                },\r\n                ai: {\r\n                    order: 9.5,\r\n                    result: {\r\n                        player: 1\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_shu,\r\n        translate: {\r\n            PSzhuangbeidashi: \"装备大师\",\r\n            PSshenzhu: \"神铸\",\r\n            PSshenzhu_info: \"出牌阶段，你可以将两张装备牌合成一张装备牌。\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PSboss_lvbu1: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"shen\",\r\n            hp: 8,\r\n            skills: [\r\n                \"wushuang\",\r\n                \"PSjingjia1\",\r\n                \"PSaozhan1\",\r\n                \"PSbaguan1\"\r\n            ],\r\n            dieAudios: [\r\n                \"boss_lvbu1\"\r\n            ],\r\n            isBossAllowed: true,\r\n            isBoss: true,\r\n            trashBin: []\r\n        },\r\n        intro: \"由“神鬼高达”设计\",\r\n        replace: [\r\n            \"PSboss_lvbu1\",\r\n            \"PSboss_lvbu2\",\r\n            \"PSboss_lvbu3\",\r\n            \"PSboss_lvbu4\"\r\n        ],\r\n        skills: {\r\n            PSjingjia1: {\r\n                derivation: [\r\n                    \"wushuangfangtianji\",\r\n                    \"shufazijinguan\",\r\n                    \"hongmianbaihuapao\",\r\n                    \"linglongshimandai\"\r\n                ],\r\n                trigger: {\r\n                    global: \"phaseBefore\",\r\n                    player: \"enterGame\"\r\n                },\r\n                filter: function (event, player) {\r\n                    return event.name != 'phase' || game.phaseNumber == 0;\r\n                },\r\n                forced: true,\r\n                content: function () {\r\n                    \"step 0\"\r\n                    var list = ['wushuangfangtianji', 'shufazijinguan'];\r\n                    list.push(['hongmianbaihuapao', 'linglongshimandai'].randomGet());\r\n                    for (var i of list) {\r\n                        if (lib.inpile.includes(i)) {\r\n                            var card = get.cardPile(function (card) {\r\n                                return card.name == i;\r\n                            });\r\n                            player.equip(card);\r\n                        }\r\n                    }\r\n                    \"step 1\"\r\n                    var types = [];\r\n                    for (var k = 1; k <= 6; k++) {\r\n                        if (player.isEmpty(k)) types.push('equip' + k);\r\n                    }\r\n                    for (var i = 0; i < types.length; i++) {\r\n                        var newCard = get.cardPile(function (card) {\r\n                            var type = get.subtype(card);\r\n                            return type == types[i] && player.canUse(card, player);\r\n                        });\r\n                        if (newCard) player.equip(newCard);\r\n                    }\r\n                },\r\n                mod: {\r\n                    canBeGained: function (card, source, player) {\r\n                        if (player.getCards('e').includes(card)) return false;\r\n                    },\r\n                    canBeDiscarded: function (card, source, player) {\r\n                        if (player.getCards('e').includes(card)) return false;\r\n                    },\r\n                    canBeReplaced: function (card, player) {\r\n                        if (player.getCards('e').includes(card)) return false;\r\n                    },\r\n                    cardDiscardable: function (card, player) {\r\n                        if (player.getCards('e').includes(card)) return false;\r\n                    },\r\n                    cardEnabled2: function (card, player) {\r\n                        if (player.getCards('e').includes(card)) return false;\r\n                    }\r\n                },\r\n                group: \"PSjingjia1_blocker\",\r\n                subSkill: {\r\n                    blocker: {\r\n                        trigger: {\r\n                            player: [\r\n                                \"loseBefore\",\r\n                                \"disableEquipBefore\"\r\n                            ]\r\n                        },\r\n                        forced: true,\r\n                        filter: function (event, player) {\r\n                            if (event.name == 'disableEquip') return true;\r\n                            return event.cards.some(card => player.getCards('e').includes(card));\r\n                        },\r\n                        content: function () {\r\n                            if (trigger.name == 'lose') {\r\n                                trigger.cards.removeArray(player.getCards('e'));\r\n                            }\r\n                            else {\r\n                                trigger.slots.removeArray(trigger.slots);\r\n                            }\r\n                        },\r\n                        sub: true,\r\n                        _priority: 0\r\n                    }\r\n                }\r\n            },\r\n            PSaozhan1: {\r\n                forced: true,\r\n                group: [\r\n                    \"PSaozhan1_wuqi\",\r\n                    \"PSaozhan1_fangju\",\r\n                    \"PSaozhan1_zuoji\",\r\n                    \"PSaozhan1_baowu\",\r\n                    \"PSaozhan1_baowu2\"\r\n                ],\r\n                subSkill: {\r\n                    wuqi: {\r\n                        mod: {\r\n                            cardUsable: function (card, player, num) {\r\n                                if (player.getEquip(1) && card.name == 'sha') return num + 1;\r\n                            }\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    fangju: {\r\n                        trigger: {\r\n                            player: \"damageBegin4\"\r\n                        },\r\n                        forced: true,\r\n                        filter: function (event, player) {\r\n                            return player.getEquip(2) && event.num > 1;\r\n                        },\r\n                        content: function () {\r\n                            trigger.num = 1;\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    zuoji: {\r\n                        trigger: {\r\n                            player: \"phaseDrawBegin\"\r\n                        },\r\n                        forced: true,\r\n                        filter: function (event, player) {\r\n                            return player.getEquip(3) || player.getEquip(4) || player.getEquip(6);\r\n                        },\r\n                        content: function () {\r\n                            trigger.num++;\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    baowu: {\r\n                        trigger: {\r\n                            player: \"phaseJudgeBefore\"\r\n                        },\r\n                        forced: true,\r\n                        filter: function (event, player) {\r\n                            return player.getEquip(5);\r\n                        },\r\n                        content: function () {\r\n                            trigger.cancel();\r\n                            game.log(player, '跳过了判定阶段');\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    baowu2: {\r\n                        init: function (player) {\r\n                            if (player.isTurnedOver()) {\r\n                                player.logSkill('PSaozhan1');\r\n                                player.turnOver();\r\n                            }\r\n                        },\r\n                        trigger: {\r\n                            player: \"turnOverBefore\"\r\n                        },\r\n                        filter: function (event, player) {\r\n                            return !player.isTurnedOver();\r\n                        },\r\n                        forced: true,\r\n                        content: function () {\r\n                            trigger.cancel();\r\n                        },\r\n                        sub: true\r\n                    }\r\n                }\r\n            },\r\n            PSbaguan1: {\r\n                trigger: {\r\n                    global: \"gameDrawBegin\"\r\n                },\r\n                forced: true,\r\n                popup: false,\r\n                silent: true,\r\n                content: function () {\r\n                    var num = trigger.num;\r\n                    trigger.num = function (target) {\r\n                        if (target == player) return 8;\r\n                        else if (typeof num == 'function') return num(target);\r\n                        else return num;\r\n                    };\r\n                },\r\n                ai: {\r\n                    threaten: 1.3\r\n                },\r\n                group: [\r\n                    \"PSbaguan1_enter\",\r\n                    \"PSbaguan1_phase\",\r\n                    \"PSbaguan1_bianshen\"\r\n                ],\r\n                subSkill: {\r\n                    enter: {\r\n                        trigger: {\r\n                            global: \"phaseBefore\",\r\n                            player: \"enterGame\"\r\n                        },\r\n                        forced: true,\r\n                        priority: 100,\r\n                        filter: function (event, player) {\r\n                            var list = ['wushuangfangtianji', 'shufazijinguan', 'hongmianbaihuapao', 'linglongshimandai'];\r\n                            var bool = false;\r\n                            for (var i of list) {\r\n                                if (!lib.inpile.includes(i)) {\r\n                                    bool = true;\r\n                                    break;\r\n                                }\r\n                            }\r\n                            if (bool == false) return false;\r\n                            return (event.name != 'phase' || game.phaseNumber == 0);\r\n                        },\r\n                        content: function () {\r\n                            var list = ['wushuangfangtianji', 'shufazijinguan', 'hongmianbaihuapao', 'linglongshimandai'];\r\n                            for (var name of list) {\r\n                                if (!lib.inpile.includes(name)) {\r\n                                    var card = game.createCard2(name, lib.suit.randomGet(), get.rand(1, 13));\r\n                                    ui.cardPile.insertBefore(card, ui.cardPile.childNodes[get.rand(0, ui.cardPile.childNodes.length)]);\r\n                                    game.log(name, '加入了牌堆');\r\n                                    game.broadcastAll(function () { lib.inpile.add(name) });\r\n                                }\r\n                            }\r\n                            game.updateRoundNumber();\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    phase: {\r\n                        trigger: {\r\n                            global: \"phaseAfter\"\r\n                        },\r\n                        filter: function (event, player) {\r\n\r\n                            return event.player != player && _status.currentPhase.next != player;\r\n                        },\r\n                        priority: -1,\r\n                        forced: true,\r\n                        content: function () {\r\n                            player.insertPhase();\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    bianshen: {\r\n                        audio: \"baonu\",\r\n                        skillAnimation: true,\r\n                        animationStr: \"变身\",\r\n                        trigger: {\r\n                            global: \"roundStart\",\r\n                            player: [\r\n                                \"changeHp\",\r\n                                \"dieBefore\"\r\n                            ]\r\n                        },\r\n                        filter: function (event, player) {\r\n                            if (event.name == 'changeHp') return player.hp <= player.getDamagedHp();\r\n                            else if (event.name != 'die') return game.roundNumber >= 2;\r\n                            return true;\r\n                        },\r\n                        forced: true,\r\n                        content: function () {\r\n                            'step 0'\r\n                            if (trigger.name == 'die') trigger.cancel();\r\n                            var list = ['暴怒战神', '神鬼无前', '炼狱修罗'];\r\n                            player.chooseControl(list, function () {\r\n                                return list.randomGet();\r\n                            }).set('prompt', '请选择一个变身形态：');\r\n                            'step 1'\r\n                            if (result.control == '暴怒战神') {\r\n                                lib.skill.PSbaguan1.reinitCharacter(player, 'PSboss_lvbu1', 'PSboss_lvbu2', [6, 6]);\r\n                            }\r\n                            else if (result.control == '神鬼无前') {\r\n                                lib.skill.PSbaguan1.reinitCharacter(player, 'PSboss_lvbu1', 'PSboss_lvbu3', [6, 6]);\r\n                            }\r\n                            else lib.skill.PSbaguan1.reinitCharacter(player, 'PSboss_lvbu1', 'PSboss_lvbu4', [6, 6]);\r\n                            ui.clear();\r\n                            'step 2'\r\n                            if (player.isLinked()) player.link();\r\n                            if (player.isTurnedOver()) player.turnOver();\r\n                            player.discard(player.getCards('j'));\r\n                            'step 3'\r\n                            while (_status.event.name != 'phaseLoop') {\r\n                                _status.event = _status.event.parent;\r\n                            }\r\n                            game.resetSkills();\r\n                            _status.paused = false;\r\n                            _status.event.player = player;\r\n                            _status.event.step = 0;\r\n                            _status.roundStart = player;\r\n                        },\r\n                        ai: {\r\n                            effect: {\r\n                                target: function (card, player, target) {\r\n                                    if (get.tag(card, 'damage') || get.tag(card, 'loseHp')) {\r\n                                        if (player.hp == 5) {\r\n                                            if (game.players.length < 4) return [0, 5];\r\n                                            var num = 0\r\n                                            for (var i = 0; i < game.players.length; i++) {\r\n                                                if (game.players[i] != game.me && game.players[i].hp == 1) {\r\n                                                    num++;\r\n                                                }\r\n                                            }\r\n                                            if (num > 1) return [0, 2];\r\n                                            if (num && Math.random() < 0.7) return [0, 1];\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                        },\r\n                        sub: true\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_shen,\r\n        translate: {\r\n            PSboss_lvbu1: \"新最强神话\",\r\n            PSjingjia1: \"精甲\",\r\n            PSjingjia1_info: \"锁定技，游戏开始时，你将五张对应装备栏的装备牌置入你的装备区；当你即将废除装备区或失去装备区的牌时，取消之。\",\r\n            PSaozhan1: \"鏖战\",\r\n            PSaozhan1_info: \"锁定技，若你装备区内有：武器牌，你可以多使用一张【杀】；防具牌，你受到的伤害始终为一；坐骑牌，摸牌阶段多摸一张牌；宝物牌，跳过你的判定阶段，且你无法被翻面。\",\r\n            PSbaguan1: \"霸关\",\r\n            PSbaguan1_info: \"锁定技，你的初始手牌数为8，游戏开始时，你将四张虎牢关专属装备置入牌堆，每名角色回合结束后，你执行一个额外回合，你无法因此连续行动两个回合。当你的体力值不大于已损失体力值/游戏第二轮开始时/你将要阵亡时，终止阵亡结算，选择将武将牌替换为“暴怒战神”、“神鬼无前”或“炼狱修罗”，然后将体力值和体力上限调整为6并立即开始你的回合。\",\r\n            \"#ext:PS武将/audio/skill/wushuang1\": \"哼！不自量力。\",\r\n            \"#ext:PS武将/audio/skill/wushuang2\": \"纵横沙场，难逢敌手。\",\r\n            \"#ext:PS武将/audio/skill/wushuang3\": \"修罗降世,神鬼辟易。\",\r\n            \"#ext:PS武将/audio/skill/wushuang4\": \"仰云天降，修罗挥兵。\",\r\n            \"#ext:PS武将/audio/skill/wushuang5\": \"尔等营狗之辈，如何配做本将军对手。\",\r\n            \"#ext:PS武将/audio/skill/wushuang6\": \"天下武夫万千,皆非吾一合之将。\",\r\n            \"#ext:PS武将/audio/skill/wushuang7\": \"画戟一击，五脏俱损。\",\r\n            \"#ext:PS武将/audio/skill/wushuang8\": \"尔等凡夫，怎敌吾千钧之力！\"\r\n        },\r\n        rank: rank.legend\r\n    },\r\n    PSboss_lvbu2: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"shen\",\r\n            hp: 6,\r\n            skills: [\r\n                \"wushuang\",\r\n                \"PSshenwei2\",\r\n                \"PSshenji2\",\r\n                \"PSbaguan2\"\r\n            ],\r\n            dieAudios: [\r\n                \"boss_lvbu2\"\r\n            ],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“神鬼高达”设计\",\r\n        skills: {\r\n            PSshenwei2: {\r\n                mod: {\r\n                    maxHandcard: function (player, current) {\r\n                        return player.maxHp;\r\n                    }\r\n                },\r\n                audio: \"xiuluo\",\r\n                trigger: {\r\n                    player: \"phaseJudgeBegin\"\r\n                },\r\n                charlotte: true,\r\n                forced: true,\r\n                filter: function (event, player) {\r\n                    return player.countCards('j') && player.countCards('hes') > 1;\r\n                },\r\n                content: function () {\r\n                    \"step 0\"\r\n                    player.chooseToDiscard('hes', 2, '神威：弃置两张牌并弃置自己判定区的所有牌', true).set('logSkill', 'PSshenwei2').ai = function (card) {\r\n                        return 6 - get.value(card);\r\n                    };\r\n                    \"step 1\"\r\n                    if (result.bool) {\r\n                        player.discard(player.getCards('j'));\r\n                    }\r\n                },\r\n                group: \"PSshenwei2_draw\",\r\n                subSkill: {\r\n                    draw: {\r\n                        audio: \"shenwei\",\r\n                        trigger: {\r\n                            player: \"phaseDrawBegin\"\r\n                        },\r\n                        forced: true,\r\n                        content: function () {\r\n                            trigger.num += 3;\r\n                        },\r\n                        sub: true\r\n                    }\r\n                }\r\n            },\r\n            PSshenji2: {\r\n                audio: \"shenji\",\r\n                enable: \"phaseUse\",\r\n                usable: 2,\r\n                filter: function (event, player) {\r\n                    return player.countCards('hes');\r\n                },\r\n                content: function () {\r\n                    'step 0'\r\n                    player.chooseToDiscard('hes', true);\r\n                    'step 1'\r\n                    var list = [\r\n                        '使用【杀】可以额外指定两名目标。',\r\n                        '使用【杀】无距离限制，且次数+1。',\r\n                        '使用【杀】造成伤害+1。',\r\n                        '使用【杀】指定目标时，目标须弃置一张牌。'\r\n                    ];\r\n                    if (player.storage.PSshenji2) list.remove(player.storage.PSshenji2);\r\n                    player.chooseControl().set('choiceList', list).set('ai', function () {\r\n                        var listx = list.length == 4 ? [0, 1, 2, 3] : [0, 1, 2];\r\n                        return listx.randomGet();\r\n                    }).set('prompt', '神戟：请选择你要获得的效果');\r\n                    event.list = list;\r\n                    'step 2'\r\n                    var name = event.list[result.index];\r\n                    player.storage.PSshenji2 = name;\r\n                    switch (name) {\r\n                        case '使用【杀】可以额外指定两名目标。':\r\n                            player.addTempSkill('PSshenji2_multi');\r\n                            break;\r\n                        case '使用【杀】无距离限制，且次数+1。':\r\n                            player.addTempSkill('PSshenji2_distance');\r\n                            break;\r\n                        case '使用【杀】造成伤害+1。':\r\n                            player.addTempSkill('PSshenji2_damage');\r\n                            break;\r\n                        default:\r\n                            player.addTempSkill('PSshenji2_discard');\r\n                    }\r\n                },\r\n                group: \"PSshenji2_clear\",\r\n                subSkill: {\r\n                    clear: {\r\n                        trigger: {\r\n                            player: \"phaseUseEnd\"\r\n                        },\r\n                        direct: true,\r\n                        nopup: true,\r\n                        filter: function (event, player) {\r\n                            return player.storage.PSshenji2;\r\n                        },\r\n                        content: function () {\r\n                            player.storage.PSshenji2 = undefined;\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    multi: {\r\n                        mod: {\r\n                            selectTarget: function (card, player, range) {\r\n                                if (card.name == 'sha' && range[1] != -1) {\r\n                                    range[1] += 2;\r\n                                }\r\n                            }\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    distance: {\r\n                        mod: {\r\n                            cardUsable: function (card, player, num) {\r\n                                if (card.name == 'sha') return num + 1;\r\n                            },\r\n                            targetInRange: function (card, player, target, now) {\r\n                                if (get.name(card) == 'sha') return true;\r\n                            }\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    damage: {\r\n                        trigger: {\r\n                            source: \"damageBegin1\"\r\n                        },\r\n                        filter: function (event) {\r\n                            return event.card && event.card.name == 'sha';\r\n                        },\r\n                        forced: true,\r\n                        direct: true,\r\n                        content: function () {\r\n                            trigger.num++;\r\n                        },\r\n                        ai: {\r\n                            damageBonus: true\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    discard: {\r\n                        trigger: {\r\n                            player: \"shaBegin\"\r\n                        },\r\n                        filter: function (event, player) {\r\n                            return event.target.countCards('he');\r\n                        },\r\n                        forced: true,\r\n                        check: function (event, player) {\r\n                            return get.attitude(player, event.target) < 0;\r\n                        },\r\n                        logTarget: \"target\",\r\n                        content: function () {\r\n                            trigger.target.chooseToDiscard('he', 1, true);\r\n                        },\r\n                        sub: true\r\n                    }\r\n                }\r\n            },\r\n            PSbaguan2: {\r\n                enable: \"phaseUse\",\r\n                filter: function (event, player) {\r\n                    return !player.hasSkill(\"PSbaguan2_clear\");\r\n                },\r\n                /**\r\n                 * 更换武将牌\r\n                 * @param { Player } player 角色\r\n                 * @param { string } name1 变更前武将名\r\n                 * @param { string } name2 变更后武将名\r\n                 * @param { number[] } hp_MaxHp 变更后是否改变体力值和体力上限 \r\n                 * @returns { object } Event#changeCharacter 返回一个事件对象\r\n                 */\r\n                reinitCharacter(player, name1, name2, hp_MaxHp) {\r\n                    player.reinit(name1, name1, hp_MaxHp);\r\n                    return player.reinitCharacter(name1, name2);\r\n                },\r\n                content: function () {\r\n                    'step 0'\r\n                    var skills = ['PSshenji2_multi', 'PSshenji2_distance', 'PSshenji2_damage', 'PSshenji2_discard'];\r\n                    var skillsx = [];\r\n                    for (var i of skills) {\r\n                        if (player.hasSkill(i)) skillsx.push(i);\r\n                    }\r\n                    if (player.storage.PSjiwu3 && player.storage.PSjiwu3.length > 0) {\r\n                        for (var j of player.storage.PSjiwu3) {\r\n                            skillsx.push(j);\r\n                        }\r\n                    }\r\n                    event.skills = skillsx;\r\n                    'step 1'\r\n                    var list = ['暴怒战神', '神鬼无前', '炼狱修罗'];\r\n                    switch (player.name) {\r\n                        case 'PSboss_lvbu2':\r\n                            list.remove('暴怒战神');\r\n                            break;\r\n                        case 'PSboss_lvbu3':\r\n                            list.remove('神鬼无前');\r\n                            break;\r\n                        case 'PSboss_lvbu4':\r\n                            list.remove('炼狱修罗');\r\n                            break;\r\n                        default: break;\r\n                    }\r\n                    list.push('cancel2');\r\n                    player.chooseControl(list, function () {\r\n                        return list.randomGet();\r\n                    }).set('prompt', '请选择你要变换的形态：');\r\n                    'step 2'\r\n                    const name = player.name1.startsWith('PSboss_lvbu') ? player.name1 : player.name2 && player.name2.startsWith('PSboss_lvbu') ? player.name2 : player.name1;\r\n                    if (result.control == '暴怒战神') {\r\n                        lib.skill.PSbaguan1.reinitCharacter(player, name, 'PSboss_lvbu2');\r\n                    }\r\n                    else if (result.control == '神鬼无前') {\r\n                        lib.skill.PSbaguan1.reinitCharacter(player, name, 'PSboss_lvbu3');\r\n                    }\r\n                    else if (result.control == '炼狱修罗') {\r\n                        lib.skill.PSbaguan1.reinitCharacter(player, name, 'PSboss_lvbu4');\r\n                    }\r\n                    else event.finish();\r\n                    'step 3'\r\n                    player.logSkill('PSbaguan1_bianshen');\r\n                    player.addSkill(\"PSbaguan2_clear\");\r\n                    'step 4'\r\n                    if (event.skills.length > 0) {\r\n                        for (var i of event.skills) {\r\n                            player.addTempSkill(i);\r\n                        }\r\n                    }\r\n                },\r\n                group: \"PSbaguan2_else\",\r\n                subSkill: {\r\n                    else: {\r\n                        trigger: {\r\n                            player: [\r\n                                \"phaseZhunbeiBegin\",\r\n                                \"phaseJieshuBegin\"\r\n                            ]\r\n                        },\r\n                        direct: true,\r\n                        priority: -1,\r\n                        filter: function (event, player) {\r\n                            return !player.hasSkill(\"PSbaguan2_clear\");\r\n                        },\r\n                        content: function () {\r\n                            'step 0'\r\n                            var skills = ['PSshenji2_multi', 'PSshenji2_distance', 'PSshenji2_damage', 'PSshenji2_discard'];\r\n                            var skillsx = [];\r\n                            for (var i of skills) {\r\n                                if (player.hasSkill(i)) skillsx.push(i);\r\n                            }\r\n                            if (player.storage.PSjiwu3 && player.storage.PSjiwu3.length > 0) {\r\n                                for (var j of player.storage.PSjiwu3) {\r\n                                    skillsx.push(j);\r\n                                }\r\n                            }\r\n                            event.skills = skillsx;\r\n                            'step 1'\r\n                            var list = ['暴怒战神', '神鬼无前', '炼狱修罗'];\r\n                            switch (player.name) {\r\n                                case 'PSboss_lvbu2':\r\n                                    list.remove('暴怒战神');\r\n                                    break\r\n                                case 'PSboss_lvbu3':\r\n                                    list.remove('神鬼无前');\r\n                                    break;\r\n                                case 'PSboss_lvbu4':\r\n                                    list.remove('炼狱修罗');\r\n                                    break;\r\n                                default: break;\r\n                            }\r\n                            list.push('cancel2');\r\n                            player.chooseControl(list, function () {\r\n                                return list.randomGet();\r\n                            }).set('prompt', '请选择你要变换的形态：');\r\n                            'step 2'\r\n                            const name = player.name1.startsWith('PSboss_lvbu') ? player.name1 : player.name2 && player.name2.startsWith('PSboss_lvbu') ? player.name2 : player.name1;\r\n                            if (result.control == '暴怒战神') {\r\n                                lib.skill.PSbaguan1.reinitCharacter(player, name, 'PSboss_lvbu2');\r\n                            }\r\n                            else if (result.control == '神鬼无前') {\r\n                                lib.skill.PSbaguan1.reinitCharacter(player, name, 'PSboss_lvbu3');\r\n                            }\r\n                            else if (result.control == '炼狱修罗') {\r\n                                lib.skill.PSbaguan1.reinitCharacter(player, name, 'PSboss_lvbu4');\r\n                            }\r\n                            else event.finish();\r\n                            'step 3'\r\n                            player.logSkill('PSbaguan1_bianshen');\r\n                            player.addSkill(\"PSbaguan2_clear\");\r\n                            'step 4'\r\n                            if (event.skills.length > 0) {\r\n                                for (var i of event.skills) {\r\n                                    player.addTempSkill(i);\r\n                                }\r\n                            }\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    clear: {\r\n                        direct: true,\r\n                        charlotte: true,\r\n                        sub: true,\r\n                        trigger: {\r\n                            global: \"roundStart\"\r\n                        },\r\n                        content: function () {\r\n                            player.removeSkill(\"PSbaguan2_clear\");\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_shen,\r\n        translate: {\r\n            PSboss_lvbu2: \"新暴怒战神\",\r\n            PSshenwei2: \"神威\",\r\n            PSshenwei2_info: \"锁定技，判定阶段，若你的判定区有牌，则你须弃置两张牌，然后弃置自己判定区内的所有牌；摸牌阶段，你额外摸三张牌，你的手牌上限为你的体力上限。\",\r\n            PSshenji2: \"神戟\",\r\n            PSshenji2_info: \"出牌阶段限两次，你可以弃置一张牌，然后获得未拥有的一项效果直到回合结束：<br/>一、使用【杀】可以额外指定两名目标。<br/>二、使用【杀】无距离限制，且次数+1。<br/>三、使用【杀】造成伤害+1。<br/>四、使用【杀】指定目标时，目标须弃置一张牌。\",\r\n            PSbaguan2: \"霸关\",\r\n            PSbaguan2_info: \"每轮限一次，回合开始阶段/出牌阶段/回合结束阶段可发动，你可以将武将牌替换为“暴怒战神”“神鬼无前”或“炼狱修罗”（三种形态共享次数），〖狂暴〗或由〖神戟〗〖极武〗获得的效果不会因武将牌替换而消失。\"\r\n        },\r\n        rank: rank.legend\r\n    },\r\n    PSboss_lvbu3: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"shen\",\r\n            hp: 6,\r\n            skills: [\r\n                \"wushuang\",\r\n                \"PSshenqu3\",\r\n                \"PSjiwu3\",\r\n                \"PSbaguan2\"\r\n            ],\r\n            dieAudios: [\r\n                \"boss_lvbu3\"\r\n            ],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“神鬼高达”设计\",\r\n        skills: {\r\n            PSshenqu3: {\r\n                audio: \"shenqu\",\r\n                group: \"PSshenqu3_tao\",\r\n                trigger: {\r\n                    global: \"phaseZhunbeiBegin\"\r\n                },\r\n                filter: function (event, player) {\r\n                    return player.countCards('h') <= player.maxHp;\r\n                },\r\n                forced: true,\r\n                content: function () {\r\n                    var num = Math.min(2, player.getDamagedHp());\r\n                    player.draw(num + 1);\r\n                },\r\n                subSkill: {\r\n                    tao: {\r\n                        trigger: {\r\n                            player: \"damageAfter\"\r\n                        },\r\n                        direct: true,\r\n                        filter: function (event, player) {\r\n                            if (!player.canUse('tao', player, false)) return false;\r\n                            return player.hasSkillTag('respondTao') || player.countCards('h', 'tao') > 0;\r\n                        },\r\n                        content: function () {\r\n                            player.chooseToUse({ name: 'tao' }, '神躯：请使用一张桃', true).logSkill = 'PSshenqu3';\r\n                        },\r\n                        sub: true\r\n                    }\r\n                }\r\n            },\r\n            PSjiwu3: {\r\n                init: function (player) {\r\n                    player.addSkill('PSjiwu3_clear');\r\n                    // player.addSkill('PSjiwu3_audio');\r\n                    if (!player.storage.PSjiwu3) player.storage.PSjiwu3 = [];\r\n                },\r\n                derivation: [\r\n                    \"qiangxix\",\r\n                    \"retieji\",\r\n                    \"decadexuanfeng\",\r\n                    \"rewansha\"\r\n                ],\r\n                audio: \"jiwu\",\r\n                enable: \"phaseUse\",\r\n                usable: 2,\r\n                filter: function (event, player) {\r\n                    if (player.countCards('h') == 0) return false;\r\n                    if (!player.hasSkill('qiangxix')) return true;\r\n                    if (!player.hasSkill('retieji')) return true;\r\n                    if (!player.hasSkill('decadexuanfeng')) return true;\r\n                    if (!player.hasSkill('rewansha')) return true;\r\n                    return false;\r\n                },\r\n                filterCard: true,\r\n                position: \"he\",\r\n                check: function (card) {\r\n                    if (get.position(card) == 'e' && _status.event.player.hasSkill('decadexuanfeng')) return 16 - get.value(card);\r\n                    return 7 - get.value(card);\r\n                },\r\n                content: function () {\r\n                    'step 0'\r\n                    var list = [];\r\n                    if (!player.hasSkill('qiangxix')) list.push('qiangxix');\r\n                    if (!player.hasSkill('retieji')) list.push('retieji');\r\n                    if (!player.hasSkill('decadexuanfeng')) list.push('decadexuanfeng');\r\n                    if (!player.hasSkill('rewansha')) list.push('rewansha');\r\n                    if (list.length == 1) {\r\n                        player.addTempSkill(list[0]);\r\n                        event.finish();\r\n                    }\r\n                    else {\r\n                        player.chooseControl(list, function () {\r\n                            if (list.includes('decadexuanfeng') && player.countCards('he', { type: 'equip' })) return 'decadexuanfeng';\r\n                            if (!player.getStat().skill.qiangxix) {\r\n                                if (player.hasSkill('qiangxix') && player.getEquip(1) && list.includes('decadexuanfeng')) return 'decadexuanfeng';\r\n                                if (list.includes('rewansha') || list.includes('qiangxix')) {\r\n                                    var players = game.filterPlayer();\r\n                                    for (var i = 0; i < players.length; i++) {\r\n                                        if (players[i].hp == 1 && get.attitude(player, players[i]) < 0) {\r\n                                            if (list.includes('rewansha')) return 'rewansha';\r\n                                            if (list.includes('qiangxix')) return 'qiangxix';\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                            if (list.includes('qiangxix')) return 'qiangxix';\r\n                            if (list.includes('rewansha')) return 'rewansha';\r\n                            if (list.includes('decadexuanfeng')) return 'decadexuanfeng';\r\n                            return 'retieji';\r\n                        }).set('prompt', '选择获得一项技能直到回合结束');\r\n                    }\r\n                    'step 1'\r\n                    player.addTempSkill(result.control);\r\n                    player.storage.PSjiwu3.push(result.control);\r\n                    player.popup(get.translation(result.control));\r\n                },\r\n                ai: {\r\n                    order: function () {\r\n                        var player = _status.event.player;\r\n                        if (player.countCards('e', { type: 'equip' })) return 10;\r\n                        if (!player.getStat().skill.qiangxix) {\r\n                            if (player.hasSkill('qiangxix') && player.getEquip(1) && !player.hasSkill('decadexuanfeng')) return 10;\r\n                            if (player.hasSkill('rewansha')) return 1;\r\n                            var players = game.filterPlayer();\r\n                            for (var i = 0; i < players.length; i++) {\r\n                                if (players[i].hp == 1 && get.attitude(player, players[i]) < 0) return 10;\r\n                            }\r\n                        }\r\n                        return 1;\r\n                    },\r\n                    result: {\r\n                        player: function (player) {\r\n                            if (player.countCards('e', { type: 'equip' })) return 1;\r\n                            if (!player.getStat().skill.qiangxix) {\r\n                                if (player.hasSkill('qiangxix') && player.getEquip(1) && !player.hasSkill('decadexuanfeng')) return 1;\r\n                                if (!player.hasSkill('rewansha') || !player.hasSkill('qiangxix')) {\r\n                                    var players = game.filterPlayer();\r\n                                    for (var i = 0; i < players.length; i++) {\r\n                                        if (players[i].hp == 1 && get.attitude(player, players[i]) < 0) return 1;\r\n                                    }\r\n                                }\r\n                            }\r\n                            return 0;\r\n                        }\r\n                    }\r\n                },\r\n                subSkill: {\r\n                    clear: {\r\n                        trigger: {\r\n                            player: \"phaseAfter\"\r\n                        },\r\n                        direct: true,\r\n                        superCharlotte: true,\r\n                        popup: false,\r\n                        filter: function (event, player) {\r\n                            return player.storage.PSjiwu3;\r\n                        },\r\n                        content: function () {\r\n                            player.storage.PSjiwu3 = [];\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    audio: {\r\n                        trigger: {\r\n                            player: [\r\n                                \"logSkill\",\r\n                                \"useSkillBegin\"\r\n                            ]\r\n                        },\r\n                        direct: true,\r\n                        superCharlotte: true,\r\n                        popup: false,\r\n                        filter: function (event, player) {\r\n                            return event.skill == 'qiangxix' || event.skill == 'rewansha' || event.skill == 'retieji' || event.skill == 'decadexuanfeng' || event.skill == 'wushuang';\r\n                        },\r\n                        content: function () {\r\n                            switch (trigger.skill) {\r\n                                case 'qiangxix':\r\n                                    var audio1 = ['qiangxix1', 'qiangxix2'].randomGet();\r\n                                    game.playAudio('..', 'extension', 'PS武将/audio/skill', audio1);\r\n                                    break;\r\n                                case 'rewansha':\r\n                                    var audio2 = ['rewansha1', 'rewansha2'].randomGet();\r\n                                    game.playAudio('..', 'extension', 'PS武将/audio/skill', audio2);\r\n                                    break;\r\n                                case 'retieji':\r\n                                    var audio3 = 'retieji1';\r\n                                    game.playAudio('..', 'extension', 'PS武将/audio/skill', audio3);\r\n                                    break;\r\n                                case 'decadexuanfeng':\r\n                                    var audio4 = ['decadexuanfeng1', 'decadexuanfeng2'].randomGet();\r\n                                    game.playAudio('..', 'extension', 'PS武将/audio/skill', audio4);\r\n                                    break;\r\n                                default:\r\n                                    var audio5 = ['wushuang1', 'wushuang2', 'wushuang3', 'wushuang4', 'wushuang5', 'wushuang6', 'wushuang7', 'wushuang8'].randomGet();\r\n                                    game.playAudio('..', 'extension', 'PS武将/audio/skill', audio5);\r\n                                    break;\r\n                            }\r\n                        },\r\n                        sub: true\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_shen,\r\n        translate: {\r\n            PSboss_lvbu3: \"新神鬼无前\",\r\n            PSshenqu3: \"神躯\",\r\n            PSshenqu3_info: \"锁定技，一名角色准备阶段，若你的手牌数不大于体力上限，你摸X+1张牌（X为你已损失的体力值且至多为2）。当你受到伤害后，若你手牌中有【桃】，则你使用之。\",\r\n            PSjiwu3: \"极武\",\r\n            PSjiwu3_info: \"出牌阶段限两次，你可以弃置一张牌，然后选择获得【强袭】、【铁骑】、【旋风】、【完杀】中的一项技能直到回合结束。\"\r\n        },\r\n        rank: rank.legend\r\n    },\r\n    PSboss_lvbu4: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"shen\",\r\n            hp: 6,\r\n            skills: [\r\n                \"wushuang\",\r\n                \"PSkuangbao4\",\r\n                \"PSshenfen4\",\r\n                \"PSbaguan2\"\r\n            ],\r\n            dieAudios: [\r\n                \"shen_lvbu\"\r\n            ],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“神鬼高达”设计\",\r\n        skills: {\r\n            PSkuangbao4: {\r\n                audio: \"baonu\",\r\n                marktext: \"💢\",\r\n                superCharlotte: true,\r\n                trigger: {\r\n                    source: \"damageSource\",\r\n                    player: \"damageEnd\"\r\n                },\r\n                forced: true,\r\n                init: function (player) {\r\n                    player.addMark('PSkuangbao4', 2);\r\n                    player.logSkill('PSkuangbao4');\r\n                    game.log(player, '获得了两枚“暴怒”标记');\r\n                },\r\n                filter: function (event, player) {\r\n                    return event.num > 0 && player.countMark('PSkuangbao4') < 6;\r\n                },\r\n                content: function () {\r\n                    player.addMark('PSkuangbao4', 1);\r\n                },\r\n                intro: {\r\n                    name: \"暴怒\",\r\n                    content: \"mark\"\r\n                },\r\n                ai: {\r\n                    combo: \"PSshenfen4\",\r\n                    maixie: true,\r\n                    maixie_hp: true\r\n                }\r\n            },\r\n            PSshenfen4: {\r\n                audio: \"shenfen\",\r\n                enable: \"phaseUse\",\r\n                usable: 2,\r\n                filter: function (event, player) {\r\n                    return player.hasMark('PSkuangbao4');\r\n                },\r\n                content: function () {\r\n                    'step 0'\r\n                    var list = [\r\n                        '回复一点体力或令一名其他角色失去一点体力',\r\n                        '使用的下一张普通锦囊牌额外指定两名角色（【铁索连环】改为一名，若目标包括自己，则可收回锦囊牌）',\r\n                        '摸三张牌并弃置所有其他角色装备区所有牌和4张手牌',\r\n                        '所有其他角色受到一点无来源伤害，然后自己获得X个“💢”标记（X为场上已受伤角色数，至多为3）'\r\n                    ];\r\n                    var contorl = ['一个', '两个', '三个', '四个'];\r\n                    var num = player.countMark('PSkuangbao4');\r\n                    if (num < 4) {\r\n                        list = list.slice(0, num);\r\n                        contorl = contorl.slice(0, num);\r\n                    };\r\n                    player.chooseControl(contorl).set('choiceList', list).set('ai', function () {\r\n                        return get.rand(0, contorl.length);\r\n                    }).set('prompt', '神愤：请选择你要弃置的“💢”标记个数');\r\n                    'step 1'\r\n                    switch (result.index) {\r\n                        case 0:\r\n                            player.removeMark('PSkuangbao4', 1);\r\n                            if (player.hasMark('PSkuangbao4')) player.markSkill('PSkuangbao4');\r\n                            else player.unmarkSkill('PSkuangbao4');\r\n                            event.goto(2);\r\n                            break;\r\n                        case 1:\r\n                            player.removeMark('PSkuangbao4', 2);\r\n                            if (player.hasMark('PSkuangbao4')) player.markSkill('PSkuangbao4');\r\n                            else player.unmarkSkill('PSkuangbao4');\r\n                            player.addSkill('PSshenfen4_use');\r\n                            event.finish();\r\n                            break;\r\n                        case 2:\r\n                            player.removeMark('PSkuangbao4', 3);\r\n                            if (player.hasMark('PSkuangbao4')) player.markSkill('PSkuangbao4');\r\n                            else player.unmarkSkill('PSkuangbao4');\r\n                            event.goto(4);\r\n                            break;\r\n                        default:\r\n                            player.removeMark('PSkuangbao4', 4);\r\n                            event.goto(6);\r\n                    }\r\n                    'step 2'\r\n                    player.chooseTarget(1, lib.filter.notMe, '神愤：是否令一名角色失去一点体力？或点击“取消”回复一点体力', false).set('ai', function (target) {\r\n                        var att = -get.attitude(_status.event.player, target);\r\n                        return att / target.hp;\r\n                    });\r\n                    'step 3'\r\n                    if (result.bool) {\r\n                        result.targets[0].loseHp();\r\n                    }\r\n                    else player.recover();\r\n                    event.finish();\r\n                    'step 4'\r\n                    player.draw(3);\r\n                    var targets = game.filterPlayer(target => { return target != player });\r\n                    targets.sort(lib.sort.seat);\r\n                    for (var i = 0; i < targets.length; i++) {\r\n                        var num = targets[i].getCards('e').length;\r\n                        if (num) player.discardPlayerCard('e', num, targets[i], true);\r\n                    }\r\n                    event.targets = targets;\r\n                    event.num = 0;\r\n                    player.line(targets, 'green');\r\n                    'step 5'\r\n                    if (num < event.targets.length) {\r\n                        var hs = event.targets[num].getCards('h');\r\n                        if (hs.length) {\r\n                            if (hs.length <= 4) player.discardPlayerCard('h', hs.length, event.targets[num], true);\r\n                            else player.discardPlayerCard('h', 4, event.targets[num], true);\r\n                        }\r\n                        event.num++;\r\n                        event.redo();\r\n                    }\r\n                    else event.finish();\r\n                    'step 6'\r\n                    var targets = game.filterPlayer(target => { return target != player });\r\n                    targets.sort(lib.sort.seat);\r\n                    for (var i = 0; i < targets.length; i++) {\r\n                        targets[i].damage('nosource');\r\n                    }\r\n                    var num = game.countPlayer(current => { return current.isDamaged() });\r\n                    num = Math.min(3, num);\r\n                    player.addMark('PSkuangbao4', num);\r\n                    player.markSkill('PSkuangbao4');\r\n                },\r\n                subSkill: {\r\n                    use: {\r\n                        trigger: {\r\n                            player: \"useCard2\"\r\n                        },\r\n                        direct: true,\r\n                        filter: function (event, player) {\r\n                            var type = get.type(event.card);\r\n                            return type == 'trick';\r\n                        },\r\n                        content: function () {\r\n                            'step 0'\r\n                            player.removeSkill('PSshenfen4_use');\r\n                            var goon = false;\r\n                            var info = get.info(trigger.card);\r\n                            if (trigger.targets && !info.multitarget) {\r\n                                var players = game.filterPlayer();\r\n                                for (var i = 0; i < players.length; i++) {\r\n                                    if (lib.filter.targetEnabled2(trigger.card, player, players[i]) && !trigger.targets.includes(players[i])) {\r\n                                        goon = true; break;\r\n                                    }\r\n                                }\r\n                            }\r\n                            if (goon && trigger.card.name != 'tiesuo') {\r\n                                player.chooseTarget('神愤：是否额外指定一至两名' + get.translation(trigger.card) + '的目标？', [1, 2], function (card, player, target) {\r\n                                    var trigger = _status.event;\r\n                                    if (trigger.targets.includes(target)) return false;\r\n                                    return lib.filter.targetEnabled2(trigger.card, _status.event.player, target);\r\n                                }).set('ai', function (target) {\r\n                                    var trigger = _status.event.getTrigger();\r\n                                    var player = _status.event.player;\r\n                                    return get.effect(target, trigger.card, player, player);\r\n                                }).set('targets', trigger.targets).set('card', trigger.card);\r\n                            }\r\n                            if (goon && trigger.card.name == 'tiesuo') {\r\n                                player.chooseTarget('神愤：是否额外指定一名' + get.translation(trigger.card) + '的目标？', 1, function (card, player, target) {\r\n                                    var trigger = _status.event;\r\n                                    if (trigger.targets.includes(target)) return false;\r\n                                    return lib.filter.targetEnabled2(trigger.card, _status.event.player, target);\r\n                                }).set('ai', function (target) {\r\n                                    var trigger = _status.event.getTrigger();\r\n                                    var player = _status.event.player;\r\n                                    return get.effect(target, trigger.card, player, player);\r\n                                }).set('targets', trigger.targets).set('card', trigger.card);\r\n                            }\r\n                            'step 1'\r\n                            if (result.bool) {\r\n                                if (!event.isMine()) game.delayx();\r\n                                event.targets = result.targets;\r\n                            }\r\n                            else {\r\n                                event.goto(3);\r\n                            }\r\n                            'step 2'\r\n                            if (event.targets) {\r\n                                player.logSkill('PSshenfen4', event.targets);\r\n                                for (var target of event.targets) {\r\n                                    trigger.targets.add(target);\r\n                                }\r\n                            }\r\n                            'step 3'\r\n                            if (trigger.cards && trigger.cards.length && trigger.targets.includes(player)) {\r\n                                player.gain(trigger.cards);\r\n                                player.$gain2(trigger.cards);\r\n                                game.log(player, '收回了', trigger.cards);\r\n                            }\r\n                        },\r\n                        sub: true\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_shen,\r\n        translate: {\r\n            PSboss_lvbu4: \"新炼狱修罗\",\r\n            PSkuangbao4: \"狂暴\",\r\n            PSkuangbao4_info: \"锁定技，游戏开始时，你获得两枚“暴怒”标记；当你造成/受到伤害后，你获得1枚“暴怒”标记。（你的“暴怒”标记至多为6）\",\r\n            PSshenfen4: \"神愤\",\r\n            PSshenfen4_info: \"出牌阶段限两次，你可以弃置一定数量的“狂暴”标记，然后执行一项效果: <br/>一枚：你选择回复一点体力或令一名其他角色失去一点体力<br/>两枚：你使用的下一张非延时锦囊牌可额外指定两名角色为目标(铁锁连环改为增加一个目标)，若该锦囊牌的目标包括自己，你收回此牌<br/>三枚：你摸三张牌并弃置场上所有其他角色四张手牌和装备区内的所有牌<br/>四枚:所有其他角色受到一点无来源伤害，然后你获得X枚“狂暴”标记( X为场上受到伤害的角色数，以此法获得的“狂暴”标记最多为3 )\"\r\n        },\r\n        rank: rank.legend\r\n    },\r\n    PSshengui: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"shen\",\r\n            hp: 6,\r\n            skills: [\r\n                \"wushuang\",\r\n                \"PSshenqu\",\r\n                \"PSjiwu\"\r\n            ],\r\n            dieAudios: [\r\n                \"boss_lvbu1\"\r\n            ],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“神鬼高达”设计\",\r\n        skills: {\r\n            PSshenqu: {\r\n                audio: \"shenqu\",\r\n                group: \"PSshenqu2\",\r\n                trigger: {\r\n                    global: \"phaseZhunbeiBegin\"\r\n                },\r\n                filter: function (event, player) {\r\n                    return player.countCards('h') <= player.maxHp;\r\n                },\r\n                frequent: true,\r\n                content: function () {\r\n                    player.draw(2);\r\n                }\r\n            },\r\n            PSjiwu: {\r\n                derivation: [\r\n                    \"PSmn_qiangxi\",\r\n                    \"sbtieji\",\r\n                    \"decadexuanfeng\",\r\n                    \"rewansha\"\r\n                ],\r\n                audio: \"jiwu\",\r\n                enable: \"phaseUse\",\r\n                init: function () {\r\n\r\n                },\r\n                filter: function (event, player) {\r\n                    if (player.countCards('h') == 0) return false;\r\n                    if (!player.hasSkill('PSmn_qiangxi')) return true;\r\n                    if (!player.hasSkill('sbtieji')) return true;\r\n                    if (!player.hasSkill('decadexuanfeng')) return true;\r\n                    if (!player.hasSkill('rewansha')) return true;\r\n                    return false;\r\n                },\r\n                filterCard: true,\r\n                position: \"he\",\r\n                check: function (card) {\r\n                    if (get.position(card) == 'e' && _status.event.player.hasSkill('decadexuanfeng')) return 16 - get.value(card);\r\n                    return 7 - get.value(card);\r\n                },\r\n                content: function () {\r\n                    'step 0'\r\n                    var list = [];\r\n                    if (!player.hasSkill('PSmn_qiangxi')) list.push('PSmn_qiangxi');\r\n                    if (!player.hasSkill('sbtieji')) list.push('sbtieji');\r\n                    if (!player.hasSkill('decadexuanfeng')) list.push('decadexuanfeng');\r\n                    if (!player.hasSkill('rewansha')) list.push('rewansha');\r\n                    if (list.length == 1) {\r\n                        player.addTempSkill(list[0]);\r\n                        event.finish();\r\n                    }\r\n                    else {\r\n                        player.chooseControl(list, function () {\r\n                            if (list.includes('decadexuanfeng') && player.countCards('he', { type: 'equip' })) return 'decadexuanfeng';\r\n                            if (!player.getStat().skill.PSmn_qiangxix) {\r\n                                if (player.hasSkill('PSmn_qiangxi') && player.getEquip(1) && list.includes('decadexuanfeng')) return 'decadexuanfeng';\r\n                                if (list.includes('rewansha') || list.includes('PSmn_qiangxi')) {\r\n                                    var players = game.filterPlayer();\r\n                                    for (var i = 0; i < players.length; i++) {\r\n                                        if (players[i].hp == 1 && get.attitude(player, players[i]) < 0) {\r\n                                            if (list.includes('rewansha')) return 'rewansha';\r\n                                            if (list.includes('PSmn_qiangxi')) return 'PSmn_qiangxi';\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                            if (list.includes('PSmn_qiangxi')) return 'PSmn_qiangxi';\r\n                            if (list.includes('rewansha')) return 'rewansha';\r\n                            if (list.includes('decadexuanfeng')) return 'decadexuanfeng';\r\n                            return 'sbtieji';\r\n                        }).set('prompt', '选择获得一项技能直到回合结束');\r\n                    }\r\n                    'step 1'\r\n                    player.addTempSkill(result.control);\r\n                    player.popup(get.translation(result.control));\r\n                },\r\n                ai: {\r\n                    order: function () {\r\n                        var player = _status.event.player;\r\n                        if (player.countCards('e', { type: 'equip' })) return 10;\r\n                        if (!player.getStat().skill.PSmn_qiangxix) {\r\n                            if (player.hasSkill('PSmn_qiangxi') && player.getEquip(1) && !player.hasSkill('decadexuanfeng')) return 10;\r\n                            if (player.hasSkill('rewansha')) return 1;\r\n                            var players = game.filterPlayer();\r\n                            for (var i = 0; i < players.length; i++) {\r\n                                if (players[i].hp == 1 && get.attitude(player, players[i]) < 0) return 10;\r\n                            }\r\n                        }\r\n                        return 1;\r\n                    },\r\n                    result: {\r\n                        player: function (player) {\r\n                            if (player.countCards('e', { type: 'equip' })) return 1;\r\n                            if (!player.getStat().skill.PSmn_qiangxix) {\r\n                                if (player.hasSkill('PSmn_qiangxi') && player.getEquip(1) && !player.hasSkill('decadexuanfeng')) return 1;\r\n                                if (!player.hasSkill('rewansha') || !player.hasSkill('PSmn_qiangxi')) {\r\n                                    var players = game.filterPlayer();\r\n                                    for (var i = 0; i < players.length; i++) {\r\n                                        if (players[i].hp == 1 && get.attitude(player, players[i]) < 0) return 1;\r\n                                    }\r\n                                }\r\n                            }\r\n                            return 0;\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            PSmn_qiangxi: {\r\n                audio: \"qiangxi_boss_lvbu3\",\r\n                group: \"PSmn_qiangxi_damage\",\r\n                trigger: {\r\n                    global: \"damageBegin2\"\r\n                },\r\n                filter: function (event, player) {\r\n                    return event.player != player && player.countCards('he', { type: 'equip' }) > 0;\r\n                },\r\n                direct: true,\r\n                content: function () {\r\n                    'step 0'\r\n                    player.chooseToDiscard('he', get.prompt('PSmn_qiangxi', trigger.player), '弃置一张装备牌并令此伤害+1', function (card) {\r\n                        return get.type(card) == 'equip';\r\n                    }).set('goon', get.damageEffect(trigger.player, player, player) > 0).set('ai', function (card) {\r\n                        if (_status.event.goon) return 12 - get.value(card);\r\n                        return 0;\r\n                    });\r\n                    'step 1'\r\n                    if (result.bool) trigger.num++;\r\n                },\r\n                ai: {\r\n                    expose: 0.25\r\n                },\r\n                subSkill: {\r\n                    damage: {\r\n                        audio: \"qiangxi_boss_lvbu3\",\r\n                        enable: \"phaseUse\",\r\n                        filter: function (event, player) {\r\n                            return game.hasPlayer(function (target) {\r\n                                return player.inRange(target) && !target.hasSkill('PSmn_qiangxi_used');\r\n                            });\r\n                        },\r\n                        filterTarget: function (card, player, target) {\r\n                            if (player == target) return false;\r\n                            if (target.hasSkill('PSmn_qiangxi_used')) return false;\r\n                            return player.inRange(target);\r\n                        },\r\n                        prompt: \"失去1点体力并摸一张牌，对一名其他角色造成1点伤害\",\r\n                        content: function () {\r\n                            'step 0'\r\n                            player.loseHp();\r\n                            player.draw();\r\n                            'step 1'\r\n                            target.addTempSkill('PSmn_qiangxi_used');\r\n                            target.damage();\r\n                        },\r\n                        ai: {\r\n                            order: 8.5,\r\n                            result: {\r\n                                target: function (player, target) {\r\n                                    //主公内奸矜持，其他身份当疯狗\r\n                                    var bool = (lib.translate[player.identity] == '主' || lib.translate[player.identity] == '内' || (get.mode() == 'identity' && player.hasSkill('olzaowang2') && lib.translate[player.identity] != 'nei'));\r\n                                    if (bool && target.hp - player.hp > 1) return 0;\r\n                                    if (!bool && player.hp < 2 && !player.countCards('hs', { name: ['tao', 'jiu'] })) return 0;\r\n                                    return -1;\r\n                                }\r\n                            }\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    used: {\r\n                        charlotte: true,\r\n                        sub: true\r\n                    }\r\n                }\r\n            },\r\n            PSshenqu2: {\r\n                trigger: {\r\n                    player: \"damageAfter\"\r\n                },\r\n                direct: true,\r\n                filter: function (event, player) {\r\n                    return player.hasSkillTag('respondTao') || player.countCards('h', 'tao') > 0;\r\n                },\r\n                content: function () {\r\n                    player.chooseToUse({ name: 'tao' }, '神躯：是否使用一张桃？').logSkill = 'shenqu';\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_shen,\r\n        translate: {\r\n            PSshengui: \"PS神鬼无前\",\r\n            PSshenqu: \"神躯\",\r\n            PSshenqu_info: \"每名角色的准备阶段，若你的手牌数少于或等于你的体力上限数，你可以摸两张牌；当你受到伤害后，你可以使用一张【桃】。\",\r\n            PSjiwu: \"极武\",\r\n            PSjiwu_info: \"出牌阶段，你可以弃置一张牌，然后选择获得【强袭】、【铁骑】、【旋风】、【完杀】中的一项技能直到回合结束。\",\r\n            PSmn_qiangxi: \"强袭\",\r\n            PSmn_qiangxi_info: \"出牌阶段对每名其他角色限一次，你可以失去1点体力并摸一张牌，对你攻击范围内的一名其他角色造成1点伤害；其他角色受到伤害时，你可以弃置一张装备牌并令伤害值+1。\"\r\n        },\r\n        rank: rank.epic\r\n    },\r\n    PSzhangrang: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"qun\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PStaoluan\"\r\n            ],\r\n            isAiForbidden: true,\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“一顿七只屑狐狸”设计\",\r\n        skills: {\r\n            PStaoluan: {\r\n                audio: \"taoluan\",\r\n                enable: [\r\n                    \"chooseToUse\",\r\n                    \"chooseToRespond\"\r\n                ],\r\n                filter: function (event, player) {\r\n                    if (!player.countCards('hse')) return false;\r\n                    for (var i of lib.inpile) {\r\n                        var type = get.type2(i);\r\n                        if ((type == 'basic' || type == 'trick') && event.filterCard({ name: i }, player, event)) return true;\r\n                    }\r\n                    return false;\r\n                },\r\n                init: function (player) {\r\n                    if (!player.storage.PStaoluan) player.storage.PStaoluan = [];\r\n                },\r\n                chooseButton: {\r\n                    dialog: function (event, player) {\r\n                        var list = [];\r\n                        for (var i = 0; i < lib.inpile.length; i++) {\r\n                            var name = lib.inpile[i];\r\n                            if (player.storage.PStaoluan && player.storage.PStaoluan.includes(name)) continue;\r\n                            if (name == 'sha') {\r\n                                if (event.filterCard({ name: name }, player, event)) list.push(['基本', '', 'sha']);\r\n                                for (var j of lib.inpile_nature) {\r\n                                    if (event.filterCard({ name: name, nature: j }, player, event)) list.push(['基本', '', 'sha', j]);\r\n                                }\r\n                            }\r\n                            else if (get.type2(name) == 'trick' && event.filterCard({ name: name }, player, event)) list.push(['锦囊', '', name]);\r\n\r\n                            else if (get.type(name) == 'basic' && event.filterCard({ name: name }, player, event)) list.push(['基本', '', name]);\r\n                        }\r\n                        return ui.create.dialog('滔乱', [list, 'vcard']);\r\n                    },\r\n                    filter: function (button, player) {\r\n                        return _status.event.getParent().filterCard({ name: button.link[2] }, player, _status.event.getParent());\r\n                    },\r\n                    check: function (button) {\r\n                        if (_status.event.getParent().type != 'phase') return 1;\r\n                        var player = _status.event.player;\r\n                        if (['wugu', 'zhulu_card', 'yiyi', 'lulitongxin', 'lianjunshengyan', 'diaohulishan'].includes(button.link[2])) return 0;\r\n                        return player.getUseValue({\r\n                            name: button.link[2],\r\n                            nature: button.link[3],\r\n                        });\r\n                    },\r\n                    backup: function (links, player) {\r\n                        return {\r\n                            filterCard: true,\r\n                            audio: 'taoluan',\r\n                            popname: true,\r\n                            check: function (card) {\r\n                                return 8 - get.value(card);\r\n                            },\r\n                            position: 'hse',\r\n                            viewAs: { name: links[0][2], nature: links[0][3] },\r\n                            onuse: function (result, player) {\r\n                                player.storage.PStaoluan.add(result.card.name);\r\n                            },\r\n                        }\r\n                    },\r\n                    prompt: function (links, player) {\r\n                        return '将一张牌当做' + (get.translation(links[0][3]) || '') + get.translation(links[0][2]) + '使用';\r\n                    }\r\n                },\r\n                hiddenCard: function (player, name) {\r\n                    if (!lib.inpile.includes(name)) return false;\r\n                    var type = get.type2(name);\r\n                    return (type == 'basic' || type == 'trick') && player.countCards('she') > 0\r\n                },\r\n                ai: {\r\n                    fireAttack: true,\r\n                    respondSha: true,\r\n                    respondShan: true,\r\n                    skillTagFilter: function (player) {\r\n                        if (!player.countCards('hse')) return false;\r\n                    },\r\n                    order: 1,\r\n                    result: {\r\n                        player: function (player) {\r\n                            if (_status.event.dying) return get.attitude(player, _status.event.dying);\r\n                            return 1;\r\n                        }\r\n                    }\r\n                },\r\n                group: [\r\n                    \"PStaoluan_draw\",\r\n                    \"PStaoluan_clear\"\r\n                ],\r\n                subSkill: {\r\n                    draw: {\r\n                        trigger: {\r\n                            player: [\r\n                                \"useCardAfter\",\r\n                                \"respondAfter\"\r\n                            ]\r\n                        },\r\n                        forced: true,\r\n                        charlotte: true,\r\n                        popup: false,\r\n                        filter: function (event, player) {\r\n                            return event.skill == 'PStaoluan_backup';\r\n                        },\r\n                        content: function () {\r\n                            player.draw();\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    clear: {\r\n                        trigger: {\r\n                            global: \"phaseJieshuEnd\"\r\n                        },\r\n                        forced: true,\r\n                        charlotte: true,\r\n                        popup: false,\r\n                        filter: function (event, player) {\r\n                            return player.storage.PStaoluan;\r\n                        },\r\n                        content: function () {\r\n                            player.storage.PStaoluan = [];\r\n                        },\r\n                        sub: true\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_qun,\r\n        translate: {\r\n            PSzhangrang: \"PS张让\",\r\n            PStaoluan: \"滔乱\",\r\n            PStaoluan_info: \"每回合每种牌名限一次，你可以将一张牌当做任意一张基本牌或锦囊牌使用或打出，然后你摸一张牌。\"\r\n        },\r\n        rank: rank.epic\r\n    },\r\n    PSxizhicai: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"wei\",\r\n            hp: 3,\r\n            skills: [\r\n                \"tiandu\",\r\n                \"PSxianfu\",\r\n                \"PSchouce\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“九个芒果”设计\",\r\n        skills: {\r\n            PSxianfu: {\r\n                trigger: {\r\n                    global: [\r\n                        \"phaseBefore\",\r\n                        \"dieAfter\"\r\n                    ],\r\n                    player: \"enterGame\"\r\n                },\r\n                forced: true,\r\n                filter: function (event, player) {\r\n                    if (event.name == 'die') return !player.storage.PSxianfu_target.length;\r\n                    return game.players.length > 1 && (event.name != 'phase' || game.phaseNumber == 0);\r\n                },\r\n                audio: \"xianfu\",\r\n                content: function () {\r\n                    'step 0'\r\n                    player.chooseTarget('请选择【先辅】的目标', lib.skill.PSxianfu_info, true, function (card, player, target) {\r\n                        return target != player && (!player.storage.PSxianfu_target || !player.storage.PSxianfu_target.includes(target));\r\n                    }).set('ai', function (target) {\r\n                        var att = get.attitude(_status.event.player, target);\r\n                        if (att > 0) return att + 1;\r\n                        if (att == 0) return Math.random();\r\n                        return att;\r\n                    }).animate = false;\r\n                    'step 1'\r\n                    if (result.bool) {\r\n                        var target = result.targets[0];\r\n                        if (!player.storage.PSxianfu_target) player.storage.PSxianfu_target = [];\r\n                        player.storage.PSxianfu_target.push(target);\r\n                        player.addSkill('PSxianfu_target');\r\n                    }\r\n                },\r\n                group: [\r\n                    \"PSxianfu_target\",\r\n                    \"PSxianfu_lose\"\r\n                ],\r\n                subSkill: {\r\n                    target: {\r\n                        audio: \"xianfu\",\r\n                        charlotte: true,\r\n                        trigger: {\r\n                            global: [\r\n                                \"damageEnd\",\r\n                                \"recoverEnd\",\r\n                                \"gainEnd\",\r\n                                \"loseEnd\"\r\n                            ]\r\n                        },\r\n                        forced: true,\r\n                        filter: function (event, player) {\r\n                            if (event.player.isDead() || !player.storage.PSxianfu_target || !player.storage.PSxianfu_target.includes(event.player) || event.num <= 0) return false;\r\n                            if (event.name == 'gain') return event.getParent().name == 'draw';\r\n                            if (event.name == 'lose') return event.type == 'discard';\r\n                            if (event.name == 'recover') return player.isDamaged();\r\n                            return true;\r\n                        },\r\n                        logTarget: \"player\",\r\n                        content: function () {\r\n                            'step 0'\r\n                            var target = trigger.player;\r\n                            if (!target.storage.PSxianfu_mark) target.storage.PSxianfu_mark = [];\r\n                            target.storage.PSxianfu_mark.add(player);\r\n                            target.storage.PSxianfu_mark.sortBySeat();\r\n                            target.markSkill('PSxianfu_mark');\r\n                            game.delayx();\r\n                            'step 1'\r\n                            if (['damage', 'recover'].includes(trigger.name)) player[trigger.name](trigger.num, 'nosource');\r\n                            if (trigger.name == 'gain') player.draw(trigger.cards.length);\r\n                            if (trigger.name == 'lose') player.chooseToDiscard('he', trigger.cards.length, true);\r\n                        },\r\n                        onremove: function (player) {\r\n                            if (!player.storage.PSxianfu_target) return;\r\n                            game.countPlayer(function (current) {\r\n                                if (player.storage.PSxianfu_target.includes(current) && current.storage.PSxianfu_mark) {\r\n                                    current.storage.PSxianfu_mark.remove(player);\r\n                                    if (!current.storage.PSxianfu_mark.length) current.unmarkSkill('PSxianfu_mark');\r\n                                    else current.markSkill('PSxianfu_mark');\r\n                                }\r\n                            });\r\n                            delete player.storage.PSxianfu_target;\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    mark: {\r\n                        marktext: \"先辅\",\r\n                        intro: {\r\n                            name: \"先辅\",\r\n                            content: \"当你受到伤害/回复体力/摸牌/弃牌后，$受到等量的伤害/回复等量的体力/摸等量的牌/弃置等量的牌\"\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    lose: {\r\n                        trigger: {\r\n                            global: \"dieBegin\"\r\n                        },\r\n                        silent: true,\r\n                        filter: function (event, player) {\r\n                            return event.player == player || player.storage.PSxianfu_target && player.storage.PSxianfu_target.includes(event.player);\r\n                        },\r\n                        content: function () {\r\n                            if (player == trigger.player) lib.skill.PSxianfu_target.onremove(player);\r\n                            else player.storage.PSxianfu_target.remove(trigger.player);\r\n                        },\r\n                        forced: true,\r\n                        popup: false,\r\n                        sub: true\r\n                    }\r\n                }\r\n            },\r\n            PSchouce: {\r\n                audio: \"chouce\",\r\n                trigger: {\r\n                    player: \"damageEnd\"\r\n                },\r\n                content: function () {\r\n                    'step 0'\r\n                    event.num = trigger.num;\r\n                    'step 1'\r\n                    player.judge();\r\n                    'step 2'\r\n                    event.color = result.color;\r\n                    if (event.color == 'black') {\r\n                        if (game.hasPlayer(function (current) {\r\n                            return current.countDiscardableCards(player, 'hej') > 0;\r\n                        })) player.chooseTarget('弃置一名角色区域内的一张牌', function (card, player, target) {\r\n                            return target.countDiscardableCards(player, 'hej');\r\n                        }, true).set('ai', function (target) {\r\n                            var player = _status.event.player;\r\n                            var att = get.attitude(player, target);\r\n                            if (att < 0) {\r\n                                att = -Math.sqrt(-att);\r\n                            }\r\n                            else {\r\n                                att = Math.sqrt(att);\r\n                            }\r\n                            return att * lib.card.guohe.ai.result.target(player, target);\r\n                        });\r\n                        else event.finish();\r\n                    }\r\n                    else {\r\n                        var next = player.chooseTarget('令一名角色摸一张牌');\r\n                        if (player.storage.PSxianfu_target && player.storage.PSxianfu_target.length) {\r\n                            next.set('prompt2', '（若目标为' + get.translation(player.storage.PSxianfu_target) + '则改为摸两张牌）');\r\n                        }\r\n                        next.set('ai', function (target) {\r\n                            var player = _status.event.player;\r\n                            var att = get.attitude(player, target) / Math.sqrt(1 + target.countCards('h'));\r\n                            if (target.hasSkillTag('nogain')) att /= 10;\r\n                            if (player.storage.PSxianfu_target && player.storage.PSxianfu_target.includes(target)) return att * 2;\r\n                            return att;\r\n                        })\r\n                    }\r\n                    'step 3'\r\n                    if (result.bool) {\r\n                        var target = result.targets[0];\r\n                        player.line(target, 'green');\r\n                        if (event.color == 'black') {\r\n                            player.discardPlayerCard(target, 'hej', true);\r\n                        }\r\n                        else {\r\n                            if (player.storage.PSxianfu_target && player.storage.PSxianfu_target.includes(target)) {\r\n                                if (!target.storage.PSxianfu_mark) target.storage.PSxianfu_mark = [];\r\n                                target.storage.PSxianfu_mark.add(player);\r\n                                target.storage.PSxianfu_mark.sortBySeat();\r\n                                target.markSkill('PSxianfu_mark');\r\n                                target.draw(2);\r\n                            }\r\n                            else {\r\n                                target.draw();\r\n                            }\r\n                        }\r\n                    }\r\n                    'step 4'\r\n                    if (--event.num > 0) {\r\n                        player.chooseBool(get.prompt2('chouce'));\r\n                    }\r\n                    else {\r\n                        event.finish();\r\n                    }\r\n                    'step 5'\r\n                    if (result.bool) {\r\n                        player.logSkill('chouce');\r\n                        event.goto(1);\r\n                    }\r\n                },\r\n                ai: {\r\n                    maixie: true,\r\n                    maixie_hp: true,\r\n                    effect: {\r\n                        target: function (card, player, target) {\r\n                            if (get.tag(card, 'damage')) {\r\n                                if (player.hasSkillTag('jueqing', false, target)) return [1, -2];\r\n                                if (!target.hasFriend()) return;\r\n                                if (target.hp >= 4) return [1, get.tag(card, 'damage') * 1.5];\r\n                                if (target.hp == 3) return [1, get.tag(card, 'damage') * 1];\r\n                                if (target.hp == 2) return [1, get.tag(card, 'damage') * 0.5];\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_wei,\r\n        translate: {\r\n            PSxizhicai: \"PS戏志才\",\r\n            PSxianfu: \"先辅\",\r\n            PSxianfu_info: \"锁定技，游戏开始时，你选择一名其他角色，当其受到伤害/回复体力/摸牌/弃牌后，你受到等量的伤害/回复等量的体力/摸等量的牌/弃置等量的牌。〖先辅〗角色死亡后，你重新选择一名〖先辅〗角色。\",\r\n            PSchouce: \"筹策\",\r\n            PSchouce_info: \"当你受到1点伤害后，你可以判定，若结果为：黑色，你弃置一名角色区域里的一张牌；红色，你选择一名角色，其摸一张牌，若其是〖先辅〗选择的角色，改为其摸两张牌。\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PSxiahoujie: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"wei\",\r\n            hp: 5,\r\n            skills: [\r\n                \"PSdanda\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“你想去哪儿呢”设计\",\r\n        skills: {\r\n            PSdanda: {\r\n                audio: \"liedan\",\r\n                trigger: {\r\n                    global: \"phaseZhunbeiBegin\"\r\n                },\r\n                forced: true,\r\n                filter: function (event, player) {\r\n                    return player != event.player;\r\n                },\r\n                logTarget: \"player\",\r\n                content: function () {\r\n                    var num = 0;\r\n                    if (player.hp > trigger.player.hp) num++;\r\n                    if (player.countCards('h') > trigger.player.countCards('h')) num++;\r\n                    if (player.countCards('e') > trigger.player.countCards('e')) num++;\r\n                    if (num) {\r\n                        player.draw(num);\r\n                        if (num == 3) player.gainMaxHp();\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_wei,\r\n        translate: {\r\n            PSxiahoujie: \"PS夏侯杰\",\r\n            PSdanda: \"胆大\",\r\n            PSdanda_info: \"锁定技，其他角色的准备阶段，你与其依次比较双方的手牌数，体力值与装备区牌数，你每有一项大于该角色则摸一张牌。 若均大于该角色，你加1点体力上限。\"\r\n        },\r\n        rank: rank.epic\r\n    },\r\n    PSqun_sunce: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"qun\",\r\n            hp: 4,\r\n            maxHp: 5,\r\n            skills: [\r\n                \"PSxiaozhan\",\r\n                \"PSzengxi\"\r\n            ],\r\n            dieAudios: [\r\n                \"re_sunben\"\r\n            ],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“咏雪雪”设计\",\r\n        skills: {\r\n            PSxiaozhan: {\r\n                audio: \"jiang\",\r\n                trigger: {\r\n                    source: \"damageEnd\"\r\n                },\r\n                frequent: true,\r\n                filter: function (event, player) {\r\n                    return event.card && event.card.name == 'sha';\r\n                },\r\n                intro: {\r\n                    name: \"骁战\",\r\n                    content: \"本回合【杀】使用次数+#\"\r\n                },\r\n                init: function (player) {\r\n                    if (!player.storage.PSxiaozhan) player.storage.PSxiaozhan = 0;\r\n                },\r\n                content: function () {\r\n                    player.storage.PSxiaozhan += trigger.num;\r\n                    player.draw(trigger.num);\r\n                    player.addTempSkill('PSxiaozhan_use');\r\n                    player.markSkill('PSxiaozhan');\r\n                    player.syncStorage('PSxiaozhan');\r\n                },\r\n                group: [\r\n                    \"PSxiaozhan_clear\",\r\n                    \"PSxiaozhan_kill\"\r\n                ],\r\n                subSkill: {\r\n                    use: {\r\n                        mod: {\r\n                            cardUsable: function (card, player, num) {\r\n                                if (card.name == 'sha') return num + player.storage.PSxiaozhan;\r\n                            }\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    clear: {\r\n                        trigger: {\r\n                            player: \"phaseUseEnd\"\r\n                        },\r\n                        charlotte: true,\r\n                        forced: true,\r\n                        silent: true,\r\n                        content: function () {\r\n                            player.storage.PSxiaozhan = 0;\r\n                        },\r\n                        sub: true,\r\n                        popup: false\r\n                    },\r\n                    kill: {\r\n                        audio: \"jiang\",\r\n                        trigger: {\r\n                            source: \"dieAfter\"\r\n                        },\r\n                        frequent: true,\r\n                        filter: function (event, player) {\r\n                            return player.countCards('h') < player.maxHp;\r\n                        },\r\n                        content: function () {\r\n                            player.drawTo(player.maxHp);\r\n                        },\r\n                        sub: true\r\n                    }\r\n                }\r\n            },\r\n            PSzengxi: {\r\n                skillAnimation: true,\r\n                animationColor: \"wood\",\r\n                audio: \"hunzi\",\r\n                juexingji: true,\r\n                animationStr: \"赠玺\",\r\n                derivation: \"PShuju\",\r\n                unique: true,\r\n                trigger: {\r\n                    player: \"phaseZhunbeiBegin\"\r\n                },\r\n                filter: function (event, player) {\r\n                    return player.countCards('e') >= 2 && !player.storage.PSzengxi;\r\n                },\r\n                forced: true,\r\n                content: function () {\r\n                    'step 0'\r\n                    player.gainMaxHp();\r\n                    player.recover();\r\n                    player.awakenSkill(event.name);\r\n                    player.storage[event.name] = true;\r\n                    player.chooseTarget('赠玺：选择一名其他角色，你交给他装备区所有牌，他交给你一半手牌（向下取整）', 1, true).set('filterTarget', function (card, player, target) {\r\n                        return target != player;\r\n                    }).set('ai', function (target) {\r\n                        var player = _status.event.player; if (player.countCards('e') > target.countCards('h') && get.attitude(player, target) > 0) return 2;\r\n                        if (player.countCards('e') > target.countCards('h') && get.attitude(player, target) <= 0) return -1;\r\n                        if (player.countCards('e') < target.countCards('h') && get.attitude(player, target) <= 0) return 3;\r\n                        if (player.countCards('e') < target.countCards('h') && get.attitude(player, target) > 0) return 1;\r\n                        return 0;\r\n                    });\r\n                    'step 1'\r\n                    if (result.bool) {\r\n                        event.target = result.targets[0];\r\n                        player.give(player.getCards('e'), event.target);\r\n                    }\r\n                    'step 2'\r\n                    var num = Math.floor(event.target.countCards('h') / 2);\r\n                    event.target.chooseCard(num, true).set('prompt', '赠玺：请将' + get.cnNumber(num) + '张手牌交给' + get.translation(player));\r\n                    'step 3'\r\n                    if (result.cards) {\r\n                        event.target.give(result.cards, player);\r\n                    }\r\n                    'step 4'\r\n                    player.addSkills('PShuju');\r\n                }\r\n            },\r\n            PShuju: {\r\n                mod: {\r\n                    targetInRange: function (card, player, target, now) {\r\n                        return true;\r\n                    }\r\n                },\r\n                audio: \"reyingzi\",\r\n                audioname2: {\r\n                    PSqun_sunce: \"reyingzi_sunce\"\r\n                },\r\n                enable: \"phaseUse\",\r\n                filter: function (event, player) {\r\n                    return player.maxHp > 0;\r\n                },\r\n                content: function () {\r\n                    if (player.isDamaged()) player.draw(player.maxHp - player.hp);\r\n                    player.loseMaxHp();\r\n                    player.addTempSkill(\"PShuju_base\");\r\n                },\r\n                subSkill: {\r\n                    base: {\r\n                        trigger: {\r\n                            player: \"useCard\"\r\n                        },\r\n                        forced: true,\r\n                        filter: function (event, player) {\r\n                            return event.baseDamage && player.getStat().skill.PShuju;\r\n                        },\r\n                        content: function () {\r\n                            if (player.getStat().skill.PShuju > 0) trigger.baseDamage += player.getStat().skill.PShuju;\r\n                        },\r\n                        sub: true\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_qun,\r\n        translate: {\r\n            PSqun_sunce: \"PS群孙策\",\r\n            PSxiaozhan: \"骁战\",\r\n            PSxiaozhan_info: \"当你使用【杀】造成伤害后，你摸X张牌且当前回合使用【杀】次数+X（X为此【杀】造成的伤害数），每当你击杀一名角色时你将手牌数摸至体力上限。\",\r\n            PSzengxi: \"赠玺\",\r\n            PSzengxi_info: \"觉醒技，准备阶段，若你装备区的牌数不少于2，你加一点体力上限并回复一点体力，将装备区的所有牌交给一名其他角色，其将一半手牌（向下取整）交给你，然后你获得技能〖虎踞〗。\",\r\n            PShuju: \"虎踞\",\r\n            PShuju_info: \"你使用牌无距离限制。出牌阶段，你可以摸等同于自身已损失体力值的牌，然后减一点体力上限，本回合使用牌的伤害基数和回复基数+1。\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PSgaoguimingmen: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"qun\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PSluansha\"\r\n            ],\r\n            dieAudios: [\r\n                \"xin_yuanshao\"\r\n            ],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“希神文祖华”设计\",\r\n        skills: {\r\n            PSluansha: {\r\n                audio: \"olxueyi\",\r\n                trigger: {\r\n                    player: \"useCardAfter\"\r\n                },\r\n                forced: true,\r\n                filter: function (event, player) {\r\n                    return event.targets.length && !player.hasHistory('sourceDamage', function (evt) {\r\n                        return evt.card == event.card;\r\n                    });\r\n                },\r\n                content: function () {\r\n                    player.draw(trigger.targets.length);\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_qun,\r\n        translate: {\r\n            PSgaoguimingmen: \"高贵名门\",\r\n            PSluansha: \"乱杀\",\r\n            PSluansha_info: \"锁定技，当你使用牌结算后，若此牌没有造成伤害，你摸等同于此牌目标数的牌。\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PSsishouyige: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"qun\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PShengce\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“10万原石”设计\",\r\n        skills: {\r\n            PShengce: {\r\n                trigger: {\r\n                    player: \"phaseZhunbeiBegin\"\r\n                },\r\n                priority: 1,\r\n                frequent: true,\r\n                filter: function (event, player) {\r\n                    return true;\r\n                },\r\n                content: function () {\r\n                    'step 0'\r\n                    var choiceList = [\r\n                        '对一名角色造成两点伤害',\r\n                        '令一名角色摸四张牌',\r\n                        '令一名角色弃四张牌',\r\n                        '获得一名角色两张牌',\r\n                        '令一名角色回复两点体力',\r\n                        '令一名角色增加两点体力上限'\r\n                    ];\r\n                    player.chooseControl().set('choiceList', choiceList).set('ai', function () {\r\n                        var num = choiceList.length - 1;\r\n                        return get.rand(0, num);\r\n                    }).set('prompt', '衡策：请选择一项');\r\n                    'step 1'\r\n                    switch (result.control) {\r\n                        case '选项一':\r\n                            event.goto(2);\r\n                            break;\r\n                        case '选项二':\r\n                            event.goto(4);\r\n                            break;\r\n                        case '选项三':\r\n                            event.goto(6);\r\n                            break;\r\n                        case '选项四':\r\n                            event.goto(8);\r\n                            break;\r\n                        case '选项五':\r\n                            event.goto(10);\r\n                            break;\r\n                        default:\r\n                            event.goto(12);\r\n                    }\r\n                    'step 2'\r\n                    player.chooseTarget('衡策：对一名角色造成两点伤害', 1, false).set('ai', function (target) {\r\n                        var player = _status.event.player;\r\n                        if (get.attitude(player, target) < 0) return 5;\r\n                        return 0;\r\n                    });\r\n                    'step 3'\r\n                    if (result.targets) {\r\n                        player.line(result.targets[0], 'fire');\r\n                        result.targets[0].damage(2, 'nocard', player);\r\n                        game.playSkillAudio('xinfu_langxi');\r\n                        event.finish();\r\n                    }\r\n                    else event.finish();\r\n                    'step 4'\r\n                    player.chooseTarget('衡策：令一名角色摸四张牌', 1, false).set('ai', function (target) {\r\n                        var player = _status.event.player;\r\n                        if (get.attitude(player, target) > 0) return 5;\r\n                        return 0;\r\n                    });\r\n                    'step 5'\r\n                    if (result.targets) {\r\n                        player.line(result.targets[0], 'green');\r\n                        result.targets[0].draw(4);\r\n                        game.playSkillAudio('shuliang');\r\n                        event.finish();\r\n                    }\r\n                    else event.finish();\r\n                    'step 6'\r\n                    player.chooseTarget('衡策：令一名角色弃四张牌', 1, false).set('filterTarget', function (card, player, target) {\r\n                        return target.countCards('he') > 0;\r\n                    }).set('ai', function (target) {\r\n                        var player = _status.event.player;\r\n                        if (get.attitude(player, target) < 0) return 5;\r\n                        return 0;\r\n                    });\r\n                    'step 7'\r\n                    if (result.targets) {\r\n                        player.line(result.targets[0], 'fire');\r\n                        var target = result.targets[0];\r\n                        if (target.countCards('he') <= 4) target.discard(target.getCards('he'));\r\n                        else target.chooseToDiscard(4, true);\r\n                        game.playSkillAudio('remieji');\r\n                        event.finish();\r\n                    }\r\n                    else event.finish();\r\n                    'step 8'\r\n                    player.chooseTarget('衡策：获得一名角色两张牌', 1, false).set('filterTarget', function (card, player, target) {\r\n                        return target.countCards('he') > 0;\r\n                    }).set('ai', function (target) {\r\n                        var player = _status.event.player;\r\n                        if (get.attitude(player, target) < 0) return 5;\r\n                        return 0;\r\n                    });\r\n                    'step 9'\r\n                    if (result.targets) {\r\n                        player.line(result.targets[0], 'fire');\r\n                        var target = result.targets[0];\r\n                        if (target.countCards('he') <= 2) player.gainPlayerCard(target, true, 'he', target.countCards('he'));\r\n                        else player.gainPlayerCard(target, 2, 'he');\r\n                        game.playSkillAudio('tuxi');\r\n                        event.finish();\r\n                    }\r\n                    else event.finish();\r\n                    'step 10'\r\n                    player.chooseTarget('衡策：令一名角色回复两点体力', 1, false).set('filterTarget', function (card, player, target) {\r\n                        return target.isDamaged();\r\n                    }).set('ai', function (target) {\r\n                        var player = _status.event.player;\r\n                        if (get.attitude(player, target) > 0) return 5;\r\n                        return 0;\r\n                    });\r\n                    'step 11'\r\n                    if (result.targets) {\r\n                        player.line(result.targets[0], 'green');\r\n                        result.targets[0].recover(2);\r\n                        game.playSkillAudio('qingnang');\r\n                        event.finish();\r\n                    }\r\n                    else event.finish();\r\n                    'step 12'\r\n                    player.chooseTarget('衡策：令一名角色增加两点体力上限', 1, false).set('ai', function (target) {\r\n                        var player = _status.event.player;\r\n                        if (get.attitude(player, target) > 0) return 5;\r\n                        return 0;\r\n                    });\r\n                    'step 13'\r\n                    if (result.targets) {\r\n                        player.line(result.targets[0], 'green');\r\n                        result.targets[0].gainMaxHp(2);\r\n                        game.playSkillAudio('yongdi');\r\n                        event.finish();\r\n                    }\r\n                    else event.finish();\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_qun,\r\n        translate: {\r\n            PSsishouyige: \"四收益哥\",\r\n            PShengce: \"衡策\",\r\n            PShengce_info: \"准备阶段，你可以从以下选项中选择一项：<br/> 1.对一名角色造成两点伤害 <br/>2.令一名角色摸四张牌 <br/>3.令一名角色弃四张牌<br/> 4.获得一名角色两张牌 <br/>5.令一名角色恢复两点体力 <br/>6.令一名角色增加两点体力上限\"\r\n        },\r\n        rank: rank.epic\r\n    },\r\n    db_PSdaweiwuwang: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"wei\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PSdwww_zhiheng\",\r\n                \"PSxiangong\",\r\n                \"PScuicheng\"\r\n            ],\r\n            dieAudios: [\r\n                \"re_sunquan\"\r\n            ],\r\n            doubleGroup: [\r\n                \"wei\",\r\n                \"wu\"\r\n            ],\r\n            trashBin: []\r\n        },\r\n        filter: function (mode) {\r\n            return mode != \"guozhan\";\r\n        },\r\n        intro: \"由“眼中藏着阿卡丽”设计\",\r\n        skills: {\r\n            PSdwww_zhiheng: {\r\n                audio: \"rezhiheng\",\r\n                audioname: [\r\n                    \"shen_caopi\"\r\n                ],\r\n                enable: \"phaseUse\",\r\n                usable: 1,\r\n                content: function () {\r\n                    'step 0'\r\n                    var num = Math.max(player.countCards('h'), 1);\r\n                    player.draw(num + 1);\r\n                    player.chooseToDiscard('he', num, true);\r\n                    'step 1'\r\n                    if (result.cards) {\r\n                        var bool = [false, false];\r\n                        var list = ['trick', 'equip'];\r\n                        for (var i = 0; i < bool.length; i++) {\r\n                            for (var j = 0; j < result.cards.length; j++) {\r\n                                if ([list[i]].includes(get.type(result.cards[j], 'trick', result.cards[j].original == 'h' ? player : false))) {\r\n                                    bool[i] = true; break;\r\n                                }\r\n                            }\r\n                        }\r\n                        if (bool[0] == true && !player.hasSkill('PSdwww_zhiheng_expire')) {\r\n                            delete player.getStat('skill').PSdwww_zhiheng;\r\n                            player.addTempSkill('PSdwww_zhiheng_expire', { player: \"phaseUseEnd\" });\r\n                        }\r\n                        if (bool[1] == true && !player.hasSkill('PSdwww_zhiheng_range')) player.addTempSkill('PSdwww_zhiheng_range');\r\n                    }\r\n                },\r\n                ai: {\r\n                    order: 5\r\n                },\r\n                subSkill: {\r\n                    range: {\r\n                        mod: {\r\n                            targetInRange: function (card, player, target, now) {\r\n                                return true;\r\n                            }\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    expire: {\r\n                        charlotte: true,\r\n                        locked: true,\r\n                        sub: true\r\n                    }\r\n                }\r\n            },\r\n            PSxiangong: {\r\n                audio: \"PShuiwan\",\r\n                trigger: {\r\n                    player: \"loseAfter\",\r\n                    global: \"loseAsyncAfter\"\r\n                },\r\n                groupSkill: true,\r\n                forced: true,\r\n                silent: true,\r\n                filter: function (event, player) {\r\n                    if (!game.filterPlayer(current => { return !current.getExpansions('PSxiangong_cards').length }).length) return false;\r\n                    if (player.group != 'wei') return false;\r\n                    if (event.type != 'discard') return false;\r\n                    if (event.getParent(3).name == 'phaseDiscard') return false;\r\n                    var evt = event.getl(player);\r\n                    for (var card of evt.cards2) {\r\n                        if (get.position(card) == 'd') return true;\r\n                    }\r\n                    return false;\r\n                },\r\n                content: function () {\r\n                    \"step 0\"\r\n                    if (trigger.delay == false) game.delay();\r\n                    player.chooseTarget('将弃置的牌置于一名没有【贡】的角色武将牌上', true).set('filterTarget', function (card, player, target) {\r\n                        return !target.getExpansions('PSxiangong_cards').length;\r\n                    }).set('ai', function (target) {\r\n                        var player = _status.event.player;\r\n                        return -get.attitude(player, target);\r\n                    });\r\n                    \"step 1\"\r\n                    if (result.bool == true) {\r\n                        var cards = [], target = result.targets[0];\r\n                        var evt = trigger.getl(player);\r\n                        for (var card of evt.cards2) {\r\n                            if (get.position(card) == 'd') {\r\n                                cards.push(card);\r\n                            }\r\n                        }\r\n                        player.logSkill('PSxiangong', target);\r\n                        target.addSkill('PSxiangong_cards');\r\n                        target.addToExpansion(player, 'give', cards).gaintag.add('PSxiangong_cards');\r\n                        target.storage.xinyingshi_source = player;\r\n                    }\r\n                },\r\n                group: \"PSxiangong_damage\",\r\n                subSkill: {\r\n                    cards: {\r\n                        marktext: \"贡\",\r\n                        intro: {\r\n                            content: \"expansion\",\r\n                            markcount: \"expansion\"\r\n                        },\r\n                        onremove: function (player, skill) {\r\n                            var cards = player.getExpansions(skill);\r\n                            if (cards.length) player.loseToDiscardpile(cards);\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    damage: {\r\n                        trigger: {\r\n                            player: \"damageBegin4\"\r\n                        },\r\n                        filter: function (event, player) {\r\n                            if (event.num == 0) return false;\r\n                            return game.hasPlayer(current => { return current.getExpansions('PSxiangong_cards').length >= event.num });\r\n                        },\r\n                        direct: true,\r\n                        content: function () {\r\n                            'step 0'\r\n                            player.chooseTarget('是否将伤害转移给有“贡”的角色？', false).set('filterTarget', function (card, player, target) {\r\n                                return target.getExpansions('PSxiangong_cards').length >= trigger.num;\r\n                            }).set('ai', function (target) {\r\n                                var player = _status.event.player;\r\n                                return -get.attitude(player, target);\r\n                            });\r\n                            'step 1'\r\n                            if (result.targets) {\r\n                                var target = result.targets[0];\r\n                                player.logSkill('PSxiangong', target);\r\n                                event.target = target;\r\n                                trigger.player = target;\r\n                                target.chooseButton(['献贡：请选择你的贡品', target.getExpansions('PSxiangong_cards')], trigger.num, true);\r\n                            }\r\n                            'step 2'\r\n                            if (result.bool) {\r\n                                event.target.gain(result.links, 'gain2', 'log');\r\n                            }\r\n                        },\r\n                        sub: true\r\n                    }\r\n                },\r\n                popup: false\r\n            },\r\n            PScuicheng: {\r\n                skillAnimation: true,\r\n                animationColor: \"fire\",\r\n                audio: \"sbtongye\",\r\n                juexingji: true,\r\n                unique: true,\r\n                groupSkill: true,\r\n                trigger: {\r\n                    player: \"phaseZhunbeiBegin\"\r\n                },\r\n                filter: function (event, player) {\r\n                    if (player.group != 'wu') return false;\r\n                    return player.getAllHistory('useSkill', evt => evt.skill == 'PSdwww_zhiheng').length >= 3 && player.hasAllHistory('sourceDamage', evt => { return true });\r\n                },\r\n                forced: true,\r\n                content: function () {\r\n                    'step 0'\r\n                    player.recover();\r\n                    player.draw();\r\n                    player.awakenSkill('PScuicheng');\r\n                    'step 1'\r\n                    var list;\r\n                    if (_status.characterlist) {\r\n                        list = [];\r\n                        for (var i = 0; i < _status.characterlist.length; i++) {\r\n                            var name = _status.characterlist[i];\r\n                            if (lib.character[name][1] == 'wu' && lib.skill.PSfushi.characterList().includes(name)) list.push(name);\r\n                        }\r\n                    }\r\n                    else if (_status.connectMode) {\r\n                        list = get.charactersOL(function (i) {\r\n                            return lib.character[i][1] != 'wu' && !lib.skill.PSfushi.characterList().includes(i);\r\n                        });\r\n                    }\r\n                    else {\r\n                        list = get.gainableCharacters(function (info, i) {\r\n                            return info[1] == 'wu' && lib.skill.PSfushi.characterList().includes(i);\r\n                        });\r\n                    }\r\n                    var players = game.players.concat(game.dead);\r\n                    for (var i = 0; i < players.length; i++) {\r\n                        list.remove(players[i].name);\r\n                        list.remove(players[i].name1);\r\n                        list.remove(players[i].name2);\r\n                    }\r\n                    list.remove('WU_sunquan');\r\n                    list.remove('sunquan');\r\n                    list.remove('sb_sunquan');\r\n                    list.remove('PSsunquan');\r\n                    list.remove('PSquansun');\r\n                    list.remove('PShw_sunquan');\r\n                    list = list.randomGets(4);\r\n                    var skills = [];\r\n                    if (player.isUnderControl()) {\r\n                        game.swapPlayerAuto(player);\r\n                    }\r\n                    if (false/* lib.config.extensions && lib.config.extensions.includes('天牢令') && lib.config['extension_天牢令_enable'] && game.TLHasExt */) {\r\n                        for (var i = 0; i < list.length; i++) {\r\n                            skills[i] = (lib.character[list[i]][3] || []);\r\n                        }\r\n                        if (!list.length || !skills.length) { event.finish(); return; }\r\n                        var next = game.createEvent('chooseToFuHan');\r\n                        next.player = player;\r\n                        next.list1 = list;\r\n                        next.list2 = skills;\r\n                        next.topic = '摧城';\r\n                        next.total = 3;\r\n                        next.setContent(lib.skill.PSfushi.chooseToFuHan);\r\n                        event.finish();\r\n                        return;\r\n                    }\r\n                    for (var i of list) {\r\n                        skills.addArray(lib.character[i][3] || []);\r\n                    }\r\n                    if (!list.length || !skills.length) { event.finish(); return; }\r\n                    var switchToAuto = function () {\r\n                        _status.imchoosing = false;\r\n                        event._result = {\r\n                            bool: true,\r\n                            skills: skills.randomGets(3),\r\n                        };\r\n                        if (event.dialog) event.dialog.close();\r\n                        if (event.control) event.control.close();\r\n                    };\r\n                    var chooseButton = function (list, skills) {\r\n                        var event = _status.event;\r\n                        if (!event._result) event._result = {};\r\n                        event._result.skills = [];\r\n                        var rSkill = event._result.skills;\r\n                        var dialog = ui.create.dialog('请选择获得至多三个技能', [list, 'character'], 'hidden');\r\n                        event.dialog = dialog;\r\n                        var table = document.createElement('div');\r\n                        table.classList.add('add-setting');\r\n                        table.style.margin = '0';\r\n                        table.style.width = '100%';\r\n                        table.style.position = 'relative';\r\n                        for (var i = 0; i < skills.length; i++) {\r\n                            var td = ui.create.div('.shadowed.reduce_radius.pointerdiv.tdnode');\r\n                            td.link = skills[i];\r\n                            table.appendChild(td);\r\n                            td.innerHTML = '<span>' + get.translation(skills[i]) + '</span>';\r\n                            td.addEventListener(lib.config.touchscreen ? 'touchend' : 'click', function () {\r\n                                if (_status.dragged) return;\r\n                                if (_status.justdragged) return;\r\n                                _status.tempNoButton = true;\r\n                                setTimeout(function () {\r\n                                    _status.tempNoButton = false;\r\n                                }, 500);\r\n                                var link = this.link;\r\n                                if (!this.classList.contains('bluebg')) {\r\n                                    if (rSkill.length >= 3) return;\r\n                                    rSkill.add(link);\r\n                                    this.classList.add('bluebg');\r\n                                }\r\n                                else {\r\n                                    this.classList.remove('bluebg');\r\n                                    rSkill.remove(link);\r\n                                }\r\n                            });\r\n                        }\r\n                        dialog.content.appendChild(table);\r\n                        dialog.add('　　');\r\n                        dialog.open();\r\n\r\n                        event.switchToAuto = function () {\r\n                            event.dialog.close();\r\n                            event.control.close();\r\n                            game.resume();\r\n                            _status.imchoosing = false;\r\n                        };\r\n                        event.control = ui.create.control('ok', function (link) {\r\n                            event.dialog.close();\r\n                            event.control.close();\r\n                            game.resume();\r\n                            _status.imchoosing = false;\r\n                        });\r\n                        for (var i = 0; i < event.dialog.buttons.length; i++) {\r\n                            event.dialog.buttons[i].classList.add('selectable');\r\n                        }\r\n                        game.pause();\r\n                        game.countChoose();\r\n                    };\r\n                    if (event.isMine()) {\r\n                        chooseButton(list, skills);\r\n                    }\r\n                    else if (event.isOnline()) {\r\n                        event.player.send(chooseButton, list, skills);\r\n                        event.player.wait();\r\n                        game.pause();\r\n                    }\r\n                    else {\r\n                        switchToAuto();\r\n                    }\r\n                    'step 2'\r\n                    var map = event.result || result;\r\n                    if (map && map.skills && map.skills.length) {\r\n                        for (var i of map.skills) player.addSkills(i);\r\n                    }\r\n                    game.broadcastAll(function (list) {\r\n                        game.expandSkills(list);\r\n                        for (var i of list) {\r\n                            var info = lib.skill[i];\r\n                            if (!info) continue;\r\n                            if (!info.audioname2) info.audioname2 = {};\r\n                            info.audioname2.old_yuanshu = 'weidi';\r\n                        }\r\n                    }, map.skills);\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_db,\r\n        translate: {\r\n            db_PSdaweiwuwang: \"大魏吴王\",\r\n            PSdwww_zhiheng: \"制衡\",\r\n            PSdwww_zhiheng_info: \"出牌阶段限一次，你可以摸 X+1张牌，然后弃置 X张牌  ，若你以此法弃置的牌中包含：1．锦囊牌，本回合你可以将制衡修改为出牌阶段限两次；2．装备牌，你本回合使用牌没有距离限制。( x 为你的手牌数且最少为 1)\",\r\n            PSxiangong: \"献贡\",\r\n            PSxiangong_info: \"魏势力技，锁定技，当你不于弃牌阶段弃置牌时，你将弃置的牌置于一名没有【贡】武将上，称之为【贡】。当你受到伤害时，你选择有【贡】且【贡】数量不小于伤害值的角色，其获得等量的【贡】然后将你此伤害转移给该角色。\",\r\n            PScuicheng: \"摧城\",\r\n            PScuicheng_info: \"吴势力技，觉醒技，准备阶段开始时，若你本局游戏造成过伤害且发动过至少三次【制衡】，你恢复一点体力并摸一张牌，然后从你已开通的吴势力武将中挑选四名武将，并选择三个技能获得之。\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PShw_sunquan: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"wu\",\r\n            hp: 4,\r\n            skills: [\r\n                \"rezhiheng\",\r\n                \"PShuiwan\",\r\n                \"rejiuyuan\"\r\n            ],\r\n            dieAudios: [\r\n                \"re_sunquan\"\r\n            ],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“你想去哪儿呢”设计<br><br>你说得对，感觉不如界孙权，史诗第一，阴间质检员，在回合中找大制衡拆顺和+1马连卡距离随手打，找难的大制衡找无懈闪桃下的回合拆顺+1马打下去，对爆也是界权优。<br>思权拳，思如泉涌！👊😭👊<br>念权剑，念念不忘!!🗡😭🗡<br>界权掌，生生世世!!!✋😭✋<br>会玩、会玩、会玩！<br>璀璨中的凋零、制衡联合！😊👉👈😊<br>极冻中的炽烈、纵横捭阖！😚👦👧😚<br>虚无中的真言、容我三思！😁👍💪😁<br>冰霜中的独舞、则吴盛可期！😍👼👼😍\",\r\n        skills: {\r\n            PShuiwan: {\r\n                audio: \"ext:PS武将/audio/skill:3\",\r\n                enable: [\r\n                    \"chooseToUse\",\r\n                    \"chooseToRespond\"\r\n                ],\r\n                filter: function (event, player) {\r\n                    if (player.countCards('hes', function (card) {\r\n                        return card.hasGaintag('zhiheng');\r\n                    }) <= 0) return false;\r\n                    for (var i of lib.inpile) {\r\n                        var type = get.type2(i);\r\n                        if ((type == 'basic' || type == 'trick' || type == 'delay') && event.filterCard({ name: i }, player, event)) return true;\r\n                    }\r\n                    return false;\r\n                },\r\n                chooseButton: {\r\n                    dialog: function (event, player) {\r\n                        var list = [];\r\n                        for (var i = 0; i < lib.inpile.length; i++) {\r\n                            var name = lib.inpile[i];\r\n                            if (name == 'sha') {\r\n                                if (event.filterCard({ name: name }, player, event)) list.push(['基本', '', 'sha']);\r\n                                for (var j of lib.inpile_nature) {\r\n                                    if (event.filterCard({ name: name, nature: j }, player, event)) list.push(['基本', '', 'sha', j]);\r\n                                }\r\n                            }\r\n                            else if (get.type2(name) == 'trick' && event.filterCard({ name: name }, player, event)) list.push(['锦囊', '', name]);\r\n                            else if (get.type2(name) == 'delay' && event.filterCard({ name: name }, player, event)) list.push(['延时锦囊', '', name]);\r\n                            else if (get.type(name) == 'basic' && event.filterCard({ name: name }, player, event)) list.push(['基本', '', name]);\r\n                        }\r\n                        return ui.create.dialog('会玩', [list, 'vcard']);\r\n                    },\r\n                    filter: function (button, player) {\r\n                        return _status.event.getParent().filterCard({ name: button.link[2] }, player, _status.event.getParent());\r\n                    },\r\n                    check: function (button) {\r\n                        if (_status.event.getParent().type != 'phase') return 1;\r\n                        var player = _status.event.player;\r\n                        if (['wugu', 'zhulu_card', 'yiyi', 'lulitongxin', 'lianjunshengyan', 'diaohulishan'].includes(button.link[2])) return 0;\r\n                        return player.getUseValue({\r\n                            name: button.link[2],\r\n                            nature: button.link[3],\r\n                        });\r\n                    },\r\n                    backup: function (links, player) {\r\n                        return {\r\n                            filterCard: function (card, player) {\r\n                                return card.hasGaintag('zhiheng');\r\n                            },\r\n                            audio: 'PShuiwan',\r\n                            popname: true,\r\n                            check: function (card) {\r\n                                return 8 - get.value(card);\r\n                            },\r\n                            position: 'hse',\r\n                            viewAs: { name: links[0][2], nature: links[0][3] },\r\n\r\n                        }\r\n                    },\r\n                    prompt: function (links, player) {\r\n                        return '将一张牌当做' + (get.translation(links[0][3]) || '') + get.translation(links[0][2]) + '使用';\r\n                    }\r\n                },\r\n                hiddenCard: function (player, name) {\r\n                    if (!lib.inpile.includes(name)) return false;\r\n                    var type = get.type2(name);\r\n                    return (type == 'basic' || type == 'trick' || type == 'delay') && player.countCards('hes', function (card) {\r\n                        return card.hasGaintag('zhiheng');\r\n                    }) > 0;\r\n                },\r\n                ai: {\r\n                    combo: \"PShw_zhiheng\",\r\n                    fireAttack: true,\r\n                    respondSha: true,\r\n                    respondShan: true,\r\n                    skillTagFilter: function (player) {\r\n                        if (player.countCards('hes', function (card) {\r\n                            return card.hasGaintag('zhiheng');\r\n                        }) <= 0) return false;\r\n                    },\r\n                    order: 1,\r\n                    result: {\r\n                        player: function (player) {\r\n                            if (_status.event.dying) return get.attitude(player, _status.event.dying);\r\n                            return 1;\r\n                        }\r\n                    }\r\n                },\r\n                group: \"PShuiwan_tag\",\r\n                subSkill: {\r\n                    tag: {\r\n                        trigger: {\r\n                            player: \"gainAfter\"\r\n                        },\r\n                        forced: true,\r\n                        filter: function (event, player) {\r\n                            var name = ['rezhiheng', 'zhiheng', 'PSzhiheng', 'PSzhiheng_else', 'ymzhiheng', 'minizhiheng', 'minirezhiheng', 'xinzhiheng', 'sbzhiheng'];\r\n                            for (var i = 0; i < name.length; i++) {\r\n                                if (event.getParent(2).name == name[i]) return true;\r\n                            }\r\n                            return false;\r\n                        },\r\n                        content: function () {\r\n                            player.addGaintag(trigger.cards, \"zhiheng\");\r\n                        },\r\n                        sub: true,\r\n                        onremove: function (player) {\r\n                            player.removeGaintag(\"zhiheng\");\r\n                        },\r\n                        audioname2: {\r\n                            old_yuanshu: \"weidi\"\r\n                        }\r\n                    }\r\n                },\r\n                audioname2: {\r\n                    old_yuanshu: \"weidi\"\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_wu,\r\n        translate: {\r\n            PShw_sunquan: \"会玩的孙权\",\r\n            PShuiwan: \"会玩\",\r\n            PShuiwan_info: \"你可以将〖制衡〗获得的牌当任意基本牌或锦囊牌使用或打出。\",\r\n            \"#ext:PS武将/audio/skill/PShuiwan1\": \"多势纷争,须衡平制稳为上。\",\r\n            \"#ext:PS武将/audio/skill/PShuiwan2\": \"不急一时，且看时局变化。\",\r\n            \"#ext:PS武将/audio/skill/PShuiwan3\": \"多思多谋,筹谋长远。\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PSyangbiao: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"qun\",\r\n            hp: 5,\r\n            skills: [\r\n                \"PSzhaohan\",\r\n                \"rangjie\",\r\n                \"PSyizheng\"\r\n            ],\r\n            isAiForbidden: true,\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“一顿七只屑狐狸”设计\",\r\n        skills: {\r\n            PSzhaohan: {\r\n                audio: \"zhaohan\",\r\n                trigger: {\r\n                    player: \"phaseZhunbeiBegin\"\r\n                },\r\n                forced: true,\r\n                content: function () {\r\n                    player.gainMaxHp();\r\n                    player.recover();\r\n                }\r\n            },\r\n            PSyizheng: {\r\n                audio: \"yizheng\",\r\n                enable: \"phaseUse\",\r\n                usable: 2,\r\n                filter: function (event, player) {\r\n                    return game.hasPlayer(function (current) {\r\n                        return current.hp <= player.hp && player.canCompare(current);\r\n                    });\r\n                },\r\n                filterTarget: function (card, player, current) {\r\n                    return current.hp <= player.hp && player.canCompare(current);\r\n                },\r\n                content: function () {\r\n                    'step 0'\r\n                    player.chooseToCompare(target);\r\n                    'step 1'\r\n                    if (result.bool) {\r\n                        target.skip('phaseDraw');\r\n                        target.addTempSkill('yizheng2', { player: 'phaseDrawSkipped' });\r\n                    }\r\n                    else {\r\n                        target.loseMaxHp();\r\n                        target.discard(target.getCards('hej'));\r\n                    }\r\n                },\r\n                ai: {\r\n                    order: 1,\r\n                    result: {\r\n                        target: function (player, target) {\r\n                            if (target.skipList.includes('phaseDraw') || target.hasSkill('pingkou')) return 0;\r\n                            var hs = player.getCards('h').sort(function (a, b) {\r\n                                return b.number - a.number;\r\n                            });\r\n                            var ts = target.getCards('h').sort(function (a, b) {\r\n                                return b.number - a.number;\r\n                            });\r\n                            if (!hs.length || !ts.length) return 0;\r\n                            if (hs[0].number > ts[0].number) return -1;\r\n                            return 0;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_qun,\r\n        translate: {\r\n            PSyangbiao: \"PS杨彪\",\r\n            PSzhaohan: \"昭汉\",\r\n            PSzhaohan_info: \"锁定技，准备阶段，你加一点体力上限并回复一点体力。\",\r\n            PSyizheng: \"义争\",\r\n            PSyizheng_info: \"出牌阶段限两次，你可以与一名体力值不大于你的角色拼点：若你赢，跳过其下个摸牌阶段；若你没赢，其减一点体力上限并弃置区域内所有牌。\"\r\n        },\r\n        rank: rank.epic\r\n    },\r\n    PSguosi: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"qun\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PStanbei\",\r\n                \"PSsidao\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“你想去哪儿呢”设计\",\r\n        skills: {\r\n            PStanbei: {\r\n                audio: \"xinfu_tanbei\",\r\n                enable: \"phaseUse\",\r\n                filterTarget: function (card, player, target) {\r\n                    return player != target && !target.hasSkill('tanbei_effect1') && !target.hasSkill('tanbei_effect2');\r\n                },\r\n                content: function () {\r\n                    \"step 0\"\r\n                    if (target.countCards('hej') == 0) {\r\n                        event._result = { index: 1 };\r\n                    }\r\n                    else {\r\n                        player.chooseControl().set('choiceList', [\r\n                            '随机获得' + get.translation(target) + '区域内的一张牌，然后其本回合内不能再对' + get.translation(target) + '使用牌。',\r\n                            '本回合内对' + get.translation(target) + '使用牌没有次数与距离限制。',\r\n                        ]).set('ai', function () {\r\n                            var list = [0, 1];\r\n                            return list.randomGet();\r\n                        });\r\n                    }\r\n                    \"step 1\"\r\n                    player.addTempSkill('tanbei_effect3');\r\n                    if (result.index == 0) {\r\n                        var card = target.getCards('hej').randomGet();\r\n                        player.gain(card, target, 'giveAuto', 'bySelf');\r\n                        target.addTempSkill('tanbei_effect2');\r\n                    }\r\n                    else {\r\n                        target.addTempSkill('tanbei_effect1');\r\n                    }\r\n                },\r\n                ai: {\r\n                    order: function () {\r\n                        return [2, 4, 6, 8, 10].randomGet();\r\n                    },\r\n                    result: {\r\n                        target: function (player, target) {\r\n                            return -2 - target.countCards('h');\r\n                        }\r\n                    },\r\n                    threaten: 1.1\r\n                }\r\n            },\r\n            PSsidao: {\r\n                audio: \"xinfu_sidao\",\r\n                trigger: {\r\n                    player: \"useCardAfter\"\r\n                },\r\n                filter: function (event, player) {\r\n                    if (!player.countCards('hs')) return false;\r\n                    if (event.getParent(2).name == 'PSsidao') return false;\r\n                    if (!event.targets || !event.targets.length || !event.isPhaseUsing(player)) return false;\r\n                    var history = player.getHistory('useCard');\r\n                    var index;\r\n                    if (event) index = history.indexOf(event) - 1;\r\n                    else index = history.length - 1;\r\n                    if (index < 0) return false;\r\n                    var evt = history[index];\r\n                    if (!evt || !evt.targets || !evt.targets.length || !evt.isPhaseUsing(player)) return false;\r\n                    for (var i = 0; i < event.targets.length; i++) {\r\n                        var num = 1;\r\n                        for (var j = 0; j <= index; j++) {\r\n                            if (history[index - j].targets.includes(event.targets[i])) num++;\r\n                            else break;\r\n                        } if (evt.targets.includes(event.targets[i]) && num % 2 == 0 && lib.filter.filterTarget({ name: 'shunshou' }, player, event.targets[i])) return true;\r\n                    }\r\n                    return false;\r\n                },\r\n                direct: true,\r\n                content: function () {\r\n                    var targets = player.getLastUsed(1).targets;\r\n                    var next = player.chooseToUse();\r\n                    next.set('targets', game.filterPlayer(function (current) {\r\n                        return targets.includes(current) && trigger.targets.includes(current);\r\n                    }));\r\n                    next.set('openskilldialog', get.prompt('PSsidao') + lib.translate.PSsidao_info);\r\n                    next.set('norestore', true);\r\n                    next.set('_backupevent', 'xinfu_sidaox');\r\n                    next.set('custom', {\r\n                        add: {},\r\n                        replace: { window: function () { } }\r\n                    });\r\n                    next.backup('xinfu_sidaox');\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_qun,\r\n        translate: {\r\n            PSguosi: \"PS郭汜\",\r\n            PStanbei: \"贪狈\",\r\n            PStanbei_info: \"出牌阶段对每名其他角色限一次，你可以指定一个目标角色，选择一项：1. 你随机获得其一个区域的一张牌，此回合不能再对其使用牌；2. 令你此回合对其使用牌没有次数和距离限制。\",\r\n            PSsidao: \"伺盗\",\r\n            PSsidao_info: \"出牌阶段，当你对一名其他角色每连续使用两张牌后，你可将一张手牌当无距离限制的顺手牵羊对其使用\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PSshen_huangzhong: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"shen\",\r\n            hp: 3,\r\n            skills: [\r\n                \"PSdingjun\"\r\n            ],\r\n            dieAudios: [\r\n                \"sb_huangzhong\"\r\n            ],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“我最爱的雨雨”设计\",\r\n        skills: {\r\n            PSdingjun: {\r\n                shaRelated: true,\r\n                audio: \"sbliegong\",\r\n                trigger: {\r\n                    player: \"useCardToPlayered\"\r\n                },\r\n                check: function (event, player) {\r\n                    return get.attitude(player, event.target) <= 0;\r\n                },\r\n                init: function (player) {\r\n                    if (!player.storage.PSdingjun) player.storage.PSdingjun = 0;\r\n                },\r\n                intro: {\r\n                    markcount: function (storage, player) {\r\n                        var num = player.getHistory('useCard', evt => { return evt.card.name == 'sha' && evt.addCount != false; }).length;\r\n                        num = storage + 1 - num;\r\n                        if (num < 0) num = 0;\r\n                        return num;\r\n                    },\r\n                    content: function (storage, player) {\r\n                        var num = player.getHistory('useCard', evt => { return evt.card.name == 'sha' && evt.addCount != false; }).length;\r\n                        num = storage + 1 - num;\r\n                        if (num < 0) num = 0;\r\n                        if (num == 0) player.unmarkSkill('PSdingjun');\r\n                        return '本回合额外使用【杀】次数+' + num;\r\n                    }\r\n                },\r\n                onremove: function (player) {\r\n                    player.unmarkSkill('PSdingjun');\r\n                },\r\n                prompt2: function (event) {\r\n                    var suit = get.suit(event.card);\r\n                    var num = get.number(event.card);\r\n                    if (suit == 'spade') return \"令\" + get.translation(event.card) + \"造成伤害+\" + num;\r\n                    if (suit == 'club') return \"本回合额外使用【杀】次数+\" + num;\r\n                    if (suit == 'heart') return \"获得\" + get.cnNumber(num) + \"点护甲\";\r\n                    if (suit == 'diamond') return \"摸\" + get.cnNumber(num) + \"张牌\";\r\n                },\r\n                filter: function (event, player) {\r\n                    if (event.card.name != 'sha') return false;\r\n                    return event.targets.length == 1 && get.suit(event.card) != 'none' && get.number(event.card) != null;\r\n                },\r\n                preHidden: true,\r\n                content: function () {\r\n                    'step 0'\r\n                    var suit = get.suit(trigger.card);\r\n                    var num = get.number(trigger.card);\r\n                    switch (suit) {\r\n                        case 'spade':\r\n                            var id = trigger.target.playerid;\r\n                            var map = trigger.getParent().customArgs;\r\n                            if (!map[id]) map[id] = {};\r\n                            if (typeof map[id].extraDamage != 'number') {\r\n                                map[id].extraDamage = 0;\r\n                            }\r\n                            map[id].extraDamage += num;\r\n                            break;\r\n                        case 'club':\r\n                            player.storage.PSdingjun += num;\r\n                            player.markSkill('PSdingjun');\r\n                            player.addTempSkill('PSdingjun_sha', { global: \"phaseUseEnd\" });\r\n                            break;\r\n                        case 'heart':\r\n                            player.changeHujia(num, null, false);\r\n                            break;\r\n                        default:\r\n                            player.draw(num);\r\n                            break;\r\n                    }\r\n                },\r\n                group: \"PSdingjun_clear\",\r\n                subSkill: {\r\n                    sha: {\r\n                        mod: {\r\n                            cardUsable: function (card, player, num) {\r\n                                if (card.name == 'sha') return num + player.storage.PSdingjun;\r\n                            }\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    clear: {\r\n                        trigger: {\r\n                            global: \"phaseUseEnd\"\r\n                        },\r\n                        direct: true,\r\n                        charlotte: true,\r\n                        forced: true,\r\n                        content: function () {\r\n                            if (player.storage.PSdingjun) player.storage.PSdingjun = 0;\r\n                            player.syncStorage('PSdingjun');\r\n                            player.unmarkSkill('PSdingjun');\r\n                        },\r\n                        sub: true\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_shen,\r\n        translate: {\r\n            PSshen_huangzhong: \"PS神黄忠\",\r\n            PSdingjun: \"定军\",\r\n            PSdingjun_info: \"每当你使用【杀】指定唯一目标时，你根据此【杀】的花色获得以下效果：<br/>黑桃，此【杀】伤害＋X ；<br/>梅花，本回合使用【杀】次数＋X ；<br/>方片，摸X张牌；<br/>红桃，获得X点护甲；<br/>X为此【杀】的点数。\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PSshen_guojia: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"shen\",\r\n            hp: 3,\r\n            skills: [\r\n                \"PShuishi\",\r\n                \"stianyi\",\r\n                \"resghuishi\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“九个芒果”设计\",\r\n        skills: {\r\n            PShuishi: {\r\n                audio: \"shuishi\",\r\n                enable: \"phaseUse\",\r\n                usable: 1,\r\n                frequent: true,\r\n                filter: function (event, player) {\r\n                    return true;\r\n                },\r\n                content: function () {\r\n                    'step 0'\r\n                    event.cards = [];\r\n                    event.numbers = [];\r\n                    'step 1'\r\n                    player.judge(function (result) {\r\n                        var evt = _status.event.getParent('PShuishi');\r\n                        if (evt && evt.numbers && evt.numbers.includes(get.number(result))) return 0;\r\n                        return 1;\r\n                    }).set('callback', lib.skill.PShuishi.callback).judge2 = function (result) {\r\n                        return result.bool ? true : false;\r\n                    };\r\n                    'step 2'\r\n                    var cards = cards.filterInD();\r\n                    if (cards.length) player.chooseTarget('将' + get.translation(cards) + '交给一名角色', true).set('ai', function (target) {\r\n                        var player = _status.event.player;\r\n                        var att = get.attitude(player, target) / Math.sqrt(1 + target.countCards('h'));\r\n                        if (target.hasSkillTag('nogain')) att /= 10;\r\n                        return att;\r\n                    });\r\n                    else event.finish();\r\n                    'step 3'\r\n                    if (result.bool) {\r\n                        var target = result.targets[0];\r\n                        event.target = target;\r\n                        player.line(target, 'green');\r\n                        target.gain(cards, 'gain2').giver = player;\r\n                    }\r\n                    else event.finish();\r\n                    'step 4'\r\n                    if (target.isMaxHandcard()) player.loseMaxHp();\r\n                },\r\n                callback: function () {\r\n                    'step 0'\r\n                    var evt = event.getParent(2);\r\n                    event.getParent().orderingCards.remove(event.judgeResult.card);\r\n                    evt.cards.push(event.judgeResult.card);\r\n                    if (event.getParent().result.bool) {\r\n                        evt.numbers.push(event.getParent().result.number);\r\n                        if (player.maxHp < 10) player.gainMaxHp();\r\n                        player.chooseBool('是否继续发动【慧识】？').set('frequentSkill', 'PShuishi');\r\n                    }\r\n                    else event._result = { bool: false };\r\n                    'step 1'\r\n                    if (result.bool) event.getParent(2).redo();\r\n                },\r\n                ai: {\r\n                    order: 9,\r\n                    result: {\r\n                        player: 1\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_shen,\r\n        translate: {\r\n            PSshen_guojia: \"PS神郭嘉\",\r\n            PShuishi: \"慧识\",\r\n            PShuishi_info: \"出牌阶段限一次。你可进行判定牌不置入弃牌堆的判定。若判定结果与本次发动技能时的其他判定结果的点数均不相同，则你加1点体力上限（若你的体力上限不小于10则不加），且可以重复此流程。然后你将所有位于处理区的判定牌交给一名角色。若其手牌数为全场最多，则你减1点体力上限。\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PSzhenji: {\r\n        info: {\r\n            sex: \"female\",\r\n            group: \"wei\",\r\n            hp: 3,\r\n            skills: [\r\n                \"PSluoshen\",\r\n                \"PSqingguo\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“人生仁生”设计\",\r\n        skills: {\r\n            PSluoshen: {\r\n                audio: \"sbluoshen\",\r\n                trigger: {\r\n                    global: \"phaseJieshuBegin\"\r\n                },\r\n                forced: true,\r\n                filter: function (event, player) {\r\n                    return true;\r\n                },\r\n                content: function () {\r\n                    'step 0'\r\n                    trigger.player.chooseToDiscard('hes', 2, function (card, player) {\r\n                        if (get.color(card) != 'black') return false;\r\n                        if (ui.selected.cards.length) {\r\n                            var suit = get.suit(card, trigger.player);\r\n                            for (var i of ui.selected.cards) {\r\n                                if (get.suit(i, trigger.player) == suit) return false;\r\n                            }\r\n                        }\r\n                        return true;\r\n                    }).set('ai', function (card) {\r\n                        const player = get.event().player;\r\n                        const target = get.event().target;\r\n                        if (get.attitude(player, target) >= 0) return 0;\r\n                        return 10 - player.hp - get.value(card);\r\n                    }).set('prompt', '洛神：请弃置两张花色不同的黑色牌，否则展示牌堆底三张牌，将其中的黑色牌置于' + get.translation(player) + '武将牌上').set('complexCard', true).set('target', player);\r\n                    'step 1'\r\n                    if (!result.bool) {\r\n                        var cards = get.bottomCards(3);\r\n                        game.cardsGotoOrdering(cards);\r\n                        trigger.player.showCards(cards, '洛神');\r\n                        var cardsx = [];\r\n                        for (var i = 0; i < cards.length; i++) {\r\n                            if (get.color(cards[i]) == \"black\") {\r\n                                cardsx.push(cards[i]);\r\n                            }\r\n                        }\r\n                        if (cardsx.length) {\r\n                            game.log(player, '将', cardsx, '作为“洛神牌”置于了', player, '武将牌上');\r\n                            player.loseToSpecial(cardsx, 'PSluoshen').visible = true;\r\n                        }\r\n                    }\r\n                    'step 2'\r\n                    player.markSkill('PSluoshen');\r\n                    game.delayx();\r\n                },\r\n                marktext: \"洛神\",\r\n                intro: {\r\n                    mark: function (dialog, storage, player) {\r\n                        var cards = player.getCards('s', function (card) {\r\n                            return card.hasGaintag('PSluoshen');\r\n                        });\r\n                        if (!cards || !cards.length) return;\r\n                        dialog.addAuto(cards);\r\n                    },\r\n                    markcount: function (storage, player) {\r\n                        return player.countCards('s', function (card) {\r\n                            return card.hasGaintag('PSluoshen');\r\n                        });\r\n                    },\r\n                    onunmark: function (storage, player) {\r\n                        var cards = player.getCards('s', function (card) {\r\n                            return card.hasGaintag('PSluoshen');\r\n                        });\r\n                        if (cards.length) {\r\n                            player.loseToDiscardpile(cards);\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            PSqingguo: {\r\n                mod: {\r\n                    aiValue: function (player, card, num) {\r\n                        if (get.name(card) != 'shan' && get.color(card) != 'black') return;\r\n                        var cards = player.getCards('hs', function (card) {\r\n                            return get.name(card) == 'shan' || get.color(card) == 'black';\r\n                        });\r\n                        cards.sort(function (a, b) {\r\n                            return (get.name(b) == 'shan' ? 1 : 2) - (get.name(a) == 'shan' ? 1 : 2);\r\n                        });\r\n                        var geti = function () {\r\n                            if (cards.includes(card)) {\r\n                                return cards.indexOf(card);\r\n                            }\r\n                            return cards.length;\r\n                        };\r\n                        if (get.name(card) == 'shan') return Math.min(num, [6, 4, 3][Math.min(geti(), 2)]) * 0.6;\r\n                        return Math.max(num, [6.5, 4, 3][Math.min(geti(), 2)]);\r\n                    },\r\n                    aiUseful: function () {\r\n                        return lib.skill.qingguo.mod.aiValue.apply(this, arguments);\r\n                    }\r\n                },\r\n                locked: false,\r\n                audio: \"ext:PS武将/audio/skill:2\",\r\n                enable: [\r\n                    \"chooseToRespond\",\r\n                    \"chooseToUse\"\r\n                ],\r\n                filterCard: function (card) {\r\n                    return get.color(card) == 'black' || card.hasGaintag('PSluoshen');\r\n                },\r\n                viewAs: {\r\n                    name: \"shan\"\r\n                },\r\n                viewAsFilter: function (player) {\r\n                    if (!player.countCards('s', function (card) {\r\n                        return card.hasGaintag('PSluoshen');\r\n                    }) && !player.countCards('hs', { color: 'black' })) return false;\r\n                },\r\n                position: \"hs\",\r\n                prompt: \"将一张黑色手牌或洛神牌当闪使用或打出\",\r\n                check: function () { return 1 },\r\n                ai: {\r\n                    order: 3,\r\n                    respondShan: true,\r\n                    skillTagFilter: function (player) {\r\n                        if (!player.countCards('s', function (card) {\r\n                            return card.hasGaintag('PSluoshen');\r\n                        }) && !player.countCards('hs', { color: 'black' })) return false;\r\n                    },\r\n                    effect: {\r\n                        target: function (card, player, target, current) {\r\n                            if (get.tag(card, 'respondShan') && current < 0) return 0.6\r\n                        }\r\n                    },\r\n                    basic: {\r\n                        useful: [\r\n                            7,\r\n                            5.1,\r\n                            2\r\n                        ],\r\n                        value: [\r\n                            7,\r\n                            5.1,\r\n                            2\r\n                        ]\r\n                    },\r\n                    result: {\r\n                        player: 1\r\n                    }\r\n                },\r\n                group: \"PSqingguo_use\",\r\n                subSkill: {\r\n                    use: {\r\n                        trigger: {\r\n                            player: [\r\n                                \"useCardAfter\",\r\n                                \"respondAfter\"\r\n                            ]\r\n                        },\r\n                        forced: true,\r\n                        nopop: false,\r\n                        filter: function (event, player) {\r\n                            return event.card.name == 'shan' && event.skill == 'PSqingguo';\r\n                        },\r\n                        content: function () {\r\n                            'step 0'\r\n                            player.chooseBool('是否将' + get.translation(trigger.cards) + '置于牌堆底？');\r\n                            'step 1'\r\n                            if (result.bool) {\r\n                                game.log(player, '将', trigger.cards, '置于了牌堆底');\r\n                                ui.cardPile.appendChild(trigger.cards[0]);\r\n                                player.popup(get.cnNumber(0) + '上' + get.cnNumber(1) + '下');\r\n                                game.delayx();\r\n                            }\r\n                        },\r\n                        sub: true\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_wei,\r\n        translate: {\r\n            PSzhenji: \"PS甄姬\",\r\n            PSluoshen: \"洛神\",\r\n            PSluoshen_info: \"锁定技，每名角色回合结束阶段开始时，须选择一项：1.弃置两张花色不同的黑色牌；2.展示牌堆底三张牌，将其中的黑色牌置于你武将牌上，称为“洛神”，你可以将洛神牌如手牌般使用或打出。\",\r\n            PSqingguo: \"倾国\",\r\n            PSqingguo_info: \"你可以将一张黑色牌或洛神牌当【闪】使用或打出，该【闪】生效后，你可以将之置于牌堆底。\",\r\n            \"#ext:PS武将/audio/skill/PSqingguo1\": \"商灵缤兮恭迎,伞盖纷兮若云。\",\r\n            \"#ext:PS武将/audio/skill/PSqingguo2\": \"晨张兮细帷,夕茸兮兰櫋。\"\r\n        },\r\n        rank: rank.epic\r\n    },\r\n    PSwu_zhangliao: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"wei\",\r\n            hp: 4,\r\n            maxHp: 6,\r\n            skills: [\r\n                \"PSwu_tuxi\",\r\n                \"PSwu_zhenzhan\"\r\n            ],\r\n            dieAudios: [\r\n                \"re_zhangliao\"\r\n            ],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“小男孩_Official”设计\",\r\n        skills: {\r\n            PSwu_tuxi: {\r\n                audio: \"retuxi\",\r\n                trigger: {\r\n                    player: \"phaseDrawBegin2\"\r\n                },\r\n                direct: true,\r\n                preHidden: true,\r\n                filter: function (event, player) {\r\n                    return event.num > 0 && !event.numFixed && game.hasPlayer(function (target) {\r\n                        return target.countCards('he') > 0 && player != target;\r\n                    });\r\n                },\r\n                gainMultiple: function () {\r\n                    'step 0'\r\n                    event.delayed = false;\r\n                    event.num = 0;\r\n                    event.cards = [];\r\n                    'step 1'\r\n                    player.gainPlayerCard(targets[num], event.position, [1, targets.length], true).set('boolline', false).set('delay', num == targets.length - 1);\r\n                    'step 2'\r\n                    if (result.bool) {\r\n                        event.cards.addArray(result.cards);\r\n                        if (num == targets.length - 1) event.delayed = true;\r\n                    }\r\n                    event.num++;\r\n                    if (event.num < targets.length) {\r\n                        event.goto(1);\r\n                    }\r\n                    'step 3'\r\n                    if (!event.delayed) game.delay();\r\n                },\r\n                content: function () {\r\n                    'step 0'\r\n                    var num = get.copy(trigger.num);\r\n                    if (get.mode() == 'guozhan' && num > 2) num = 2;\r\n                    player.chooseTarget(get.prompt('new_retuxi'), '获得至多' + get.translation(num) + '名角色的各一张手牌，然后少摸等量的牌', [1, num], function (card, player, target) {\r\n                        return target.countCards('he') > 0 && player != target;\r\n                    }, function (target) {\r\n                        var att = get.attitude(_status.event.player, target);\r\n                        if (target.hasSkill('tuntian')) return att / 10;\r\n                        return 1 - att;\r\n                    }).setHiddenSkill('PSwu_tuxi');\r\n                    'step 1'\r\n                    if (result.bool) {\r\n                        result.targets.sortBySeat();\r\n                        player.logSkill('PSwu_tuxi', result.targets);\r\n                        var next = game.createEvent('gainMultiple', false);\r\n                        next.player = player;\r\n                        next.targets = result.targets;\r\n                        next.position = 'hej';\r\n                        next.setContent(lib.skill.PSwu_tuxi.gainMultiple);\r\n                        trigger.num -= result.targets.length;\r\n                    }\r\n                    else {\r\n                        event.finish();\r\n                    }\r\n                    'step 2'\r\n                    if (trigger.num <= 0) game.delay();\r\n                },\r\n                ai: {\r\n                    threaten: 1.6,\r\n                    expose: 0.2\r\n                }\r\n            },\r\n            PSwu_zhenzhan: {\r\n                audio: \"ext:PS武将/audio/skill:2\",\r\n                trigger: {\r\n                    global: [\r\n                        \"useCard2\",\r\n                        \"discardAfter\"\r\n                    ]\r\n                },\r\n                forced: true,\r\n                priority: -1,\r\n                logTarget: \"player\",\r\n                filter: function (event, player) {\r\n                    if (!event.player.isAlive()) return false;\r\n                    if (event.player == player) return false;\r\n                    if (event.name == 'discard') return event.getParent(2).name != \"phaseDiscard\";\r\n                    else return event.targets.length > 1;\r\n                },\r\n                content: function () {\r\n                    player.line(trigger.player, 'fire');\r\n                    var num = trigger.name == 'discard' ? trigger.cards.length : trigger.targets.length;\r\n                    num = Math.min(player.getDamagedHp(), num);\r\n                    if (num <= 0) num = 1;\r\n                    trigger.player.damage(num, 'nocard', player);\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_wei,\r\n        translate: {\r\n            PSwu_zhangliao: \"PS武张辽\",\r\n            PSwu_zhangliao_prefix: \"PS武\",\r\n            PSwu_tuxi: \"突袭\",\r\n            PSwu_tuxi_info: \"摸牌阶段，你可以少摸任意张牌并获得等量的其他角色区域内等量的牌。\",\r\n            PSwu_zhenzhan: \"阵斩\",\r\n            PSwu_zhenzhan_info: \"锁定技。其他角色使用多目标的牌指定目标时/于弃牌阶段外弃置牌后，你对其造成X点伤害。（X为此牌目标数/弃置的牌数，且至多为你已损失体力值，至少为1）\",\r\n            \"#ext:PS武将/audio/skill/PSwu_zhenzhan1\": \"兵贵神速，随我来。\",\r\n            \"#ext:PS武将/audio/skill/PSwu_zhenzhan2\": \"行包围之势，尽数诛之。\"\r\n        },\r\n        rank: rank.epic\r\n    },\r\n    PSsunru: {\r\n        info: {\r\n            sex: \"female\",\r\n            group: \"wu\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PSyingjian\",\r\n                \"PSshixin\"\r\n            ],\r\n            isAiForbidden: true,\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“一顿七只屑狐狸”设计\",\r\n        skills: {\r\n            PSyingjian: {\r\n                trigger: {\r\n                    player: [\r\n                        \"phaseZhunbeiBegin\",\r\n                        \"phaseJudgeBegin\",\r\n                        \"phaseDrawBegin\",\r\n                        \"phaseDiscardBegin\",\r\n                        \"phaseJieshuBegin\"\r\n                    ]\r\n                },\r\n                direct: true,\r\n                audio: \"qingyi\",\r\n                content: function () {\r\n                    var card = {\r\n                        name: 'sha',\r\n                        storage: { PSyingjian: true }\r\n                    };\r\n                    player.chooseUseTarget('###是否发动【影箭】？###视为使用一张没有距离限制的【杀】', card, false, 'nodistance').logSkill = 'yingjian';\r\n                },\r\n                ai: {\r\n                    unequip: true,\r\n                    skillTagFilter: function (player, tag, arg) {\r\n                        if (!arg || !arg.card || !arg.card.storage || !arg.card.storage.PSyingjian) return false;\r\n                    },\r\n                    threaten: function (player, target) {\r\n                        return 1.6;\r\n                    }\r\n                },\r\n                group: \"PSyingjian_use\",\r\n                subSkill: {\r\n                    use: {\r\n                        audio: \"qingyi\",\r\n                        enable: \"phaseUse\",\r\n                        usable: 1,\r\n                        content: function () {\r\n                            var card = {\r\n                                name: 'sha',\r\n                                storage: { PSyingjian: true }\r\n                            };\r\n                            player.chooseUseTarget('影箭：视为使用一张没有距离限制的【杀】', card, false, 'nodistance').logSkill = 'yingjian';\r\n                        },\r\n                        ai: {\r\n                            unequip: true,\r\n                            skillTagFilter: function (player, tag, arg) {\r\n                                if (!arg || !arg.card || !arg.card.storage || !arg.card.storage.PSyingjian) return false;\r\n                            },\r\n                            threaten: function (player, target) {\r\n                                return 1.6;\r\n                            }\r\n                        },\r\n                        sub: true\r\n                    }\r\n                }\r\n            },\r\n            PSshixin: {\r\n                audio: \"shixin\",\r\n                trigger: {\r\n                    player: \"damageBegin4\"\r\n                },\r\n                filter: function (event) {\r\n                    return true;\r\n                },\r\n                forced: true,\r\n                content: function () {\r\n                    if (trigger.hasNature('fire')) trigger.cancel();\r\n                    else trigger.num--;\r\n                },\r\n                ai: {\r\n                    nofire: true,\r\n                    effect: {\r\n                        target: function (card, player, target, current) {\r\n                            if (get.tag(card, 'fireDamage')) return 'zerotarget';\r\n                        }\r\n                    }\r\n                },\r\n                group: \"PSshixin_end\",\r\n                subSkill: {\r\n                    end: {\r\n                        trigger: {\r\n                            source: \"damageBegin2\"\r\n                        },\r\n                        forced: true,\r\n                        filter: function (event, player) {\r\n                            return _status.currentPhase == player && !player.hasSkill(\"PSshixin_blocker\");\r\n                        },\r\n                        content: function () {\r\n                            player.recover();\r\n                            player.addTempSkill(\"PSshixin_blocker\");\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    blocker: {\r\n                        charlotte: true,\r\n                        forced: true,\r\n                        sub: true\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_wu,\r\n        translate: {\r\n            PSsunru: \"PS孙茹\",\r\n            PSyingjian: \"影箭\",\r\n            PSyingjian_info: \"准备阶段开始时/判定阶段开始时/摸牌阶段开始时/弃牌阶段开始时/结束阶段开始时/出牌阶段限一次，你可以视为使用一张无视防具，无距离限制，不计入次数的【杀】。\",\r\n            PSshixin: \"释衅\",\r\n            PSshixin_info: \"锁定技，防止你受到火属性伤害，你受到的非火焰伤害-1；你于回合内第一次造成伤害时，回复一点体力。\"\r\n        },\r\n        rank: rank.epic\r\n    },\r\n    PSfuzhijie: {\r\n        info: {\r\n            sex: \"female\",\r\n            group: \"wu\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PSfuzhi\"\r\n            ],\r\n            dieAudios: [\r\n                \"zhangxuan\"\r\n            ],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“门刀臣零衣”设计\",\r\n        skills: {\r\n            PSfuzhi: {\r\n                audio: \"tongli\",\r\n                trigger: {\r\n                    global: \"useCardAfter\"\r\n                },\r\n                filter: function (event, player, name) {\r\n                    if (event.getParent(2).name == 'PSfuzhi') return false;\r\n                    if (!event.card || event.card.length == 0) return false;\r\n                    var type = get.type(event.card);\r\n\r\n                    if (['shan', 'wuxie'].includes(event.card.name)) return false;\r\n                    return game.findPlayer2(target => {\r\n                        var info = lib.card[event.card.name];\r\n                        if (info.autoViewAs) {\r\n                            if (player.canUse({ card: event.card, name: info.autoViewAs }, target, false)) return true;\r\n                        }\r\n                        else if (player.canUse(event.card, target, false)) return true;\r\n                        return false;\r\n                    });\r\n                },\r\n                direct: true,\r\n                content: function () {\r\n                    'step 0'\r\n                    var createCard = game.createCard2(trigger.card);\r\n                    var info = lib.card[createCard.name];\r\n                    if (info.autoViewAs) player.chooseUseTarget([createCard], { name: info.autoViewAs }, false);\r\n                    else player.chooseUseTarget(createCard, false);\r\n                    'step 1'\r\n                    if (result.targets) player.logSkill('PSfuzhi');\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_wu,\r\n        translate: {\r\n            PSfuzhijie: \"复制姐\",\r\n            PSfuzhi: \"复制\",\r\n            PSfuzhi_info: \"一名角色使用牌结算后，你可以使用同名实体牌。\"\r\n        },\r\n        rank: rank.epic\r\n    },\r\n    PSfx_shen_guanyu: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"shen\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PSshenwu\",\r\n                \"PShunwu\"\r\n            ],\r\n            dieAudios: [\r\n                \"shen_guanyu\"\r\n            ],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“绿诗涵”设计\",\r\n        skills: {\r\n            PSshenwu: {\r\n                init: function (player) {\r\n                    lib.card.tao.enable = function (card, player) {\r\n                        if (player.hasSkill('PSshenwu')) return game.hasPlayer(function (current) {\r\n                            return current.isDamaged();\r\n                        });\r\n                        return player.hp < player.maxHp;\r\n                    };\r\n                    lib.card.tao.selectTarget = function (card, player, target) {\r\n                        if (player.hasSkill('PSshenwu')) return 1;\r\n                        return -1;\r\n                    };\r\n                    lib.card.tao.filterTarget = function (card, player, target) {\r\n                        if (player.hasSkill('PSshenwu')) return target.hp < target.maxHp;\r\n                        return target == player && target.hp < target.maxHp;\r\n                    };\r\n                },\r\n                mod: {\r\n                    cardname: function (card, player, name) {\r\n                        if (get.suit(card) == 'heart') return 'tao';\r\n                    }\r\n                },\r\n                ai: {\r\n                    nokeep: true,\r\n                    basic: {\r\n                        order: function (card, player) {\r\n                            if (player.hasSkillTag('pretao')) return 5;\r\n                            return 2;\r\n                        },\r\n                        useful: [\r\n                            6.5,\r\n                            4,\r\n                            3,\r\n                            2\r\n                        ],\r\n                        value: [\r\n                            6.5,\r\n                            4,\r\n                            3,\r\n                            2\r\n                        ]\r\n                    },\r\n                    result: {\r\n                        target: 2,\r\n                        target_use: function (player, target) {\r\n                            // if(player==target&&player.hp<=0) return 2;\r\n                            if (player.hasSkillTag('nokeep', true, null, true)) return 2;\r\n                            var nd = player.needsToDiscard();\r\n                            var keep = false;\r\n                            if (nd <= 0) {\r\n                                keep = true;\r\n                            }\r\n                            else if (nd == 1 && target.hp >= 2 && target.countCards('h', 'tao') <= 1) {\r\n                                keep = true;\r\n                            }\r\n                            var mode = get.mode();\r\n                            if (target.hp >= 2 && keep && target.hasFriend()) {\r\n                                if (target.hp > 2 || nd == 0) return 0;\r\n                                if (target.hp == 2) {\r\n                                    if (game.hasPlayer(function (current) {\r\n                                        if (target != current && get.attitude(target, current) >= 3) {\r\n                                            if (current.hp <= 1) return true;\r\n                                            if ((mode == 'identity' || mode == 'versus' || mode == 'chess') && current.identity == 'zhu' && current.hp <= 2) return true;\r\n                                        }\r\n                                    })) {\r\n                                        return 0;\r\n                                    }\r\n                                }\r\n                            }\r\n                            if (target.hp < 0 && target != player && target.identity != 'zhu') return 0;\r\n                            var att = get.attitude(player, target);\r\n                            if (att < 3 && att >= 0 && player != target) return 0;\r\n                            var tri = _status.event.getTrigger();\r\n                            if (mode == 'identity' && player.identity == 'fan' && target.identity == 'fan') {\r\n                                if (tri && tri.name == 'dying' && tri.source && tri.source.identity == 'fan' && tri.source != target) {\r\n                                    var num = game.countPlayer(function (current) {\r\n                                        if (current.identity == 'fan') {\r\n                                            return current.countCards('h', 'tao');\r\n                                        }\r\n                                    });\r\n                                    if (num > 1 && player == target) return 2;\r\n                                    return 0;\r\n                                }\r\n                            }\r\n                            if (mode == 'identity' && player.identity == 'zhu' && target.identity == 'nei') {\r\n                                if (tri && tri.name == 'dying' && tri.source && tri.source.identity == 'zhong') {\r\n                                    return 0;\r\n                                }\r\n                            }\r\n                            if (mode == 'stone' && target.isMin() &&\r\n                                player != target && tri && tri.name == 'dying' && player.side == target.side &&\r\n                                tri.source != target.getEnemy()) {\r\n                                return 0;\r\n                            }\r\n                            return 2;\r\n                        }\r\n                    },\r\n                    tag: {\r\n                        recover: 1\r\n                    }\r\n                }\r\n            },\r\n            PShunwu: {\r\n                audio: \"ext:PS武将/audio/skill:1\",\r\n                trigger: {\r\n                    player: \"recoverAfter\"\r\n                },\r\n                filter: function (event, player) {\r\n                    return !player.isDamaged() && game.dead.length > 0;;\r\n                },\r\n                content: function () {\r\n                    \"step 0\"\r\n                    player.judge(function (card) {\r\n                        if (['sha', 'juedou', 'nanman', 'wanjian', 'huogong'].includes(card.name)) return 10;\r\n                        return -10;\r\n                    }).judge2 = function (result) {\r\n                        return result.bool == false ? true : false;\r\n                    };\r\n                    \"step 1\"\r\n                    if (!result.bool) {\r\n                        player.chooseTarget('复活一名已死亡角色').set('filterTarget', function (card, player, target) {\r\n                            if (target.isAlive()) return false;\r\n                            return true;\r\n                        }).set('deadTarget', true).set('ai', function (target) {\r\n                            var player = _status.event.player;\r\n                            return get.attitude(player, target)\r\n                        });\r\n                    }\r\n                    'step 2'\r\n                    if (result.targets) {\r\n                        var target = result.targets[0];\r\n                        target.revive();\r\n                        target.recoverTo(target.maxHp);\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_shen,\r\n        translate: {\r\n            PSfx_shen_guanyu: \"羽关神\",\r\n            PSshenwu: \"神武\",\r\n            PSshenwu_info: \"锁定技，你的♥牌均视为【桃】；你的【桃】可以对其他角色使用。\",\r\n            PShunwu: \"魂武\",\r\n            PShunwu_info: \"当你回复体力至满状态后，你可以进行一次判定，若结果不为【杀】【决斗】【南蛮入侵】【万箭齐发】【火攻】，你令一名已阵亡的角色复活并回复体力至体力上限。\",\r\n            \"#ext:PS武将/audio/skill/PShunwu1\": \"复活吧，我的爱人！\"\r\n        },\r\n        rank: rank.junk\r\n    },\r\n    PSpeixiu: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"qun\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PSxingtu\",\r\n                \"PSjuezhi\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“九个芒果”设计\",\r\n        skills: {\r\n            PSxingtu: {\r\n                init: function (player) {\r\n                    if (!lib.translate.xingtu1) lib.translate.xingtu1 = '无次数限制';\r\n                },\r\n                audio: \"xingtu\",\r\n                trigger: {\r\n                    player: \"useCard\"\r\n                },\r\n                filter: function (event, player) {\r\n                    if (player.hasSkill('PSxingtu_disable')) return false;\r\n                    var num1 = get.number(event.card), num2 = player.storage.PSxingtu;\r\n                    return typeof num1 == 'number' && typeof num2 == 'number';\r\n                },\r\n                forced: true,\r\n                popup: false,\r\n                content: function () {\r\n                    'step 0'\r\n                    var num = 3;\r\n                    var num1 = get.number(trigger.card), num2 = player.storage.PSxingtu, num3 = [0, 1, 2].randomGet(); //随机给出0~2的数字num3\r\n                    var prompt;\r\n                    switch (num3) {\r\n                        case 0:\r\n                            prompt = num2 + '+' + num1 + '=' + '?'; break;\r\n                        case 1:\r\n                            prompt = num2 + '-' + num1 + '=' + '?'; break;\r\n                        default:\r\n                            prompt = num2 + '*' + num1 + '=' + '?';\r\n                    }//根据随机数字num3得到提示内容\r\n                    var answer = [\r\n                        num2 + num1,\r\n                        num2 - num1,\r\n                        num2 * num1,\r\n                    ];\r\n                    var list = [answer[num3] + 1, answer[num3], answer[num3] - 1];//根据随机数字num3得到答案数组，新的数组元素为正确答案+1/-1\r\n                    event.num = answer[num3];\r\n                    list.randomSort();//list里的元素随机排序\r\n                    list.push('放弃');\r\n                    var next = player.chooseControl(list);\r\n                    next.set('prompt', '行图：请回答' + prompt);\r\n                    next.set('ai', function () {\r\n                        return event.num.toString();\r\n                    });\r\n                    /* player.popup(num--);//玩家武将牌弹出数字\r\n                    event.popup = setInterval(function () {\r\n                        player.popup(num);\r\n                        num--;\r\n                        if (num == 0) num = '时间到！';\r\n                    }, 1000);//每过1秒弹出一次 */\r\n                    var o = {\r\n                        O: function (num = 3) {\r\n                            if (typeof num != 'number') num = 3;\r\n                            ui.timer.show();\r\n                            game.countDown(num, function () {\r\n                                ui.timer.hide();\r\n                            });\r\n                        },\r\n                    };\r\n                    o.O('尊嘟假嘟');//显示倒计时  \r\n                    setTimeout(function () {\r\n                        clearInterval(event.popup);//停止弹出函数\r\n                        if (next.controlbars) {\r\n                            /* for (var i = 0; i < next.controlbars.length - 1; i++) {\r\n                                next.controlbars[i].close();//按钮关闭\r\n                            } */\r\n                            next.controlbars.at(-1).click();\r\n                        }\r\n                    }, 3000);//3秒后自动点击“取消”\r\n                    'step 1'\r\n                    clearInterval(event.popup);//停止弹出函数 \r\n                    if (result.control == event.num) {\r\n                        player.logSkill('xingtu');\r\n                        player.draw();\r\n                    }\r\n                    else player.addTempSkill('PSxingtu_disable');//答错或时间到技能失效\r\n                },\r\n                mod: {\r\n                    cardUsable: function (card, player) {\r\n                        if (get.itemtype(card) == 'card') {\r\n                            if (card.hasGaintag('xingtu1')) return Infinity;\r\n                        }\r\n                        else if (card.isCard && card.cards) {\r\n                            if (card.cards.some(card => card.hasGaintag('xingtu1'))) return Infinity;\r\n                        }//if（card.hasGaintag('xingtu1')）这样写会报错TAT\r\n                    },\r\n                    aiOrder: function (player, card, num) {\r\n                        if (get.itemtype(card) == 'card') {\r\n                            if (card.hasGaintag('xingtu1')) return num + 5;\r\n                        }\r\n                        else if (card.isCard && card.cards) {\r\n                            if (card.cards.some(card => card.hasGaintag('xingtu1'))) return num + 5;\r\n                        }//if（card.hasGaintag('xingtu1')）这样写会报错TAT\r\n                    }\r\n                },\r\n                group: [\r\n                    \"PSxingtu_record\",\r\n                    \"PSxingtu_tag\"\r\n                ],\r\n                intro: {\r\n                    content: \"当前记录：X=#\",\r\n                    markcount: () => undefined\r\n                },\r\n                subSkill: {\r\n                    record: {\r\n                        audio: \"xingtu\",\r\n                        trigger: {\r\n                            player: \"useCardAfter\"\r\n                        },\r\n                        filter: function (event, player) {\r\n                            return typeof get.number(event.card) == 'number';\r\n                        },\r\n                        forced: true,\r\n                        content: function () {\r\n                            'step 0'\r\n                            player.storage.PSxingtu = get.number(trigger.card);\r\n                            player.markSkill('PSxingtu');\r\n                            game.log(player, '当前记录', '#g【行图】', '点数为', '#y' + get.number(trigger.card));\r\n                            'step 1'\r\n                            if (game.HasExtension) {\r\n                                game.broadcastAll(function (player, storage) {\r\n                                    if (player.marks.PSxingtu) player.marks.PSxingtu.firstChild.innerHTML = ((game.HasExtension('十周年UI') ? 'X=' : '') + storage);\r\n                                }, player, player.storage.PSxingtu);\r\n                            }\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    tag: {\r\n                        trigger: {\r\n                            player: \"gainAfter\"\r\n                        },\r\n                        forced: true,\r\n                        filter: function (event, player) {\r\n                            return event.getParent(2).name == 'PSxingtu';\r\n                        },\r\n                        content: function () {\r\n                            player.addGaintag(trigger.cards, \"xingtu1\");\r\n                        },\r\n                        sub: true,\r\n                        onremove: function (player) {\r\n                            player.removeGaintag('xingtu1');\r\n                            delete player.storage.PSxingtu;\r\n                        }\r\n                    },\r\n                    disable: {\r\n                        charlotte: true,\r\n                        sub: true\r\n                    }\r\n                }\r\n            },\r\n            PSjuezhi: {\r\n                enable: \"phaseUse\",\r\n                audio: \"juezhi\",\r\n                filter: function (event, player) {\r\n                    return player.countCards('he') > 1;\r\n                },\r\n                filterCard: true,\r\n                position: \"he\",\r\n                usable: 1,\r\n                prompt: function () {\r\n                    var player = _status.event.player;\r\n                    if (player.hasSkill('PSxingtu') && !player.hasSkill('PSxingtu_disable')) return '〖行图〗②未失效，是否继续发动技能？' + lib.translate.PSjuezhi_info;\r\n                    return lib.translate.PSjuezhi_info;\r\n                },\r\n                selectCard: 2,\r\n                check: function (card) {\r\n                    if (ui.selected.cards.length > 1) return 0;\r\n                    return 4 - get.value(card);\r\n                },\r\n                content: function () {\r\n                    player.draw(2);\r\n                    if (player.hasSkill('PSxingtu_disable')) player.removeSkill('PSxingtu_disable');\r\n                },\r\n                ai: {\r\n                    order: 1,\r\n                    result: {\r\n                        player: 1\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_qun,\r\n        translate: {\r\n            PSpeixiu: \"PS裴秀\",\r\n            PSxingtu: \"行图\",\r\n            PSxingtu_info: \"锁定技。①当你使用有点数的牌结算结束后，你将此牌点数记录为X。②当你使用牌时，系统随机给出此牌的点数Y与X的四则运算式子（除法除外），你需要在3秒内选择答案；若答案正确，你摸一张牌，否则此效果本回合失效③你使用②摸到的牌无次数限制。\",\r\n            PSjuezhi: \"爵制\",\r\n            PSjuezhi_info: \"出牌阶段限一次，你可以弃置两张牌，然后摸两张牌，令〖行图〗②重新生效。\"\r\n        },\r\n        rank: rank.epic\r\n    },\r\n    PSshen_liubei: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"shen\",\r\n            hp: 6,\r\n            skills: [\r\n                \"PSlongnu\",\r\n                \"PSlb_jieying\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“希神文祖华”设计\",\r\n        skills: {\r\n            PSlongnu: {\r\n                mark: true,\r\n                locked: true,\r\n                zhuanhuanji: true,\r\n                marktext: \"☯\",\r\n                derivation: [\r\n                    \"nuzhan\",\r\n                    \"liyong\"\r\n                ],\r\n                init: (player) => {\r\n                    if (player.storage.PSlongnu == void 0) player.changeZhuanhuanji('PSlongnu');\r\n                    if (!lib.skill.nuzhan.audioname2) lib.skill.nuzhan.audioname2 = {};\r\n                    lib.skill.nuzhan.audioname2.PSshen_liubei = \"wusheng_jsp_guanyu\";\r\n                },\r\n                intro: {\r\n                    content: function (storage, player, skill) {\r\n                        if (player.storage.PSlongnu == true) return '锁定技，出牌阶段开始时，你失去1点体力并摸一张牌，然后本阶段内你视为拥有技能〖怒斩〗，且你的红色手牌均视为火【杀】且无距离限制。';\r\n                        return '锁定技，出牌阶段开始时，你减1点体力上限并摸一张牌，然后本阶段内你然后本阶段内你视为拥有技能〖厉勇〗，且你的锦囊牌均视为雷【杀】且无使用次数限制。';\r\n                    }\r\n                },\r\n                audio: \"nzry_longnu\",\r\n                trigger: {\r\n                    player: \"phaseUseBegin\"\r\n                },\r\n                forced: true,\r\n                content: function () {\r\n                    'step 0'\r\n                    if (player.storage.PSlongnu == true) {\r\n                        player.loseHp();\r\n                    }\r\n                    else {\r\n                        player.loseMaxHp();\r\n                    }\r\n                    player.draw();\r\n                    'step 1'\r\n                    if (player.storage.PSlongnu == true) {\r\n                        player.addTempSkill('PSlongnu_yang', 'phaseUseAfter');\r\n                        player.addTempSkill('nuzhan', 'phaseUseAfter');\r\n                    }\r\n                    else {\r\n                        player.addTempSkill('PSlongnu_yin', 'phaseUseAfter');\r\n                        player.addTempSkill('liyong', 'phaseUseAfter');\r\n                    }\r\n                    player.changeZhuanhuanji('PSlongnu');\r\n                },\r\n                subSkill: {\r\n                    yang: {\r\n                        mod: {\r\n                            cardname: function (card, player) {\r\n                                if (get.color(card) == 'red') return 'sha';\r\n                            },\r\n                            cardnature: function (card, player) {\r\n                                if (get.color(card) == 'red') return 'fire';\r\n                            },\r\n                            targetInRange: function (card) {\r\n                                if (get.color(card) == 'red') return true;\r\n                            }\r\n                        },\r\n                        ai: {\r\n                            effect: {\r\n                                target: function (card, player, target, current) {\r\n                                    if (get.tag(card, 'respondSha') && current < 0) return 0.6\r\n                                }\r\n                            },\r\n                            respondSha: true\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    yin: {\r\n                        mod: {\r\n                            cardname: function (card, player) {\r\n                                if (['trick', 'delay'].includes(lib.card[card.name].type)) return 'sha';\r\n                            },\r\n                            cardnature: function (card, player) {\r\n                                if (['trick', 'delay'].includes(lib.card[card.name].type)) return 'thunder';\r\n                            },\r\n                            cardUsable: function (card, player) {\r\n                                if (card.name == 'sha' && game.hasNature(card, 'thunder')) return Infinity;\r\n                            }\r\n                        },\r\n                        ai: {\r\n                            effect: {\r\n                                target: function (card, player, target, current) {\r\n                                    if (get.tag(card, 'respondSha') && current < 0) return 0.6\r\n                                }\r\n                            },\r\n                            respondSha: true\r\n                        },\r\n                        sub: true\r\n                    }\r\n                },\r\n                ai: {\r\n                    fireAttack: true,\r\n                    halfneg: true,\r\n                    threaten: 1.05\r\n                }\r\n            },\r\n            PSlb_jieying: {\r\n                audio: \"nzry_jieying\",\r\n                locked: true,\r\n                global: \"PSlb_jieying_3\",\r\n                ai: {\r\n                    effect: {\r\n                        target: function (card) {\r\n                            if (card.name == 'tiesuo') return 'zeroplayertarget';\r\n                        }\r\n                    }\r\n                },\r\n                group: [\r\n                    \"PSlb_jieying_1\",\r\n                    \"PSlb_jieying_2\"\r\n                ],\r\n                subSkill: {\r\n                    1: {\r\n                        audio: \"nzry_jieying\",\r\n                        trigger: {\r\n                            player: [\r\n                                \"linkBefore\",\r\n                                \"enterGame\"\r\n                            ],\r\n                            global: \"phaseBefore\"\r\n                        },\r\n                        forced: true,\r\n                        filter: function (event, player) {\r\n                            if (event.name == 'link') return player.isLinked();\r\n                            return (event.name != 'phase' || game.phaseNumber == 0) && !player.isLinked();\r\n                        },\r\n                        content: function () {\r\n                            if (trigger.name != 'link') player.link(true);\r\n                            else trigger.cancel();\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    2: {\r\n                        audio: \"nzry_jieying\",\r\n                        trigger: {\r\n                            player: [\r\n                                \"changeHp\",\r\n                                \"loseMaxHpAfter\"\r\n                            ]\r\n                        },\r\n                        direct: true,\r\n                        content: function () {\r\n                            \"step 0\"\r\n                            player.draw();\r\n                            if (game.hasPlayer(function (current) {\r\n                                return current != player && !current.isLinked();\r\n                            })) player.chooseTarget(true, '请选择【结营】的目标', function (card, player, target) {\r\n                                return target != player && !target.isLinked();\r\n                            }).ai = function (target) {\r\n                                return 1 + Math.random();\r\n                            };\r\n                            else event.finish();\r\n                            \"step 1\"\r\n                            if (result.bool) {\r\n                                player.line(result.targets);\r\n                                player.logSkill('PSlb_jieying');\r\n                                result.targets[0].link(true);\r\n                            } else {\r\n                                event.finish();\r\n                            };\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    3: {\r\n                        mod: {\r\n                            maxHandcard: function (player, num) {\r\n                                if (game.countPlayer(function (current) { return current.hasSkill('PSlb_jieying') }) > 0 && player.isLinked()) return num + 2;\r\n                            }\r\n                        },\r\n                        sub: true\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_shen,\r\n        translate: {\r\n            PSshen_liubei: \"PS神刘备\",\r\n            PSlongnu: \"龙怒\",\r\n            PSlongnu_info: \"转换技，锁定技，阳：出牌阶段开始时，你失去1点体力并摸一张牌，然后本阶段内你视为拥有技能〖怒斩〗，且你的红色手牌均视为火【杀】且无距离限制。阴：出牌阶段开始时，你减1点体力上限并摸一张牌，然后本阶段内你然后本阶段内你视为拥有技能〖厉勇〗，且你的锦囊牌均视为雷【杀】且无使用次数限制。\",\r\n            PSlb_jieying: \"结营\",\r\n            PSlb_jieying_info: \"锁定技，游戏开始时或当你的武将牌重置时，你横置；所有已横置的角色手牌上限+2；当你的体力或体力上限变化后，你摸一张牌，然后横置一名其他角色。\"\r\n        },\r\n        dynamicTranslate: {\r\n            PSlongnu: function (player) {\r\n                if (player.storage.PSlongnu == true)\r\n                    return '转换技，锁定技，<span class=\"bluetext\">阳：出牌阶段开始时，你失去1点体力并摸一张牌，然后本阶段内你视为拥有技能〖怒斩〗，且你的红色手牌均视为火【杀】且无距离限制。</span>阴：出牌阶段开始时，你减1点体力上限并摸一张牌，然后本阶段内你然后本阶段内你视为拥有技能〖厉勇〗，且你的锦囊牌均视为雷【杀】且无使用次数限制。';\r\n                return '转换技，锁定技，阳：出牌阶段开始时，你失去1点体力并摸一张牌，然后本阶段内你视为拥有技能〖怒斩〗，且你的红色手牌均视为火【杀】且无距离限制。<span class=\"bluetext\">阴：出牌阶段开始时，你减1点体力上限并摸一张牌，然后本阶段内你然后本阶段内你视为拥有技能〖厉勇〗，且你的锦囊牌均视为雷【杀】且无使用次数限制。</span>';\r\n            }\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PSjin_duyu: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"jin\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PSsanchen\",\r\n                \"PSzhaotao\",\r\n                \"PSpozhu\"\r\n            ],\r\n            dieAudios: [\r\n                \"duyu\"\r\n            ],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“一顿七只屑狐狸”设计\",\r\n        skills: {\r\n            PSsanchen: {\r\n                audio: \"sanchen\",\r\n                enable: \"phaseUse\",\r\n                usable: 3,\r\n                init: function (player) {\r\n                    if (!player.storage.PSsanchen) player.storage.PSsanchen = 0;\r\n                },\r\n                content: function () {\r\n                    'step 0'\r\n                    player.draw(3);\r\n                    player.storage.PSsanchen++;\r\n                    'step 1'\r\n                    if (!game.hasPlayer(current => { return current.countCards('h') > 0 && current != player })) { event.finish(); return; }\r\n                    player.chooseTarget('弃置一名其他角色手牌').set('filterTarget', function (card, player, target) {\r\n                        return target != player && target.countCards('h') > 0;\r\n                    }).set('ai', function (target) {\r\n                        var player = _status.event.player;\r\n                        return -get.attitude(player, target);\r\n                    });\r\n                    'step 2'\r\n                    if (result.bool) {\r\n                        var target = result.targets[0];\r\n                        player.logSkill('PSsanchen', target);\r\n                        player.discardPlayerCard(target, [1, Infinity], 'h', false, 'visible').set('filterButton', function (button) {\r\n                            for (var i = 0; i < ui.selected.buttons.length; i++) {\r\n                                if (get.suit(button.link) == get.suit(ui.selected.buttons[i].link)) return false;\r\n                            };\r\n                            return true;\r\n                        }).set('ai', function (card) {\r\n                            return 10 - target.hp - get.value(card);\r\n                        }).set('prompt', '三陈：弃置' + get.translation(target) + '花色不同的牌').set('complexCard', true);\r\n                    }\r\n                },\r\n                ai: {\r\n                    order: 10\r\n                }\r\n            },\r\n            PSzhaotao: {\r\n                audio: \"zhaotao\",\r\n                forbid: [\r\n                    \"guozhan\"\r\n                ],\r\n                trigger: {\r\n                    player: \"phaseJieshuBegin\"\r\n                },\r\n                forced: true,\r\n                juexingji: true,\r\n                skillAnimation: true,\r\n                animationColor: \"thunder\",\r\n                filter: function (event, player) {\r\n                    return player.storage.PSsanchen && player.storage.PSsanchen > 2;\r\n                },\r\n                content: function () {\r\n                    player.awakenSkill('PSzhaotao');\r\n                    player.gainMaxHp();\r\n                    player.recover();\r\n                    if (!player.isDisabledJudge()) {\r\n                        player.disableJudge();\r\n                        game.log(player, '废除了判定区');\r\n                    }\r\n                    player.addSkills('PSjin_miewu');\r\n                },\r\n                derivation: \"PSjin_miewu\"\r\n            },\r\n            PSpozhu: {\r\n                audio: \"pozhu\",\r\n                enable: \"phaseUse\",\r\n                filter: function (event, player) {\r\n                    return player.countCards('he') > 1;\r\n                },\r\n                filterCard: function () {\r\n                    if (ui.selected.targets.length) return false;\r\n                    return true;\r\n                },\r\n                position: \"he\",\r\n                selectCard: 2,\r\n                complexSelect: true,\r\n                complexCard: true,\r\n                filterTarget: function (card, player, target) {\r\n                    return target != player;\r\n                },\r\n                check: function (card) {\r\n                    return 6 - get.value(card);\r\n                },\r\n                content: function () {\r\n                    target.damage('nocard');\r\n                },\r\n                ai: {\r\n                    damage: true,\r\n                    order: 2,\r\n                    result: {\r\n                        target: function (player, target) {\r\n                            return get.damageEffect(target, player);\r\n                        }\r\n                    },\r\n                    threaten: 1.5,\r\n                    expose: 0.3\r\n                }\r\n            },\r\n            PSjin_miewu: {\r\n                audio: \"spmiewu\",\r\n                trigger: {\r\n                    player: \"phaseJudgeBefore\"\r\n                },\r\n                forced: true,\r\n                filter: function (event, player) {\r\n                    return player.isDisabledJudge();\r\n                },\r\n                content: function () {\r\n                    'step 0'\r\n                    trigger.cancel();\r\n                    'step 1'\r\n                    var next = player.phaseDraw();\r\n                    event.next.remove(next);\r\n                    trigger.getParent().next.push(next);\r\n                },\r\n                ai: {\r\n                    effect: {\r\n                        target: function (card, player, target) {\r\n                            if (get.type(card) == 'delay') return 'zerotarget';\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_jin,\r\n        translate: {\r\n            PSjin_duyu: \"PS晋杜预\",\r\n            PSjin_duyu_prefix: \"PS晋\",\r\n            PSsanchen: \"三陈\",\r\n            PSsanchen_info: \"出牌阶段限三次，你可以摸3张牌，然后观看一名其他角色的手牌，从中弃置任意张花色不同的牌。\",\r\n            PSzhaotao: \"诏讨\",\r\n            PSzhaotao_info: \"觉醒技，结束阶段开始时，若你本局游戏已发动两次以上〖三陈〗，你增加一点体力上限并回复一点体力，废除判定区，然后获得〖灭吴〗。\",\r\n            PSpozhu: \"破竹\",\r\n            PSpozhu_info: \"出牌阶段，你可以弃置两张牌，对一名其他角色造成一点伤害。\",\r\n            PSjin_miewu: \"灭吴\",\r\n            PSjin_miewu_info: \"锁定技，若你的判定区已废除，则你的判定阶段视为摸牌阶段。\"\r\n        },\r\n        rank: rank.epic\r\n    },\r\n    PSsb_xushao: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"qun\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PSsb_pingjian\"\r\n            ],\r\n            dieAudios: [\r\n                \"xushao\"\r\n            ],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“才七乓”设计\",\r\n        skills: {\r\n            PSsb_pingjian: {\r\n                audio: \"pingjian\",\r\n                trigger: {\r\n                    player: [\r\n                        \"damageEnd\",\r\n                        \"phaseJieshuBegin\"\r\n                    ]\r\n                },\r\n                initList: function () {\r\n                    var list = [];\r\n                    if (_status.connectMode) var list = get.charactersOL();\r\n                    else {\r\n                        var list = [];\r\n                        for (var i in lib.character) {\r\n                            if (lib.filter.characterDisabled2(i) || lib.filter.characterDisabled(i)) continue;\r\n                            list.push(i);\r\n                        }\r\n                    }\r\n                    game.countPlayer2(function (current) {\r\n                        list.remove(current.name);\r\n                        list.remove(current.name1);\r\n                        list.remove(current.name2);\r\n                        if (current.storage.rehuashen && current.storage.rehuashen.character) list.removeArray(current.storage.rehuashen.character)\r\n                    });\r\n                    _status.characterlist = list;\r\n                },\r\n                frequent: true,\r\n                chooseToPingJian: function () {\r\n                    'step 0'\r\n                    var list1 = event.list1,\r\n                        list2 = event.list2;\r\n                    var switchToAuto = function () {\r\n                        _status.imchoosing = false;\r\n                        var newList = list2.flat();\r\n                        for (var i = 0; i < newList.length; i++) {\r\n                            if (lib.skill[newList[i]].ai && lib.skill[newList[i]].ai.combo) newList.remove(newList[i]);\r\n                        }\r\n                        event._result = {\r\n                            bool: true,\r\n                            skills: newList.randomGets(event.total),\r\n                        };\r\n                        if (event.initbg) event.initbg.close();\r\n                        if (event.control) event.control.close();\r\n                    };\r\n                    var chooseButton = function (list1, list2) {\r\n                        var event = _status.event;\r\n                        if (!event._result) event._result = {};\r\n                        event._result.skills = [];\r\n                        if (game.TLHasExt('十周年')) {\r\n                            var con = document.getElementById('dui-controls');\r\n                            if (con) con.classList.add('Tlao_confirmdown2');\r\n                        }\r\n                        event.initbg = ui.create.div('.Tlao_initbg', document.body);\r\n                        event.initbg.addEventListener(lib.config.touchscreen ? 'touchend' : 'click', function () {\r\n                            game.TLremoveSkillInfo();\r\n                        }, true)\r\n                        var initDialog = ui.create.div('.Tlao_init', event.initbg);\r\n                        initDialog.addEventListener(lib.config.touchscreen ? 'touchend' : 'click', function () {\r\n                            game.TLremoveSkillInfo();\r\n                        }, true)\r\n                        if (!game.TLHasExt('十周年')) initDialog.style.transform = 'translate(-50%,-90%)';\r\n                        var initTopic = ui.create.div('.Tlao_inittishi', initDialog);\r\n                        initTopic.textContent = event.topic;\r\n                        game.TLCreateStand(player, initDialog, 266, 1);\r\n                        var initBord = ui.create.div('', initDialog);\r\n                        initBord.style.cssText = 'width:586px;height:216px;top:33px;right:60px;positon:\"absolute\";';\r\n                        var skills = event.list2.flat(), num = 0;\r\n                        for (var i = 0; i < event.list1.length; i++) {\r\n                            var x = i * (104 - list1.length * 4) + (8 - list1.length) * 35 + 35;\r\n                            game.TLCreateHead(event.list1[i], initBord, 68, x, 12);\r\n                            for (var j = 0; j < event.list2[i].length; j++) {\r\n                                var td = ui.create.div('.Tlao_skillnode', initBord);\r\n                                if (get.info(list2[i][j]).limited || get.info(list2[i][j]).juexingji) td.classList.add('Tlao_skillnodelimit');\r\n                                td.link = skills[num];\r\n                                num++;\r\n                                td.textContent = get.translation(event.list2[i][j]);\r\n                                td.style.left = (x - 3) + 'px';\r\n                                td.style.top = (84 + j * 40) + 'px';\r\n                                td.addEventListener(lib.config.touchscreen ? 'touchend' : 'click', function () {\r\n                                    this.style.animation = 'initbutton 0.2s forwards';\r\n                                    this.addEventListener('animationend', function () { this.style.animation = ''; });\r\n                                    game.TLremoveSkillInfo();\r\n                                    if (this.classList.contains('Tlao_initselected')) {\r\n                                        this.classList.remove('Tlao_initselected');\r\n                                        event._result.skills.remove(this.link);\r\n                                    } else if (this.classList.contains('Tlao_initselected2')) {\r\n                                        this.classList.remove('Tlao_initselected2');\r\n                                        event._result.skills.remove(this.link);\r\n                                    } else {\r\n                                        if (event._result.skills.length < event.total) {\r\n                                            if (this.classList.contains('Tlao_skillnodelimit')) this.classList.add('initselected2');\r\n                                            else this.classList.add('Tlao_initselected');\r\n                                            event._result.skills.push(this.link);\r\n                                        }\r\n                                        game.TLcreateSkillInfo(this.link, event.initbg);\r\n                                    }\r\n                                }, true)\r\n                            }\r\n                        }\r\n                        var prompt = ui.create.div('', initDialog);\r\n                        prompt.style.cssText = 'width:100%;height:20px;left:0;bottom:0;text-align:center;font-family:\"yuanli\";font-size:20px;line-height:18px;color:#f1dfcc;filter: drop-shadow(1px 0 0 #664934) drop-shadow(-1px 0 0 #664934) drop-shadow(0 1px 0 #664934) drop-shadow(0 -1px 0 #664934);transform:translateY(220%);letter-spacing:3px;pointer-events:none;';\r\n                        prompt.textContent = '请选择' + get.cnNumber(event.total) + '个武将技能';\r\n                        event.switchToAuto = function () {\r\n                            if (game.TLHasExt('十周年')) {\r\n                                var con = document.getElementById('dui-controls');\r\n                                if (con) con.classList.remove('Tlao_confirmdown2');\r\n                            }\r\n                            event.initbg.remove();\r\n                            event.control.close();\r\n                            game.resume();\r\n                            _status.imchoosing = false;\r\n                        };\r\n                        event.control = ui.create.control('ok', function (link) {\r\n                            if (game.TLHasExt('十周年')) {\r\n                                var con = document.getElementById('dui-controls');\r\n                                if (con) con.classList.remove('Tlao_confirmdown2');\r\n                            }\r\n                            event.initbg.remove();\r\n                            event.control.close();\r\n                            game.resume();\r\n                            _status.imchoosing = false;\r\n                        });\r\n                        game.pause();\r\n                        game.countChoose();\r\n                    };\r\n                    if (event.isMine()) {\r\n                        chooseButton(list1, list2);\r\n                    }\r\n                    else if (event.isOnline()) {\r\n                        event.player.send(chooseButton, list1, list2);\r\n                        event.player.wait();\r\n                        game.pause();\r\n                    }\r\n                    else {\r\n                        switchToAuto();\r\n                    }\r\n                    'step 1'\r\n                    var map = event.result || result;\r\n                    if (map && map.skills && map.skills.length) {\r\n                        for (var i of map.skills) {\r\n                            if (event.triggername == 'phaseUse') {\r\n                                player.storage.PSsb_pingjian.add(i);\r\n                                player.addTempSkill(i, 'phaseUseEnd');\r\n                                player.addTempSkill('PSsb_pingjian_temp', 'phaseUseEnd');\r\n                                if (!player.storage.PSsb_pingjian_temp) player.storage.PSsb_pingjian_temp = [];\r\n                                player.storage.PSsb_pingjian_temp.add(i);\r\n                            }\r\n                            else {\r\n                                player.storage.PSsb_pingjian.add(i);\r\n                                player.addTempSkill(i, event.triggername == 'damageEnd' ? 'damageAfter' : 'phaseJieshu');\r\n                            }\r\n                        }\r\n                    }\r\n                    game.broadcastAll(function (list) {\r\n                        game.expandSkills(list);\r\n                        for (var i of list) {\r\n                            var info = lib.skill[i];\r\n                            if (!info) continue;\r\n                            if (!info.audioname2) info.audioname2 = {};\r\n                            info.audioname2.old_yuanshu = 'weidi';\r\n                        }\r\n                    }, map.skills);\r\n                },\r\n                content: function () {\r\n                    'step 0'\r\n                    if (!player.storage.PSsb_pingjian) player.storage.PSsb_pingjian = [];\r\n                    event._result = { bool: true };\r\n                    'step 1'\r\n                    if (result.bool) {\r\n                        if (!_status.characterlist) {\r\n                            lib.skill.PSsb_pingjian.initList();\r\n                        }\r\n                        var list = [];\r\n                        var skills = [];\r\n                        var map = [];\r\n                        _status.characterlist.randomSort();\r\n                        var name2 = event.triggername;\r\n                        for (var i = 0; i < _status.characterlist.length; i++) {\r\n                            var name = _status.characterlist[i];\r\n                            if (!name || (name.indexOf('zuoci') != -1 || name.indexOf('xushao') != -1)) continue;\r\n                            var skills2 = lib.character[name][3];\r\n                            for (var j = 0; j < skills2.length; j++) {\r\n                                if (player.storage.PSsb_pingjian.includes(skills2[j])) continue;\r\n                                if (skills.includes(skills2[j]) && lib.skill.PSfushi.characterList().includes(name)) {\r\n                                    list.add(name);\r\n                                    if (!map[name]) map[name] = [];\r\n                                    map[name].push(skills2[j]);\r\n                                    skills.add(skills2[j]);\r\n                                    continue;\r\n                                }\r\n                                var list2 = [skills2[j]];\r\n                                game.expandSkills(list2);\r\n                                for (var k = 0; k < list2.length; k++) {\r\n                                    var info = lib.skill[list2[k]];\r\n                                    if (!info || !info.trigger || !info.trigger.player || info.silent || info.limited || info.juexingji || info.zhuanhuanji || info.hiddenSkill || info.dutySkill) continue;\r\n                                    if ((info.trigger.player == name2 || Array.isArray(info.trigger.player) && info.trigger.player.includes(name2)) && lib.skill.PSfushi.characterList().includes(name)) {\r\n                                        if (info.init || info.ai && (info.ai.combo || info.ai.notemp || info.ai.neg)) continue;\r\n                                        if (info.filter) {\r\n                                            try {\r\n                                                var bool = info.filter(trigger, player, name2);\r\n                                                if (!bool) continue;\r\n                                            }\r\n                                            catch (e) {\r\n                                                continue;\r\n                                            }\r\n                                        }\r\n                                        list.add(name);\r\n                                        if (!map[name]) map[name] = [];\r\n                                        map[name].push(skills2[j]);\r\n                                        skills.add(skills2[j]);\r\n                                        break;\r\n                                    }\r\n                                }\r\n                            }\r\n                            if (list.length > 5) break;\r\n                        }\r\n                        if (!skills.length) {\r\n                            //player.draw();\r\n                            event.finish();\r\n                        }\r\n                        else {\r\n                            //skills.unshift('摸一张牌');\r\n                            if (player.isUnderControl()) {\r\n                                game.swapPlayerAuto(player);\r\n                            }\r\n                            if (false/* lib.config.extensions && lib.config.extensions.includes('天牢令') && lib.config['extension_天牢令_enable'] && game.TLHasExt */) {\r\n                                var skillx = skills.slice(0);\r\n                                skills = [];\r\n                                for (var i = 0; i < list.length; i++) {\r\n                                    skills[i] = (lib.character[list[i]][3] || []).filter(function (skill) {\r\n                                        return skillx.includes(skill);\r\n                                    });\r\n                                }\r\n                                if (!list.length || !skills.length) { event.finish(); return; }\r\n                                var next = game.createEvent('chooseToPingJian');\r\n                                next.player = player;\r\n                                next.list1 = list;\r\n                                next.list2 = skills;\r\n                                next.topic = '评荐';\r\n                                next.total = 2;\r\n                                next.triggername = event.triggername == 'damageEnd' ? 'damageAfter' : 'phaseJieshu';\r\n                                next.setContent(lib.skill.PSsb_pingjian.chooseToPingJian);\r\n                                event.finish();\r\n                                return;\r\n                            }\r\n                            var switchToAuto = function () {\r\n                                _status.imchoosing = false;\r\n                                event._result = {\r\n                                    bool: true,\r\n                                    skills: skills.randomGets(2),\r\n                                };\r\n                                if (event.dialog) event.dialog.close();\r\n                                if (event.control) event.control.close();\r\n                            };\r\n                            var chooseButton = function (list, skills) {\r\n                                var event = _status.event;\r\n                                if (!event._result) event._result = {};\r\n                                event._result.skills = [];\r\n                                var rSkill = event._result.skills;\r\n                                var dialog = ui.create.dialog('请选择发动至多两个技能', [list, 'character'], 'hidden');\r\n                                event.dialog = dialog;\r\n                                var table = document.createElement('div');\r\n                                table.classList.add('add-setting');\r\n                                table.style.margin = '0';\r\n                                table.style.width = '100%';\r\n                                table.style.position = 'relative';\r\n                                for (var i = 0; i < skills.length; i++) {\r\n                                    var td = ui.create.div('.shadowed.reduce_radius.pointerdiv.tdnode');\r\n                                    td.link = skills[i];\r\n                                    table.appendChild(td);\r\n                                    td.innerHTML = '<span>' + get.translation(skills[i]) + '</span>';\r\n                                    td.addEventListener(lib.config.touchscreen ? 'touchend' : 'click', function () {\r\n                                        if (_status.dragged) return;\r\n                                        if (_status.justdragged) return;\r\n                                        _status.tempNoButton = true;\r\n                                        setTimeout(function () {\r\n                                            _status.tempNoButton = false;\r\n                                        }, 500);\r\n                                        var link = this.link;\r\n                                        if (!this.classList.contains('bluebg')) {\r\n                                            if (rSkill.length >= 2) return;\r\n                                            rSkill.add(link);\r\n                                            this.classList.add('bluebg');\r\n                                        }\r\n                                        else {\r\n                                            this.classList.remove('bluebg');\r\n                                            rSkill.remove(link);\r\n                                        }\r\n                                    });\r\n                                }\r\n                                dialog.content.appendChild(table);\r\n                                dialog.add('　　');\r\n                                dialog.open();\r\n\r\n                                event.switchToAuto = function () {\r\n                                    event.dialog.close();\r\n                                    event.control.close();\r\n                                    game.resume();\r\n                                    _status.imchoosing = false;\r\n                                };\r\n                                event.control = ui.create.control('ok', function (link) {\r\n                                    event.dialog.close();\r\n                                    event.control.close();\r\n                                    game.resume();\r\n                                    _status.imchoosing = false;\r\n                                });\r\n                                for (var i = 0; i < event.dialog.buttons.length; i++) {\r\n                                    event.dialog.buttons[i].classList.add('selectable');\r\n                                }\r\n                                game.pause();\r\n                                game.countChoose();\r\n                            };\r\n                            if (event.isMine()) {\r\n                                chooseButton(list, skills);\r\n                            }\r\n                            else if (event.isOnline()) {\r\n                                event.player.send(chooseButton, list, skills);\r\n                                event.player.wait();\r\n                                game.pause();\r\n                            }\r\n                            else {\r\n                                switchToAuto();\r\n                            }\r\n                        }\r\n                    }\r\n                    else event.finish();\r\n                    'step 2'\r\n                    var map = event.result || result;\r\n                    if (map && map.skills && map.skills.length) {\r\n                        for (var i of map.skills) {\r\n                            player.storage.PSsb_pingjian.add(i);\r\n                            player.addTempSkill(i, event.triggername == 'damageEnd' ? 'damageAfter' : 'phaseJieshu');\r\n                        }\r\n                    }\r\n                    game.broadcastAll(function (list) {\r\n                        game.expandSkills(list);\r\n                        for (var i of list) {\r\n                            var info = lib.skill[i];\r\n                            if (!info) continue;\r\n                            if (!info.audioname2) info.audioname2 = {};\r\n                            info.audioname2.old_yuanshu = 'weidi';\r\n                        }\r\n                    }, map.skills);\r\n\r\n\r\n                    if (result.control == '摸一张牌') {\r\n                        player.draw();\r\n                        return;\r\n                    }\r\n\r\n                },\r\n                group: \"PSsb_pingjian_use\",\r\n                phaseUse_special: [\r\n                    \"xinfu_lingren\"\r\n                ],\r\n                subSkill: {\r\n                    use: {\r\n                        usable: 1,\r\n                        sub: true,\r\n                        audio: \"pingjian\",\r\n                        enable: \"phaseUse\",\r\n                        position: \"he\",\r\n                        content: function () {\r\n                            'step 0'\r\n                            if (!player.storage.PSsb_pingjian) player.storage.PSsb_pingjian = [];\r\n                            event._result = { bool: true };\r\n                            'step 1'\r\n                            if (result.bool) {\r\n                                var list = [];\r\n                                var skills = [];\r\n                                var map = [];\r\n                                if (!_status.characterlist) {\r\n                                    lib.skill.PSsb_pingjian.initList();\r\n                                }\r\n                                _status.characterlist.randomSort();\r\n                                for (var i = 0; i < _status.characterlist.length; i++) {\r\n                                    var name = _status.characterlist[i];\r\n                                    if (!name || (name.indexOf('zuoci') != -1 || name.indexOf('xushao') != -1)) continue;\r\n                                    var skills2 = lib.character[name][3];\r\n                                    for (var j = 0; j < skills2.length; j++) {\r\n                                        if (player.storage.PSsb_pingjian.includes(skills2[j])) continue;\r\n                                        if ((skills.includes(skills2[j]) || lib.skill.PSsb_pingjian.phaseUse_special.includes(skills2[j])) && lib.skill.PSfushi.characterList().includes(name)) {\r\n                                            list.add(name);\r\n                                            if (!map[name]) map[name] = [];\r\n                                            map[name].push(skills2[j]);\r\n                                            skills.add(skills2[j]);\r\n                                            continue;\r\n                                        }\r\n                                        var list2 = [skills2[j]];\r\n                                        game.expandSkills(list2);\r\n                                        for (var k = 0; k < list2.length; k++) {\r\n                                            var info = lib.skill[list2[k]];\r\n                                            if (!info || !info.enable || info.viewAs || info.limited || info.juexingji || info.zhuanhuanji || info.hiddenSkill || info.dutySkill) continue;\r\n                                            if ((info.enable == 'phaseUse' || Array.isArray(info.enable) && info.enable.includes('phaseUse')) && lib.skill.PSfushi.characterList().includes(name)) {\r\n                                                if (info.init || info.onChooseToUse || info.ai && (info.ai.combo || info.ai.notemp || info.ai.neg)) continue;\r\n                                                if (info.filter) {\r\n                                                    try {\r\n                                                        var bool = info.filter(event.getParent(2), player);\r\n                                                        if (!bool) continue;\r\n                                                    }\r\n                                                    catch (e) {\r\n                                                        continue;\r\n                                                    }\r\n                                                }\r\n                                                list.add(name);\r\n                                                if (!map[name]) map[name] = [];\r\n                                                map[name].push(skills2[j]);\r\n                                                skills.add(skills2[j]);\r\n                                                break;\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                    if (list.length > 5) break;\r\n                                }\r\n                                if (!skills.length) {\r\n                                    //player.draw();\r\n                                    event.finish();\r\n                                }\r\n                                else {\r\n                                    if (player.isUnderControl()) {\r\n                                        game.swapPlayerAuto(player);\r\n                                    }\r\n                                    if (false/* lib.config.extensions && lib.config.extensions.includes('天牢令') && lib.config['extension_天牢令_enable'] && game.TLHasExt */) {\r\n                                        var skillx = skills.slice(0);\r\n                                        skills = [];\r\n                                        for (var i = 0; i < list.length; i++) {\r\n                                            skills[i] = (lib.character[list[i]][3] || []).filter(function (skill) {\r\n                                                return skillx.includes(skill);\r\n                                            });\r\n                                        }\r\n                                        if (!list.length || !skills.length) { event.finish(); return; }\r\n                                        var next = game.createEvent('chooseToPingJian');\r\n                                        next.player = player;\r\n                                        next.list1 = list;\r\n                                        next.list2 = skills;\r\n                                        next.topic = '评荐';\r\n                                        next.total = 2;\r\n                                        next.triggername = 'phaseUse';\r\n                                        next.setContent(lib.skill.PSsb_pingjian.chooseToPingJian);\r\n                                        event.finish();\r\n                                        return;\r\n                                    }//skills.unshift('摸一张牌');\r\n                                    var switchToAuto = function () {\r\n                                        _status.imchoosing = false;\r\n                                        event._result = {\r\n                                            bool: true,\r\n                                            skills: skills.randomGets(2),\r\n                                        };\r\n                                        if (event.dialog) event.dialog.close();\r\n                                        if (event.control) event.control.close();\r\n                                    };\r\n                                    var chooseButton = function (list, skills) {\r\n                                        var event = _status.event;\r\n                                        if (!event._result) event._result = {};\r\n                                        event._result.skills = [];\r\n                                        var rSkill = event._result.skills;\r\n                                        var dialog = ui.create.dialog('请选择发动至多两个技能', [list, 'character'], 'hidden');\r\n                                        event.dialog = dialog;\r\n                                        var table = document.createElement('div');\r\n                                        table.classList.add('add-setting');\r\n                                        table.style.margin = '0';\r\n                                        table.style.width = '100%';\r\n                                        table.style.position = 'relative';\r\n                                        for (var i = 0; i < skills.length; i++) {\r\n                                            var td = ui.create.div('.shadowed.reduce_radius.pointerdiv.tdnode');\r\n                                            td.link = skills[i];\r\n                                            table.appendChild(td);\r\n                                            td.innerHTML = '<span>' + get.translation(skills[i]) + '</span>';\r\n                                            td.addEventListener(lib.config.touchscreen ? 'touchend' : 'click', function () {\r\n                                                if (_status.dragged) return;\r\n                                                if (_status.justdragged) return;\r\n                                                _status.tempNoButton = true;\r\n                                                setTimeout(function () {\r\n                                                    _status.tempNoButton = false;\r\n                                                }, 500);\r\n                                                var link = this.link;\r\n                                                if (!this.classList.contains('bluebg')) {\r\n                                                    if (rSkill.length >= 2) return;\r\n                                                    rSkill.add(link);\r\n                                                    this.classList.add('bluebg');\r\n                                                }\r\n                                                else {\r\n                                                    this.classList.remove('bluebg');\r\n                                                    rSkill.remove(link);\r\n                                                }\r\n                                            });\r\n                                        }\r\n                                        dialog.content.appendChild(table);\r\n                                        dialog.add('　　');\r\n                                        dialog.open();\r\n\r\n                                        event.switchToAuto = function () {\r\n                                            event.dialog.close();\r\n                                            event.control.close();\r\n                                            game.resume();\r\n                                            _status.imchoosing = false;\r\n                                        };\r\n                                        event.control = ui.create.control('ok', function (link) {\r\n                                            event.dialog.close();\r\n                                            event.control.close();\r\n                                            game.resume();\r\n                                            _status.imchoosing = false;\r\n                                        });\r\n                                        for (var i = 0; i < event.dialog.buttons.length; i++) {\r\n                                            event.dialog.buttons[i].classList.add('selectable');\r\n                                        }\r\n                                        game.pause();\r\n                                        game.countChoose();\r\n                                    };\r\n                                    if (event.isMine()) {\r\n                                        chooseButton(list, skills);\r\n                                    }\r\n                                    else if (event.isOnline()) {\r\n                                        event.player.send(chooseButton, list, skills);\r\n                                        event.player.wait();\r\n                                        game.pause();\r\n                                    }\r\n                                    else {\r\n                                        switchToAuto();\r\n                                    }\r\n                                }\r\n                            }\r\n                            else event.finish();\r\n                            'step 2'\r\n                            var map = event.result || result;\r\n                            if (map && map.skills && map.skills.length) {\r\n                                for (var i of map.skills) {\r\n                                    player.storage.PSsb_pingjian.add(i);\r\n                                    player.addTempSkill(i, 'phaseUseEnd');\r\n                                    player.addTempSkill('PSsb_pingjian_temp', 'phaseUseEnd');\r\n                                    if (!player.storage.PSsb_pingjian_temp) player.storage.PSsb_pingjian_temp = [];\r\n                                    player.storage.PSsb_pingjian_temp.add(i);\r\n                                }\r\n                            }\r\n\r\n\r\n                            //event.getParent(2).goto(0);\r\n                        },\r\n                        ai: {\r\n                            order: 10,\r\n                            result: {\r\n                                player: 1\r\n                            }\r\n                        }\r\n                    },\r\n                    temp: {\r\n                        onremove: true,\r\n                        trigger: {\r\n                            player: [\r\n                                \"useSkillBegin\",\r\n                                \"useCard1\"\r\n                            ]\r\n                        },\r\n                        silent: true,\r\n                        firstDo: true,\r\n                        filter: function (event, player) {\r\n                            var info = lib.skill[event.skill];\r\n                            if (!info) return false;\r\n                            if (!player.storage.PSsb_pingjian_temp) return false;\r\n                            if (player.storage.PSsb_pingjian_temp.includes(event.skill)) return true;\r\n                            if (player.storage.PSsb_pingjian_temp.includes(info.sourceSkill) || player.storage.PSsb_pingjian_temp.includes(info.group)) return true;\r\n                            if (Array.isArray(info.group) && (info.group.includes(player.storage.PSsb_pingjian_temp[0]) || info.group.includes(player.storage.PSsb_pingjian_temp[1]))) return true;\r\n                            return false;\r\n                        },\r\n                        content: function () {\r\n                            var info = lib.skill[trigger.skill];\r\n                            for (var i of player.storage.PSsb_pingjian_temp) {\r\n                                if (Array.isArray(info.group) && info.group.includes(i)) {\r\n                                    player.removeSkills(i);\r\n                                    player.storage.PSsb_pingjian_temp.remove(i);\r\n                                    break;\r\n                                }\r\n                                if (info.sourceSkill == i || info.group == i || trigger.skill == i) {\r\n                                    player.removeSkills(i);\r\n                                    player.storage.PSsb_pingjian_temp.remove(i);\r\n                                    break;\r\n                                }\r\n                            }\r\n                            if (!player.storage.PSsb_pingjian_temp.length) {\r\n                                player.removeSkill('PSsb_pingjian_temp');\r\n                            }\r\n                        },\r\n                        forced: true,\r\n                        popup: false,\r\n                        sub: true\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_qun,\r\n        translate: {\r\n            PSsb_xushao: \"PS双倍许劭\",\r\n            PSsb_pingjian: \"评荐\",\r\n            PSsb_pingjian_info: \"结束阶段开始时/当你受到伤害后/出牌阶段限一次，你可以令系统随机从剩余武将牌堆中检索出6张拥有发动时机为结束阶段开始时/当你受到伤害后/出牌阶段的技能的武将牌。然后你可以选择尝试发动其中2个技能。每个技能每局只能选择一次。（村：受到伤害后不会失去已获得的“评鉴技能”）\"\r\n        },\r\n        rank: rank.epic\r\n    },\r\n    PSxushi: {\r\n        info: {\r\n            sex: \"female\",\r\n            group: \"wu\",\r\n            hp: 3,\r\n            skills: [\r\n                \"PSwengua\",\r\n                \"PSfuzhu\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“眼中藏着阿卡丽”设计\",\r\n        skills: {\r\n            PSwengua: {\r\n                global: \"PSwengua_use\",\r\n                group: [\r\n                    \"PSwengua_tag\",\r\n                    \"PSwengua_draw\"\r\n                ],\r\n                audio: \"wengua\",\r\n                subSkill: {\r\n                    use: {\r\n                        audio: \"wengua\",\r\n                        enable: \"phaseUse\",\r\n                        filter: function (event, player) {\r\n                            if (player.hasSkill('wengua3')) return false;\r\n                            return player.countCards('he') && game.hasPlayer(function (current) {\r\n                                return current.hasSkill('PSwengua');\r\n                            });\r\n                        },\r\n                        log: false,\r\n                        delay: false,\r\n                        filterCard: function (card, player) {\r\n                            var list = game.filterPlayer(function (current) {\r\n                                return current.hasSkill('PSwengua');\r\n                            });\r\n                            if (list.length == 1 && list[0] == player && player.storage.PSfuzhu) return false;\r\n                            return true;\r\n                        },\r\n                        selectCard: function () {\r\n                            var player = _status.event.player;\r\n                            var list = game.filterPlayer(function (current) {\r\n                                return current.hasSkill('PSwengua');\r\n                            });\r\n                            if (list.length == 1 && list[0] == player && player.storage.PSfuzhu) return -1;\r\n                            return 1;\r\n                        },\r\n                        discard: false,\r\n                        lose: false,\r\n                        position: \"he\",\r\n                        prompt: function () {\r\n                            var player = _status.event.player;\r\n                            var list = game.filterPlayer(function (current) {\r\n                                return current.hasSkill('PSwengua');\r\n                            });\r\n                            if (list.length == 1 && list[0] == player) {\r\n                                if (player.storage.PSfuzhu) return;\r\n                                return '将一张牌置于牌堆顶或是牌堆底';\r\n                            }\r\n                            var str = '将一张牌交给' + get.translation(list);\r\n                            if (list.length > 1) str += '中的一人';\r\n                            return str;\r\n                        },\r\n                        check: function (card) {\r\n                            if (card.name == 'sha') return 5;\r\n                            return 8 - get.value(card);\r\n                        },\r\n                        content: function () {\r\n                            \"step 0\"\r\n                            var targets = game.filterPlayer(function (current) {\r\n                                return current.hasSkill('PSwengua');\r\n                            });\r\n                            if (targets.length == 1) {\r\n                                event.target = targets[0];\r\n                                event.goto(2);\r\n                            }\r\n                            else if (targets.length > 0) {\r\n                                player.chooseTarget(true, '选择【问卦】的目标', function (card, player, target) {\r\n                                    return _status.event.list.includes(target);\r\n                                }).set('list', targets).set('ai', function (target) {\r\n                                    var player = _status.event.player;\r\n                                    return get.attitude(player, target);\r\n                                });\r\n                            }\r\n                            else {\r\n                                event.finish();\r\n                            }\r\n                            \"step 1\"\r\n                            if (result.bool && result.targets.length) {\r\n                                event.target = result.targets[0];\r\n                            }\r\n                            else {\r\n                                event.finish();\r\n                            }\r\n                            \"step 2\"\r\n                            if (event.target) {\r\n                                player.logSkill('PSwengua', event.target);\r\n                                player.addTempSkill('wengua3', 'phaseUseEnd');\r\n                                event.card = cards[0];\r\n                                if (event.target != player) {\r\n                                    player.give(cards, event.target);\r\n                                }\r\n                            }\r\n                            else {\r\n                                event.finish();\r\n                            }\r\n                            delete _status.noclearcountdown;\r\n                            game.stopCountChoose();\r\n                            \"step 3\"\r\n                            if (event.target.storage.PSfuzhu) {\r\n                                event.goto(8);\r\n                            }\r\n                            \"step 4\"\r\n                            if (event.target.getCards('he').includes(event.card)) {\r\n                                event.target.chooseControlList('问卦', '将' + get.translation(event.card) + '置于牌堆顶', '将' + get.translation(event.card) + '置于牌堆底', event.target == player, function () {\r\n                                    if (get.attitude(event.target, player) < 0) return 2;\r\n                                    return 1;\r\n                                });\r\n                            }\r\n                            else {\r\n                                event.finish();\r\n                            }\r\n                            \"step 5\"\r\n                            event.index = result.index;\r\n                            if (event.index == 0 || event.index == 1) {\r\n                                var next = event.target.lose(event.card, ui.cardPile);\r\n                                if (event.index == 0) next.insert_card = true;\r\n                                game.broadcastAll(function (player) {\r\n                                    var cardx = ui.create.card();\r\n                                    cardx.classList.add('infohidden');\r\n                                    cardx.classList.add('infoflip');\r\n                                    player.$throw(cardx, 1000, 'nobroadcast');\r\n                                }, event.target);\r\n                            }\r\n                            else event.finish();\r\n                            \"step 6\"\r\n                            game.delay();\r\n                            \"step 7\"\r\n                            if (event.index == 1) {\r\n                                game.log(event.target, '将获得的牌置于牌堆底');\r\n                                if (ui.cardPile.childElementCount == 1 || player == event.target) {\r\n                                    player.draw();\r\n                                }\r\n                                else {\r\n                                    game.asyncDraw([player, target], null, null);\r\n                                }\r\n                            }\r\n                            else if (event.index == 0) {\r\n                                game.log(player, '将获得的牌置于牌堆顶');\r\n                                if (ui.cardPile.childElementCount == 1 || player == event.target) {\r\n                                    player.draw('bottom');\r\n                                }\r\n                                else {\r\n                                    game.asyncDraw([player, target], null, null, true);\r\n                                }\r\n                            }\r\n                            event.finish();\r\n                            \"step 8\"\r\n                            event.target.chooseControl(['从牌堆顶摸牌', '从牌堆底摸牌']).set('ai', () => { return '从牌堆顶摸牌' });\r\n                            \"step 9\"\r\n                            if (result.index == 0) {\r\n                                if (ui.cardPile.childElementCount == 1 || player == event.target) {\r\n                                    player.draw();\r\n                                }\r\n                                else {\r\n                                    game.asyncDraw([player, target], null, null);\r\n                                }\r\n                            }\r\n                            else {\r\n                                if (ui.cardPile.childElementCount == 1 || player == event.target) {\r\n                                    player.draw('bottom');\r\n                                }\r\n                                else {\r\n                                    game.asyncDraw([player, target], null, null, true);\r\n                                }\r\n                            }\r\n                        },\r\n                        ai: {\r\n                            order: 2,\r\n                            threaten: 1.5,\r\n                            result: {\r\n                                player: function (player, target) {\r\n                                    var target = game.findPlayer(function (current) {\r\n                                        return current.hasSkill('PSwengua');\r\n                                    });\r\n                                    if (target) {\r\n                                        return get.attitude(player, target);\r\n                                    }\r\n                                }\r\n                            }\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    tag: {\r\n                        mod: {\r\n                            ignoredHandcard: function (card, player) {\r\n                                if (player.storage.PSfuzhu && card.hasGaintag('wengua')) return true;\r\n                            }\r\n                        },\r\n                        trigger: {\r\n                            player: \"gainAfter\"\r\n                        },\r\n                        forced: true,\r\n                        filter: function (event, player) {\r\n                            if (!player.storage.PSfuzhu) return false;\r\n                            return event.getParent().name == 'draw' && event.getParent(2).name == 'PSwengua_use';\r\n                        },\r\n                        content: function () {\r\n                            player.addGaintag(trigger.cards, \"wengua\");\r\n                        },\r\n                        onremove: function (player) {\r\n                            player.removeGaintag(\"wengua\");\r\n                        },\r\n                        audioname2: {\r\n                            old_yuanshu: \"weidi\"\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    draw: {\r\n                        trigger: {\r\n                            player: \"loseAfter\",\r\n                            global: [\r\n                                \"equipAfter\",\r\n                                \"addJudgeAfter\",\r\n                                \"gainAfter\",\r\n                                \"loseAsyncAfter\",\r\n                                \"addToExpansionAfter\"\r\n                            ]\r\n                        },\r\n                        forced: true,\r\n                        filter: function (event, player) {\r\n                            if (!player.storage.PSfuzhu) return false;\r\n                            var evt = event.getl(player);\r\n                            if (!evt || !evt.cards2 || !evt.cards2.length) return false;\r\n                            if (event.name == 'lose') {\r\n                                for (var i in event.gaintag_map) {\r\n                                    if (event.gaintag_map[i].includes('wengua')) return true;\r\n                                }\r\n                                return false;\r\n                            }\r\n                            return player.hasHistory('lose', function (evt) {\r\n                                if (event != evt.getParent()) return false;\r\n                                for (var i in evt.gaintag_map) {\r\n                                    if (evt.gaintag_map[i].includes('wengua')) return true;\r\n                                }\r\n                                return false;\r\n                            });\r\n                        },\r\n                        content: function () {\r\n                            player.draw();\r\n                        },\r\n                        sub: true\r\n                    }\r\n                }\r\n            },\r\n            PSfuzhu: {\r\n                audio: \"fuzhu\",\r\n                dutySkill: true,\r\n                derivation: \"PSwengua_1\",\r\n                group: [\r\n                    \"PSfuzhu_achieve\",\r\n                    \"PSfuzhu_fail\"\r\n                ],\r\n                trigger: {\r\n                    global: \"phaseJieshuBegin\"\r\n                },\r\n                filter: function (event, player) {\r\n                    return event.player != player && event.player.hasSex('male') && ui.cardPile.childElementCount <= player.hp * 10;\r\n                },\r\n                check: function (event, player) {\r\n                    return get.attitude(player, event.player) < 0 && get.effect(event.player, { name: 'sha' }, player, player) > 0;\r\n                },\r\n                logTarget: \"player\",\r\n                onWash: function () {\r\n                    _status.event.getParent('PSfuzhu').washed = false;\r\n                    return 'remove';\r\n                },\r\n                content: function () {\r\n                    'step 0'\r\n                    event.washed = false;\r\n                    lib.onwash.push(lib.skill.PSfuzhu.onWash);\r\n                    event.total = game.players.length + game.dead.length;\r\n                    if (!player.storage.PSfuzhu_target) player.storage.PSfuzhu_target = trigger.player;\r\n                    'step 1'\r\n                    event.total--;\r\n                    var card = get.cardPile2(function (card) {\r\n                        return card.name == 'sha' && player.canUse(card, trigger.player, false);\r\n                    });\r\n                    if (card) {\r\n                        card.remove();\r\n                        game.updateRoundNumber();\r\n                        player.useCard(card, trigger.player, false);\r\n                    }\r\n                    'step 2'\r\n                    if (event.total > 0 && !event.washed && ui.cardPile.childElementCount <= player.hp * 10 && trigger.player.isIn()) event.goto(1);\r\n                    'step 3'\r\n                    lib.onwash.remove(lib.skill.PSfuzhu.onWash);\r\n                    var cards = get.cards(ui.cardPile.childElementCount + 1);\r\n                    for (var i = 0; i < cards.length; i++) {\r\n                        ui.cardPile.insertBefore(cards[i], ui.cardPile.childNodes[get.rand(ui.cardPile.childElementCount)]);\r\n                    }\r\n                    game.updateRoundNumber();\r\n                },\r\n                ai: {\r\n                    threaten: 1.5\r\n                },\r\n                subSkill: {\r\n                    achieve: {\r\n                        audio: \"ext:PS武将/audio/skill:2\",\r\n                        trigger: {\r\n                            source: \"dieAfter\"\r\n                        },\r\n                        forced: true,\r\n                        skillAnimation: true,\r\n                        animationColor: \"fire\",\r\n                        filter: function (event, player) {\r\n                            return event.getParent(5).name == 'PSfuzhu' && event.player == player.storage.PSfuzhu_target;\r\n                        },\r\n                        content: function () {\r\n                            game.log(player, '成功完成使命');\r\n                            game.log(player, '升级了〖问卦〗');\r\n                            player.popup('使命成功', 'wood');\r\n                            player.awakenSkill('PSfuzhu');\r\n                            player.storage.PSfuzhu = true;\r\n                            var num = 0;\r\n                            player.getHistory('sourceDamage', function (evt) {\r\n                                if (evt.card && evt.getParent(3).name == 'PSfuzhu') num += evt.num;\r\n                            });\r\n                            num = Math.ceil(num / 2);\r\n                            player.draw(num);\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    fail: {\r\n                        audio: \"ext:PS武将/audio/skill:2\",\r\n                        trigger: {\r\n                            player: \"PSfuzhuAfter\"\r\n                        },\r\n                        forced: true,\r\n                        filter: function (event, player) {\r\n                            return true;\r\n                        },\r\n                        content: function () {\r\n                            game.log(player, '使命失败');\r\n                            player.popup('使命失败', 'fire');\r\n                            player.awakenSkill('PSfuzhu');\r\n                            if (player.isDamaged()) player.recover();\r\n                            else player.draw();\r\n                        },\r\n                        sub: true\r\n                    }\r\n                }\r\n            },\r\n            PSwengua_1: {\r\n                audio: \"wengua\"\r\n            }\r\n        },\r\n        sort: sort.PScharacter_wu,\r\n        translate: {\r\n            PSxushi: \"PS徐氏\",\r\n            PSwengua: \"问卦\",\r\n            PSwengua_info: \"其他角色/你的出牌阶段限一次，其可以交给你一张牌，(若当前回合角色为你，则跳过此步骤)，你可以将此牌/一张牌置于牌堆顶或牌堆底，然后你与其/你从另一端摸一张牌\",\r\n            PSfuzhu: \"伏诛\",\r\n            PSfuzhu_info: \"使命技。①一名男性角色的结束阶段，若牌堆剩余牌数不大于你体力值的十倍，则你可以依次对其使用牌堆中所有的【杀】（不能超过游戏人数），然后洗牌。②成功：当你因〖伏诛〗①杀死该角色后，你摸Y张牌，然后升级〖问卦〗（Y为你发动〖伏诛〗①造成伤害数的一半，向上取整）。③失败：当你发动〖伏诛〗①没有杀死该角色，你回复一点体力（若体力值已满，则摸一张牌）。\",\r\n            PSwengua_1: \"问卦·升级\",\r\n            PSwengua_1_info: \"其他角色/你的出牌阶段限一次，其可以交给你一张牌，(若当前回合角色为你，则跳过此步骤)，然后你与其/你从牌堆顶或牌堆底摸一张牌。你的问卦牌不计入手牌上限，当你失去问卦牌时，你摸一张牌。\",\r\n            \"#ext:PS武将/audio/skill/PSfuzhu_achieve1\": \"汝等奸贼，何当今日丧命！\",\r\n            \"#ext:PS武将/audio/skill/PSfuzhu_achieve2\": \"诛暴灭奸，平夫君之冤。\",\r\n            \"#ext:PS武将/audio/skill/PSfuzhu_fail1\": \"未能除贼，愧对夫君。\",\r\n            \"#ext:PS武将/audio/skill/PSfuzhu_fail2\": \"计划失策，恐难再有时机。\"\r\n        },\r\n        dynamicTranslate: {\r\n            PSwengua: function (player) {\r\n                if (player.storage.PSfuzhu)\r\n                    return \"其他角色/你的出牌阶段限一次，其可以交给你一张牌，(若当前回合角色为你，则跳过此步骤)，然后你与其/你从牌堆顶或牌堆底摸一张牌。你的问卦牌不计入手牌上限，当你失去问卦牌时，你摸一张牌。\";\r\n                return \"其他角色/你的出牌阶段限一次，其可以交给你一张牌，(若当前回合角色为你，则跳过此步骤)，你可以将此牌/一张牌置于牌堆顶或牌堆底，然后你与其/你从另一端摸一张牌\";\r\n            }\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PSjiaxu: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"qun\",\r\n            hp: 3,\r\n            skills: [\r\n                \"PSluanwu\",\r\n                \"PSwansha\",\r\n                \"reweimu\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“九个芒果”设计\",\r\n        skills: {\r\n            PSluanwu: {\r\n                audio: \"luanwu\",\r\n                enable: \"phaseUse\",\r\n                usable: 1,\r\n                filterTarget: true,\r\n                selectTarget: [\r\n                    1,\r\n                    Infinity\r\n                ],\r\n                multiline: true,\r\n                filter: function (event, player) {\r\n                    return game.countPlayer(current => {\r\n                        return current != player;\r\n                    }) > 1;\r\n                },\r\n                content: function () {\r\n                    var targetx = targets.slice().sortBySeat(target)[1];\r\n                    var card = { name: 'sha', isCard: true };\r\n                    if (target.canUse(card, targetx, false)) target.useCard(card, targetx, false);\r\n                },\r\n                ai: {\r\n                    threaten: 3,\r\n                    order: 7,\r\n                    result: {\r\n                        target: -1\r\n                    }\r\n                }\r\n            },\r\n            PSwansha: {\r\n                audio: \"ext:PS武将/audio/skill:2\",\r\n                trigger: {\r\n                    global: \"dying\"\r\n                },\r\n                forced: true,\r\n                logTarget: function (event, player) {\r\n                    return event.player;\r\n                },\r\n                preHidden: true,\r\n                firstDo: true,\r\n                filter: function (event, player, name) {\r\n                    return _status.currentPhase == player && event.player != player;\r\n                },\r\n                content: function () {\r\n                    'step 0'\r\n                    player.line(trigger.player);\r\n                    trigger.player.die({ source: trigger.source });\r\n                    'step 1'\r\n                    if (!trigger.player.isAlive()) {\r\n                        trigger.cancel(true);\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_qun,\r\n        translate: {\r\n            PSjiaxu: \"PS贾诩\",\r\n            PSluanwu: \"乱武\",\r\n            PSluanwu_info: \"出牌阶段限一次。你可以选择至少两名角色，然后每名你选择的角色依次视为对这些角色中与其逆时针座次最近的另一名角色使用一张不计入次数的【杀】。\",\r\n            PSwansha: \"完杀\",\r\n            PSwansha_info: \"锁定技，你的回合内，除你以外，进入濒死状态的角色立即死亡，且使其进入濒死状态的角色视为杀死其的角色。\",\r\n            \"#ext:PS武将/audio/skill/PSwansha1\": \"汝以孤立无援，乖乖领死吧。\",\r\n            \"#ext:PS武将/audio/skill/PSwansha2\": \"且看你如何自救。\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PSshen_zhangliao: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"shen\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PSduorui\",\r\n                \"drlt_zhiti\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“九个芒果”设计\",\r\n        skills: {\r\n            PSduorui: {\r\n                audio: \"drlt_duorui\",\r\n                trigger: {\r\n                    source: \"damageSource\"\r\n                },\r\n                filter: function (event, player) {\r\n                    var list = [];\r\n                    var listm = [];\r\n                    var listv = [];\r\n                    if (event.player.name1 != undefined) listm = lib.character[event.player.name1][3];\r\n                    else listm = lib.character[event.player.name][3];\r\n                    if (event.player.name2 != undefined) listv = lib.character[event.player.name2][3];\r\n                    listm = listm.concat(listv);\r\n                    var func = function (skill) {\r\n                        var info = get.info(skill);\r\n                        if (!info || info.charlotte || info.hiddenSkill) return false;\r\n                        return true;\r\n                    };\r\n                    for (var i = 0; i < listm.length; i++) {\r\n                        if (func(listm[i])) list.add(listm[i]);\r\n                    }\r\n                    for (var i in event.player.disabledSkills) {\r\n                        if (list.includes(i)) list.remove(i);\r\n                    };\r\n                    return player != event.player && event.player.isIn() && list.length && player.isPhaseUsing();\r\n                },\r\n                check: function (event, player) {\r\n                    return true;\r\n                },\r\n                content: function () {\r\n                    'step 0'\r\n                    var list = [];\r\n                    var listm = [];\r\n                    var listv = [];\r\n                    if (trigger.player.name1 != undefined) listm = lib.character[trigger.player.name1][3];\r\n                    else listm = lib.character[trigger.player.name][3];\r\n                    if (trigger.player.name2 != undefined) listv = lib.character[trigger.player.name2][3];\r\n                    listm = listm.concat(listv);\r\n                    var func = function (skill) {\r\n                        var info = get.info(skill);\r\n                        if (!info || info.charlotte || info.hiddenSkill) return false;\r\n                        return true;\r\n                    };\r\n                    for (var i = 0; i < listm.length; i++) {\r\n                        if (func(listm[i])) list.add(listm[i]);\r\n                    }\r\n                    for (var i in trigger.player.disabledSkills) {\r\n                        if (list.includes(i)) list.remove(i);\r\n                    };\r\n                    event.skills = list;\r\n                    'step 1'\r\n                    if (event.skills.length > 1) {\r\n                        player.chooseControl(event.skills).set('prompt', '请选择禁用' + get.translation(trigger.player) + '的一个技能').set('ai', function () { return event.skills.randomGet() });\r\n                    }\r\n                    else if (event.skills.length == 1) event._result = { control: event.skills[0] };\r\n                    else event.finish();\r\n                    'step 2'\r\n                    if (!trigger.player.storage.PSduorui) trigger.player.storage.PSduorui = [];\r\n                    trigger.player.storage.PSduorui.add(result.control);\r\n                    trigger.player.disableSkill('PSduorui_disable', result.control);\r\n                    trigger.player.addTempSkill('PSduorui_disable', { player: 'phaseAfter' });\r\n                    game.log(trigger.player, '的〖', result.control, '〗失效了');\r\n                },\r\n                group: \"PSduorui_add\",\r\n                subSkill: {\r\n                    add: {\r\n                        enable: \"phaseUse\",\r\n                        filter: function (event, player) {\r\n                            return player.countDisabled() < 5;\r\n                        },\r\n                        popup: false,\r\n                        content: function () {\r\n                            'step 0'\r\n                            player.chooseToDisable().ai = function (event, player, list) {\r\n                                if (list.includes('equip5')) return 'equip5';\r\n                                return list.randomGet();\r\n                            };\r\n                            'step 1'\r\n                            var skills = [], list = [], players = game.filterPlayer(current => current != player);\r\n                            for (var target of players) {\r\n                                if (target.name) list.add(target.name);\r\n                                if (target.name2) list.add(target.name2);\r\n                                if (target.name3) list.add(target.name3);\r\n                                skills.addArray(target.getStockSkills('无名杀', '启动').filter(function (skill) {\r\n                                    var info = get.info(skill);\r\n                                    return info;\r\n                                }));\r\n                            }\r\n                            var skillsx = [];\r\n                            for (var i of skills) {\r\n                                if (player.hasSkill(i)) skillsx.add(i);\r\n                            }\r\n                            skills.removeArray(skillsx);\r\n                            if (!list.length || !skills.length) { event.finish(); return; }\r\n                            if (player.isUnderControl()) {\r\n                                game.swapPlayerAuto(player);\r\n                            }\r\n                            if (false/* lib.config.extensions && lib.config.extensions.includes('天牢令') && lib.config['extension_天牢令_enable'] && game.TLHasExt */) {\r\n                                skills = [];\r\n                                for (var i = 0; i < list.length; i++) {\r\n                                    skills[i] = (lib.character[list[i]][3] || []).filter(function (skill) {\r\n                                        if (player.hasSkill(skill)) return false;\r\n                                        return true;\r\n                                    });\r\n                                }\r\n                                if (!list.length || !skills.length) { event.finish(); return; }\r\n                                var next = game.createEvent('chooseToFuHan');\r\n                                next.player = player;\r\n                                next.list1 = list;\r\n                                next.list2 = skills;\r\n                                next.topic = '夺锐';\r\n                                next.total = 1;\r\n                                next.setContent(lib.skill.PSfushi.chooseToFuHan);\r\n                                player.logSkill('PSduorui');\r\n                                event.finish();\r\n                                return;\r\n                            }\r\n                            var switchToAuto = function () {\r\n                                _status.imchoosing = false;\r\n                                event._result = {\r\n                                    bool: true,\r\n                                    skills: skills.randomGets(),\r\n                                };\r\n                                if (event.dialog) event.dialog.close();\r\n                                if (event.control) event.control.close();\r\n                            };\r\n                            var chooseButton = function (list, skills) {\r\n                                var event = _status.event;\r\n                                if (!event._result) event._result = {};\r\n                                event._result.skills = [];\r\n                                var rSkill = event._result.skills;\r\n                                var dialog = ui.create.dialog('请选择获得一个技能', [list, 'character'], 'hidden');\r\n                                event.dialog = dialog;\r\n                                var table = document.createElement('div');\r\n                                table.classList.add('add-setting');\r\n                                table.style.margin = '0';\r\n                                table.style.width = '100%';\r\n                                table.style.position = 'relative';\r\n                                for (var i = 0; i < skills.length; i++) {\r\n                                    var td = ui.create.div('.shadowed.reduce_radius.pointerdiv.tdnode');\r\n                                    td.link = skills[i];\r\n                                    table.appendChild(td);\r\n                                    td.innerHTML = '<span>' + get.translation(skills[i]) + '</span>';\r\n                                    td.addEventListener(lib.config.touchscreen ? 'touchend' : 'click', function () {\r\n                                        if (_status.dragged) return;\r\n                                        if (_status.justdragged) return;\r\n                                        _status.tempNoButton = true;\r\n                                        setTimeout(function () {\r\n                                            _status.tempNoButton = false;\r\n                                        }, 500);\r\n                                        var link = this.link;\r\n                                        if (!this.classList.contains('bluebg')) {\r\n                                            if (rSkill.length >= 1) return;\r\n                                            rSkill.add(link);\r\n                                            this.classList.add('bluebg');\r\n                                        }\r\n                                        else {\r\n                                            this.classList.remove('bluebg');\r\n                                            rSkill.remove(link);\r\n                                        }\r\n                                    });\r\n                                }\r\n                                dialog.content.appendChild(table);\r\n                                dialog.add('　　');\r\n                                dialog.open();\r\n\r\n                                event.switchToAuto = function () {\r\n                                    event.dialog.close();\r\n                                    event.control.close();\r\n                                    game.resume();\r\n                                    _status.imchoosing = false;\r\n                                };\r\n                                event.control = ui.create.control('ok', function (link) {\r\n                                    event.dialog.close();\r\n                                    event.control.close();\r\n                                    game.resume();\r\n                                    _status.imchoosing = false;\r\n                                });\r\n                                for (var i = 0; i < event.dialog.buttons.length; i++) {\r\n                                    event.dialog.buttons[i].classList.add('selectable');\r\n                                }\r\n                                game.pause();\r\n                                game.countChoose();\r\n                            };\r\n                            if (event.isMine()) {\r\n                                chooseButton(list, skills);\r\n                            }\r\n                            else if (event.isOnline()) {\r\n                                event.player.send(chooseButton, list, skills);\r\n                                event.player.wait();\r\n                                game.pause();\r\n                            }\r\n                            else {\r\n                                switchToAuto();\r\n                            }\r\n                            'step 2'\r\n                            var map = event.result || result;\r\n                            if (map && map.skills && map.skills.length) {\r\n                                player.logSkill('PSduorui');\r\n                                for (var i of map.skills) player.addSkills(i);\r\n                            }\r\n                            game.broadcastAll(function (list) {\r\n                                game.expandSkills(list);\r\n                                for (var i of list) {\r\n                                    var info = lib.skill[i];\r\n                                    if (!info) continue;\r\n                                    if (!info.audioname2) info.audioname2 = {};\r\n                                    info.audioname2.old_yuanshu = 'weidi';\r\n                                }\r\n                            }, map.skills);\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    disable: {\r\n                        onremove: function (player, skill) {\r\n                            player.enableSkill(skill);\r\n                            delete player.storage.PSduorui;\r\n                        },\r\n                        locked: true,\r\n                        mark: true,\r\n                        marktext: \"🔒\",\r\n                        charlotte: true,\r\n                        intro: {\r\n                            content: function (storage, player, skill) {\r\n                                var list = [];\r\n                                for (var i in player.disabledSkills) {\r\n                                    if (player.disabledSkills[i].includes(skill)) list.push(i);\r\n                                };\r\n                                if (list.length) {\r\n                                    var str = '失效技能：';\r\n                                    for (var i = 0; i < list.length; i++) {\r\n                                        if (lib.translate[list[i] + '_info']) str += get.translation(list[i]) + '、';\r\n                                    };\r\n                                    return str.slice(0, -1);\r\n                                };\r\n                            }\r\n                        },\r\n                        sub: true\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_shen,\r\n        translate: {\r\n            PSshen_zhangliao: \"PS神张辽\",\r\n            PSduorui: \"夺锐\",\r\n            PSduorui_info: \"出牌阶段，你可以废除一个装备栏，然后获得场上的一个技能。当你于出牌阶段内对一名其他角色造成伤害后，你可以令该角色的一个技能失效直到其回合结束。\"\r\n        },\r\n        rank: rank.legend\r\n    },\r\n    PSguanyu: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"shu\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PSwusheng\",\r\n                \"PSyijue\",\r\n                \"PSmashu\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“一顿七只屑狐狸”设计\",\r\n        replace: [\r\n            \"PSguanyunchang\",\r\n            \"PSguanyu\"\r\n        ],\r\n        skills: {\r\n            PSwusheng: {\r\n                mod: {\r\n                    aiOrder: function (player, card, num) {\r\n                        if (get.itemtype(card) == 'card' && card.name == 'sha' && get.suit(card) == 'heart') return num + 0.2;\r\n                        if (get.itemtype(card) == 'card' && card.name == 'sha' && get.suit(card) == 'diamond') return num + 0.1;\r\n                    },\r\n                    targetInRange: function (card) {\r\n                        if (get.suit(card) == 'diamond' && card.name == 'sha') return true;\r\n                    }\r\n                },\r\n                locked: false,\r\n                audio: \"wusheng_re_guanyu\",\r\n                enable: [\r\n                    \"chooseToRespond\",\r\n                    \"chooseToUse\"\r\n                ],\r\n                filterCard: function (card, player) {\r\n                    if (get.zhu(player, 'shouyue')) return true;\r\n                    return get.color(card) == 'red';\r\n                },\r\n                position: \"hes\",\r\n                viewAs: {\r\n                    name: \"sha\",\r\n                    isCard: true\r\n                },\r\n                viewAsFilter: function (player) {\r\n                    if (get.zhu(player, 'shouyue')) {\r\n                        if (!player.countCards('hes')) return false;\r\n                    }\r\n                    else {\r\n                        if (!player.countCards('hes', { color: 'red' })) return false;\r\n                    }\r\n                },\r\n                prompt: \"将一张红色牌当杀使用或打出\",\r\n                check: function (card) {\r\n                    var val = get.value(card);\r\n                    if (_status.event.name == 'chooseToRespond') return 1 / Math.max(0.1, val);\r\n                    return 5 - val;\r\n                },\r\n                ai: {\r\n                    respondSha: true,\r\n                    skillTagFilter: function (player) {\r\n                        if (get.zhu(player, 'shouyue')) {\r\n                            if (!player.countCards('hes')) return false;\r\n                        }\r\n                        else {\r\n                            if (!player.countCards('hes', { color: 'red' })) return false;\r\n                        }\r\n                    },\r\n                    yingbian: function (card, player, targets, viewer) {\r\n                        if (get.attitude(viewer, player) <= 0) return 0;\r\n                        var base = 0, hit = false;\r\n                        if (get.cardtag(card, 'yingbian_hit')) {\r\n                            hit = true;\r\n                            if (targets.filter(function (target) {\r\n                                return target.hasShan() && get.attitude(viewer, target) < 0 && get.damageEffect(target, player, viewer, get.nature(card)) > 0;\r\n                            })) base += 5;\r\n                        }\r\n                        if (get.cardtag(card, 'yingbian_all')) {\r\n                            if (game.hasPlayer(function (current) {\r\n                                return !targets.includes(current) && lib.filter.targetEnabled2(card, player, current) && get.effect(current, card, player, player) > 0;\r\n                            })) base += 5;\r\n                        }\r\n                        if (get.cardtag(card, 'yingbian_damage')) {\r\n                            if (targets.filter(function (target) {\r\n                                return get.attitude(player, target) < 0 && (hit || !target.mayHaveShan() || player.hasSkillTag('directHit_ai', true, {\r\n                                    target: target,\r\n                                    card: card,\r\n                                }, true)) && !target.hasSkillTag('filterDamage', null, {\r\n                                    player: player,\r\n                                    card: card,\r\n                                    jiu: true,\r\n                                })\r\n                            })) base += 5;\r\n                        }\r\n                        return base;\r\n                    },\r\n                    canLink: function (player, target, card) {\r\n                        if (!target.isLinked() && !player.hasSkill('wutiesuolian_skill')) return false;\r\n                        if (target.mayHaveShan() && !player.hasSkillTag('directHit_ai', true, {\r\n                            target: target,\r\n                            card: card,\r\n                        }, true)) return false;\r\n                        if (player.hasSkill('jueqing') || player.hasSkill('gangzhi') || target.hasSkill('gangzhi')) return false;\r\n                        return true;\r\n                    },\r\n                    basic: {\r\n                        useful: [\r\n                            5,\r\n                            3,\r\n                            1\r\n                        ],\r\n                        value: [\r\n                            5,\r\n                            3,\r\n                            1\r\n                        ]\r\n                    },\r\n                    order: function (item, player) {\r\n                        if (player.hasSkillTag('presha', true, null, true)) return 10;\r\n                        if (lib.linked.includes(get.nature(item))) {\r\n                            if (game.hasPlayer(function (current) {\r\n                                return current != player && current.isLinked() && player.canUse(item, current, null, true) && get.effect(current, item, player, player) > 0 && lib.card.sha.ai.canLink(player, current, item);\r\n                            }) && game.countPlayer(function (current) {\r\n                                return current.isLinked() && get.damageEffect(current, player, player, get.nature(item)) > 0;\r\n                            }) > 1) return 3.1;\r\n                            return 3;\r\n                        }\r\n                        return 3.05;\r\n                    },\r\n                    result: {\r\n                        target: function (player, target, card, isLink) {\r\n                            var eff = function () {\r\n                                if (!isLink && player.hasSkill('jiu')) {\r\n                                    if (!target.hasSkillTag('filterDamage', null, {\r\n                                        player: player,\r\n                                        card: card,\r\n                                        jiu: true,\r\n                                    })) {\r\n                                        if (get.attitude(player, target) > 0) {\r\n                                            return -7;\r\n                                        }\r\n                                        else {\r\n                                            return -4;\r\n                                        }\r\n                                    }\r\n                                    return -0.5;\r\n                                }\r\n                                return -1.5;\r\n                            }();\r\n                            if (!isLink && target.mayHaveShan() && !player.hasSkillTag('directHit_ai', true, {\r\n                                target: target,\r\n                                card: card,\r\n                            }, true)) return eff / 1.2;\r\n                            return eff;\r\n                        }\r\n                    },\r\n                    tag: {\r\n                        respond: 1,\r\n                        respondShan: 1,\r\n                        damage: function (card) {\r\n                            if (game.hasNature(card, 'poison')) return;\r\n                            return 1;\r\n                        },\r\n                        natureDamage: function (card) {\r\n                            if (game.hasNature(card)) return 1;\r\n                        },\r\n                        fireDamage: function (card, nature) {\r\n                            if (game.hasNature(card, 'fire')) return 1;\r\n                        },\r\n                        thunderDamage: function (card, nature) {\r\n                            if (game.hasNature(card, 'thunder')) return 1;\r\n                        },\r\n                        poisonDamage: function (card, nature) {\r\n                            if (game.hasNature(card, 'poison')) return 1;\r\n                        }\r\n                    }\r\n                },\r\n                group: \"PSwusheng_effect\",\r\n                subSkill: {\r\n                    effect: {\r\n                        trigger: {\r\n                            player: \"useCardToPlayered\"\r\n                        },\r\n                        forced: true,\r\n                        filter: function (event, player) {\r\n                            return event.card && event.card.name == 'sha' && (get.suit(event.card) == 'heart' || get.suit(event.card) == 'diamond') && event.card.isCard;\r\n                        },\r\n                        logTarget: \"target\",\r\n                        content: function () {\r\n                            if (get.suit(trigger.card) == 'heart') {\r\n                                var id = trigger.target.playerid;\r\n                                var map = trigger.getParent().customArgs;\r\n                                if (!map[id]) map[id] = {};\r\n                                if (typeof map[id].extraDamage != 'number') {\r\n                                    map[id].extraDamage = 0;\r\n                                }\r\n                                map[id].extraDamage++;\r\n                                if (!trigger.getParent().directHit.includes(trigger.target)) {\r\n                                    if (typeof map[id].shanRequired == 'number') {\r\n                                        map[id].shanRequired++;\r\n                                    }\r\n                                    else {\r\n                                        map[id].shanRequired = 2;\r\n                                    }\r\n                                }\r\n                            }\r\n                            else {\r\n                                var target = trigger.target;\r\n                                player.gainPlayerCard(target, 'he', true);\r\n                            }\r\n                        },\r\n                        sub: true\r\n                    }\r\n                }\r\n            },\r\n            PSyijue: {\r\n                audio: \"yijue\",\r\n                enable: \"phaseUse\",\r\n                usable: 1,\r\n                position: \"he\",\r\n                filterTarget: function (card, player, target) {\r\n                    return player != target && target.countCards('he');\r\n                },\r\n                filter: function (event, player) {\r\n                    return player.countCards('he');\r\n                },\r\n                filterCard: true,\r\n                check: function (card) {\r\n                    return 8 - get.value(card);\r\n                },\r\n                content: function () {\r\n                    \"step 0\"\r\n                    if (!target.countCards('he')) {\r\n                        event.finish();\r\n                    }\r\n                    \"step 1\"\r\n                    if (player.isUnderControl()) {\r\n                        game.swapPlayerAuto(player);\r\n                    }\r\n                    var switchToAuto = function () {\r\n                        _status.imchoosing = false;\r\n                        var types = ['任意'].concat(['basic', 'trick', 'equip']);\r\n                        event._result = {\r\n                            bool: true,\r\n                            suit: ['任意', ...lib.suit].randomGet(),\r\n                            type: types.randomGet(),\r\n                        };\r\n                        if (event.dialog) event.dialog.close();\r\n                        if (event.control) event.control.close();\r\n                    };\r\n                    var chooseButton = function (player) {\r\n                        var event = _status.event;\r\n                        player = player || event.player;\r\n                        if (!event._result) event._result = {};\r\n                        var dialog = ui.create.dialog('义绝：请声明牌的类型和花色', 'forcebutton', 'hidden');\r\n                        event.dialog = dialog;\r\n                        dialog.addText('类型');\r\n                        var table = document.createElement('div');\r\n                        table.classList.add('add-setting');\r\n                        table.style.margin = '0';\r\n                        table.style.width = '100%';\r\n                        table.style.position = 'relative';\r\n                        var types = ['任意', 'basic', 'trick', 'equip'];\r\n                        for (var i = 0; i < types.length; i++) {\r\n                            var td = ui.create.div('.shadowed.reduce_radius.pointerdiv.tdnode');\r\n                            td.link = types[i];\r\n                            table.appendChild(td);\r\n                            td.innerHTML = '<span>' + get.translation(types[i]) + '</span>';\r\n                            td.addEventListener(lib.config.touchscreen ? 'touchend' : 'click', function () {\r\n                                if (_status.dragged) return;\r\n                                if (_status.justdragged) return;\r\n                                _status.tempNoButton = true;\r\n                                setTimeout(function () {\r\n                                    _status.tempNoButton = false;\r\n                                }, 500);\r\n                                var link = this.link;\r\n                                var current = this.parentNode.querySelector('.bluebg');\r\n                                if (current) {\r\n                                    current.classList.remove('bluebg');\r\n                                }\r\n                                this.classList.add('bluebg');\r\n                                event._result.type = link;\r\n                            });\r\n                        }\r\n                        dialog.content.appendChild(table);\r\n                        dialog.addText('花色');\r\n                        var table2 = document.createElement('div');\r\n                        table2.classList.add('add-setting');\r\n                        table2.style.margin = '0';\r\n                        table2.style.width = '100%';\r\n                        table2.style.position = 'relative';\r\n                        var suits = ['任意'].concat(lib.suit);\r\n                        for (var i = 0; i < suits.length; i++) {\r\n                            var td = ui.create.div('.shadowed.reduce_radius.pointerdiv.tdnode');\r\n                            var suit = suits[i];\r\n                            td.link = suit;\r\n                            table2.appendChild(td);\r\n                            td.innerHTML = '<span>' + get.translation(suit) + '</span>';\r\n                            td.addEventListener(lib.config.touchscreen ? 'touchend' : 'click', function () {\r\n                                if (_status.dragged) return;\r\n                                if (_status.justdragged) return;\r\n                                _status.tempNoButton = true;\r\n                                setTimeout(function () {\r\n                                    _status.tempNoButton = false;\r\n                                }, 500);\r\n                                var link = this.link;\r\n                                var current = this.parentNode.querySelector('.bluebg');\r\n                                if (current) {\r\n                                    current.classList.remove('bluebg');\r\n                                }\r\n                                this.classList.add('bluebg');\r\n                                event._result.suit = link;\r\n                            });\r\n                        }\r\n                        dialog.content.appendChild(table2);\r\n                        dialog.add('　　');\r\n                        event.dialog.open();\r\n                        event.switchToAuto = function () {\r\n                            event._result = {\r\n                                bool: true,\r\n                                type: types.randomGet(),\r\n                                suit: suits.randomGet(),\r\n                            };\r\n                            event.dialog.close();\r\n                            event.control.close();\r\n                            game.resume();\r\n                            _status.imchoosing = false;\r\n                        };\r\n                        event.control = ui.create.control('ok', function (link) {\r\n                            var result = event._result;\r\n                            result.bool = true;\r\n                            event.dialog.close();\r\n                            event.control.close();\r\n                            game.resume();\r\n                            _status.imchoosing = false;\r\n                        });\r\n                        for (var i = 0; i < event.dialog.buttons.length; i++) {\r\n                            event.dialog.buttons[i].classList.add('selectable');\r\n                        }\r\n                        game.pause();\r\n                        game.countChoose();\r\n                    };\r\n                    if (event.isMine()) {\r\n                        chooseButton(player);\r\n                    }\r\n                    else if (event.isOnline()) {\r\n                        event.player.send(chooseButton, player);\r\n                        event.player.wait();\r\n                        game.pause();\r\n                    }\r\n                    else {\r\n                        switchToAuto();\r\n                    }\r\n                    \"step 2\"\r\n                    var map = event.result || result;\r\n                    if (map.bool) {\r\n                        if (map.type && map.type != '任意') event.type = map.type;\r\n                        if (map.suit && map.suit != '任意') event.suit = map.suit;\r\n                        game.log(player, '声明了', (event.suit || '任意花色'), '和', (event.type || '任意类型'));\r\n                        player.popup(get.translation(event.suit + 2 || '任意花色') + '<br/>' + get.translation(event.type || '任意类型'), 'thunder');\r\n                    }\r\n                    \"step 3\"\r\n                    if (!target.hasCard(card => {\r\n                        return get.suit(card) == (event.suit || get.suit(card)) && get.type2(card) == (event.type || get.type2(card));\r\n                    }, 'he')) event._result = { bool: false };\r\n                    else target.chooseCard(false, 'he', function (card) {\r\n                        return get.suit(card) == (event.suit || get.suit(card)) && get.type2(card) == (event.type || get.type2(card));\r\n                    }).set('ai', function (card) {\r\n                        var player = _status.event.player;\r\n                        if ((player.hasShan() || player.hp < 3) && get.color(card) == 'black') return 0.5;\r\n                        return Math.max(1, 20 - get.value(card));\r\n                    }).set('prompt', '交给' + get.translation(player) + '一张牌，否则获得负面效果');\r\n                    \"step 4\"\r\n                    if (result.bool && result.cards) {\r\n                        player.gain(result.cards[0], target, 'give', 'bySelf');\r\n                        if (target.hp < target.maxHp) {\r\n                            player.chooseBool('是否让' + get.translation(target) + '回复一点体力？').ai = function (event, player) {\r\n                                return get.recoverEffect(target, player, player) > 0;\r\n                            };\r\n                        }\r\n                    }\r\n                    else {\r\n                        player.draw();\r\n                        if (!target.hasSkill('fengyin')) {\r\n                            target.addTempSkill('fengyin');\r\n                        }\r\n                        target.addTempSkill('PSyijue_effect');\r\n                        event.finish();\r\n                    }\r\n                    \"step 5\"\r\n                    if (result.bool) {\r\n                        target.recover();\r\n                    }\r\n                },\r\n                ai: {\r\n                    result: {\r\n                        target: function (player, target) {\r\n                            var hs = player.getCards('h');\r\n                            if (hs.length < 3) return 0;\r\n                            if (target.countCards('h') > target.hp + 1 && get.recoverEffect(target) > 0) {\r\n                                return 1;\r\n                            }\r\n                            if (player.canUse('sha', target) && (player.countCards('h', 'sha') || player.countCards('he', { color: 'red' }))) {\r\n                                return -2;\r\n                            }\r\n                            return -0.5;\r\n                        }\r\n                    },\r\n                    order: 9,\r\n                    directHit_ai: true,\r\n                    skillTagFilter: function (player, tag, arg) {\r\n                        if (!arg.target.hasSkillTag('new_yijue2')) return false;\r\n                    }\r\n                },\r\n                subSkill: {\r\n                    effect: {\r\n                        trigger: {\r\n                            player: \"damageBegin1\"\r\n                        },\r\n                        filter: function (event) {\r\n                            return event.source && event.source == _status.currentPhase && event.card && event.card.name == 'sha' && event.notLink();\r\n                        },\r\n                        popup: false,\r\n                        forced: true,\r\n                        charlotte: true,\r\n                        content: function () {\r\n                            trigger.num++;\r\n                        },\r\n                        mark: true,\r\n                        mod: {\r\n                            cardEnabled2: function (card) {\r\n                                if (get.position(card) == 'h') return false;\r\n                            }\r\n                        },\r\n                        intro: {\r\n                            content: \"不能使用或打出手牌\"\r\n                        },\r\n                        sub: true\r\n                    }\r\n                }\r\n            },\r\n            PSmashu: {\r\n                mod: {\r\n                    globalFrom: function (from, to, distance) {\r\n                        return distance - 1;\r\n                    },\r\n                    globalTo: function (from, to, distance) {\r\n                        return distance + 1;\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_shu,\r\n        translate: {\r\n            PSguanyu: \"PS关羽\",\r\n            PSwusheng: \"武圣\",\r\n            PSwusheng_info: \"你可以将一张红色牌当做【杀】使用或打出。你使用的♦杀没有距离限制且可以获得对方一张牌；你使用的♥杀造成伤害+1，且目标需要连续使用两张【闪】才能抵消。\",\r\n            PSyijue: \"义绝\",\r\n            PSyijue_info: \"出牌阶段限一次，你可以弃置一张牌并令一名有牌的其他角色选择交给你一张由你声明花色和类型的牌。若其选择不交出，你摸一张牌，该角色不能使用或打出牌，非锁定技失效且受到来自你的【杀】伤害+1直到回合结束。否则你可以令其回复一点体力。\",\r\n            PSmashu: \"马术\",\r\n            PSmashu_info: \"锁定技，你计算与其他角色的距离时-1，其他角色计算与你的距离时+1。\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PSshen_zhangfei: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"shen\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PSshencai\",\r\n                \"PSxunshi\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“虚幼屎”设计\",\r\n        skills: {\r\n            PSshencai: {\r\n                audio: \"shencai\",\r\n                enable: \"phaseUse\",\r\n                usable: 5,\r\n                filter: function (event, player) {\r\n                    var count = player.getStat('skill').PSshencai;\r\n                    if (count && count > player.countMark('PSshencai')) return false;\r\n                    return true;\r\n                },\r\n                filterTarget: function (card, player, target) {\r\n                    return player != target;\r\n                },\r\n                onremove: true,\r\n                prompt: \"选择一名其他角色进行地狱审判\",\r\n                content: function () {\r\n                    var next = target.judge();\r\n                    next.callback = lib.skill.PSshencai.contentx;\r\n                },\r\n                ai: {\r\n                    order: 8,\r\n                    result: {\r\n                        target: -1\r\n                    }\r\n                },\r\n                contentx: function () {\r\n                    var card = event.judgeResult.card;\r\n                    var player = event.getParent(2).player;\r\n                    var target = event.getParent(2).target;\r\n                    if (get.position(card, true) == 'o') player.gain(card, 'gain2');\r\n                    var list = [], str = lib.skill.PSshencai.getStr(card);\r\n                    for (var i in lib.skill.PSshencai.filterx) {\r\n                        if (str.indexOf(lib.skill.PSshencai.filterx[i]) != -1) list.push('PSshencai_' + i);\r\n                    }\r\n                    if (list.length) {\r\n                        if (target.isIn()) {\r\n                            for (var i of list) {\r\n                                target.addSkill(i);\r\n                                target.addMark(i, 1);\r\n                            }\r\n                        }\r\n                    }\r\n                    else if (target.isIn()) {\r\n                        player.gainPlayerCard(target, true, 'hej');\r\n                        target.addMark('PSshencai_death', 1);\r\n                        target.addSkill('PSshencai_death');\r\n                    }\r\n                },\r\n                filterx: {\r\n                    losehp: \"体力\",\r\n                    weapon: \"武器\",\r\n                    respond: \"打出\",\r\n                    distance: \"距离\"\r\n                },\r\n                getStr: function (node) {\r\n                    var str = '', name = node.name;\r\n                    if (lib.translate[name + '_info']) {\r\n                        if (lib.card[name].type && lib.translate[lib.card[name].type]) str += ('' + get.translation(lib.card[name].type) + '牌|');\r\n                        if (get.subtype(name)) {\r\n                            str += ('' + get.translation(get.subtype(name)) + '|');\r\n                        }\r\n                        if (lib.card[name] && lib.card[name].addinfomenu) {\r\n                            str += ('' + lib.card[name].addinfomenu + '|');\r\n                        }\r\n                        if (get.subtype(name) == 'equip1') {\r\n                            var added = false;\r\n                            if (lib.card[node.name] && lib.card[node.name].distance) {\r\n                                var dist = lib.card[node.name].distance;\r\n                                if (dist.attackFrom) {\r\n                                    added = true;\r\n                                    str += ('攻击范围：' + (-dist.attackFrom + 1) + '|');\r\n                                }\r\n                            }\r\n                            if (!added) {\r\n                                str += ('攻击范围：1|');\r\n                            }\r\n                        }\r\n                    }\r\n                    if (lib.card[name].cardPrompt) {\r\n                        str += ('' + lib.card[name].cardPrompt(node) + '|');\r\n                    }\r\n                    else if (lib.translate[name + '_info']) {\r\n                        str += ('' + lib.translate[name + '_info'] + '|');\r\n                    }\r\n                    if (lib.card[name].yingbian_prompt && get.is.yingbian(node)) {\r\n                        if (typeof lib.card[name].yingbian_prompt == 'function') str += ('应变：' + lib.card[name].yingbian_prompt(node) + '|');\r\n                        else str += ('应变：' + lib.card[name].yingbian_prompt + '|');\r\n                    }\r\n                    return str;\r\n                },\r\n                subSkill: {\r\n                    losehp: {\r\n                        charlotte: true,\r\n                        marktext: \"笞\",\r\n                        trigger: {\r\n                            player: \"damageEnd\"\r\n                        },\r\n                        forced: true,\r\n                        content: function () {\r\n                            player.loseHp(trigger.num);\r\n                        },\r\n                        ai: {\r\n                            effect: {\r\n                                target: function (card, player, target, current) {\r\n                                    if (get.tag(card, 'damage') && current < 0) return 1.6;\r\n                                }\r\n                            }\r\n                        },\r\n                        intro: {\r\n                            name: \"神裁 - 体力\",\r\n                            name2: \"笞\",\r\n                            content: \"锁定技。当你受到伤害后，你失去等量的体力。\",\r\n                            onunmark: true\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    weapon: {\r\n                        charlotte: true,\r\n                        marktext: \"杖\",\r\n                        trigger: {\r\n                            target: \"useCardToTargeted\"\r\n                        },\r\n                        forced: true,\r\n                        filter: function (event, player) {\r\n                            return event.card.name == 'sha';\r\n                        },\r\n                        content: function () {\r\n                            trigger.directHit.add(player);\r\n                            game.log(player, '不可响应', trigger.card);\r\n                        },\r\n                        intro: {\r\n                            name: \"神裁 - 武器\",\r\n                            name2: \"杖\",\r\n                            content: \"锁定技。当你成为【杀】的目标后，你不能使用牌响应此【杀】。\",\r\n                            onunmark: true\r\n                        },\r\n                        global: \"PSshencai_weapon_ai\",\r\n                        sub: true\r\n                    },\r\n                    ai: {\r\n                        ai: {\r\n                            directHit_ai: true,\r\n                            skillTagFilter: function (player, tag, arg) {\r\n                                if (!arg || !arg.card || arg.card.name != 'sha') return false;\r\n                                if (!arg.target || !arg.target.hasSkill('PSshencai_weapon')) return false;\r\n                                return true;\r\n                            }\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    respond: {\r\n                        charlotte: true,\r\n                        marktext: \"徒\",\r\n                        trigger: {\r\n                            player: \"loseAfter\",\r\n                            global: [\r\n                                \"equipAfter\",\r\n                                \"addJudgeAfter\",\r\n                                \"gainAfter\",\r\n                                \"loseAsyncAfter\",\r\n                                \"addToExpansionAfter\"\r\n                            ]\r\n                        },\r\n                        forced: true,\r\n                        filter: function (event, player) {\r\n                            if (!player.hasCard(function (card) {\r\n                                return lib.filter.cardDiscardable(card, player, 'PSshencai_respond');\r\n                            }, 'h')) return false;\r\n                            var evt = event.getParent('PSshencai_respond');\r\n                            if (evt && evt.player == player) return false;\r\n                            evt = event.getl(player);\r\n                            return evt && evt.hs && evt.hs.length > 0;\r\n                        },\r\n                        content: function () {\r\n                            var cards = player.getCards('h', function (card) {\r\n                                return lib.filter.cardDiscardable(card, player, 'PSshencai_respond');\r\n                            });\r\n                            if (cards.length > 0) player.discard(cards.randomGet());\r\n                        },\r\n                        intro: {\r\n                            name: \"神裁 - 打出\",\r\n                            name2: \"徒\",\r\n                            content: \"锁定技。当你失去手牌后，你随机弃置一张手牌（不嵌套触发）。\",\r\n                            onunmark: true\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    distance: {\r\n                        charlotte: true,\r\n                        marktext: \"流\",\r\n                        trigger: {\r\n                            player: \"phaseJieshuBegin\"\r\n                        },\r\n                        forced: true,\r\n                        content: function () {\r\n                            player.turnOver();\r\n                        },\r\n                        intro: {\r\n                            name: \"神裁 - 距离\",\r\n                            name2: \"流\",\r\n                            content: \"锁定技。结束阶段开始时，你翻面。\",\r\n                            onunmark: true\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    death: {\r\n                        charlotte: true,\r\n                        marktext: \"死\",\r\n                        mod: {\r\n                            maxHandcard: function (player, num) {\r\n                                return num - player.countMark('PSshencai_death');\r\n                            }\r\n                        },\r\n                        trigger: {\r\n                            player: \"phaseEnd\"\r\n                        },\r\n                        forced: true,\r\n                        filter: function (event, player) {\r\n                            return player.countMark('PSshencai_death') > game.countPlayer();\r\n                        },\r\n                        content: function () {\r\n                            player.die();\r\n                        },\r\n                        intro: {\r\n                            name: \"神裁 - 死\",\r\n                            name2: \"死\",\r\n                            content: \"锁定技。你的角色手牌上限-#；回合结束时，若场上存活人数小于#，则你死亡。\",\r\n                            onunmark: true\r\n                        },\r\n                        sub: true\r\n                    }\r\n                },\r\n                intro: {\r\n                    content: \"发动次数上限+#\"\r\n                }\r\n            },\r\n            PSxunshi: {\r\n                trigger: {\r\n                    player: \"useCard2\"\r\n                },\r\n                forced: true,\r\n                direct: true,\r\n                priority: -1,\r\n                filter: function (event, player) {\r\n                    return get.color(event.card) == 'none';\r\n                },\r\n                content: function () {\r\n                    if (player.countMark('PSshencai') < 4 && player.hasSkill('PSshencai', null, null, false)) player.addMark('PSshencai', 1, false);\r\n                },\r\n                group: \"xunshi\"\r\n            }\r\n        },\r\n        sort: sort.PScharacter_shen,\r\n        translate: {\r\n            PSshen_zhangfei: \"PS神张飞\",\r\n            PSshencai: \"神裁\",\r\n            PSshencai_info: \"出牌阶段限一次，你可以令一名其他角色进行判定。你获得此判定牌，然后若此判定牌：包含以下要素中的任意一个，获得对应的效果：{⒈体力：当其受到伤害后，其失去等量的体力、⒉武器：其不能使用牌响应杀、⒊打出：当其失去手牌后，其再随机弃置一张手牌（不嵌套触发）、⒋距离：其的结束阶段开始时，其翻面}；若均不包含，你获得其区域里的一张牌，其获得一枚“死”并获得如下效果：其的角色手牌上限-X、其的回合结束时，若X大于场上存活人数，则其死亡（X为其“死”标记数）。\",\r\n            PSxunshi: \"巡使\",\r\n            PSxunshi_info: \"锁定技。①你手牌区内所有的多目标锦囊牌均视为花色为none的普【杀】。②你使用颜色为none的牌无距离和次数限制。③当你使用无颜色的牌选择目标后，你令你的〖神裁〗的发动次数上限+1（至多为5），然后可以为此牌增加任意个目标。\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PSmeng_liubei: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"shu\",\r\n            hp: 1,\r\n            skills: [\r\n                \"PStaoyuan\",\r\n                \"PSshiren\"\r\n            ],\r\n            dieAudios: [\r\n                \"re_liubei\"\r\n            ],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“遇见鲲啊”设计\",\r\n        skills: {\r\n            PStaoyuan: {\r\n                audio: \"ext:PS武将/audio/skill:2\",\r\n                trigger: {\r\n                    player: \"changeHp\"\r\n                },\r\n                forced: true,\r\n                filter: function (event, player) {\r\n                    return event.num < 0 && game.hasPlayer(current => current.group === 'shu');\r\n                },\r\n                content: function () {\r\n                    'step 0'\r\n                    let num = game.countPlayer(current => current.group === 'shu');\r\n                    event.cards = get.cards(num);\r\n                    player.showCards(event.cards, '桃园');\r\n                    let bool = false;\r\n                    for (var card of event.cards) {\r\n                        if (get.color(card) !== 'black') {\r\n                            bool = true;\r\n                            break;\r\n                        }\r\n                    }\r\n                    event.bool = bool;\r\n                    'step 1'\r\n                    if (event.bool) {\r\n                        if (player.hp < 1) player.recover(1 - player.hp);\r\n                    }\r\n                    else event.finish();\r\n                    'step 2'\r\n                    player.chooseTarget('桃园：选择一名角色，让其挑选武将牌').set('ai', function (target) {\r\n                        var player = _status.event.player;\r\n                        var att = get.attitude(player, target) / Math.sqrt(1 + target.countCards('h'));\r\n                        return att;\r\n                    });\r\n                    'step 3'\r\n                    if (result.targets) {\r\n                        let target = result.targets[0];\r\n                        let list;\r\n                        if (_status.characterlist) {\r\n                            list = [];\r\n                            for (var i = 0; i < _status.characterlist.length; i++) {\r\n                                var name = _status.characterlist[i];\r\n                                if (lib.character[name][1] == 'shu' && lib.skill.PSfushi.characterList().includes(name)) list.push(name);\r\n                            }\r\n                        }\r\n                        else if (_status.connectMode) {\r\n                            list = get.charactersOL(function (i) {\r\n                                return lib.character[i][1] != 'shu' && !lib.skill.PSfushi.characterList().includes(i);\r\n                            });\r\n                        }\r\n                        else {\r\n                            list = get.gainableCharacters(function (info, i) {\r\n                                return info[1] == 'shu' && lib.skill.PSfushi.characterList().includes(i);\r\n                            });\r\n                        }\r\n                        var players = game.players.concat(game.dead);\r\n                        for (var i = 0; i < players.length; i++) {\r\n                            list.remove(players[i].name);\r\n                            list.remove(players[i].name1);\r\n                            list.remove(players[i].name2);\r\n                        }\r\n                        if (!list.length) {\r\n                            event.finish();\r\n                            return;\r\n                        }\r\n                        target.chooseButton(['桃园：选择获得一张武将牌上的所有技能', [list.randomGets(3), 'character']], true);\r\n                        event.target = target;\r\n                    }\r\n                    else event.finish();\r\n                    'step 4'\r\n                    if (result.bool) {\r\n                        let name = result.links[0];\r\n                        event.target.flashAvatar('PStaoyuan', name);\r\n                        game.log(event.target, '获得了', '#y' + get.translation(name), '的所有技能');\r\n                        event.target.addSkills(lib.character[name][3]);\r\n                    }\r\n                }\r\n            },\r\n            PSshiren: {\r\n                mod: {\r\n                    maxHandcard: function (player, num) {\r\n                        return num + game.countPlayer(current => current.group === 'shu');\r\n                    }\r\n                },\r\n                audio: \"ext:PS武将/audio/skill:2\",\r\n                enable: \"phaseUse\",\r\n                usable: 1,\r\n                filter: function (event, player) {\r\n                    return game.hasPlayer(function (current) {\r\n                        return player.canCompare(current) && current.inRangeOf(player);\r\n                    });\r\n                },\r\n                filterTarget: function (card, player, current) {\r\n                    return player.canCompare(current) && current.inRangeOf(player);\r\n                },\r\n                content: () => {\r\n                    'step 0'\r\n                    player.chooseToCompare(target);\r\n                    'step 1'\r\n                    if (result.bool) {\r\n                        target.changeGroup('shu');\r\n                    }\r\n                },\r\n                ai: {\r\n                    order: 3,\r\n                    result: {\r\n                        player: function (player) {\r\n                            var num = player.countCards('h');\r\n                            if (num > player.hp) return 0;\r\n                            if (num == 1) return -2;\r\n                            if (num == 2) return -1;\r\n                            return -0.7;\r\n                        },\r\n                        target: function (player, target) {\r\n                            var num = target.countCards('h');\r\n                            if (num == 1) return -1;\r\n                            if (num == 2) return -0.7;\r\n                            return -0.5\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_shu,\r\n        translate: {\r\n            PSmeng_liubei: \"PS梦刘备\",\r\n            PSmeng_liubei_prefix: \"PS梦\",\r\n            PStaoyuan: \"桃园\",\r\n            PStaoyuan_info: \"锁定技，当你体力减少后，你从牌堆顶亮出X张牌，若亮出的牌颜色不全为黑色，则你将体力回复到1，然后你指定一名角色，令其从三张未登场的蜀势力武将牌中选择一名获得上面所有技能。（X为场上蜀势力角色的数量）\",\r\n            PSshiren: \"识人\",\r\n            PSshiren_info: \"你的手牌上限加X。出牌阶段限制一次，你可以与你攻击范围内的一名角色进行拼点，若你赢，则该角色的势力变为蜀势力。（X为场上蜀势力角色的数量）\",\r\n            \"#ext:PS武将/audio/skill/PSshiren1\": \"此战有将军在，方可胜。\",\r\n            \"#ext:PS武将/audio/skill/PSshiren2\": \"蜀汉霸业，方需将军出战。\",\r\n            \"#ext:PS武将/audio/skill/PStaoyuan1\": \"备，愿结交天下豪杰。\",\r\n            \"#ext:PS武将/audio/skill/PStaoyuan2\": \"仁之所至,何吝外物。\"\r\n        },\r\n        rank: rank.epic\r\n    },\r\n    PSshen_dengai: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"shen\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PStuoyu\",\r\n                \"PSxianjin\",\r\n                \"PSqijing\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“mento last”设计\",\r\n        substitute: [\r\n            [\r\n                \"PSshen_dengai2\",\r\n                [\r\n                    \"ext:PS武将/image/character/PSshen_dengai2.jpg\",\r\n                    \"die:ext:PS武将/audio/die:true\"\r\n                ]\r\n            ]\r\n        ],\r\n        skills: {\r\n            PStuoyu: {\r\n                audio: \"dctuoyu\",\r\n                inherit: \"dctuoyu\",\r\n                audioname2: {\r\n                    PSshen_dengai2: [\r\n                        \"ext:PS武将/audio/skill/PStuoyu_PSshen_dengai21\",\r\n                        \"ext:PS武将/audio/skill/PStuoyu_PSshen_dengai22\"\r\n                    ]\r\n                },\r\n                cardIsIgnored: function (card) {\r\n                    const tags = [\"dctuoyu_fengtian\", \"dctuoyu_qingqu\", \"dctuoyu_junshan\"];\r\n                    for (let i = 0; i < tags.length; i++) {\r\n                        if (card.hasGaintag(tags[i] + \"_tag\")) {\r\n                            return true;\r\n                        }\r\n                    }\r\n                    return false;\r\n                },\r\n                mod: {\r\n                    ignoredHandcard: function (card) {\r\n                        if (get.info('PStuoyu').cardIsIgnored(card)) return true;\r\n                    },\r\n                    cardDiscardable: function (card, _, name) {\r\n                        if (name == \"phaseDiscard\" && get.info('PStuoyu').cardIsIgnored(card)) return false;\r\n                    }\r\n                },\r\n                ai: {\r\n                    combo: \"PSxianjin\"\r\n                }\r\n            },\r\n            PSxianjin: {\r\n                audio: \"dcxianjin\",\r\n                audioname2: {\r\n                    PSshen_dengai2: [\r\n                        \"ext:PS武将/audio/skill/PSxianjin_PSshen_dengai21\",\r\n                        \"ext:PS武将/audio/skill/PSxianjin_PSshen_dengai22\"\r\n                    ]\r\n                },\r\n                inherit: \"dcxianjin\",\r\n                trigger: {\r\n                    global: \"roundStart\",\r\n                    player: \"damageEnd\",\r\n                    source: \"damageSource\"\r\n                },\r\n                filter: function (event, player, name) {\r\n                    return name === \"roundStart\" || player.countMark(\"dcxianjin\") % 2 == 0;\r\n                },\r\n                content: function () {\r\n                    \"step 0\";\r\n                    var tags = [\"dctuoyu_fengtian\", \"dctuoyu_qingqu\", \"dctuoyu_junshan\"];\r\n                    tags.removeArray(player.getStorage(\"dctuoyu\"));\r\n                    if (!tags.length) {\r\n                        player.insertPhase();\r\n                    } else if (tags.length == 1) {\r\n                        event._result = { control: tags[0] };\r\n                    } else player.chooseControl(tags).set(\"prompt\", \"险进：选择激活一个副区域标签\");\r\n                    \"step 1\";\r\n                    var control = result.control;\r\n                    if (control) {\r\n                        game.log(player, \"激活了副区域\", \"#y\" + get.translation(control));\r\n                        player.markAuto(\"dctuoyu\", [control]);\r\n                        player.popup(get.translation(control + \"_tag\"));\r\n                    }\r\n                    player.draw(player.getStorage(\"dctuoyu\").length);\r\n                }\r\n            },\r\n            PSqijing: {\r\n                audio: \"dcqijing\",\r\n                audioname2: {\r\n                    PSshen_dengai2: [\r\n                        \"ext:PS武将/audio/skill/PSqijing_PSshen_dengai21\",\r\n                        \"ext:PS武将/audio/skill/PSqijing_PSshen_dengai22\"\r\n                    ]\r\n                },\r\n                trigger: {\r\n                    global: [\r\n                        \"phaseAfter\",\r\n                        \"phaseCancelled\",\r\n                        \"phaseSkipped\"\r\n                    ]\r\n                },\r\n                filter: function (event, player) {\r\n                    return !event.skill && event.player.next == _status.roundStart && player.getStorage(\"dctuoyu\").length == 3;\r\n                },\r\n                forced: true,\r\n                juexingji: true,\r\n                skillAnimation: true,\r\n                animationColor: \"orange\",\r\n                forceDie: true,\r\n                priority: -Infinity,\r\n                lastDo: true,\r\n                content() {\r\n                    \"step 0\";\r\n                    player.changeSkin(\"PSqijing\", \"PSshen_dengai2\");\r\n                    lib.character.PSshen_dengai.dieAudios = ['ext:PS武将/audio/die/PSshen_dengai2.mp3'];\r\n                    player.awakenSkill(\"PSqijing\");\r\n                    player.loseMaxHp();\r\n                    player.addSkills(\"dccuixin\");\r\n                    \"step 1\";\r\n                    if (game.countPlayer() > 2) {\r\n                        if (player == trigger.player && !trigger.skill) {\r\n                            var evt = trigger.getParent();\r\n                            if (evt.name == \"phaseLoop\" && evt._isStandardLoop) evt.player = player.next;\r\n                        }\r\n                        player\r\n                            .chooseTarget(\r\n                                \"请选择一名要更换座次的角色，将自己移动到该角色的上家位置\",\r\n                                function (card, player, target) {\r\n                                    return target != player && target != player.next;\r\n                                },\r\n                                true\r\n                            )\r\n                            .set(\"ai\", function (target) {\r\n                                var player = _status.event.player;\r\n                                var current = _status.currentPhase.next;\r\n                                var max = 20,\r\n                                    att = 0;\r\n                                while (max > 0) {\r\n                                    max--;\r\n                                    if (current == target) return att;\r\n                                    att -= get.attitude(player, current);\r\n                                    current = current.next;\r\n                                }\r\n                                return att;\r\n                            });\r\n                    } else event.finish();\r\n                    \"step 2\";\r\n                    if (result.bool) {\r\n                        var target = result.targets[0];\r\n                        game.broadcastAll(\r\n                            function (target1, target2) {\r\n                                game.swapSeat(target1, target2, null, true);\r\n                            },\r\n                            player,\r\n                            target\r\n                        );\r\n                    }\r\n                },\r\n                ai: {\r\n                    combo: \"PStuoyu\"\r\n                },\r\n                _priority: 0\r\n            }\r\n        },\r\n        sort: sort.PScharacter_shen,\r\n        translate: {\r\n            PSshen_dengai: \"PS神邓艾\",\r\n            PStuoyu: \"拓域\",\r\n            PStuoyu_info: \"①锁定技。当你使用拥有对应副区域标签的牌时，你令此牌获得对应效果。丰田：伤害值或回复值+1；清渠：无次数和距离限制；峻山：不可被响应。②出牌阶段开始时和结束时，你给你的手牌分配对应的已激活副区域标签，已分配的手牌不计入手牌上限（每个区域至多五张）。\",\r\n            PSxianjin: \"险进\",\r\n            PSxianjin_info: \"锁定技，每轮开始时/当你造成或受到2次伤害后，你激活一个副区域，若你区域均已开发，则改为下回合开始前你执行一个回合，然后摸X张牌（X为已开发的副区域数）。\",\r\n            PSqijing: \"奇径\",\r\n            PSqijing_info: \"觉醒技，每轮结束后，若你的手牌副区域均已开发，你减1体力上限，获得〖摧心〗，然后将座次移动至除你以外的两名相邻角色之间。\",\r\n            \"#ext:PS武将/audio/skill/PStuoyu_PSshen_dengai21\": \"巨灵之力盈身，曳金牛于高阙，惊蛟蟒于狂澜。\",\r\n            \"#ext:PS武将/audio/skill/PStuoyu_PSshen_dengai22\": \"效五丁开山之旧事，全六合一统于天阙。\",\r\n            \"#ext:PS武将/audio/skill/PSxianjin_PSshen_dengai21\": \"敌备险拒我，我行险擒敌，勇者胜也。\",\r\n            \"#ext:PS武将/audio/skill/PSxianjin_PSshen_dengai22\": \"鸥鹭擒蚌，必以利喙击其坚甲，而后得脍。\",\r\n            \"#ext:PS武将/audio/skill/PSqijin_PSshen_dengai21\": \"世人皆寻已有之平路，独吾愿为开路之先锋。\",\r\n            \"#ext:PS武将/audio/skill/PSqijin_PSshen_dengai22\": \"纵尔匿离天之穹、九幽之渊，吾亦擒汝首而还。\",\r\n            \"#ext:PS武将/audio/skill/cuixin_PSshen_dengai21\": \"缚咖于颈，镇岳于魂，教汝死灰不燃、万劫不复！\",\r\n            \"#ext:PS武将/audio/skill/cuixin_PSshen_dengai22\": \"上军争功，夺三家之士气，击天下之雄兵。\",\r\n            \"#ext:PS武将/audio/die/PSshen_dengai2:die\": \"巨灵不屑顾，奈何反被宵小伤。\"\r\n        },\r\n        rank: rank.epic\r\n    },\r\n    PSshen_xunyu: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"shen\",\r\n            hp: 3,\r\n            skills: [\r\n                \"PSlingce\",\r\n                \"PStianzuo\",\r\n                \"PSdinghan\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“一顿七只屑狐狸”设计\",\r\n        skills: {\r\n            PSlingce: {\r\n                audio: \"lingce\",\r\n                trigger: {\r\n                    global: \"washCard\"\r\n                },\r\n                forced: true,\r\n                content() {\r\n                    \"step 0\"\r\n                    var cards = get.cards(8);\r\n                    event.cards = cards;\r\n                    if (player.storage.PSdinghan == true) player.chooseCardButton(cards, '选择获得至多六张牌', [1, 6]);\r\n                    else player.chooseCardButton(cards, '选择获得的牌名不同的牌', [1, Infinity]).set('filterButton', function (button) {\r\n                        let name = get.name(button.link);\r\n                        for (var i of ui.selected.buttons) {\r\n                            if (get.name(i.link) === name) return false;\r\n                        }\r\n                        return true;\r\n                    });\r\n                    \"step 1\"\r\n                    if (result.bool) {\r\n                        player.gain(result.links, 'draw');\r\n                    }\r\n                    game.cardsDiscard(event.cards.removeArray(result.links));\r\n                }\r\n            },\r\n            PStianzuo: {\r\n                audio: \"tianzuo\",\r\n                trigger: {\r\n                    player: [\r\n                        \"damageEnd\",\r\n                        \"phaseEnd\"\r\n                    ]\r\n                },\r\n                filter: function (event, player) {\r\n                    if (!ui.discardPile.childNodes.length) return false;\r\n                    if (event.name != 'phase') return event.num > 0;\r\n                    return true;\r\n                },\r\n                content: async function (event, trigger, player) {\r\n                    'step 0'\r\n                    const num = event.triggername === \"damageEnd\" ? trigger.num : 1;\r\n                    // event.num--;\r\n                    /* var cards = get.cards(ui.cardPile.childElementCount + 1);\r\n                    for (var i = 0; i < cards.length; i++) {\r\n                        ui.cardPile.insertBefore(cards[i], ui.cardPile.childNodes[get.rand(ui.cardPile.childElementCount)]);\r\n                    }\r\n                    game.updateRoundNumber();\r\n                    player.storage.PStianzuo++; */\r\n                    for (let i = 0; i < num; i++) {\r\n                        await game.washCard();\r\n                    }\r\n                },\r\n                group: \"PStianzuo_use\",\r\n                subSkill: {\r\n                    use: {\r\n                        audio: \"tianzuo\",\r\n                        enable: \"phaseUse\",\r\n                        usable: 1,\r\n                        filter: function (event, player) {\r\n                            if (!ui.discardPile.childNodes.length) return false;\r\n                            return true;\r\n                        },\r\n                        content: () => {\r\n                            game.washCard();\r\n                            /* var cards = get.cards(ui.cardPile.childElementCount + 1);\r\n                            for (var i = 0; i < cards.length; i++) {\r\n                                ui.cardPile.insertBefore(cards[i], ui.cardPile.childNodes[get.rand(ui.cardPile.childElementCount)]);\r\n                            }\r\n                            player.storage.PStianzuo++;\r\n                            game.updateRoundNumber(); */\r\n                            // event.trigger('PStianzuoAfter');\r\n                        },\r\n                        sub: true\r\n                    }\r\n                },\r\n                ai: {\r\n                    maixie: true,\r\n                    maixie_hp: true\r\n                }\r\n            },\r\n            PSdinghan: {\r\n                skillAnimation: true,\r\n                animationColor: \"fire\",\r\n                derivation: \"PSzuoding\",\r\n                audio: \"dinghan\",\r\n                juexingji: true,\r\n                unique: true,\r\n                forced: true,\r\n                trigger: {\r\n                    player: \"PStianzuoAfter\"\r\n                },\r\n                filter: (event, player) => {\r\n                    return player.getAllHistory('useSkill', evt => ['PStianzuo', 'PStianzuo_use'].includes(evt.skill)).length >= 3;\r\n                },\r\n                content: () => {\r\n                    player.awakenSkill(event.name);\r\n                    player.storage[event.name] = true;\r\n                    player.gainMaxHp();\r\n                    player.recover();\r\n                    player.addSkills('PSzuoding');\r\n                }\r\n            },\r\n            PSzuoding: {\r\n                audio: \"ext:PS武将/audio/skill:2\",\r\n                enable: \"phaseUse\",\r\n                usable: 3,\r\n                filterCard: true,\r\n                position: \"hes\",\r\n                viewAs: {\r\n                    name: \"qizhengxiangsheng\"\r\n                },\r\n                viewAsFilter: function (player) {\r\n                    if (!player.countCards('hes')) return false;\r\n                },\r\n                prompt: \"将一张牌当【奇正相生】使用\",\r\n                check: function (card) { return 4 - get.value(card) }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_shen,\r\n        translate: {\r\n            PSshen_xunyu: \"PS神荀彧\",\r\n            PSlingce: \"灵策\",\r\n            PSlingce_info: \"锁定技，当牌堆洗牌时，你观看牌堆顶8张牌，并从中获得牌名不同的牌，剩余的牌进入弃牌堆。\",\r\n            PStianzuo: \"天佐\",\r\n            PStianzuo_info: \"出牌阶段限一次/当你受到一点伤害后/回合结束时，若弃牌堆有牌，你可以令牌堆洗牌。\",\r\n            PSdinghan: \"定汉\",\r\n            PSdinghan_info: \"觉醒技，当你本局游戏至少发动过三次〖天佐〗，你增加一点体力上限并回复一点体力，获得技能〖佐定〗，然后将〖灵策〗中“获得牌名不同的牌”修改为“ 获得其中至多六张牌”。\",\r\n            PSzuoding: \"佐定\",\r\n            PSzuoding_info: \"出牌阶段限三次，你可以将一张牌当【奇正相生】使用。\",\r\n            \"#ext:PS武将/audio/skill/PSzuoding1\": \"看我二桃杀三士。\",\r\n            \"#ext:PS武将/audio/skill/PSzuoding2\": \"驱邪避恶，佑社稷黎民。\"\r\n        },\r\n        dynamicTranslate: {\r\n            PSlingce: function (player) {\r\n                if (player.storage.PSdinghan)\r\n                    return \"锁定技，当牌堆洗牌时，你观看牌堆顶8张牌，并从中获得至多六张牌，剩余的牌进入弃牌堆。\";\r\n                return \"锁定技，当牌堆洗牌时，你观看牌堆顶8张牌，并从中获得牌名不同的牌，剩余的牌进入弃牌堆。\";\r\n            }\r\n        },\r\n        rank: rank.epic\r\n    },\r\n    PShaozhao: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"wei\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PSzhengu\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“你想去哪儿呢”设计\",\r\n        skills: {\r\n            PSzhengu: {\r\n                audio: \"drlt_zhenggu\",\r\n                trigger: {\r\n                    player: \"phaseJieshuBegin\"\r\n                },\r\n                filter: function (event, player) {\r\n                    return !player.hasSkill(\"PSzhengu_mark\") || game.hasPlayer(current => current != player && !current.hasSkill(\"PSzhengu_mark\"));\r\n                },\r\n                async cost(event, trigger, player) {\r\n                    event.result = await player.chooseTarget(get.prompt2('PSzhengu'), function (card, player, target) {\r\n                        if (target === player) return false;\r\n                        if (!player.hasSkill(\"PSzhengu_mark\")) return true;\r\n                        return !target.hasSkill(\"PSzhengu_mark\");\r\n                    })\r\n                        .set('ai', function (target) {\r\n                            const att = get.attitude(player, target);\r\n                            const num = target.countCards('h') - player.countCards('h');\r\n                            if (player.hasSkill(\"PSzhengu_mark\") && num <= 0) return 0;\r\n                            if (target.hasSkill(\"PSzhengu_mark\") && num <= 0) return 0;\r\n                            if (att <= 0) {\r\n                                if (num > 0) return num;\r\n                                return 0;\r\n                            }\r\n                            return Math.abs(num);\r\n                        })\r\n                        .forResult();\r\n                },\r\n                async content(event, trigger, player) {\r\n                    const target = event.targets[0];\r\n                    let control;\r\n                    if (player.hasSkill(\"PSzhengu_mark\")) {\r\n                        control = target;\r\n                    } else if (target.hasSkill(\"PSzhengu_mark\")) {\r\n                        control = player;\r\n                    } else {\r\n                        ({ control } = await player.chooseControl()\r\n                            .set('controls', ['自己', target])\r\n                            .set('prompt', `令你或${get.translation(target)}变成“高达”：手牌数始终保持与另一方一致，直到“高达”的回合结束时`)\r\n                            .set('target', target)\r\n                            .set('ai', function () {\r\n                                const { controls, target } = get.event();\r\n                                const att = get.attitude(player, target);\r\n                                const num = target.countCards('h') - player.countCards('h');\r\n                                if (att <= 0 && num > 0) return controls[0];\r\n                                return num > 0 ? controls[0] : controls[1];\r\n                            })\r\n                            .forResult());\r\n                    }\r\n\r\n                    const current = control === '自己' ? player : target;\r\n                    const buffTarget = control === '自己' ? target : player;\r\n\r\n                    game.log(current, '变成了“高达”！对象是：', buffTarget);\r\n                    var num = buffTarget.countCards('h') - current.countCards('h');\r\n                    if (num > 0) current.draw(num);\r\n                    if (num < 0) current.chooseToDiscard('h', true, -num);\r\n                    current.storage.PSzhengu_mark = buffTarget;\r\n                    current.addTempSkill(\"PSzhengu_mark\", { player: \"phaseJieshuBegin\" });\r\n                    current.markSkill(\"PSzhengu_mark\");\r\n                },\r\n                subSkill: {\r\n                    mark: {\r\n                        onremove: function (player) {\r\n                            player.unmarkSkill(\"PSzhengu_mark\");\r\n                            delete player.storage.PSzhengu_mark;\r\n                        },\r\n                        mark: \"character\",\r\n                        intro: {\r\n                            content: \"已经变成了$的形状\"\r\n                        },\r\n                        trigger: {\r\n                            global: [\r\n                                \"loseAfter\",\r\n                                \"equipAfter\",\r\n                                \"addJudgeAfter\",\r\n                                \"gainAfter\",\r\n                                \"loseAsyncAfter\",\r\n                                \"addToExpansionAfter\"\r\n                            ]\r\n                        },\r\n                        forced: true,\r\n                        filter: function (event, player) {\r\n                            let target = player.storage.PSzhengu_mark;\r\n                            return target && target.isIn() && target.isAlive() && target.countCards('h') !== player.countCards('h');\r\n                        },\r\n                        content: function () {\r\n                            let target = player.storage.PSzhengu_mark;\r\n                            let num = target.countCards('h') - player.countCards('h');\r\n                            target.logSkill(\"PSzhengu\", player);\r\n                            target.line(player, 'fire');\r\n                            if (num > 0) player.draw(num);\r\n                            else player.chooseToDiscard('h', -num, true);\r\n                        },\r\n                        sub: true\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_wei,\r\n        translate: {\r\n            PShaozhao: \"PS郝昭\",\r\n            PSzhengu: \"镇骨\",\r\n            PSzhengu_info: \"结束阶段，你可以选择一名其他角色，然后你令你或其成为“高达”（“高达”效果：手牌数始终保持与对方一致，直到下回合结束时。一名角色不能重复成为“高达”）。\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PSxuyou: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"qun\",\r\n            hp: 3,\r\n            skills: [\r\n                \"PSchenglve\",\r\n                \"PSshicai\",\r\n                \"nzry_cunmu\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“神鬼高达”设计\",\r\n        skills: {\r\n            PSchenglve: {\r\n                mark: true,\r\n                locked: false,\r\n                zhuanhuanji: true,\r\n                marktext: \"☯\",\r\n                intro: {\r\n                    content: function (storage, player, skill) {\r\n                        var str = `出牌阶段限一次，你可以摸${player.storage.PSchenglve ? '两' : '一'}张牌，然后弃置${player.storage.PSchenglve ? '一' : '两'}张手牌。若如此做，直到本回合结束，你使用与弃置牌花色相同的牌无距离和次数限制，且当你使用/打出/弃置与弃置牌花色相同的牌后，你摸一张牌`;\r\n                        if (player.storage.PSchenglve_effect) {\r\n                            str += '<br><li>当前花色：';\r\n                            str += get.translation(player.storage.PSchenglve_effect);\r\n                        }\r\n                        return str;\r\n                    }\r\n                },\r\n                enable: \"phaseUse\",\r\n                usable: 1,\r\n                audio: \"nzry_chenglve\",\r\n                content: function () {\r\n                    'step 0'\r\n                    if (player.storage.PSchenglve == true) {\r\n                        player.draw(2);\r\n                        player.chooseToDiscard('h', true);\r\n                    }\r\n                    else {\r\n                        player.draw();\r\n                        player.chooseToDiscard('h', 2, true);\r\n                    }\r\n                    player.changeZhuanhuanji('PSchenglve')\r\n                    'step 1'\r\n                    if (result.bool) {\r\n                        player.storage.PSchenglve_effect = [];\r\n                        for (var i = 0; i < result.cards.length; i++) {\r\n                            player.storage.PSchenglve_effect.add(get.suit(result.cards[i], player));\r\n                        }\r\n                        player.markSkill('PSchenglve');\r\n                        player.addTempSkill('PSchenglve_effect');\r\n                    };\r\n                },\r\n                ai: {\r\n                    order: 2.7,\r\n                    result: {\r\n                        player: function (player) {\r\n                            if (!player.storage.PSchenglve && player.countCards('h') < 3) return 0;\r\n                            return 1;\r\n                        }\r\n                    }\r\n                },\r\n                subSkill: {\r\n                    effect: {\r\n                        mod: {\r\n                            cardUsable: function (card, player) {\r\n                                var cards = player.storage.PSchenglve_effect;\r\n                                for (var i = 0; i < cards.length; i++) {\r\n                                    if (cards[i] == get.suit(card)) return Infinity;\r\n                                };\r\n                            },\r\n                            targetInRange: function (card, player) {\r\n                                var cards = player.storage.PSchenglve_effect;\r\n                                for (var i = 0; i < cards.length; i++) {\r\n                                    if (cards[i] == get.suit(card)) return true;\r\n                                };\r\n                            }\r\n                        },\r\n                        trigger: {\r\n                            player: [\r\n                                \"useCardAfter\",\r\n                                \"respondAfter\",\r\n                                \"discardAfter\"\r\n                            ]\r\n                        },\r\n                        forced: true,\r\n                        filter: function (event, player) {\r\n                            let cards = player.storage.PSchenglve_effect;\r\n                            return cards.includes(get.suit(event.card));\r\n                        },\r\n                        content: function () {\r\n                            player.draw();\r\n                        },\r\n                        onremove: true,\r\n                        sub: true\r\n                    }\r\n                }\r\n            },\r\n            PSshicai: {\r\n                audio: \"nzry_shicai_2\",\r\n                trigger: {\r\n                    player: [\r\n                        \"useCardAfter\"\r\n                    ],\r\n                    target: \"useCardToTargeted\"\r\n                },\r\n                filter: function (event, player, name) {\r\n                    if (name == 'useCardToTargeted' && ('equip' != get.type(event.card) || event.player != player)) return false;\r\n                    if (name == 'useCardAfter' && ['equip', 'delay'].includes(get.type(event.card))) return false;\r\n                    if (event.cards.filterInD().length <= 0) return false;\r\n                    var history = player.getHistory('useCard');\r\n                    var evt = name == 'useCardAfter' ? event : event.getParent();\r\n                    for (var i = 0; i < history.length; i++) {\r\n                        if (history[i] != evt && get.name(history[i].card) == get.name(event.card)) return false;\r\n                        else if (history[i] == evt) return true;\r\n                    }\r\n                    return false;\r\n                },\r\n                check: function (event, player) {\r\n                    if (get.type(event.card) == 'equip') {\r\n                        if (get.subtype(event.card) == 'equip6') return true;\r\n                        if (get.equipResult(player, event.target, event.card.name) <= 0) return true;\r\n                        var eff1 = player.getUseValue(event.card);\r\n                        var subtype = get.subtype(event.card);\r\n                        return player.countCards('h', function (card) {\r\n                            return get.subtype(card) == subtype && player.getUseValue(card) >= eff1;\r\n                        }) > 0;\r\n                    }\r\n                    return true;\r\n                },\r\n                content: function () {\r\n                    \"step 0\"\r\n                    event.cards = trigger.cards.filterInD();\r\n                    if (event.cards.length > 1) {\r\n                        var next = player.chooseToMove('恃才：将牌按顺序置于牌堆顶');\r\n                        next.set('list', [['牌堆顶', event.cards]]);\r\n                        next.set('reverse', ((_status.currentPhase && _status.currentPhase.next) ? get.attitude(player, _status.currentPhase.next) > 0 : false));\r\n                        next.set('processAI', function (list) {\r\n                            var cards = list[0][1].slice(0);\r\n                            cards.sort(function (a, b) {\r\n                                return (_status.event.reverse ? 1 : -1) * (get.value(b) - get.value(a));\r\n                            });\r\n                            return [cards];\r\n                        });\r\n                    }\r\n                    \"step 1\"\r\n                    if (result.bool && result.moved && result.moved[0].length) cards = result.moved[0].slice(0);\r\n                    while (cards.length) {\r\n                        var card = cards.pop();\r\n                        if (get.position(card, true) == 'o') {\r\n                            card.fix();\r\n                            ui.cardPile.insertBefore(card, ui.cardPile.firstChild);\r\n                            game.log(player, '将', card, '置于牌堆顶');\r\n                        }\r\n                    }\r\n                    game.updateRoundNumber();\r\n                    player.draw();\r\n                },\r\n                ai: {\r\n                    reverseOrder: true,\r\n                    skillTagFilter: function (player) {\r\n                        if (player.getHistory('useCard', function (evt) {\r\n                            return get.type(evt.card) == 'equip';\r\n                        }).length > 0) return false;\r\n                    },\r\n                    effect: {\r\n                        target: function (card, player, target) {\r\n                            if (player == target && get.type(card) == 'equip' && !player.getHistory('useCard', function (evt) {\r\n                                return get.type(evt.card) == 'equip'\r\n                            }).length == 0) return [1, 3];\r\n                        }\r\n                    },\r\n                    threaten: 2.4\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_qun,\r\n        translate: {\r\n            PSxuyou: \"PS许攸\",\r\n            PSchenglve: \"成略\",\r\n            PSchenglve_info: \"转换技，出牌阶段限一次，阴：你可以摸一张牌，然后弃置两张手牌。阳：你可以摸两张牌，然后弃置一张手牌。若如此做，直到本回合结束，你使用与弃置牌花色相同的牌无距离和次数限制，且当你使用/打出/弃置与弃置牌花色相同的牌后，你摸一张牌。\",\r\n            PSshicai: \"恃才\",\r\n            PSshicai_info: \"当你使用牌时，若此牌与你本回合使用的牌名均不同，则你可以将此牌置于牌堆顶，然后摸一张牌。\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PSshen_sunquan: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"shen\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PSyuheng\",\r\n                \"PSdili\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“九个芒果”设计\",\r\n        skills: {\r\n            PSyuheng: {\r\n                getList: function () {\r\n                    var list;\r\n                    if (_status.characterlist) {\r\n                        list = [];\r\n                        for (var i = 0; i < _status.characterlist.length; i++) {\r\n                            var name = _status.characterlist[i];\r\n                            if (lib.character[name][1] == 'wu' && lib.skill.PSfushi.characterList().includes(name)) list.push(name);\r\n                        }\r\n                    }\r\n                    else if (_status.connectMode) {\r\n                        list = get.charactersOL(function (i) {\r\n                            return lib.character[i][1] != 'wu' && !lib.skill.PSfushi.characterList().includes(i);\r\n                        });\r\n                    }\r\n                    else {\r\n                        list = get.gainableCharacters(function (info) {\r\n                            return info[1] == 'wu' && lib.skill.PSfushi.characterList().includes(i);\r\n                        });\r\n                    }\r\n                    var players = game.players.concat(game.dead);\r\n                    for (var i = 0; i < players.length; i++) {\r\n                        list.remove(players[i].name);\r\n                        list.remove(players[i].name1);\r\n                        list.remove(players[i].name2);\r\n                    }\r\n                    //list=list.randomGets(Math.max(4,game.countPlayer()));\r\n                    var skills = [];\r\n                    for (var i of list) {\r\n                        skills.addArray((lib.character[i][3] || []).filter(function (skill) {\r\n                            var info = get.info(skill);\r\n                            return info && !info.zhuSkill && !info.hiddenSkill && !info.charlotte;\r\n                        }));\r\n                    }\r\n                    return skills;\r\n                },\r\n                group: \"PSyuheng_remove\",\r\n                audio: \"yuheng\",\r\n                trigger: {\r\n                    player: \"phaseBegin\"\r\n                },\r\n                filter: function (event, player) {\r\n                    return player.hasCard(function (card) {\r\n                        return lib.filter.cardDiscardable(card, player, 'PSyuheng');\r\n                    }, 'he');\r\n                },\r\n                frequent: true,\r\n                keepSkill: true,\r\n                marktext: \"驭衡\",\r\n                intro: {\r\n                    name: \"驭衡\",\r\n                    content: function (storage, player) {\r\n                        return `因〖驭衡〗获得的技能：${get.translation(player.additionalSkills.PSyuheng)}`;\r\n                    },\r\n                    markcount: function (storage, player) {\r\n                        return player.additionalSkills.PSyuheng.length;\r\n                    }\r\n                },\r\n                content: function () {\r\n                    'step 0'\r\n                    let num = player.getCards('he').reduce(function (arr, card) {\r\n                        return arr.add(get.suit(card, player)), arr;\r\n                    }, []).length;\r\n                    player.chooseToDiscard('he', false, [1, num], function (card, player) {\r\n                        if (!ui.selected.cards.length) return true;\r\n                        var suit = get.suit(card, player);\r\n                        for (var i of ui.selected.cards) {\r\n                            if (get.suit(i, player) == suit) return false;\r\n                        }\r\n                        return true;\r\n                    }).set('complexCard', true).set('ai', function (card) {\r\n                        var list = lib.skill.PSyuheng.getList();\r\n                        if (ui.selected.cards.length >= list.length) return 0;\r\n                        if (!player.hasValueTarget(card)) return 5;\r\n                        return 1 / (get.value(card) || 0.5);\r\n                    }).set('prompt', '驭衡：弃置花色不同的牌获得等量吴势力角色的技能');\r\n                    'step 1'\r\n                    if (result.bool) {\r\n                        var list = lib.skill.PSyuheng.getList().slice(0);\r\n                        list = list.filter(function (skill) {\r\n                            return !player.hasSkill(skill);\r\n                        });\r\n                        player.draw(result.cards.length);\r\n                        var skills = list.randomGets(Math.min(list.length, result.cards.length));\r\n                        if (player.additionalSkills.PSyuheng && player.additionalSkills.PSyuheng.length) {\r\n                            skills.addArray(player.additionalSkills.PSyuheng);\r\n                        }\r\n                        player.addAdditionalSkill('PSyuheng', skills);\r\n                        player.markSkill('PSyuheng');\r\n                        game.log(player, '获得了以下技能：', '#g' + get.translation(skills));\r\n                    }\r\n                },\r\n                subSkill: {\r\n                    remove: {\r\n                        audio: \"yuheng\",\r\n                        trigger: {\r\n                            player: \"phaseEnd\"\r\n                        },\r\n                        filter: function (event, player) {\r\n                            return player.additionalSkills.PSyuheng && player.additionalSkills.PSyuheng.length;\r\n                        },\r\n                        frequent: true,\r\n                        content: function () {\r\n                            'step 0'\r\n                            let skills = player.additionalSkills.PSyuheng;\r\n                            event.num = skills.length;\r\n                            player.chooseButton(['驭衡：选择失去任意数量个技能，摸等量的牌', [skills, 'vcard']], [1, event.num], false).set('ai', function (button) { });\r\n                            'step 1'\r\n                            if (result.bool) {\r\n                                let links = result.links.map(ele => ele[ele.length - 1]);\r\n                                game.log(player, '失去了以下技能：', '#g' + get.translation(links));\r\n                                player.draw(links.length);\r\n                                player.removeSkills(links);\r\n                                player.additionalSkills.PSyuheng.length ? player.markSkill('PSyuheng') : player.unmarkSkill('PSyuheng');\r\n                            }\r\n                        },\r\n                        sub: true\r\n                    }\r\n                }\r\n            },\r\n            PSdili: {\r\n                derivation: [\r\n                    \"junkshengzhi\",\r\n                    \"junkquandao\",\r\n                    \"junkchigang\"\r\n                ],\r\n                juexingji: true,\r\n                audio: \"dili\",\r\n                trigger: {\r\n                    global: \"phaseBefore\",\r\n                    player: [\r\n                        \"enterGame\",\r\n                        \"loseMaxHpEnd\",\r\n                        \"gainMaxHpEnd\",\r\n                        \"addSkill\",\r\n                        \"removeSkill\"\r\n                    ]\r\n                },\r\n                filter: function (event, player, name) {\r\n                    if (event.name == 'phase' && game.phaseNumber > 0) return false;\r\n                    return player.additionalSkills.PSyuheng && player.additionalSkills.PSyuheng.length > player.maxHp;\r\n                },\r\n                forced: true,\r\n                skillAnimation: true,\r\n                animationColor: \"wood\",\r\n                content: function () {\r\n                    player.awakenSkill('PSdili');\r\n                    player.removeSkills('PSyuheng');\r\n                    player.addSkill(lib.skill.PSdili.derivation);\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_shen,\r\n        translate: {\r\n            PSshen_sunquan: \"PS神孙权\",\r\n            PSyuheng: \"驭衡\",\r\n            PSyuheng_info: \"①回合开始时，你可以弃置任意张花色不同的牌，然后摸等量的牌并获得等量吴势力的技能。②回合结束时，你可以选择失去任意个因〖驭衡①〗获得的技能，然后摸等量的牌。\",\r\n            PSdili: \"帝力\",\r\n            PSdili_info: \"觉醒技，当你因〖驭衡①〗获得的技能数大于你的体力上限时，你失去技能〖驭衡〗，然后获得技能〖圣质〗、〖权道〗、〖持纲〗。\"\r\n        },\r\n        rank: rank.epic\r\n    },\r\n    PSshen_dianwei: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"shen\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PSjuanjia\",\r\n                \"qiexie\",\r\n                \"cuijue\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“mento last”设计\",\r\n        skills: {\r\n            PSjuanjia: {\r\n                audio: \"juanjia\",\r\n                trigger: {\r\n                    global: \"phaseBefore\",\r\n                    player: \"enterGame\"\r\n                },\r\n                forced: true,\r\n                filter: function (event, player) {\r\n                    return (event.name != 'phase' || game.phaseNumber == 0);\r\n                },\r\n                content: function () {\r\n                    for (let i = 1; i < 6; i++) {\r\n                        if (player.hasEnabledSlot(i) && i !== 1) {\r\n                            player.disableEquip(i);\r\n                            player.expandEquip(1);\r\n                        }\r\n                    }\r\n                },\r\n                _priority: 0\r\n            }\r\n        },\r\n        sort: sort.PScharacter_shen,\r\n        translate: {\r\n            PSshen_dianwei: \"PS神典韦\",\r\n            PSjuanjia: \"捐甲\",\r\n            PSjuanjia_info: \"锁定技，游戏开始时，你废除一个宝物栏、防具栏、攻击马栏和防御马栏，然后获得等量的额外武器栏。\"\r\n        },\r\n        rank: rank.legend\r\n    },\r\n    PSlvmeng: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"wu\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PSbolan\"\r\n            ],\r\n            dieAudios: [\r\n                \"re_lvmeng\"\r\n            ],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“群弱智（兼群小丑）”设计\",\r\n        skills: {\r\n            PSbolan: {\r\n                trigger: {\r\n                    player: [\r\n                        \"phaseDrawBegin1\",\r\n                        \"phaseZhunbeiBegin\"\r\n                    ]\r\n                },\r\n                forced: true,\r\n                derivation: \"PSgongxin\",\r\n                mod: {\r\n                    globalFrom: function (from, to, distance) {\r\n                        return distance - (from.storage.PSbolan);\r\n                    },\r\n                    maxHandcard: function (player, num) {\r\n                        return num + player.storage.PSbolan;\r\n                    }\r\n                },\r\n                filter: function (event, player, name) {\r\n                    if (name === \"phaseZhunbeiBegin\") return player.storage.PSbolan >= 5;\r\n                    return player.hp > 0 && !event.numFixed;\r\n                },\r\n                init: function (player, skill) {\r\n                    if (!player.storage[skill]) player.storage[skill] = 0;\r\n                },\r\n                marktext: \"识\",\r\n                intro: {\r\n                    name: \"博览\",\r\n                    content: \"mark\"\r\n                },\r\n                content: function () {\r\n                    if (event.triggername === \"phaseZhunbeiBegin\") {\r\n                        player.addSkills('PSgongxin');\r\n                        game.playSkillAudio(\"botu\");\r\n                    }\r\n                    else {\r\n                        trigger.changeToZero();\r\n                        player.draw(player.hp);\r\n                        player.storage.PSbolan += Math.max(player.hp - 2, 0);\r\n                        player.markSkill('PSbolan');\r\n                        game.playSkillAudio(\"qinxue\");\r\n                    }\r\n                }\r\n            },\r\n            PSgongxin: {\r\n                mark: true,\r\n                locked: false,\r\n                zhuanhuanji: true,\r\n                marktext: \"☯\",\r\n                intro: {\r\n                    content: function (storage, player, skill) {\r\n                        return `出牌阶段限一次，你可以观看一名其他角色的手牌，然后获得其中任意张花色${player.storage.PSgongxin == true ? '相同' : '不同'}的牌。每以此法获得一张牌，你移去一个“识”。`;\r\n                    }\r\n                },\r\n                enable: \"phaseUse\",\r\n                usable: 1,\r\n                audio: \"gongxin\",\r\n                prompt: () => {\r\n                    var player = _status.event.player;\r\n                    return `观看一名其他角色的手牌，获得其任意张花色${player.storage.PSgongxin ? '相同' : '不同'}的牌`;\r\n                },\r\n                filterTarget: function (card, player, target) {\r\n                    return target != player && target.countCards('h');\r\n                },\r\n                content: function () {\r\n                    'step 0'\r\n                    event.videoId = lib.status.videoId++;\r\n                    var cards = target.getCards('h');\r\n                    if (player.isOnline2()) {\r\n                        player.send(function (cards, id) {\r\n                            ui.create.dialog('攻心', cards).videoId = id;\r\n                        }, cards, event.videoId);\r\n                    }\r\n                    event.dialog = ui.create.dialog('攻心', cards);\r\n                    event.dialog.videoId = event.videoId;\r\n                    if (!event.isMine()) {\r\n                        event.dialog.style.display = 'none';\r\n                    }\r\n                    player.chooseButton([1, Infinity]).set('filterButton', function (button) {\r\n                        if (!ui.selected.buttons.length) return true;\r\n                        var suit = get.suit(button.link);\r\n                        for (var i of ui.selected.buttons) {\r\n                            if (player.storage.PSgongxin == true) {\r\n                                if (get.suit(i.link) != suit) return false;\r\n                            }\r\n                            else {\r\n                                if (get.suit(i.link) == suit) return false;\r\n                            }\r\n                        }\r\n                        return true;\r\n                    }).set('dialog', event.videoId);\r\n                    'step 1'\r\n                    if (player.isOnline2()) player.send('closeDialog', event.videoId);\r\n                    event.dialog.close();\r\n                    if (result.bool) {\r\n                        player.gain(result.links, target, 'giveAuto');\r\n                        player.storage.PSbolan -= Math.min(result.links.length, player.storage.PSbolan);\r\n                        player.storage.PSbolan ? player.markSkill('PSbolan') : player.unmarkSkill('PSbolan');\r\n                    }\r\n                    player.changeZhuanhuanji('PSgongxin');\r\n                },\r\n                ai: {\r\n                    order: 12,\r\n                    expose: 0.4,\r\n                    result: {\r\n                        target: function (player, target) {\r\n                            return -target.countCards('h');\r\n                        }\r\n                    }\r\n                },\r\n                group: \"PSgongxin_remove\",\r\n                subSkill: {\r\n                    remove: {\r\n                        trigger: {\r\n                            player: \"phaseJieshuBegin\"\r\n                        },\r\n                        forced: true,\r\n                        filter: (event, player) => player.storage.PSbolan < 5,\r\n                        content: () => {\r\n                            player.removeSkills('PSgongxin');\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_wu,\r\n        translate: {\r\n            PSlvmeng: \"PS吕蒙\",\r\n            PSbolan: \"博览\",\r\n            PSbolan_info: \"锁定技,摸牌阶段,你改为摸与你体力值相等的牌，然后你记录本次以此法摸的牌为X，你获得X-2个“识”标记。每有一个“识”，你的手牌上限+1，计算与其他角色的距离-1。准备阶段,若你的“识”不小于5,你获得〖攻心〗。\",\r\n            PSgongxin: \"攻心\",\r\n            PSgongxin_info: \"转换技,出牌阶段限一次。阳:你可以观看一名其他角色的手牌，然后获得其中任意张花色相同的牌。阴:你可以观看一名其他角色的手牌,然后选择获得其中任意张花色不同的牌。每以此法获得一张牌，你移去一个“识”。结束阶段,若你的“识”小于5，你失去〖攻心〗。\"\r\n        },\r\n        dynamicTranslate: {\r\n            PSgongxin: function (player) {\r\n                if (player.storage.PSgongxin == true)\r\n                    return '转换技,出牌阶段限一次。<span class=\"bluetext\">阳:你可以观看一名其他角色的手牌，然后获得其中任意张花色相同的牌。</span>阴:你可以观看一名其他角色的手牌,然后选择获得其中任意张花色不同的牌。每以此法获得一张牌，你移去一个“识”。结束阶段,若你的“识”小于5，你失去〖攻心〗。';\r\n                return '转换技,出牌阶段限一次。阳:你可以观看一名其他角色的手牌，然后获得其中任意张花色相同的牌。<span class=\"bluetext\">阴:你可以观看一名其他角色的手牌,然后选择获得其中任意张花色不同的牌。</span>每以此法获得一张牌，你移去一个“识”。结束阶段,若你的“识”小于5，你失去〖攻心〗。';\r\n            },\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PSzhonghui: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"wei\",\r\n            hp: 4,\r\n            skills: [\r\n                \"clanyuzhi\",\r\n                \"PSquanshu\",\r\n                \"clanbaozu\",\r\n                \"PSpaiyi\"\r\n            ],\r\n            clans: [\r\n                \"颍川钟氏\"\r\n            ],\r\n            dieAudios: [\r\n                \"clan_zhonghui\"\r\n            ],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“九个鲨雕”设计\",\r\n        skills: {\r\n            PSquanshu: {\r\n                audio: \"xinquanji\",\r\n                trigger: {\r\n                    player: \"damageEnd\",\r\n                    source: \"damageSource\"\r\n                },\r\n                filter: function (event, player) {\r\n                    return true;\r\n                },\r\n                prompt2: function (event, player) {\r\n                    return `摸${get.cnNumber(player.getDamagedHp(true))}张牌，再将一张牌置于武将牌上`;\r\n                },\r\n                content: function () {\r\n                    'step 0'\r\n                    player.draw(player.getDamagedHp(true));\r\n                    'step 1'\r\n                    var hs = player.getCards('h');\r\n                    if (hs.length > 0) {\r\n                        if (hs.length == 1) event._result = { bool: true, cards: hs };\r\n                        else player.chooseCard('h', true, '选择一张牌作为“权”');\r\n                    }\r\n                    else event.finish();\r\n                    'step 2'\r\n                    if (result.bool) {\r\n                        var cs = result.cards;\r\n                        player.addToExpansion(cs, player, 'give').gaintag.add('PSquanshu');\r\n                    }\r\n                },\r\n                intro: {\r\n                    content: \"expansion\",\r\n                    markcount: \"expansion\"\r\n                },\r\n                onremove: function (player, skill) {\r\n                    var cards = player.getExpansions(skill);\r\n                    if (cards.length) player.loseToDiscardpile(cards);\r\n                },\r\n                locked: false,\r\n                mod: {\r\n                    maxHandcard: function (player, num) {\r\n                        return num + player.getExpansions('PSquanshu').length;\r\n                    }\r\n                },\r\n                ai: {\r\n                    maixie: true,\r\n                    maixie_hp: true,\r\n                    effect: {\r\n                        target: function (card, player, target) {\r\n                            if (get.tag(card, 'damage')) {\r\n                                if (player.hasSkillTag('jueqing', false, target)) return [1, -2];\r\n                                if (!target.hasFriend()) return;\r\n                                var num = 1;\r\n                                if (get.attitude(player, target) > 0) {\r\n                                    if (player.needsToDiscard()) {\r\n                                        num = 0.7;\r\n                                    }\r\n                                    else {\r\n                                        num = 0.5;\r\n                                    }\r\n                                }\r\n                                if (target.hp >= 4) return [1, num * 2];\r\n                                if (target.hp == 3) return [1, num * 1.5];\r\n                                if (target.hp == 2) return [1, num * 0.5];\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            PSpaiyi: {\r\n                audio: \"xinpaiyi\",\r\n                enable: \"phaseUse\",\r\n                usable: 1,\r\n                filter: function (event, player) {\r\n                    return player.getExpansions('PSquanshu').length > 0;\r\n                },\r\n                chooseButton: {\r\n                    dialog: function (event, player) {\r\n                        return ui.create.dialog('排异', player.getExpansions('PSquanshu'), 'hidden')\r\n                    },\r\n                    backup: function (links, player) {\r\n                        return {\r\n                            audio: 'xinpaiyi',\r\n                            filterTarget: true,\r\n                            filterCard: function () { return false },\r\n                            selectCard: -1,\r\n                            card: links[0],\r\n                            delay: false,\r\n                            content: lib.skill.PSpaiyi.contentx,\r\n                            ai: {\r\n                                order: 10,\r\n                                result: {\r\n                                    target: function (player, target) {\r\n                                        if (target != player) return 0;\r\n                                        if (player.getExpansions('PSquanshu').length <= 1 || (player.needsToDiscard() && !player.getEquip('zhuge') && !player.hasSkill('new_paoxiao'))) return 0;\r\n                                        return 1;\r\n                                    }\r\n                                },\r\n                            },\r\n                        }\r\n                    },\r\n                    prompt: function (event, player) {\r\n                        var num = player.getExpansions('PSquanshu').length - 1;\r\n                        var max = Math.max(1, num);\r\n                        return `令一名角色摸${get.cnNumber(max)}张牌，然后该角色可以对其他角色造成伤害`;\r\n                    }\r\n                },\r\n                contentx: function () {\r\n                    \"step 0\"\r\n                    var card = lib.skill.PSpaiyi_backup.card;\r\n                    player.loseToDiscardpile(card);\r\n                    \"step 1\"\r\n                    var num = player.getExpansions('PSquanshu').length;\r\n                    var max = Math.max(1, num);\r\n                    target.draw(max);\r\n                    target.chooseTarget(false, [1, max], '对至多' + get.cnNumber(max) + '名角色各造成1点伤害').set('ai', function (target) {\r\n                        var player = _status.event.player;\r\n                        return get.damageEffect(target, player, player);\r\n                    });\r\n                    \"step 2\"\r\n                    if (result.bool) {\r\n                        var targets = result.targets.sortBySeat();\r\n                        target.line(targets, 'green');\r\n                        for (var i of targets) i.damage('nocard', target);\r\n                    }\r\n                },\r\n                ai: {\r\n                    order: function (item, player) {\r\n                        var num = player.getExpansions('PSquanshu').length;\r\n                        if (num == 1) return 8;\r\n                        return 1;\r\n                    },\r\n                    result: {\r\n                        player: 1\r\n                    }\r\n                },\r\n                _priority: 0\r\n            }\r\n        },\r\n        sort: sort.PScharacter_wei,\r\n        translate: {\r\n            PSzhonghui: \"PS钟会\",\r\n            PSquanshu: \"权术\",\r\n            PSquanshu_info: \"当你造成或受到伤害后，你可以摸Y张牌，然后将一张手牌置于你的武将牌上，称为“权”，你的手牌上限+Z（Y为你已损失的体力值，Z为“权”的数量）。\",\r\n            PSpaiyi: \"排异\",\r\n            PSpaiyi_info: \"出牌阶段限一次，你可以移去一张“权”并令一名角色摸Z张牌，然后其对至多Z名角色各造成1点伤害（Z为“权”的数量且至少为1）\",\r\n            PSpaiyi_backup: \"权术\"\r\n        },\r\n        rank: rank.epic\r\n    },\r\n    PSlibai: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"qun\",\r\n            hp: 3,\r\n            skills: [\r\n                \"PSjiuxian\",\r\n                \"PSshixian\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“九个芒果”设计\",\r\n        skills: {\r\n            PSjiuxian: {\r\n                audio: \"dclbjiuxian\",\r\n                trigger: {\r\n                    player: [\r\n                        \"useCardAfter\",\r\n                        \"gainAfter\"\r\n                    ]\r\n                },\r\n                forced: true,\r\n                filter: function (event, player, name) {\r\n                    if (lib.config.extension_PS武将_PS_pingzeTip == true) {\r\n                        let hs = player.getCards('h', (card) => !card.hasGaintag(\"PSshixian_ping\") && !card.hasGaintag(\"PSshixian_ze\"));\r\n                        let hs1 = player.getCards('h', (card) => hs.includes(card) && getPingZe(get.translation(card.name)) == '平');\r\n                        let hs2 = hs.removeArray(hs1);\r\n                        player.addGaintag(hs1, \"PSshixian_ping\");\r\n                        player.addGaintag(hs2, \"PSshixian_ze\");\r\n                    }\r\n                    else {\r\n                        player.removeGaintag(\"PSshixian_ping\");\r\n                        player.removeGaintag(\"PSshixian_ze\");\r\n                    }\r\n                    if (name == \"gainAfter\") return false;\r\n                    return event.card.name === 'jiu' && player.hasSkill('PSshixian');\r\n                },\r\n                prompt2: function (event, player) {\r\n                    return `令你使用的下一张牌无视条件触发技能〖诗仙〗？`\r\n                },\r\n                content: function () {\r\n                    player.addTempSkill('PSjiuxian_ignore', 'useCardEnd');\r\n                },\r\n                group: \"dclbjiuxian\",\r\n                subSkill: {\r\n                    ignore: {\r\n                        charlotte: true,\r\n                        forced: true,\r\n                        popup: false\r\n                    }\r\n                }\r\n            },\r\n            PSshixian: {\r\n                audio: \"dcshixian\",\r\n                trigger: {\r\n                    player: \"useCard\"\r\n                },\r\n                intro: {\r\n                    content: function (storage, player, skill) {\r\n                        let evt = player.getAllHistory('useCard').at(-1);\r\n                        return `当前记录：${getPingZe(get.translation(evt.card.name))}`;\r\n                    }\r\n                },\r\n                locked: false,\r\n                filter: function (event, player) {\r\n                    player.markSkill('PSshixian');\r\n                    player.marks.PSshixian.firstChild.innerHTML = getPingZe(get.translation(event.card.name));\r\n                    player.markSkill('PSshixian');\r\n                    if (player.hasSkill('PSjiuxian_ignore')) return true;\r\n                    var history = player.getAllHistory('useCard'), index = history.indexOf(event);\r\n                    if (index < 1) return false;\r\n                    var evt = history[index - 1];\r\n                    let pingze1 = getPingZe(get.translation(event.card.name));\r\n                    let pingze2 = getPingZe(get.translation(evt.card.name));\r\n                    return pingze1 !== pingze2;\r\n                },\r\n                filterx: function (event) {\r\n                    if (event.targets.length == 0) return false;\r\n                    var type = get.type(event.card);\r\n                    if (type != 'basic' && type != 'trick') return false;\r\n                    return true;\r\n                },\r\n                prompt2: function (event, player) {\r\n                    if (lib.skill.PSshixian.filterx(event)) return '摸一张牌并令' + get.translation(event.card) + '额外结算一次？';\r\n                    return '摸一张牌。';\r\n                },\r\n                check: function (event, player) {\r\n                    if (lib.skill.PSshixian.filterx(event)) return !get.tag(event.card, 'norepeat');\r\n                    return true;\r\n                },\r\n                content: function () {\r\n                    player.draw();\r\n                    if (lib.skill.PSshixian.filterx(trigger)) {\r\n                        trigger.effectCount++;\r\n                        game.log(trigger.card, '额外结算一次');\r\n                    }\r\n                },\r\n                mod: {\r\n                    aiOrder: function (player, card, num) {\r\n                        if (typeof card == 'object' && !get.tag(card, 'norepeat')) {\r\n                            var history = player.getAllHistory('useCard');\r\n                            if (history.length > 0) {\r\n                                var cardx = history[history.length - 1].card;\r\n                                if (getPingZe(get.translation(card.name)) !== getPingZe(get.translation(cardx.name))) return num + 20;\r\n                            }\r\n                        }\r\n                    }\r\n                },\r\n                _priority: 0\r\n            }\r\n        },\r\n        sort: sort.PScharacter_qun,\r\n        translate: {\r\n            PSlibai: \"PS李白\",\r\n            PSjiuxian: \"酒仙\",\r\n            PSjiuxian_info: \"①你可以将额定目标数大于1的锦囊牌当做【酒】使用。②你使用【酒】无次数限制。③当你使用【酒】后，你使用的下一张牌无视条件触发技能〖诗仙〗。\",\r\n            PSshixian: \"诗仙\",\r\n            PSshixian_info: \"当你使用一张牌时，若此牌牌名的最后一个字的平仄声与你于本局游戏使用的上一张牌的不同，则你可以摸一张牌，并令此牌额外结算一次。(以平水韵为标准)\",\r\n            PSshixian_ping: \"平\",\r\n            PSshixian_ze: \"仄\"\r\n        },\r\n        rank: rank.epic\r\n    },\r\n    PSxie_sunquan: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"wu\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PSzongheng\",\r\n                \"PSxiqu\",\r\n                \"PSchengchen\"\r\n            ],\r\n            dieAudios: [\r\n                \"re_sunquan\"\r\n            ],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“一顿七只屑狐狸”设计\",\r\n        skills: {\r\n            PSzongheng: {\r\n                audio: \"rezhiheng\",\r\n                audioname: [\r\n                    \"shen_caopi\"\r\n                ],\r\n                enable: \"phaseUse\",\r\n                position: \"h\",\r\n                filter: function (event, player) {\r\n                    const skills = player.getHistory('useSkill', evt => evt.skill == 'PSzongheng');\r\n                    if (!skills.length) return true;\r\n                    let suits = [];\r\n                    let num = lib.suit.length;\r\n                    skills.forEach(evt => {\r\n                        evt.event.cards.forEach(card => {\r\n                            suits.add(get.suit(card));\r\n                        });\r\n                        num -= suits.length;\r\n                        suits = [];\r\n                    });\r\n                    return num > 0;\r\n                },\r\n                complexCard: true,\r\n                filterCard: function (card, player, event) {\r\n                    if (ui.selected.cards.length > 1) {\r\n                        var suit = get.suit(card);\r\n                        if (get.suit(ui.selected.cards[0]) != get.suit(ui.selected.cards[1])) {\r\n                            for (var i of ui.selected.cards) {\r\n                                if (get.suit(i) == suit) return false;\r\n                            }\r\n                        }\r\n                        else {\r\n                            for (var i of ui.selected.cards) {\r\n                                if (get.suit(i) != suit) return false;\r\n                            }\r\n                        }\r\n                    }\r\n                    event = event || _status.event;\r\n                    if (typeof event != 'string') event = event.getParent().name;\r\n                    var mod = game.checkMod(card, player, event, 'unchanged', 'cardDiscardable', player);\r\n                    return mod != 'unchanged' ? mod : true;\r\n                },\r\n                discard: false,\r\n                lose: false,\r\n                delay: false,\r\n                selectCard: [\r\n                    1,\r\n                    Infinity\r\n                ],\r\n                check: function (card) {\r\n                    var player = _status.event.player;\r\n                    if (get.position(card) == 'h' && !player.countCards('h', 'du') && (player.hp > 2 || !player.countCards('h', function (card) {\r\n                        return get.value(card) >= 8;\r\n                    }))) {\r\n                        return 1;\r\n                    }\r\n                    return 6 - get.value(card)\r\n                },\r\n                content: function () {\r\n                    'step 0'\r\n                    player.discard(cards);\r\n                    let num = cards.length > 3 ? 1 : 0;\r\n                    player.draw(num + cards.length);\r\n                },\r\n                subSkill: {\r\n                    draw: {\r\n                        trigger: {\r\n                            player: \"loseEnd\"\r\n                        },\r\n                        silent: true,\r\n                        filter: function (event, player) {\r\n                            if (event.getParent(2).skill != 'PSzongheng' && event.getParent(2).skill != 'jilue_zhiheng') return false;\r\n                            if (player.countCards('h')) return false;\r\n                            for (var i = 0; i < event.cards.length; i++) {\r\n                                if (event.cards[i].original == 'h') return true;\r\n                            }\r\n                            return false;\r\n                        },\r\n                        content: function () {\r\n                            player.addTempSkill('PSzongheng_delay', trigger.getParent(2).skill + 'After');\r\n                        },\r\n                        sub: true,\r\n                        forced: true,\r\n                        popup: false,\r\n                        _priority: 1\r\n                    },\r\n                    delay: {\r\n                        sub: true,\r\n                        _priority: 0\r\n                    }\r\n                },\r\n                ai: {\r\n                    order: 1,\r\n                    result: {\r\n                        player: 1\r\n                    },\r\n                    threaten: 1.55\r\n                },\r\n                _priority: 0\r\n            },\r\n            PSxiqu: {\r\n                audio: \"sbtongye\",\r\n                enable: \"phaseUse\",\r\n                limited: true,\r\n                charlotte: true,\r\n                skillAnimation: true,\r\n                animationColor: \"gray\",\r\n                filter: function (event, player) {\r\n                    return game.hasPlayer(current => current != player && (current.countCards('e') > 0 || current.countGainableCards(player, 'h') > 0));\r\n                },\r\n                filterTarget: () => lib.filter.notMe,\r\n                content: function () {\r\n                    'step 0'\r\n                    player.awakenSkill('PSxiqu');\r\n                    let cards = target.getCards('e');\r\n                    target.discard(cards);\r\n                    'step 1'\r\n                    if (target.countGainableCards(player, 'h') > 0) player.gainPlayerCard(target, [1, 2], 'h', true);\r\n                },\r\n                ai: {\r\n                    order: 100,\r\n                    result: {\r\n                        player: 100\r\n                    }\r\n                },\r\n                mark: true,\r\n                intro: {\r\n                    content: \"limited\"\r\n                },\r\n                init: (player, skill) => player.storage[skill] = false,\r\n                _priority: 0\r\n            },\r\n            PSchengchen: {\r\n                audio: \"sbzhiheng\",\r\n                skillAnimation: true,\r\n                animationColor: \"wood\",\r\n                juexingji: true,\r\n                unique: true,\r\n                derivation: [\r\n                    \"rezhiheng\"\r\n                ],\r\n                trigger: {\r\n                    source: \"dieAfter\"\r\n                },\r\n                filter: function (event, player) {\r\n                    return game.hasPlayer(current => current != player && current.group == 'wei') && player.countCards('h') > 0;\r\n                },\r\n                forced: true,\r\n                content: function () {\r\n                    'step 0'\r\n                    player.removeSkills('PSzongheng');\r\n                    player.addSkill('rezhiheng');\r\n                    game.log(player, '失去了技能', '#g【纵横】');\r\n                    game.log(player, '获得了技能', '#g【制衡】');\r\n                    player.awakenSkill(event.name);\r\n                    player.storage[event.name] = true;\r\n                    player.chooseTarget('将所有手牌交给一名魏势力角色', true).set('filterTarget', function (card, player, target) {\r\n                        return target != player && target.group == 'wei';\r\n                    }).set('ai', target => get.attitude(_status.event.player, target));\r\n                    'step 1'\r\n                    if (result.bool) {\r\n                        let cards = player.getCards('h');\r\n                        player.give(cards, result.targets[0]);\r\n                        player.changeGroup('wei');\r\n                    }\r\n                },\r\n                ai: {\r\n                    order: 1,\r\n                    result: {\r\n                        target: function (player, target) {\r\n                            if (target.hasSkillTag('nogain')) return 0;\r\n                            if (player.countCards('h') == player.countCards('h', 'du')) return -1;\r\n                            if (target.hasJudge('lebu')) return 0;\r\n                            if (get.attitude(player, target) > 3) {\r\n                                var basis = get.threaten(target);\r\n                                if (player == get.zhu(player) && player.hp <= 2 && player.countCards('h', 'shan') && !game.hasPlayer(function (current) {\r\n                                    return get.attitude(current, player) > 3 && current.countCards('h', 'tao') > 0;\r\n                                })) return 0;\r\n                                if (target.countCards('h') + player.countCards('h') > target.hp + 2) return basis * 0.8;\r\n                                return basis;\r\n                            }\r\n                            return 0;\r\n                        }\r\n                    }\r\n                },\r\n                _priority: 0\r\n            }\r\n        },\r\n        sort: sort.PScharacter_wu,\r\n        translate: {\r\n            PSxie_sunquan: \"PS屑孙权\",\r\n            PSzongheng: \"纵横\",\r\n            PSzongheng_info: \"出牌阶段限X次，你可以弃置任意张花色相同或不同的手牌，并摸等量的牌。若弃置的牌大于三张，你多摸一张牌（X为你本回合未以此法弃置的花色数）。\",\r\n            PSxiqu: \"袭取\",\r\n            PSxiqu_info: \"限定技，出牌阶段，你可以选择一名其他角色，你令其弃置装备区所有牌，且可以获得其至多两张手牌。\",\r\n            PSchengchen: \"称臣\",\r\n            PSchengchen_info: \"觉醒技，当你杀死一名角色后，你将所有手牌交给一名其他“魏”势力角色，将势力改为“魏”，然后失去技能〖纵横〗，获得技能〖制衡〗。\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PSshu_sunshangxiang: {\r\n        info: {\r\n            sex: \"female\",\r\n            group: \"shu\",\r\n            hp: 3,\r\n            skills: [\r\n                \"PSliangzhu\",\r\n                \"PSfanxiang\"\r\n            ],\r\n            dieAudios: [\r\n                \"sp_sunshangxiang\"\r\n            ],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“九个鲨雕”设计\",\r\n        skills: {\r\n            PSliangzhu: {\r\n                audio: \"liangzhu\",\r\n                trigger: {\r\n                    global: \"recoverAfter\"\r\n                },\r\n                frequent: true,\r\n                filter: function (event, player) {\r\n                    return true;\r\n                },\r\n                content: function () {\r\n                    'step 0'\r\n                    player.draw();\r\n                    player.chooseToDiscard(`是否弃置一张牌令${get.translation(trigger.player)}摸两张牌`, 'he', false, 1).set('ai', () => {\r\n                        if (get.attitude(player, trigger.player) <= 0) return 0;\r\n                        return get.disvalue;\r\n                    }).set('player', _status.event.player);\r\n                    'step 1'\r\n                    if (result.bool) {\r\n                        trigger.player.draw(2);\r\n                        if (!player.storage.PSliangzhu) player.storage.PSliangzhu = [];\r\n                        player.storage.PSliangzhu.add(trigger.player);\r\n                    }\r\n                },\r\n                ai: {\r\n                    expose: 0.1\r\n                },\r\n                _priority: 0\r\n            },\r\n            PSfanxiang: {\r\n                skillAnimation: true,\r\n                animationColor: \"fire\",\r\n                audio: \"fanxiang\",\r\n                unique: true,\r\n                juexingji: true,\r\n                forceunique: true,\r\n                derivation: \"PSxiaoji\",\r\n                trigger: {\r\n                    player: \"phaseZhunbeiBegin\"\r\n                },\r\n                init: function (player) {\r\n                    game.changeSkillAudio('PSxiaoji', player.name, 'xiaoji_sp_sunshangxiang');\r\n                },\r\n                filter: function (event, player) {\r\n                    if (player.storage.PSfanxiang) return false;\r\n                    return game.hasPlayer(function (current) {\r\n                        return player.storage.PSliangzhu && player.storage.PSliangzhu.includes(current) && current.isDamaged();\r\n                    });\r\n                },\r\n                forced: true,\r\n                content: function () {\r\n                    'step 0'\r\n                    player.storage.PSfanxiang = true;\r\n                    player.awakenSkill('PSfanxiang');\r\n                    let list = [\r\n                        '增加一点体力上限并回复一点体力',\r\n                        '获得技能〖枭姬〗',\r\n                        '背水：失去技能〖良助〗，然后依次执行上述所有选项'\r\n                    ];\r\n                    player.chooseControl().set('prompt', '返乡：请选择一项').set('choiceList', list).set('ai', () => {\r\n                        let player = _status.event.player;\r\n                        if (!player.countCards('h', name => ['jiu', 'tao'].includes(name)) && player.hp == 1) return '选项三';\r\n                        return '选项二';\r\n                    });\r\n                    'step 1'\r\n                    switch (result.index) {\r\n                        case 0:\r\n                            player.gainMaxHp();\r\n                            player.recover();\r\n                            break;\r\n                        case 1:\r\n                            player.addSkills('PSxiaoji');\r\n                            break;\r\n                        case 2:\r\n                            player.removeSkills('PSliangzhu');\r\n                            player.gainMaxHp();\r\n                            player.recover();\r\n                            player.addSkills('PSxiaoji');\r\n                    }\r\n                },\r\n                _priority: 0\r\n            }\r\n        },\r\n        sort: sort.PScharacter_shu,\r\n        translate: {\r\n            PSshu_sunshangxiang: \"PS孙尚香\",\r\n            PSliangzhu: \"良助\",\r\n            PSliangzhu_info: \"当一名角色回复体力后，你可以摸一张牌，然后你可以弃置一张牌令其摸两张牌。\",\r\n            PSfanxiang: \"返乡\",\r\n            PSfanxiang_info: \"觉醒技，准备阶段开始时，若场上有已受伤且你发动过〖良助〗令其摸牌的角色，则你选择一项：1.增加一点体力上限并回复一点体力；2.获得技能〖枭姬〗；3.背水：失去技能〖良助〗，然后依次执行上述所有选项。\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PSmenghuo: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"shu\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PShuoshou\",\r\n                \"PSxingluan\"\r\n            ],\r\n            dieAudios: [\r\n                \"re_menghuo\"\r\n            ],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“群弱智（兼群小丑）”设计\",\r\n        skills: {\r\n            PShuoshou: {\r\n                audio: \"ext:PS武将/audio/skill:2\",\r\n                inherit: \"huoshou\",\r\n                trigger: {\r\n                    source: \"damageSource\"\r\n                },\r\n                filter: function (event, player) {\r\n                    return event.card && event.card.name === 'nanman' && event.player.isAlive() && event.player.isIn() && event.player.countCards('he');\r\n                },\r\n                content: function () {\r\n                    player.gainPlayerCard(trigger.player, 1, 'he', true);\r\n                }\r\n            },\r\n            PSxingluan: {\r\n                audio: \"sppanqin\",\r\n                trigger: {\r\n                    global: \"useCardAfter\"\r\n                },\r\n                locked: true,\r\n                getNum: function (event, player) {\r\n                    let damageNum = 0;\r\n                    player.getHistory('sourceDamage', function (evt) {\r\n                        if (evt.card === event.card) {\r\n                            damageNum += evt.num;\r\n                        }\r\n                    });\r\n                    const num = Math.max(event.targets.length - damageNum, 0);\r\n                    return num;\r\n                },\r\n                filter: function (event, player) {\r\n                    if (event.card.name !== 'nanman') return false;\r\n                    if (event.cards.filterInD('od').length === 0) return false;\r\n                    return player.countCards('he') >= lib.skill.PSxingluan.getNum(event, player);\r\n                },\r\n                prompt2: function (event, player) {\r\n                    const num = lib.skill.PSxingluan.getNum(event, player);\r\n                    let str = num > 0 ? `弃置${get.cnNumber(num)}张牌，` : '';\r\n                    str += `获得 ${get.translation(event.cards)} `;\r\n                    return str;\r\n                },\r\n                content: function () {\r\n                    const num = lib.skill.PSxingluan.getNum(trigger, player);\r\n                    if (num > 0) player.chooseToDiscard('he', num, true);\r\n                    const cards = trigger.cards.filterInD('od');\r\n                    player.gain(cards, 'gain2');\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_shu,\r\n        translate: {\r\n            PSmenghuo: \"PS孟获\",\r\n            PShuoshou: \"祸首\",\r\n            PShuoshou_info: \"锁定技。①【南蛮入侵】对你无效。②当其他角色使用【南蛮入侵】指定第一个目标后，你代替其成为此牌的伤害来源。③当你的【南蛮入侵】对一名角色造成伤害后，你可以获得对方一张牌。\",\r\n            PSxingluan: \"兴乱\",\r\n            PSxingluan_info: \"锁定技，当一张【南蛮入侵】结算完毕后，你可以弃置X张牌，获得这张【南蛮入侵】（X为此【南蛮入侵】的指定目标数-造成伤害数）。\",\r\n            \"#ext:PS武将/audio/skill/PShuoshou1\": \"南中王孟获在此！\",\r\n            \"#ext:PS武将/audio/skill/PShuoshou2\": \"哈哈！知道南中子弟的厉害了吧！\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PSzhugeliang: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"shu\",\r\n            hp: 3,\r\n            skills: [\r\n                \"PSjiqiao\",\r\n                \"PShuoji\",\r\n                \"PSpingnan\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“一顿七只屑狐狸”设计\",\r\n        skills: {\r\n            PSjiqiao: {\r\n                audio: \"ext:PS武将/audio/skill:2\",\r\n                trigger: {\r\n                    global: \"phaseBefore\",\r\n                    player: \"enterGame\"\r\n                },\r\n                forced: true,\r\n                filter: function (event, player) {\r\n                    return (event.name != 'phase' || game.phaseNumber == 0);\r\n                },\r\n                content: function () {\r\n                    const cards = ['muniu', 'bagua', 'zhuge'];\r\n                    /* for (let i of cards) {\r\n                         var card = get.cardPile2(function (card) {\r\n                         return player.canUse(card, player) && card.name === i;\r\n                         }); \r\n                         }\r\n                        player.equip(card);*/\r\n                    cards.forEach(name => {\r\n                        const card = game.createCard(name, lib.suit.randomGet(), get.rand(1, 13));\r\n                        if (player.canUse(card, player)) player.equip(card);\r\n                    });\r\n                },\r\n                group: \"PSjiqiao_use\",\r\n                subSkill: {\r\n                    use: {\r\n                        audio: \"PSjiqiao\",\r\n                        trigger: {\r\n                            global: [\r\n                                \"logSkill\",\r\n                                \"useSkillBegin\"\r\n                            ]\r\n                        },\r\n                        forced: true,\r\n                        filter: function (event, player) {\r\n                            return event.skill && get.info(event.skill).equipSkill && ['muniu_skill', 'bagua_skill', 'zhuge_skill'].includes(event.skill);\r\n                        },\r\n                        content: () => {\r\n                            player.draw();\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            PShuoji: {\r\n                audio: \"ext:PS武将/audio/skill:2\",\r\n                enable: \"phaseUse\",\r\n                usable: 3,\r\n                content: function () {\r\n                    var card = get.cardPile2(function (card) {\r\n                        return get.translation(card).includes('火') || lib.translate[card.name + '_info'].includes('火');\r\n                    });\r\n                    if (card) {\r\n                        player.gain(card, 'gain2')\r\n                    } else {\r\n                        game.log(player, '从牌堆中没有检索到带', '#y火', '字的牌');\r\n                        player.chat('没有检索到带\"火\"字的牌');\r\n                    }\r\n                },\r\n                ai: {\r\n                    order: 10\r\n                }\r\n            },\r\n            PSpingnan: {\r\n                audio: \"ext:PS武将/audio/skill:2\",\r\n                enable: \"phaseUse\",\r\n                usable: 1,\r\n                filterTarget: true,\r\n                selectTarget: [\r\n                    1,\r\n                    3\r\n                ],\r\n                multitarget: true,\r\n                content: function () {\r\n                    'step 0'\r\n                    targets.sort(lib.sort.seat);\r\n                    targets.forEach(target => target.damage());\r\n                    const filterTarget = targets.filter(current => current.isAlive() && current.isIn() && current !== player && current.countGainableCards(player, 'he') > 0);\r\n                    if (filterTarget.length) {\r\n                        player.chooseTarget('平南：是否获得其中一名角色的一张牌？').set('filterTarget', function (card, player, target) {\r\n                            return filterTarget.includes(target);\r\n                        }).set('ai', function (target) {\r\n                            var att = get.attitude(_status.event.player, target);\r\n                            if (target.hasSkill('tuntian')) return att / 10;\r\n                            return 1 - att;\r\n                        });\r\n                    }\r\n                    'step 1'\r\n                    if (result.bool && result.targets) {\r\n                        player.gainPlayerCard(result.targets[0], 1, 'he', true);\r\n                    }\r\n                },\r\n                ai: {\r\n                    damage: true,\r\n                    order: 8,\r\n                    result: {\r\n                        player: function (player, target) {\r\n                            return get.damageEffect(player, player, player);\r\n                        },\r\n                        target: function (player, target) {\r\n                            return get.damageEffect(target, player, target);\r\n                        }\r\n                    },\r\n                    threaten: 1.5\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_shu,\r\n        translate: {\r\n            PSzhugeliang: \"PS诸葛亮\",\r\n            PSjiqiao: \"机巧\",\r\n            PSjiqiao_info: \"锁定技，游戏开始时，你将【木牛流马】、【八卦阵】、【诸葛连弩】置入你的对应装备栏。当一名角色触发上述装备效果时，你摸一张牌。\",\r\n            PShuoji: \"火计\",\r\n            PShuoji_info: \"出牌阶段限三次，你可以从牌堆中检索并获得牌名或描述里带有“火”字的牌。\",\r\n            PSpingnan: \"平南\",\r\n            PSpingnan_info: \"出牌阶段限一次，你可以对至多三名角色造成1点伤害，然后获得其中一名角色区域内的一张牌。\",\r\n            \"#ext:PS武将/audio/skill/PShuoji1\": \"业火炽燃，酬其宿债。\",\r\n            \"#ext:PS武将/audio/skill/PShuoji2\": \"水中有火，乃焚敌军。\",\r\n            \"#ext:PS武将/audio/skill/PSjiqiao1\": \"天地以下，八重以列。\",\r\n            \"#ext:PS武将/audio/skill/PSjiqiao2\": \"随时而行，以正合，以奇胜。\",\r\n            \"#ext:PS武将/audio/skill/PSpingnan1\": \"尔等宵小，岂能诈我。\",\r\n            \"#ext:PS武将/audio/skill/PSpingnan2\": \"亮，早有成册在胸，主公大可放心。\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PSpanzhangmazhong: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"wu\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PSduodao\",\r\n                \"PSanjian\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“mento last”设计\",\r\n        skills: {\r\n            PSduodao: {\r\n                audio: \"reduodao\",\r\n                trigger: {\r\n                    player: \"damageEnd\",\r\n                    target: \"useCardToTargeted\"\r\n                },\r\n                filter: function (event, player, name) {\r\n                    if (name === \"useCardToTargeted\") return event.player !== player && event.card.name == 'sha';\r\n                    return event.source && event.source !== player;\r\n                },\r\n                direct: true,\r\n                check: function (event, player) {\r\n                    return 1;\r\n                },\r\n                content: function () {\r\n                    'step 0'\r\n                    player.draw();\r\n                    var target = event.triggername === 'useCardToTargeted' ? trigger.player : trigger.source;\r\n                    if (target && target.countGainableCards(player, 'he') > 0) {\r\n                        player.gainPlayerCard(target, 1, 'he', false);\r\n                    }\r\n                    'step 1'\r\n                    if (!result.bool || (result.bool && result.cards[0].original !== 'h')) {\r\n                        player.draw();\r\n                    }\r\n                },\r\n                ai: {\r\n                    maixie_defend: true\r\n                },\r\n                _priority: 0\r\n            },\r\n            PSanjian: {\r\n                mod: {\r\n                    targetEnabled: function (card, player, target, now) {\r\n                        if (player.getEquips(1).length === 0) {\r\n                            if (card.name == 'sha') return false;\r\n                        }\r\n                    }\r\n                },\r\n                audio: \"reanjian\",\r\n                trigger: {\r\n                    player: \"useCardToPlayered\"\r\n                },\r\n                forced: true,\r\n                filter: function (event, player) {\r\n                    return event.card.name == 'sha' && !event.target.getEquips(1).length;\r\n                },\r\n                logTarget: \"target\",\r\n                content: function () {\r\n                    trigger.directHit.add(trigger.target);\r\n                    var map = trigger.customArgs;\r\n                    var id = trigger.target.playerid;\r\n                    if (!map[id]) map[id] = {};\r\n                    if (!map[id].extraDamage) map[id].extraDamage = 0;\r\n                    map[id].extraDamage++;\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_wu,\r\n        translate: {\r\n            PSpanzhangmazhong: \"PS潘璋马忠\",\r\n            PSduodao: \"夺刀\",\r\n            PSduodao_info: \"当你受到其他角色的伤害后或成为其他角色杀的目标时，你可以摸一张牌并获得伤害来源／该角色的一张牌。若未从其手牌区获得牌则你额外摸一张牌。\",\r\n            PSanjian: \"暗箭\",\r\n            PSanjian_info: \"锁定技，武器栏没有牌的角色不能对你使用【杀】，不可响应你使用的【杀】，且受到你的【杀】伤害+1。\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PSlingcao: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"wu\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PSdujin\",\r\n                \"PSgudan\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“九个鲨雕”设计\",\r\n        skills: {\r\n            PSdujin: {\r\n                audio: \"dujin\",\r\n                trigger: {\r\n                    player: \"phaseDrawBegin2\"\r\n                },\r\n                forced: true,\r\n                filter: function (event, player) {\r\n                    return !event.numFixed;\r\n                },\r\n                content: function () {\r\n                    trigger.num += Math.max(1, player.countCards('e'));\r\n                },\r\n                mod: {\r\n                    maxHandcard: function (player, num) {\r\n                        return num + Math.max(1, player.countCards('e'));\r\n                    }\r\n                }\r\n            },\r\n            PSgudan: {\r\n                audio: \"ext:PS武将/audio/skill:2\",\r\n                trigger: {\r\n                    player: \"damageBegin4\",\r\n                    target: \"useCardToTargeted\"\r\n                },\r\n                forced: true,\r\n                filter: function (event, player, name) {\r\n                    if (name === \"useCardToTargeted\") return get.type2(event.card) === 'trick' && get.color(event.card) === 'black' && event.targets.length === 1 && event.targets[0] === player;\r\n                    if (!event.source || event.source === player) return false;\r\n                    let card = event.cards ? event.cards[0] : event.card;\r\n                    if (get.itemtype(card) == 'card' && card.original === 'h') return false;\r\n                    return true;\r\n                },\r\n                content: function () {\r\n                    'step 0'\r\n                    if (event.triggername === \"damageBegin4\") {\r\n                        trigger.num++;\r\n                        event.finish();\r\n                    } else {\r\n                        player.chooseToDiscard('he', 1).ai = function (card) {\r\n                            return 6 - get.value(card);\r\n                        };\r\n                    }\r\n                    'step 1'\r\n                    if (!result.bool) {\r\n                        player.loseHp();\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_wu,\r\n        translate: {\r\n            PSlingcao: \"PS凌操\",\r\n            PSdujin: \"独进\",\r\n            PSdujin_info: \"锁定技，摸牌阶段你额外摸X张牌，你的手牌上限+X（X为你装备区里的装备牌数量且至少为1）。\",\r\n            PSgudan: \"孤胆\",\r\n            PSgudan_info: \"锁定技，当你受到其他角色造成的伤害时，若此伤害不为手牌造成的伤害，此伤害+1；当你成为黑色锦囊牌的唯一目标时，你须弃置一张牌或者失去一点体力。\",\r\n            \"#ext:PS武将/audio/skill/PSgudan1\": \"愿效忠勇，敢为先锋。\",\r\n            \"#ext:PS武将/audio/skill/PSgudan2\": \"进军江夏，独破贼兵！\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PSliubei: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"shu\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PSrende\",\r\n                \"rejijiang\"\r\n            ],\r\n            isZhugong: true,\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“九个芒果”设计\",\r\n        replace: [\r\n            \"PSliubei\",\r\n            \"PSmeng_liubei\"\r\n        ],\r\n        skills: {\r\n            PSrende: {\r\n                audio: \"ext:PS武将/audio/skill:2\",\r\n                enable: \"phaseUse\",\r\n                filter: function (event, player) {\r\n                    return game.hasPlayer(function (current) {\r\n                        return current.countCards('h') && !current.hasSkill('PSrende_used');\r\n                    });\r\n                },\r\n                filterTarget: function (card, player, target) {\r\n                    if (!ui.selected.targets.length) return !target.hasSkill('PSrende_used') && target.countCards('h');\r\n                    return true;\r\n                },\r\n                targetprompt: [\r\n                    \"交出牌\",\r\n                    \"获得牌\"\r\n                ],\r\n                selectTarget: 2,\r\n                multitarget: true,\r\n                content: function () {\r\n                    'step 0'\r\n                    targets[0].addTempSkill('PSrende_used', 'phaseUseEnd');\r\n                    targets[0].chooseCard('h', true, [1, targets[0].countCards('h')], '选择交给' + get.translation(targets[1]) + '至少一张牌').set('ai', card => {\r\n                        if (_status.event.attitude) return 0;\r\n                        return 7 - get.value(card);\r\n                    }).set('attitude', get.attitude(targets[0], targets[1]) < 0);;\r\n                    'step 1'\r\n                    if (result.bool && result.cards && result.cards.length) {\r\n                        targets[0].give(result.cards, targets[1]);\r\n                        if (result.cards.length >= 2) {\r\n                            let next = game.createEvent('chooseToUse');\r\n                            next.player = targets[0];\r\n                            next.setContent(lib.skill.PSrende.chooseToUse);\r\n                        }\r\n                    }\r\n                },\r\n                chooseToUse: function () {\r\n                    'step 0'\r\n                    var list = [];\r\n                    if (lib.filter.cardUsable({ name: 'sha' }, player, event.getParent('chooseToUse')) && game.hasPlayer(function (current) {\r\n                        return player.canUse('sha', current);\r\n                    })) {\r\n                        list.push(['基本', '', 'sha']);\r\n                    }\r\n                    for (var i of lib.inpile_nature) {\r\n                        if (lib.filter.cardUsable({ name: 'sha', nature: i }, player, event.getParent('chooseToUse')) && game.hasPlayer(function (current) {\r\n                            return player.canUse({ name: 'sha', nature: i }, current);\r\n                        })) {\r\n                            list.push(['基本', '', 'sha', i]);\r\n                        }\r\n                    }\r\n                    if (lib.filter.cardUsable({ name: 'tao' }, player, event.getParent('chooseToUse')) && game.hasPlayer(function (current) {\r\n                        return player.canUse('tao', current);\r\n                    })) {\r\n                        list.push(['基本', '', 'tao']);\r\n                    }\r\n                    if (lib.filter.cardUsable({ name: 'jiu' }, player, event.getParent('chooseToUse')) && game.hasPlayer(function (current) {\r\n                        return player.canUse('jiu', current);\r\n                    })) {\r\n                        list.push(['基本', '', 'jiu']);\r\n                    }\r\n                    if (list.length) {\r\n                        player.chooseButton(['是否视为使用一张基本牌？', [list, 'vcard']]).set('ai', function (button) {\r\n                            var player = _status.event.player;\r\n                            var card = { name: button.link[2], nature: button.link[3], isCard: true };\r\n                            if (card.name == 'tao') {\r\n                                if (player.hp == 1 || (player.hp == 2 && !player.hasShan()) || player.needsToDiscard()) {\r\n                                    return 5;\r\n                                }\r\n                                return 1;\r\n                            }\r\n                            if (card.name == 'sha') {\r\n                                if (game.hasPlayer(function (current) {\r\n                                    return player.canUse(card, current) && get.effect(current, card, player, player) > 0\r\n                                })) {\r\n                                    if (card.nature == 'fire') return 2.95;\r\n                                    if (card.nature == 'thunder' || card.nature == 'ice') return 2.92;\r\n                                    return 2.9;\r\n                                }\r\n                                return 0;\r\n                            }\r\n                            if (card.name == 'jiu') {\r\n                                return 0.5;\r\n                            }\r\n                            return 0;\r\n                        });\r\n                    }\r\n                    else {\r\n                        event.finish();\r\n                    }\r\n                    'step 1'\r\n                    if (result && result.bool && result.links[0]) {\r\n                        var card = { name: result.links[0][2], nature: result.links[0][3] };\r\n                        player.chooseUseTarget(card, true);\r\n                    }\r\n                },\r\n                ai: {\r\n                    order: 8,\r\n                    result: {\r\n                        target: function (player, target) {\r\n                            if (ui.selected.targets.length == 0) {\r\n                                return -1;\r\n                            }\r\n                            else {\r\n                                return 1.2;\r\n                            }\r\n                        },\r\n                        player: 1.1\r\n                    },\r\n                    expose: 0.4,\r\n                    threaten: 3\r\n                },\r\n                subSkill: {\r\n                    used: {\r\n                        charlotte: true,\r\n                        silent: true,\r\n                        nopup: true\r\n                    }\r\n                },\r\n                _priority: 0\r\n            }\r\n        },\r\n        sort: sort.PScharacter_shu,\r\n        translate: {\r\n            PSliubei: \"PS刘备\",\r\n            PSrende: \"仁德\",\r\n            PSrende_info: \"出牌阶段，你可以令一名角色将至少一张手牌交给由你指定的其他角色，然后本阶段你不能再对该角色发动〖仁德〗；若其交出的牌不少于两张，其可以视为使用一张基本牌。\",\r\n            \"#ext:PS武将/audio/skill/PSrende1\": \"仁义感民，德彰天下。\",\r\n            \"#ext:PS武将/audio/skill/PSrende2\": \"曹魏倚天时，孙吴居地利，唯吾占人和。\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PScaoren: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"wei\",\r\n            hp: 2,\r\n            maxHp: 5,\r\n            skills: [\r\n                \"PSjushou\",\r\n                \"PSbianzhen\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“mento last”设计\",\r\n        skills: {\r\n            PSjushou: {\r\n                audio: \"xinjushou\",\r\n                trigger: {\r\n                    global: \"phaseBegin\"\r\n                },\r\n                filter: function (event, player, name) {\r\n                    if (player.isTurnedOver()) return false;\r\n                    for (var i of lib.inpile) {\r\n                        var type = get.type(i);\r\n                        if (type === 'trick' && lib.filter.cardUsable({ name: i }, player, event.getParent('chooseToUse')) && player.hasUseTarget({ name: i })) {\r\n                            return true;\r\n                        }\r\n                    }\r\n                    return true;\r\n                },\r\n                content() {\r\n                    'step 0'\r\n                    var list = [];\r\n                    for (var name of lib.inpile) {\r\n                        if (get.type(name) === 'trick' && lib.filter.cardUsable({ name: name }, player, event.getParent('chooseToUse')) && player.hasUseTarget({ name: name })) {\r\n                            list.push(['锦囊', '', name]);\r\n                        }\r\n                    }\r\n                    if (list.length) {\r\n                        player.chooseButton(['据守：视为使用一张锦囊牌', [list, 'vcard']]).set('ai', function (button) {\r\n                            var player = _status.event.player;\r\n                            var card = { name: button.link[2], nature: button.link[3], isCard: true };\r\n                            if (event.type != 'phase') return 1;\r\n                            if (['wugu', 'zhulu_card', 'yiyi', 'lulitongxin', 'lianjunshengyan', 'diaohulishan'].includes(card.name)) return 0;\r\n                            return player.getUseValue({\r\n                                name: card.name,\r\n                            });\r\n                        });\r\n                    }\r\n                    else {\r\n                        event.finish();\r\n                    }\r\n                    'step 1'\r\n                    if (result && result.bool && result.links[0]) {\r\n                        player.turnOver();\r\n                        var card = { name: result.links[0][2], nature: result.links[0][3] };\r\n                        player.chooseUseTarget(card, true);\r\n                    }\r\n                },\r\n                group: [\r\n                    \"PSjushou_turnOver\",\r\n                    \"PSjushou_chooseUse\"\r\n                ],\r\n                subSkill: {\r\n                    chooseUse: {\r\n                        audio: \"xinjushou\",\r\n                        enable: \"chooseToUse\",\r\n                        filter: function (event, player) {\r\n                            if (player.isTurnedOver()) return false;\r\n                            for (var i of lib.inpile) {\r\n                                var type = get.type(i);\r\n                                if (type === 'trick' && event.filterCard({ name: i }, player, event)) return true;\r\n                            }\r\n                            return false;\r\n                        },\r\n                        chooseButton: {\r\n                            dialog: function (event, player) {\r\n                                var list = [];\r\n                                for (var i = 0; i < lib.inpile.length; i++) {\r\n                                    var name = lib.inpile[i];\r\n                                    if (get.type(name) == 'trick' && event.filterCard({ name: name }, player, event)) list.push(['锦囊', '', name]);\r\n                                }\r\n                                return ui.create.dialog('据守', [list, 'vcard']);\r\n                            },\r\n                            filter: function (button, player) {\r\n                                return _status.event.getParent().filterCard({ name: button.link[2] }, player, _status.event.getParent());\r\n                            },\r\n                            check: function (button) {\r\n                                if (_status.event.getParent().type != 'phase') return 1;\r\n                                var player = _status.event.player;\r\n                                if (['wugu', 'zhulu_card', 'yiyi', 'lulitongxin', 'lianjunshengyan', 'diaohulishan'].includes(button.link[2])) return 0;\r\n                                return player.getUseValue({\r\n                                    name: button.link[2],\r\n                                    nature: button.link[3],\r\n                                });\r\n                            },\r\n                            backup: function (links, player) {\r\n                                return {\r\n                                    audio: 'xinjushou',\r\n                                    popname: true,\r\n                                    filterCard: false,\r\n                                    selectCard: 0,\r\n                                    check: function (card) {\r\n                                        return 8 - get.value(card);\r\n                                    },\r\n                                    viewAs: { name: links[0][2], nature: links[0][3] },\r\n                                    precontent: function () {\r\n                                        player.turnOver();\r\n                                    },\r\n                                }\r\n                            },\r\n                            prompt: function (links, player) {\r\n                                return '请选择' + (get.translation(links[0][3]) || '') + get.translation(links[0][2]) + '的目标';\r\n                            }\r\n                        },\r\n                        hiddenCard: function (player, name) {\r\n                            if (!lib.inpile.includes(name)) return false;\r\n                            if (player.isTurnedOver()) return false;\r\n                            var type = get.type(name);\r\n                            return type == 'trick';\r\n                        },\r\n                        ai: {\r\n                            fireAttack: true,\r\n                            skillTagFilter: function (player) {\r\n                                if (!player.countCards('he')) return false;\r\n                            },\r\n                            order: 1,\r\n                            result: {\r\n                                player: function (player) {\r\n                                    return 1;\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    turnOver: {\r\n                        audio: \"xinjushou\",\r\n                        trigger: {\r\n                            player: \"turnOverEnd\"\r\n                        },\r\n                        direct: true,\r\n                        filter(event, player) {\r\n                            return player.hasCard(function (card) {\r\n                                return lib.filter.cardDiscardable(card, player, 'PSjushou_turnOver');\r\n                            }, 'he');\r\n                        },\r\n                        content() {\r\n                            'step 0'\r\n                            player.chooseToDiscard('he', 1, get.prompt('PSjushou_turnOver'), '当你翻面时，你可以弃置一张牌，然后选择回血或者移动场上的牌').set('ai', function (card) {\r\n                                if (_status.event.goon) return 6 - get.value(card);\r\n                                return 0;\r\n                            })\r\n                            'step 1'\r\n                            if (result.bool) {\r\n                                let list = player.isDamaged() ? ['回复一点体力'] : [];\r\n                                if (player.canMoveCard()) list.push('移动场上一张牌');\r\n                                if (!list.length) { event.finish(); return; }\r\n                                else if (list.length === 2) {\r\n                                    player.chooseControl(list, true).set('ai', function () {\r\n                                        if (!player.countCards('h', name => ['jiu', 'tao'].includes(name)) && player.hp <= 2) return '回复一点体力';\r\n                                        if (player.canMoveCard(true)) return '移动场上一张牌';\r\n                                        return '回复一点体力';\r\n                                    });\r\n                                }\r\n                                else {\r\n                                    event._result = {\r\n                                        bool: true,\r\n                                        control: list[0],\r\n                                        index: 0,\r\n                                    }\r\n                                }\r\n                            }\r\n                            'step 2'\r\n                            if (result.control && result.control !== 'cancel2') {\r\n                                if (result.control === '回复一点体力') player.recover();\r\n                                else player.moveCard(true);\r\n                            }\r\n                        }\r\n                    }\r\n                },\r\n                ai: {\r\n                    maixie: true,\r\n                    maixie_hp: true,\r\n                    result: {\r\n                        effect: function (card, player, target) {\r\n                            if (get.tag(card, 'damage')) {\r\n                                if (player.hasSkillTag('jueqing', false, target)) return [1, -2];\r\n                                if (!target.hasFriend()) return;\r\n                                var num = 1;\r\n                                if (get.attitude(player, target) > 0) {\r\n                                    if (player.needsToDiscard()) {\r\n                                        num = 0.7;\r\n                                    }\r\n                                    else {\r\n                                        num = 0.5;\r\n                                    }\r\n                                }\r\n                                if (target.maxHp - target.countCards('h') >= 3) return [1, num * 2];\r\n                                if (target.maxHp - target.countCards('h') === 2) return [1, num * 1.5];\r\n                                if (target.maxHp - target.countCards('h') < 2) return [1, num * 0.5];\r\n                            }\r\n                        }\r\n                    },\r\n                    threaten: 0.6\r\n                }\r\n            },\r\n            PSbianzhen: {\r\n                audio: \"kuiwei\",\r\n                trigger: {\r\n                    player: \"damageEnd\"\r\n                },\r\n                forced: true,\r\n                content: function () {\r\n                    let num = player.countCards('h'), num2 = player.maxHp;\r\n                    if (num <= num2) player.draw(num2);\r\n                    if (num >= num2) player.draw();\r\n                    if (player.isTurnedOver()) player.turnOver();\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_wei,\r\n        translate: {\r\n            PScaoren: \"PS曹仁\",\r\n            PSjushou: \"据守\",\r\n            PSjushou_info: \"一名角色回合开始时或当你需要使用非延时锦囊牌时，若你的武将牌正面朝上，你可以翻面并视为你使用一张你需要的非延时锦囊牌。当你翻面后，你可以弃置一张牌然后选择：1．回复一点体力：2．移动场上一张牌。\",\r\n            PSbianzhen: \"变阵\",\r\n            PSbianzhen_info: \"锁定技，当你受到伤害后，若你的手牌数：不大于X，你摸X张牌；不小于X，你摸1张牌（X为你的体力上限）。然后若你的武将牌背面朝上，你翻面。\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PSzhangfei: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"shu\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PSrepaoxiao\",\r\n                \"PSliyong\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“九个芒果”设计\",\r\n        skills: {\r\n            PSrepaoxiao: {\r\n                audio: \"paoxiao_re_zhangfei\",\r\n                firstDo: true,\r\n                trigger: {\r\n                    player: [\r\n                        \"useCard1\",\r\n                        \"useCard\",\r\n                        \"respond\"\r\n                    ]\r\n                },\r\n                forced: true,\r\n                shaRelated: true,\r\n                filter(event, player, name) {\r\n                    if (name === \"useCard1\") return !event.audioed && event.card.name == 'sha' && player.countUsed('sha', true) > 1 && event.getParent().type == 'phase';\r\n                    if (!event.cards.length || event.card.name !== 'sha' || event.cards.length && !['o', 'd'].includes(get.position(event.cards[0]))) return false;\r\n                    if (name === \"respond\") return player.getHistory('respond', evt => evt.card.name === 'sha').length === 1;\r\n                    return player.getHistory('useCard', evt => evt.card.name === 'sha').length === 1;\r\n                },\r\n                async content(event, trigger, player) {\r\n                    trigger.audioed = true;\r\n                    if (event.triggername === \"useCard\" && player.getHistory('useCard', evt => evt.card.name === 'sha').length === 1) {\r\n                        player.gain(trigger.cards, 'gain2');\r\n                    } else if (player.getHistory('respond', evt => evt.card.name === 'sha').length === 1) {\r\n                        player.gain(trigger.cards, 'gain2');\r\n                    }\r\n                },\r\n                mod: {\r\n                    cardUsable: function (card, player, num) {\r\n                        if (card.name == 'sha') return Infinity;\r\n                    },\r\n                    targetInRange: function (card, player, target) {\r\n                        if (card.name == 'sha' && player.getEquips(1).length > 0) return true;\r\n                    }\r\n                },\r\n                ai: {\r\n                    unequip: true,\r\n                    skillTagFilter: function (player, tag, arg) {\r\n                        if (!get.zhu(player, 'shouyue')) return false;\r\n                        if (arg && arg.name == 'sha') return true;\r\n                        return false;\r\n                    }\r\n                },\r\n                _priority: 0\r\n            },\r\n            PSliyong: {\r\n                audio: \"liyong\",\r\n                trigger: {\r\n                    player: [\r\n                        \"shaMiss\",\r\n                        \"useCardToPlayered\"\r\n                    ],\r\n                    source: \"damageSource\"\r\n                },\r\n                forced: true,\r\n                direct: true,\r\n                shaRelated: true,\r\n                filter: function (event, player, name) {\r\n                    switch (name) {\r\n                        case shaMiss:\r\n                            return true;\r\n                        case useCardToPlayered:\r\n                            return event.card && get.name(event.card) === \"sha\";\r\n                        case damageSource:\r\n                            return event.card && event.card.name == 'sha' && event.player != player && event.player.isIn() && event.player.isAlive();\r\n                    }\r\n                },\r\n                init: function (player, skill) {\r\n                    if (!player.storage[skill]) player.storage[skill] = [];\r\n                },\r\n                intro: {\r\n                    content: function (storage, player) {\r\n                        return storage.join('');\r\n                    },\r\n                    markcount: function (storage, player) {\r\n                        return storage.length;\r\n                    }\r\n                },\r\n                content: function () {\r\n                    switch (event.triggername) {\r\n                        case shaMiss:\r\n                            player.getHistory('custom').push({ PSliyong_effect: true });\r\n                            break;\r\n                        case useCardToPlayered:\r\n                            player.logSkill(event.name);\r\n                            player.markSkill(event.name);\r\n                            if (player.getHistory('useCard', evt => evt.card.name === \"sha\").length > 1) {\r\n                                player.storage[event.name].add('加伤！');\r\n                                var id = trigger.target.playerid;\r\n                                var map = trigger.getParent().customArgs;\r\n                                if (!map[id]) map[id] = {};\r\n                                if (typeof map[id].extraDamage != 'number') {\r\n                                    map[id].extraDamage = 0;\r\n                                }\r\n                                map[id].extraDamage++;\r\n                            }\r\n                            if (player.hasHistory('custom', evt => evt.PSliyong_effect) && trigger.isFirstTarget) {\r\n                                player.storage[event.name].add('强命！');\r\n                                trigger.getParent().directHit.addArray(game.players);\r\n                            }\r\n                            break;\r\n                        case damageSource:\r\n                            player.storage[event.name].add('铁骑！');\r\n                            trigger.player.addTempSkill('fengyin');\r\n                    }\r\n                },\r\n                group: \"PSliyong_draw\",\r\n                subSkill: {\r\n                    draw: {\r\n                        audio: \"liyong\",\r\n                        trigger: {\r\n                            global: \"phaseEnd\"\r\n                        },\r\n                        filter: function (event, player, name) {\r\n                            return player.storage.PSliyong && player.storage.PSliyong.length > 0;\r\n                        },\r\n                        forced: true,\r\n                        content: function () {\r\n                            const num = player.storage.PSliyong.length;\r\n                            player.storage.PSliyong = [];\r\n                            player.unmarkSkill('PSliyong');\r\n                            player.draw(num);\r\n                        }\r\n                    }\r\n                },\r\n                ai: {\r\n                    ignoreSkill: true,\r\n                    directHit_ai: true,\r\n                    skillTagFilter: function (player, tag, arg) {\r\n                        if (tag == 'directHit_ai') {\r\n                            return get.attitude(player, arg.target) <= 0;\r\n                        }\r\n                        if (!arg || arg.isLink || !arg.card || arg.card.name != 'sha') return false;\r\n                        if (!arg.target || get.attitude(player, arg.target) >= 0) return false;\r\n                        if (!arg.skill || !lib.skill[arg.skill] || lib.skill[arg.skill].charlotte || get.is.locked(arg.skill) || !arg.target.getSkills(true, false).includes(arg.skill)) return false;\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_shu,\r\n        translate: {\r\n            PSzhangfei: \"PS张飞\",\r\n            PSrepaoxiao: \"咆哮\",\r\n            PSrepaoxiao_info: \"锁定技。①你使用【杀】无次数限制。②若你的装备区内有武器牌，则你使用【杀】无距离限制。③当你于一回合内首次使用或打出【杀】时，你收回此【杀】对应的实体牌。\",\r\n            PSliyong: \"厉勇\",\r\n            PSliyong_info: \"锁定技。<br>①当你使用【杀】指定目标后，若你本回合使用过的【杀】：被响应过，此【杀】不可被响应；数量不为1，此【杀】对其造成伤害+1。<br>②当你使用【杀】对一名其他角色造成伤害后，其本回合非锁定技失效。<br>③一名角色回合结束时，若你本回合使用过的【杀】因〖厉勇〗触发了{强命/加伤/铁骑}效果，你摸X张牌（X为触发的项数）。\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PSreluxun: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"wu\",\r\n            hp: 3,\r\n            skills: [\r\n                \"PSreqianxun\",\r\n                \"PSrelianying\"\r\n            ],\r\n            clans: [\r\n                \"吴郡陆氏\"\r\n            ],\r\n            dieAudios: [\r\n                \"re_luxun\"\r\n            ],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“九个芒果”设计\",\r\n        skills: {\r\n            PSreqianxun: {\r\n                audio: \"reqianxun\",\r\n                trigger: {\r\n                    target: \"useCardToBegin\",\r\n                    player: \"judgeBefore\"\r\n                },\r\n                filter: function (event, player) {\r\n                    if (player.countCards('h') == 0) return false;\r\n                    if (event.getParent().name == 'phaseJudge') {\r\n                        return true;\r\n                    }\r\n                    if (event.name == 'judge') return false;\r\n                    if (event.targets && event.targets.length > 1) return false;\r\n                    if (event.card && get.type(event.card) == 'trick' && event.player != player) return true;\r\n                },\r\n                content: function () {\r\n                    var cards = player.getCards('h');\r\n                    player.loseToSpecial(cards, 'PSreqianxun').visible = false;\r\n                    player.markSkill('PSreqianxun');\r\n                    // player.addToExpansion(cards, 'giveAuto', player).gaintag.add('PSreqianxun_storage');\r\n                    player.addSkill('PSreqianxun_gain');\r\n                },\r\n                marktext: \"谦\",\r\n                intro: {\r\n                    mark: function (dialog, storage, player) {\r\n                        var content = player.getCards('s', function (card) {\r\n                            return card.hasGaintag('PSreqianxun');\r\n                        })\r\n                        if (content && content.length) {\r\n                            if (player == game.me || player.isUnderControl()) {\r\n                                dialog.addAuto(content);\r\n                            }\r\n                            else {\r\n                                return '共有' + get.cnNumber(content.length) + '张牌';\r\n                            }\r\n                        }\r\n                    },\r\n                    markcount: function (storage, player) {\r\n                        return player.getCards('s', function (card) {\r\n                            return card.hasGaintag('PSreqianxun');\r\n                        }).length;\r\n                    },\r\n                    onunmark: function (storage, player) {\r\n                        var cards = player.getCards('s', function (card) {\r\n                            return card.hasGaintag('PSreqianxun');\r\n                        });\r\n                        if (cards.length) {\r\n                            player.lose(cards, ui.discardPile);\r\n                            player.$throw(cards, 1000);\r\n                            game.log(cards, '进入了弃牌堆');\r\n                        }\r\n                    }\r\n                },\r\n                ai: {\r\n                    effect: function (card, player, target) {\r\n                        if (!target.hasFriend()) return;\r\n                        if (player == target) return;\r\n                        var type = get.type(card);\r\n                        var nh = target.countCards();\r\n                        if (type == 'trick') {\r\n                            if (!get.tag(card, 'multitarget') || get.info(card).singleCard) {\r\n                                if (get.tag(card, 'damage')) {\r\n                                    if (nh < 3 || target.hp <= 2) return 0.8;\r\n                                }\r\n                                return [1, nh];\r\n                            }\r\n                        }\r\n                        else if (type == 'delay') {\r\n                            return [0.5, 0.5];\r\n                        }\r\n                    }\r\n                },\r\n                _priority: 0,\r\n                subSkill: {\r\n                    gain: {\r\n                        trigger: {\r\n                            global: \"phaseEnd\"\r\n                        },\r\n                        forced: true,\r\n                        audio: false,\r\n                        content: function () {\r\n                            'step 0'\r\n                            var cards = player.getCards('s', function (card) {\r\n                                return card.hasGaintag('PSreqianxun');\r\n                            });\r\n                            if (cards.length) player.gain(cards, 'draw');\r\n                            'step 1'\r\n                            game.delay();\r\n                            player.unmarkSkill('PSreqianxun');\r\n                            player.removeSkill('PSreqianxun_gain');\r\n                        },\r\n                        _priority: 0\r\n                    }\r\n                }\r\n            },\r\n            PSrelianying: {\r\n                audio: \"relianying\",\r\n                trigger: {\r\n                    player: \"loseAfter\",\r\n                    global: [\r\n                        \"equipAfter\",\r\n                        \"addJudgeAfter\",\r\n                        \"gainAfter\",\r\n                        \"loseAsyncAfter\",\r\n                        \"addToExpansionAfter\"\r\n                    ]\r\n                },\r\n                direct: true,\r\n                filter: function (event, player) {\r\n                    if (player.countCards('h')) return false;\r\n                    var evt = event.getl(player);\r\n                    return evt && evt.hs && evt.hs.length;\r\n                },\r\n                content: function () {\r\n                    \"step 0\"\r\n                    var num = trigger.getl(player).hs.length;\r\n                    player.chooseTarget(get.prompt('relianying'), '令至多' + get.cnNumber(num) + '名角色各摸一张牌', [1, num]).ai = function (target) {\r\n                        var player = _status.event.player;\r\n                        if (player == target) return get.attitude(player, target) + 10;\r\n                        return get.attitude(player, target);\r\n                    }\r\n                    \"step 1\"\r\n                    if (result.bool) {\r\n                        player.logSkill('PSrelianying', result.targets);\r\n                        game.asyncDraw(result.targets);\r\n                    }\r\n                    else event.finish();\r\n                    \"step 2\"\r\n                    game.delay();\r\n                },\r\n                ai: {\r\n                    threaten: 0.8,\r\n                    effect: {\r\n                        target: function (card) {\r\n                            if (card.name == 'guohe' || card.name == 'liuxinghuoyu') return 0.5;\r\n                        }\r\n                    },\r\n                    noh: true\r\n                },\r\n                _priority: 0,\r\n                group: \"PSrelianying_else\",\r\n                subSkill: {\r\n                    else: {\r\n                        trigger: {\r\n                            player: [\r\n                                \"useCardEnd\",\r\n                                \"respondEnd\"\r\n                            ]\r\n                        },\r\n                        direct: true,\r\n                        content: function () {\r\n                            'step 0'\r\n                            player.chooseBool(`是否弃置${_status.currentPhase === player ? '' : get.translation(_status.currentPhase) + '的'}一张手牌，然后摸一张牌`).set('ai', function () { return 1 });\r\n                            'step 1'\r\n                            if (result.bool) {\r\n                                if (_status.currentPhase === player) {\r\n                                    player.chooseToDiscard('h', true);\r\n                                } else {\r\n                                    player.discardPlayerCard(_status.currentPhase, 'h', true);\r\n                                }\r\n                                player.draw();\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_wu,\r\n        translate: {\r\n            PSreluxun: \"PS界陆逊\",\r\n            PSreluxun_prefix: \"PS界\",\r\n            PSreqianxun: \"谦逊\",\r\n            PSreqianxun_info: \"每当一张延时类锦囊牌或其他角色使用的普通锦囊牌生效时，若你是此牌的唯一目标，你可以将所有手牌置于你的武将牌上，你可以如手牌般使用或打出以此法置于武将牌上的牌。若如此做，此回合结束时，你获得你武将牌上的所有牌。\",\r\n            PSrelianying: \"连营\",\r\n            PSrelianying_info: \"①当你失去最后的手牌时，你可以令至多X名角色各摸一张牌（X为你此次失去的手牌数）。<br>②当你使用或打出牌后，你可以弃置当前回合角色一张手牌，然后摸一张牌。\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PSxurong: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"qun\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PSxionghuo\",\r\n                \"PSshajue\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“九个芒果”设计\",\r\n        skills: {\r\n            PSxionghuo: {\r\n                audio: \"xinfu_xionghuo\",\r\n                enable: \"phaseUse\",\r\n                filter: function (event, player) {\r\n                    return player.countMark('PSxionghuo') > 0;\r\n                },\r\n                filterTarget: function (card, player, target) {\r\n                    return player != target;\r\n                },\r\n                content: function () {\r\n                    player.removeMark('PSxionghuo', 1);\r\n                    target.addMark('PSxionghuo', 1);\r\n                },\r\n                ai: {\r\n                    order: 11,\r\n                    result: {\r\n                        target: function (player, target) {\r\n                            if ((player.countMark('PSxionghuo') >= 2 || !game.hasPlayer(function (current) {\r\n                                return current != player && get.attitude(player, current) < 0 && current.hasMark('PSxionghuo');\r\n                            })) && player.countCards('h', function (card) {\r\n                                return get.tag(card, 'damage') && player.canUse(card, target, null, true)\r\n                                    && player.getUseValue(card) > 0 && get.effect_use(target, card, player) > 0\r\n                                    && target.hasSkillTag('filterDamage', null, {\r\n                                        player: player,\r\n                                        card: card,\r\n                                    });\r\n                            })) return 3 / Math.max(1, target.hp);\r\n                            if ((!player.hasUnknown() && game.countPlayer(function (current) {\r\n                                return get.attitude(player, current) < 0;\r\n                            }) <= 1) || player.countMark('PSxionghuo') >= 2) {\r\n                                return -1;\r\n                            }\r\n                            return 0;\r\n                        }\r\n                    },\r\n                    effect: {\r\n                        player: function (card, player, target) {\r\n                            if (player != target && get.tag(card, 'damage') && target && target.hasMark('PSxionghuo') && !target.hasSkillTag('filterDamage', null, {\r\n                                player: player,\r\n                                card: card,\r\n                            })) return [1, 0, 1, -2];\r\n                        }\r\n                    },\r\n                    threaten: 1.6\r\n                },\r\n                marktext: \"戾\",\r\n                intro: {\r\n                    name: \"暴戾\",\r\n                    content: \"mark\"\r\n                },\r\n                group: [\r\n                    \"PSxionghuo_init\",\r\n                    \"PSxionghuo_damage\",\r\n                    \"PSxionghuo_effect\"\r\n                ],\r\n                subSkill: {\r\n                    init: {\r\n                        audio: \"xinfu_xionghuo\",\r\n                        trigger: {\r\n                            global: \"phaseBefore\",\r\n                            player: \"enterGame\"\r\n                        },\r\n                        filter: function (event, player) {\r\n                            return event.name != 'phase' || game.phaseNumber == 0;\r\n                        },\r\n                        forced: true,\r\n                        locked: false,\r\n                        content: function () {\r\n                            player.addMark('PSxionghuo', 3);\r\n                        },\r\n                        sub: true,\r\n                        _priority: 0\r\n                    },\r\n                    damage: {\r\n                        audio: \"xinfu_xionghuo\",\r\n                        trigger: {\r\n                            source: \"damageBegin1\"\r\n                        },\r\n                        filter: function (event, player) {\r\n                            return event.player.countMark('PSxionghuo') > 0 && event.player != player;\r\n                        },\r\n                        forced: true,\r\n                        locked: false,\r\n                        logTarget: \"player\",\r\n                        content: function () {\r\n                            trigger.num += trigger.player.countMark('PSxionghuo');\r\n                        },\r\n                        sub: true,\r\n                        _priority: 0\r\n                    },\r\n                    effect: {\r\n                        audio: \"xinfu_xionghuo\",\r\n                        trigger: {\r\n                            global: \"phaseUseBegin\"\r\n                        },\r\n                        filter: function (event, player) {\r\n                            return event.player.countMark('PSxionghuo') > 0 && event.player != player;\r\n                        },\r\n                        line: false,\r\n                        forced: true,\r\n                        locked: false,\r\n                        logTarget: \"player\",\r\n                        content: function () {\r\n                            const num = trigger.player.countMark('PSxionghuo');\r\n                            trigger.player.removeMark('PSxionghuo', num);\r\n                            const arr = [0, 1, 2].randomGets(Math.min(num, 3));\r\n                            for (let i = 0; i < arr.length; i++) {\r\n                                switch (arr[i]) {\r\n                                    case 0:\r\n                                        player.line(trigger.player, 'fire');\r\n                                        trigger.player.damage('fire');\r\n                                        trigger.player.addTempSkill('PSxionghuo_disable');\r\n                                        trigger.player.markAuto('PSxionghuo_disable', [player]);\r\n                                        break;\r\n                                    case 1:\r\n                                        player.line(trigger.player, 'water');\r\n                                        trigger.player.loseHp();\r\n                                        trigger.player.addMark('PSxionghuo_low', 1, false);\r\n                                        trigger.player.addTempSkill('PSxionghuo_low');\r\n                                        break;\r\n                                    case 2:\r\n                                        player.line(trigger.player, 'green');\r\n                                        var card1 = trigger.player.getCards('h').randomGet();\r\n                                        var card2 = trigger.player.getCards('e').randomGet();\r\n                                        var list = [];\r\n                                        if (card1) list.push(card1);\r\n                                        if (card2) list.push(card2);\r\n                                        if (list.length) player.gain(list, trigger.player, 'giveAuto', 'bySelf');\r\n                                        break;\r\n                                }\r\n                            }\r\n                            game.delay();\r\n                        },\r\n                        sub: true,\r\n                        _priority: 0\r\n                    },\r\n                    disable: {\r\n                        mod: {\r\n                            playerEnabled: function (card, player, target) {\r\n                                if (card.name == 'sha' && player.getStorage('PSxionghuo_disable').includes(target)) return false;\r\n                            }\r\n                        },\r\n                        charlotte: true,\r\n                        onremove: true,\r\n                        mark: true,\r\n                        marktext: \"禁\",\r\n                        intro: {\r\n                            content: \"不能对$使用【杀】\"\r\n                        },\r\n                        sub: true,\r\n                        _priority: 0\r\n                    },\r\n                    low: {\r\n                        mod: {\r\n                            maxHandcard: function (player, num) {\r\n                                return num - player.countMark('PSxionghuo_low');\r\n                            }\r\n                        },\r\n                        charlotte: true,\r\n                        onremove: true,\r\n                        mark: true,\r\n                        marktext: \"减\",\r\n                        intro: {\r\n                            content: \"手牌上限-#\"\r\n                        },\r\n                        sub: true,\r\n                        _priority: 0\r\n                    }\r\n                },\r\n                _priority: 0\r\n            },\r\n            PSshajue: {\r\n                audio: \"xinfu_shajue\",\r\n                trigger: {\r\n                    global: \"dying\"\r\n                },\r\n                filter: function (event, player) {\r\n                    return event.player != player;\r\n                },\r\n                forced: true,\r\n                content: function () {\r\n                    player.addMark('PSxionghuo', 1);\r\n                    //player.markSkill('PSxionghuo');\r\n                    if (trigger.player.hp < 0 && get.itemtype(trigger.parent.cards) == 'cards' && get.position(trigger.parent.cards[0], true) == 'o') {\r\n                        player.gain(trigger.parent.cards, 'gain2');\r\n                    }\r\n                },\r\n                _priority: 0\r\n            }\r\n        },\r\n        sort: sort.PScharacter_qun,\r\n        translate: {\r\n            PSxurong: \"PS徐荣\",\r\n            PSxionghuo: \"凶镬\",\r\n            PSxionghuo_info: \"游戏开始时，你获得3个“暴戾”标记。出牌阶段，你可以交给一名其他角色一个“暴戾”标记。当你对有“暴戾”标记的其他角色造成伤害时，此伤害+X。有“暴戾”标记的其他角色的出牌阶段开始时，其移去所有“暴戾”标记并随机执行X项：1.受到1点火焰伤害且本回合不能对你使用【杀】；2.失去1点体力且本回合手牌上限-1；3.你随机获得其一张手牌和一张装备区的牌。（X为目标角色的“暴戾”标记数）\",\r\n            PSshajue: \"杀绝\",\r\n            PSshajue_info: \"锁定技，其他角色进入濒死状态时，你获得一个“暴戾”标记。然后若其体力值小于0，你获得使其进入濒死状态的牌。\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PSlifeng: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"shu\",\r\n            hp: 3,\r\n            skills: [\r\n                \"PStunchu\",\r\n                \"PSshuliang\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“九个芒果”设计\",\r\n        skills: {\r\n            PStunchu: {\r\n                audio: \"tunchu\",\r\n                trigger: {\r\n                    global: \"phaseBefore\",\r\n                    player: \"enterGame\"\r\n                },\r\n                forced: true,\r\n                filter: function (event, player) {\r\n                    return (event.name != 'phase' || game.phaseNumber == 0);\r\n                },\r\n                onremove: function (player, skill) {\r\n                    var cards = player.getExpansions(skill);\r\n                    if (cards.length) player.loseToDiscardpile(cards);\r\n                },\r\n                intro: {\r\n                    markcount: \"expansion\",\r\n                    content: \"expansion\"\r\n                },\r\n                content: function () {\r\n                    'step 0'\r\n                    player.draw(2);\r\n                    var hs = player.getCards('h');\r\n                    if (hs.length) {\r\n                        if (hs.length <= 2) event._result = { bool: true, cards: hs };\r\n                        else player.chooseCard('h', 2, true, '选择两张手牌作为“粮”').set('ai', function (card) {\r\n                            return 5 - get.value(card);\r\n                        });\r\n                    }\r\n                    'step 1'\r\n                    if (result.bool && result.cards && result.cards.length) {\r\n                        player.addToExpansion(result.cards, player, 'giveAuto').gaintag.add('PStunchu');\r\n                    }\r\n                },\r\n                ai: {\r\n                    threaten: 3\r\n                },\r\n                group: [\r\n                    \"PStunchu_draw\",\r\n                    \"PStunchu_choose\"\r\n                ],\r\n                subSkill: {\r\n                    draw: {\r\n                        audio: \"tunchu\",\r\n                        trigger: {\r\n                            player: \"phaseDrawBegin2\"\r\n                        },\r\n                        forced: true,\r\n                        preHidden: true,\r\n                        filter: function (event, player) {\r\n                            return !event.numFixed && player.getExpansions('PStunchu').length;\r\n                        },\r\n                        content: function () {\r\n                            trigger.num += player.getExpansions('PStunchu').length;\r\n                        },\r\n                        mod: {\r\n                            maxHandcard: function (player, num) {\r\n                                return num + player.getExpansions('PStunchu').length;\r\n                            }\r\n                        },\r\n                        sub: true\r\n                    },\r\n                    choose: {\r\n                        audio: \"tunchu\",\r\n                        trigger: {\r\n                            player: \"phaseDrawEnd\"\r\n                        },\r\n                        forced: true,\r\n                        popup: false,\r\n                        filter: function (event, player) {\r\n                            return player.getExpansions('PStunchu').length <= Math.min(player.maxHp, 3) && player.countCards('h');\r\n                        },\r\n                        content: function () {\r\n                            'step 0'\r\n                            const num = Math.min(player.maxHp, 3);\r\n                            player.chooseCard('h', [1, num], false, `屯储：是否选择至多${get.cnNumber(num)}张手牌作为“粮”`).set('ai', function (card) {\r\n                                return 5 - get.value(card);\r\n                            });\r\n                            'step 1'\r\n                            if (result.bool && result.cards && result.cards.length) {\r\n                                player.addToExpansion(result.cards, player, 'giveAuto').gaintag.add('PStunchu');\r\n                            }\r\n                        },\r\n                        sub: true\r\n                    }\r\n                }\r\n            },\r\n            PSshuliang: {\r\n                audio: \"shuliang\",\r\n                trigger: {\r\n                    global: \"phaseJieshuBegin\"\r\n                },\r\n                direct: true,\r\n                filter: function (event, player) {\r\n                    return player.getExpansions('PStunchu').length > 0 && event.player.countCards('h') < event.player.getHandcardLimit() && event.player.isIn();\r\n                },\r\n                content: function () {\r\n                    'step 0'\r\n                    var goon = (get.attitude(player, trigger.player) > 0);\r\n                    player.chooseCardButton(get.prompt('PSshuliang', trigger.player), player.getExpansions('PStunchu')).set('ai', function () {\r\n                        if (_status.event.goon) return 1;\r\n                        return 0;\r\n                    }).set('goon', goon);\r\n                    'step 1'\r\n                    if (result.bool) {\r\n                        player.logSkill('PSshuliang', trigger.player);\r\n                        player.loseToDiscardpile(result.links);\r\n                        trigger.player.draw(2);\r\n                    }\r\n                },\r\n                ai: {\r\n                    combo: \"PStunchu\"\r\n                },\r\n                _priority: 0\r\n            }\r\n        },\r\n        sort: sort.PScharacter_shu,\r\n        translate: {\r\n            PSlifeng: \"PS李丰\",\r\n            PStunchu: \"屯储\",\r\n            PStunchu_info: \"①锁定技，游戏开始时，你摸两张牌，然后将两张手牌置于武将牌上，称为「粮」；<br/>②摸牌阶段，你额外摸X张牌，你的手牌上限+X（X为你的「粮」数）；<br/>③摸牌阶段结束时，若你的“粮”数不大于Y，你可以将至多Y张手牌置于武将牌上（Y为你的体力上限，且至多为3）。\",\r\n            PSshuliang: \"输粮\",\r\n            PSshuliang_info: \"一名角色的结束阶段开始时，若其手牌数少于手牌上限，你可以移去一张「粮」，然后该角色摸两张牌。\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PSchenshi: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"shu\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PSqingbei\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“神鬼高达”设计\",\r\n        skills: {\r\n            PSqingbei: {\r\n                audio: \"qingbei\",\r\n                trigger: {\r\n                    global: \"roundStart\"\r\n                },\r\n                direct: true,\r\n                content: function () {\r\n                    'step 0'\r\n                    var next = player.chooseButton(['###擎北：是否选择任意种花色？###<div class=\"text center\">本轮你使用牌后，若此牌的花色与你以此法选择花色均不相同，你摸X张牌，否则你须弃置X张牌（X为你本轮以此法选择的花色数）</div>', [lib.suit.map(i => ['', '', 'lukai_' + i]), 'vcard']], [1, 4]);\r\n                    next.set('ai', button => {\r\n                        var player = _status.event.player;\r\n                        var suit = button.link[2].slice(6);\r\n                        var val = player.getCards('hs', { suit: suit }).map(card => {\r\n                            return get.value(card) + player.getUseValue(card) / 3;\r\n                        }).reduce((p, c) => {\r\n                            return p + c;\r\n                        }, 0);\r\n                        if (val > 10 && ui.selected.buttons.length > 0) return -1;\r\n                        if (val > 6 && ui.selected.buttons.length == 2) return -1;\r\n                        if (ui.selected.buttons.length == 3) return -1;\r\n                        return 1 + 1 / val;\r\n                    });\r\n                    'step 1'\r\n                    if (result.bool) {\r\n                        var suits = result.links.map(i => i[2].slice(6));\r\n                        player.logSkill('PSqingbei');\r\n                        player.addTempSkill('PSqingbei_effect', 'roundStart');\r\n                        player.setStorage('PSqingbei_effect', suits);\r\n                        player.markSkill('PSqingbei_effect');\r\n                    }\r\n                },\r\n                ai: {\r\n                    threaten: 2.3\r\n                },\r\n                subSkill: {\r\n                    effect: {\r\n                        audio: \"qingbei\",\r\n                        trigger: {\r\n                            player: \"useCardAfter\"\r\n                        },\r\n                        charlotte: true,\r\n                        onremove: true,\r\n                        forced: true,\r\n                        filter: function (event, player) {\r\n                            // if (!lib.suit.includes(get.suit(event.card))) return false;\r\n                            return player.getStorage('PSqingbei_effect').length;\r\n                        },\r\n                        content: function () {\r\n                            const suit = get.suit(trigger.card);\r\n                            if (player.getStorage('PSqingbei_effect').includes(suit)) player.chooseToDiscard('hes', true, player.getStorage('PSqingbei_effect').length);\r\n                            else player.draw(player.getStorage('PSqingbei_effect').length);\r\n                        },\r\n                        mark: true,\r\n                        intro: {\r\n                            content: (storage) => `本轮内使用非${get.translation(storage)}花色的牌后，摸${get.cnNumber(storage.length)}张牌；<br>使用${get.translation(storage)}花色的牌后，弃置${get.cnNumber(storage.length)}张牌。`\r\n                        },\r\n                        ai: {\r\n                            effect: {\r\n                                player: function (card, player, target) {\r\n                                    const num = player.getStorage('PSqingbei_effect').length;\r\n                                    if (player.getStorage('PSqingbei_effect').includes(get.suit(card))) return [1, -num];\r\n                                    else return [1, num];\r\n                                }\r\n                            }\r\n                        },\r\n                        sub: true,\r\n                        _priority: 0\r\n                    }\r\n                },\r\n                _priority: 0\r\n            }\r\n        },\r\n        sort: sort.PScharacter_shu,\r\n        translate: {\r\n            PSchenshi: \"PS陈式\",\r\n            PSqingbei: \"擎北\",\r\n            PSqingbei_info: \"一轮游戏开始时，你可以选择任意种花色。然后你本轮使用牌后，若此牌的花色与你以此法选择花色均不相同，你摸X张牌，否则你须弃置X张牌（X为你本轮以此法选择过的花色数）。\"\r\n        },\r\n        rank: rank.epic\r\n    },\r\n    PSben_sunben: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"wu\",\r\n            hp: 3,\r\n            skills: [\r\n                \"jiang\",\r\n                \"PShunzi\",\r\n                \"zhiba\"\r\n            ],\r\n            dieAudios: [\r\n                \"sunce\"\r\n            ],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“九个芒果”设计\",\r\n        skills: {\r\n            PShunzi: {\r\n                audio: \"rehunzi\",\r\n                trigger: {\r\n                    player: \"phaseZhunbeiBegin\"\r\n                },\r\n                filter: function (event, player) {\r\n                    return !player.storage.PShunzi;\r\n                },\r\n                skillAnimation: true,\r\n                animationColor: \"wood\",\r\n                juexingji: true,\r\n                derivation: [\r\n                    \"reyingzi\",\r\n                    \"gzyinghun\",\r\n                    \"PSduwu\",\r\n                    \"PSchoushang\",\r\n                    \"PShuaiji\",\r\n                    \"PSchanhuo\"\r\n                ],\r\n                unique: true,\r\n                forced: true,\r\n                content: function () {\r\n                    player.gainMaxHp();\r\n                    player.addSkills('reyingzi');\r\n                    player.addSkills('gzyinghun');\r\n                    player.addSkills('PSduwu');\r\n                    // game.log(player, '获得了技能', '#g【英姿】【英魂】【崩勇】');\r\n                    player.awakenSkill(event.name);\r\n                    player.storage[event.name] = true;\r\n                },\r\n                _priority: 1\r\n            },\r\n            PSduwu: {\r\n                audio: \"rehunzi\",\r\n                trigger: {\r\n                    player: \"phaseZhunbeiBegin\"\r\n                },\r\n                filter: function (event, player) {\r\n                    return !player.storage.PSduwu && !player.getHistory('useSkill', evt => evt.skill === 'PShunzi').length;\r\n                },\r\n                skillAnimation: true,\r\n                animationColor: \"wood\",\r\n                juexingji: true,\r\n                derivation: [\r\n                    \"dushi\",\r\n                    \"yaowu\",\r\n                    \"PSchoushang\"\r\n                ],\r\n                unique: true,\r\n                forced: true,\r\n                content: function () {\r\n                    player.gainMaxHp();\r\n                    player.addSkills('dushi');\r\n                    player.addSkills('yaowu');\r\n                    player.addSkills('PSchoushang');\r\n                    player.awakenSkill(event.name);\r\n                    player.storage[event.name] = true;\r\n                },\r\n                _priority: 1\r\n            },\r\n            PSchoushang: {\r\n                audio: \"rehunzi\",\r\n                trigger: {\r\n                    player: \"phaseZhunbeiBegin\"\r\n                },\r\n                filter: function (event, player) {\r\n                    return !player.storage.PSchoushang && !player.getHistory('useSkill', evt => evt.skill === 'PSduwu').length;\r\n                },\r\n                skillAnimation: true,\r\n                animationColor: \"wood\",\r\n                juexingji: true,\r\n                derivation: [\r\n                    \"chouhai\",\r\n                    \"ranshang\",\r\n                    \"PShuaiji\"\r\n                ],\r\n                unique: true,\r\n                forced: true,\r\n                content: function () {\r\n                    player.gainMaxHp();\r\n                    player.addSkills('chouhai');\r\n                    player.addSkills('ranshang');\r\n                    player.addSkills('PShuaiji');\r\n                    player.awakenSkill(event.name);\r\n                    player.storage[event.name] = true;\r\n                },\r\n                _priority: 1\r\n            },\r\n            PShuaiji: {\r\n                audio: \"rehunzi\",\r\n                trigger: {\r\n                    player: \"phaseZhunbeiBegin\"\r\n                },\r\n                filter: function (event, player) {\r\n                    return !player.storage.PShuaiji && !player.getHistory('useSkill', evt => evt.skill === 'PSchoushang').length;\r\n                },\r\n                skillAnimation: true,\r\n                animationColor: \"wood\",\r\n                juexingji: true,\r\n                derivation: [\r\n                    \"benghuai\",\r\n                    \"tongji\",\r\n                    \"PSchanhuo\"\r\n                ],\r\n                unique: true,\r\n                forced: true,\r\n                content: function () {\r\n                    player.gainMaxHp();\r\n                    player.addSkills('benghuai');\r\n                    player.addSkills('tongji');\r\n                    player.addSkills('PSchanhuo');\r\n                    player.awakenSkill(event.name);\r\n                    player.storage[event.name] = true;\r\n                },\r\n                _priority: 1\r\n            },\r\n            PSchanhuo: {\r\n                audio: \"rehunzi\",\r\n                trigger: {\r\n                    player: \"phaseZhunbeiBegin\"\r\n                },\r\n                filter: function (event, player) {\r\n                    return !player.storage.PSchanhuo && !player.getHistory('useSkill', evt => evt.skill === 'PShuaiji').length;\r\n                },\r\n                skillAnimation: true,\r\n                animationColor: \"wood\",\r\n                juexingji: true,\r\n                derivation: [\r\n                    \"chanyuan\",\r\n                    \"lianhuo\"\r\n                ],\r\n                unique: true,\r\n                forced: true,\r\n                content: function () {\r\n                    player.gainMaxHp();\r\n                    player.addSkills('chanyuan');\r\n                    player.addSkills('lianhuo');\r\n                    player.awakenSkill(event.name);\r\n                    player.storage[event.name] = true;\r\n                },\r\n                _priority: 1\r\n            }\r\n        },\r\n        sort: sort.PScharacter_wu,\r\n        translate: {\r\n            PSben_sunben: \"PS笨孙笨\",\r\n            PShunzi: \"魂姿\",\r\n            PShunzi_info: \"觉醒技，准备阶段，你加一点体力上限，并获得技能〖英姿〗、〖英魂〗和〖毒武〗。\",\r\n            PSduwu: \"毒武\",\r\n            PSduwu_info: \"觉醒技，准备阶段，若你于此回合没有发动技能〖魂姿〗，你加一点体力上限，并获得技能〖毒逝〗、〖耀武〗和〖仇殇〗。\",\r\n            PSchoushang: \"仇殇\",\r\n            PSchoushang_info: \"觉醒技，准备阶段，若你于此回合没有发动技能〖毒武〗，你加一点体力上限，并获得技能〖仇海〗、〖燃殇〗和〖坏疾〗。\",\r\n            PShuaiji: \"坏疾\",\r\n            PShuaiji_info: \"觉醒技，准备阶段，若你于此回合没有发动技能〖仇殇〗，你加一点体力上限，并获得技能〖崩坏〗、〖同疾〗和〖缠祸〗。\",\r\n            PSchanhuo: \"缠祸\",\r\n            PSchanhuo_info: \"觉醒技，准备阶段，若你于此回合没有发动技能〖坏疾〗，你加一点体力上限，并获得技能〖缠怨〗和〖链祸〗。\"\r\n        },\r\n        rank: rank.junk\r\n    },\r\n    PSqun_zhaoyun: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"qun\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PSlongwei\",\r\n                \"PSqiangshu\"\r\n            ],\r\n            dieAudios: [\r\n                \"zhaoyun\"\r\n            ],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“九个陈皮”设计\",\r\n        skills: {\r\n            PSlongwei: {\r\n                audio: \"chongzhen\",\r\n                trigger: {\r\n                    player: \"useCardToPlayer\",\r\n                    target: \"useCardToTarget\"\r\n                },\r\n                filter: function (event, player, name) {\r\n                    const target = name === \"useCardToPlayer\" ? event.target : event.player;\r\n                    return event.card.name == 'sha' && target && target.countDiscardableCards(player, 'he') > 0;\r\n                },\r\n                shaRelated: true,\r\n                logTarget: function (event, player) {\r\n                    return event.name === \"useCardToPlayer\" ? event.target : event.player;\r\n                },\r\n                content: function () {\r\n                    'step 0'\r\n                    const target = event.triggername === \"useCardToPlayer\" ? trigger.target : trigger.player;\r\n                    player.discardPlayerCard(target, 1, 'he', true);\r\n                    'step 1'\r\n                    if (result.bool && result.cards && result.cards.length && get.color(trigger.card) === get.color(result.cards[0]) && ['o', 'd'].includes(get.position(result.cards[0]))) {\r\n                        player.gain(result.cards, 'gain2');\r\n                    }\r\n                },\r\n                ai: {\r\n                    effect: {\r\n                        player: function (card, player, target) {\r\n                            if (get.name(card) === 'sha') {\r\n                                if (target.countDiscardableCards(player, 'he') > 0) return [1, 1.75];\r\n                                return [1, 1];\r\n                            }\r\n                        },\r\n                        target: function (card, player, target) {\r\n                            if (get.name(card) === 'sha') {\r\n                                if (player.countDiscardableCards(target, 'he') > 0) return [1, -0.5];\r\n                                return [1, 1];\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            PSqiangshu: {\r\n                audio: \"ollongdan\",\r\n                enable: [\r\n                    \"chooseToUse\",\r\n                    \"chooseToRespond\"\r\n                ],\r\n                usable: 1,\r\n                viewAs: {\r\n                    name: \"sha\",\r\n                    storage: {\r\n                        PSqiangshu: true\r\n                    }\r\n                },\r\n                filterCard: true,\r\n                position: \"hes\",\r\n                filter: function (event, player) {\r\n                    return player.countCards('hes');\r\n                },\r\n                check: function (card) {\r\n                    return 6 - get.value(card) && get.cardNameLength(card) > 1;\r\n                },\r\n                precontent: function () {\r\n                    event.getParent().addCount = false;\r\n                },\r\n                mod: {\r\n                    targetInRange: function (card) {\r\n                        if (card.storage && card.storage.PSqiangshu) return true;\r\n                    },\r\n                    selectTarget: function (card, player, range) {\r\n                        if (card.name == 'sha' && card.storage && card.storage.PSqiangshu && range[1] != -1) {\r\n                            try {\r\n                                range[1] = get.cardNameLength(card.cards.length ? card.cards[0] : card);\r\n                            } catch (e) {\r\n                                range[1] = lib.translate[(card.cards.length ? card.cards[0] : card).name].length;\r\n                            }\r\n                        }\r\n                    }\r\n                },\r\n                ai: {\r\n                    order: () => get.order({ name: 'sha' }) + 0.2,\r\n                    result: {\r\n                        player: 1,\r\n                        target: function (player, target, card, isLink) {\r\n                            let eff = -1.5, odds = 1.35, num = 1;\r\n                            if (isLink) {\r\n                                let cache = _status.event.getTempCache('sha_result', 'eff');\r\n                                if (typeof cache !== 'object' || cache.card !== get.translation(card)) return eff;\r\n                                if (cache.odds < 1.35 && cache.bool) return 1.35 * cache.eff;\r\n                                return cache.odds * cache.eff;\r\n                            }\r\n                            if (player.hasSkill('jiu') || player.hasSkillTag('damageBonus', true, {\r\n                                target: target,\r\n                                card: card\r\n                            })) {\r\n                                if (target.hasSkillTag('filterDamage', null, {\r\n                                    player: player,\r\n                                    card: card,\r\n                                    jiu: true,\r\n                                })) eff = -0.5;\r\n                                else {\r\n                                    num = 2;\r\n                                    if (get.attitude(player, target) > 0) eff = -7;\r\n                                    else eff = -4;\r\n                                }\r\n                            }\r\n                            if (!player.hasSkillTag('directHit_ai', true, {\r\n                                target: target,\r\n                                card: card,\r\n                            }, true)) odds -= 0.7 * target.mayHaveShan(player, 'use', target.getCards(i => {\r\n                                return i.hasGaintag('sha_notshan');\r\n                            }), 'odds');\r\n                            _status.event.putTempCache('sha_result', 'eff', {\r\n                                bool: target.hp > num && get.attitude(player, target) > 0,\r\n                                card: get.translation(card),\r\n                                eff: eff,\r\n                                odds: odds\r\n                            });\r\n                            return odds * eff;\r\n                        }\r\n                    },\r\n                    yingbian: function (card, player, targets, viewer) {\r\n                        if (get.attitude(viewer, player) <= 0) return 0;\r\n                        var base = 0, hit = false;\r\n                        if (get.cardtag(card, 'yingbian_hit')) {\r\n                            hit = true;\r\n                            if (targets.some(target => {\r\n                                return target.mayHaveShan(viewer, 'use', target.getCards(i => {\r\n                                    return i.hasGaintag('sha_notshan');\r\n                                })) && get.attitude(viewer, target) < 0 && get.damageEffect(target, player, viewer, get.natureList(card)) > 0;\r\n                            })) base += 5;\r\n                        }\r\n                        if (get.cardtag(card, 'yingbian_add')) {\r\n                            if (game.hasPlayer(function (current) {\r\n                                return !targets.includes(current) && lib.filter.targetEnabled2(card, player, current) && get.effect(current, card, player, player) > 0;\r\n                            })) base += 5;\r\n                        }\r\n                        if (get.cardtag(card, 'yingbian_damage')) {\r\n                            if (targets.some(target => {\r\n                                return get.attitude(player, target) < 0 && (hit || !target.mayHaveShan(viewer, 'use', target.getCards(i => {\r\n                                    return i.hasGaintag('sha_notshan');\r\n                                })) || player.hasSkillTag('directHit_ai', true, {\r\n                                    target: target,\r\n                                    card: card,\r\n                                }, true)) && !target.hasSkillTag('filterDamage', null, {\r\n                                    player: player,\r\n                                    card: card,\r\n                                    jiu: true,\r\n                                })\r\n                            })) base += 5;\r\n                        }\r\n                        return base;\r\n                    },\r\n                    canLink: function (player, target, card) {\r\n                        if (!target.isLinked() && !player.hasSkill('wutiesuolian_skill')) return false;\r\n                        if (player.hasSkill('jueqing') || player.hasSkill('gangzhi') || target.hasSkill('gangzhi')) return false;\r\n                        return true;\r\n                    },\r\n                    basic: {\r\n                        useful: [\r\n                            5,\r\n                            3,\r\n                            1\r\n                        ],\r\n                        value: [\r\n                            5,\r\n                            3,\r\n                            1\r\n                        ]\r\n                    },\r\n                    tag: {\r\n                        respond: 1,\r\n                        respondShan: 1,\r\n                        damage: function (card) {\r\n                            if (game.hasNature(card, 'poison')) return;\r\n                            return 1;\r\n                        },\r\n                        natureDamage: function (card) {\r\n                            if (game.hasNature(card, 'linked')) return 1;\r\n                        },\r\n                        fireDamage: function (card, nature) {\r\n                            if (game.hasNature(card, 'fire')) return 1;\r\n                        },\r\n                        thunderDamage: function (card, nature) {\r\n                            if (game.hasNature(card, 'thunder')) return 1;\r\n                        },\r\n                        poisonDamage: function (card, nature) {\r\n                            if (game.hasNature(card, 'poison')) return 1;\r\n                        }\r\n                    }\r\n                },\r\n                _priority: 0\r\n            }\r\n        },\r\n        sort: sort.PScharacter_qun,\r\n        translate: {\r\n            PSqun_zhaoyun: \"PS群赵云\",\r\n            PSlongwei: \"龙威\",\r\n            PSlongwei_info: \"当你使用杀指定目标或成为杀的目标时，你可以弃置对方的一张牌，若弃置牌的颜色与该杀的颜色相同，你获得之。\",\r\n            PSqiangshu: \"枪术\",\r\n            PSqiangshu_info: \"每回合限一次，你可以将一张牌当【杀】使用或打出（无距离限制且不计入次数），你以此法使用的【杀】额定目标数为X（X为此牌的牌名数）。\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PSxuzhu: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"wei\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PSluoyi\",\r\n                \"PShanzhan\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“九个陈皮”设计\",\r\n        skills: {\r\n            PSluoyi: {\r\n                enable: \"phaseUse\",\r\n                audio: \"luoyi\",\r\n                usable: 2,\r\n                viewAsFilter: function (player) {\r\n                    return [1, 2, 3, 4, 5].some(ele => player.hasEnabledSlot(ele));;\r\n                },\r\n                viewAs: {\r\n                    name: \"juedou\",\r\n                    isCard: true\r\n                },\r\n                filterCard: () => false,\r\n                selectCard: -1,\r\n                precontent: function () {\r\n                    'step 0'\r\n                    player.chooseToDisable().set('ai', function (event, player, list) {\r\n                        if (list.includes('equip5')) return 'equip5';\r\n                        return list.randomGet();\r\n                    });\r\n                    'step 1'\r\n                    player.when({ source: 'damageBegin2', player: \"useCardEnd\" }).filter(evt => {\r\n                        if (evt.name == \"useCard\") return true;\r\n                        return evt.getParent().skill === 'PSluoyi' && player.countCards('e') <= evt.player.countCards('e');\r\n                    }).then(() => {\r\n                        if (event.triggername === \"useCardEnd\") return;\r\n                        trigger.num++;\r\n                    });\r\n                },\r\n                ai: {\r\n                    order: function () {\r\n                        return get.order({ name: 'juedou' }) - 0.5;\r\n                    },\r\n                    wuxie: function (target, card, player, viewer, status) {\r\n                        if (player === game.me && get.attitude(viewer, player._trueMe || player) > 0) return 0;\r\n                        if (status * get.attitude(viewer, target) * get.effect(target, card, player, target) >= 0) return 0;\r\n                    },\r\n                    basic: {\r\n                        order: 5,\r\n                        useful: 1,\r\n                        value: 5.5\r\n                    },\r\n                    result: {\r\n                        target: -1.5,\r\n                        player: function (player, target, card) {\r\n                            if (player.hasSkillTag('directHit_ai', true, {\r\n                                target: target,\r\n                                card: card,\r\n                            }, true)) {\r\n                                return 0;\r\n                            }\r\n                            if (get.damageEffect(target, player, target) > 0 && get.attitude(player, target) > 0 && get.attitude(target, player) > 0) {\r\n                                return 0;\r\n                            }\r\n                            var hs1 = target.getCards('h', 'sha');\r\n                            var hs2 = player.getCards('h', 'sha');\r\n                            if (hs1.length > hs2.length + 1) {\r\n                                return -2;\r\n                            }\r\n                            var hsx = target.getCards('h');\r\n                            if (hsx.length > 2 && hs2.length == 0 && hsx[0].number < 6) {\r\n                                return -2;\r\n                            }\r\n                            if (hsx.length > 3 && hs2.length == 0) {\r\n                                return -2;\r\n                            }\r\n                            if (hs1.length > hs2.length && (!hs2.length || hs1[0].number > hs2[0].number)) {\r\n                                return -2;\r\n                            }\r\n                            return -0.5;\r\n                        }\r\n                    },\r\n                    tag: {\r\n                        respond: 2,\r\n                        respondSha: 2,\r\n                        damage: 1\r\n                    }\r\n                }\r\n            },\r\n            PShanzhan: {\r\n                audio: \"reluoyi\",\r\n                trigger: {\r\n                    global: \"dying\"\r\n                },\r\n                usable: 1,\r\n                check: () => true,\r\n                content: async function (event, trigger, player) {\r\n                    if (player.countDiscardableCards(player, 'hes') > 0) {\r\n                        const { result } = await player.chooseToDiscard([1, 2], 'hes', '是否弃置至多两张牌，恢复等量的装备栏？', false).set('ai', get.disvalue);\r\n                        if (result.cards && result.cards.length) {\r\n                            const num = result.cards.length;\r\n                            if (num >= player.countDisabledSlot()) {\r\n                                for (let i = 1; i <= 5; i++) {\r\n                                    let type = 'equip' + i;\r\n                                    let number = player.disabledSlots[type];\r\n                                    if (typeof number === 'number' && number !== 0) {\r\n                                        for (let j = 0; j < number; j++) {\r\n                                            await player.enableEquip(i);\r\n                                        }\r\n                                    }\r\n                                }\r\n                                player.enableEquip(result.control);\r\n                            } else {\r\n                                for (let i = 0; i < num; i++) {\r\n                                    await player.chooseToEnable();\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                    player.drawTo(4);\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_wei,\r\n        translate: {\r\n            PSxuzhu: \"PS许褚\",\r\n            PSluoyi: \"裸衣\",\r\n            PSluoyi_info: \"出牌阶段限两次，你可以废除一个装备栏，视为使用一张【决斗】。当你以此法使用【决斗】对其他角色造成伤害时，若你装备区的牌数不大于目标角色，此伤害+1。\",\r\n            PShanzhan: \"酣战\",\r\n            PShanzhan_info: \"每回合限一次，当一名角色进入濒死状态时，你可以弃置至多两张牌，恢复等量的装备栏，然后你将手牌摸至4张。\"\r\n        },\r\n        rank: rank.epic\r\n    },\r\n    PSgongsunzan: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"qun\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PSdangkou\",\r\n                \"PSbaima\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“九个陈皮”设计\",\r\n        skills: {\r\n            PSdangkou: {\r\n                audio: \"dcqiaomeng\",\r\n                enable: \"phaseUse\",\r\n                filter: function (event, player) {\r\n                    return player.countCards('hes') > 0 && !player.hasSkill('PSdangkou_used');\r\n                },\r\n                async content(event, trigger, player) {\r\n                    const { control } = await player.chooseControl(['失去体力', '回复体力', 'cancel2']).set('ai', function () {\r\n                        if (player.hp > player.getDamagedHp()) return '失去体力';\r\n                        else return '回复体力';\r\n                    }).set('prompt', lib.translate.PSdangkou_info).forResult();\r\n                    if (control === 'cancel2') {\r\n                        return;\r\n                    }\r\n                    player.addTempSkill('PSdangkou_used');\r\n                    if (control === '失去体力') {\r\n                        await player.loseHp();\r\n                        await player.gainMaxHp();\r\n                        await player.chooseUseTarget('sha', '是否使用一张【杀】？', false);\r\n                    } else {\r\n                        await player.recover();\r\n                        await player.loseMaxHp();\r\n                        await player.draw(2);\r\n                    }\r\n                },\r\n                subSkill: {\r\n                    used: {\r\n                        charlotte: true,\r\n                        forced: true,\r\n                        popup: false\r\n                    }\r\n                },\r\n                ai: {\r\n                    order: 8,\r\n                    result: {\r\n                        player: 1\r\n                    }\r\n                },\r\n                _priority: 0\r\n            },\r\n            PSbaima: {\r\n                audio: \"reyicong\",\r\n                trigger: {\r\n                    player: \"changeHp\"\r\n                },\r\n                forced: true,\r\n                locked: true,\r\n                content: function () { },\r\n                mod: {\r\n                    globalFrom: function (from, to, current) {\r\n                        return current - Math.max(from.hp, 1);\r\n                    },\r\n                    globalTo: function (from, to, current) {\r\n                        return current + Math.max(to.getDamagedHp(), 1);\r\n                    }\r\n                },\r\n                ai: {\r\n                    threaten: 0.8\r\n                },\r\n                _priority: 0\r\n            }\r\n        },\r\n        sort: sort.PScharacter_qun,\r\n        translate: {\r\n            PSgongsunzan: \"PS公孙瓒\",\r\n            PSdangkou: \"荡寇\",\r\n            PSdangkou_info: \"出牌阶段限一次，你可以选择一项：1.失去一点体力并增加一点体力上限，然后视为使用一张【杀】（不计入使用次数）；2.回复一点体力并减一点体力上限，然后摸两张牌。\",\r\n            PSbaima: \"白马\",\r\n            PSbaima_info: \"锁定技，你计算与其他角色距离时-X，其他角色计算与你的距离时+Y（X为你的体力值，Y为你已损失的体力值，至少为1）。\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PSdongzhuo: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"qun\",\r\n            hp: 8,\r\n            skills: [\r\n                \"PSlingbao\",\r\n                \"PSjiuchi\",\r\n                \"PSzongyu\",\r\n                \"olbaonue\"\r\n            ],\r\n            isZhugong: true,\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“九个陈皮”设计\",\r\n        skills: {\r\n            PSlingbao: {\r\n                audio: \"starweilin\",\r\n                trigger: {\r\n                    player: \"useCard\"\r\n                },\r\n                check: function (event, player) {\r\n                    return get.value(event.card) > 4;\r\n                },\r\n                prompt2: function (event, player) {\r\n                    return `令${get.translation(event.card)}额外结算一次`;\r\n                },\r\n                filter: function (event, player) {\r\n                    if (!['club', 'spade'].includes(get.suit(event.card))) return false;\r\n                    var evt = player.getLastUsed(1);\r\n                    if (!evt || !evt.card) return false;\r\n                    if (!player.isPhaseUsing()) return false;\r\n                    var evt2 = evt.getParent('phaseUse');\r\n                    if (!evt2 || evt2.name != 'phaseUse' || evt2.player != player) return false;\r\n                    return get.suit(evt.card) === get.suit(event.card);\r\n                },\r\n                usable: 1,\r\n                content: function () {\r\n                    trigger.effectCount++;\r\n                }\r\n            },\r\n            PSjiuchi: {\r\n                mod: {\r\n                    cardUsable: function (card, player, num) {\r\n                        if (card.name == 'jiu') return Infinity;\r\n                    }\r\n                },\r\n                audio: \"oljiuchi\",\r\n                enable: \"chooseToUse\",\r\n                filterCard: function (card) {\r\n                    return get.suit(card) == 'spade';\r\n                },\r\n                viewAs: {\r\n                    name: \"jiu\"\r\n                },\r\n                position: \"hes\",\r\n                viewAsFilter: function (player) {\r\n                    return player.hasCard(card => get.suit(card) == 'spade', 'hs');\r\n                },\r\n                prompt: \"将一张黑桃牌当酒使用\",\r\n                check: function (cardx, player) {\r\n                    if (player && player == cardx.player) return true;\r\n                    if (_status.event.type == 'dying') return 1;\r\n                    var player = _status.event.player;\r\n                    var shas = player.getCards('hs', function (card) {\r\n                        return card != cardx && get.name(card, player) == 'sha';\r\n                    });\r\n                    if (!shas.length) return -1;\r\n                    if (shas.length > 1 && (player.getCardUsable('sha') > 1 || player.countCards('hs', 'zhuge'))) {\r\n                        return 0;\r\n                    }\r\n                    shas.sort(function (a, b) {\r\n                        return get.order(b) - get.order(a);\r\n                    });\r\n                    var card = false;\r\n                    if (shas.length) {\r\n                        for (var i = 0; i < shas.length; i++) {\r\n                            if (shas[i] != cardx && lib.filter.filterCard(shas[i], player)) {\r\n                                card = shas[i]; break;\r\n                            }\r\n                        }\r\n                    }\r\n                    if (card) {\r\n                        if (game.hasPlayer(function (current) {\r\n                            return (get.attitude(player, current) < 0 &&\r\n                                !current.hasShan()\r\n                                && current.hp + current.countCards('h', { name: ['tao', 'jiu'] }) > 1 + (player.storage.jiu || 0)\r\n                                && player.canUse(card, current, true, true) &&\r\n                                !current.hasSkillTag('filterDamage', null, {\r\n                                    player: player,\r\n                                    card: card,\r\n                                    jiu: true,\r\n                                }) &&\r\n                                get.effect(current, card, player) > 0);\r\n                        })) {\r\n                            return 4 - get.value(cardx);\r\n                        }\r\n                    }\r\n                    return -1;\r\n                },\r\n                ai: {\r\n                    threaten: 1.5,\r\n                    basic: {\r\n                        useful: (card, i) => {\r\n                            if (_status.event.player.hp > 1) {\r\n                                if (i === 0) return 4;\r\n                                return 1;\r\n                            }\r\n                            if (i === 0) return 7.3;\r\n                            return 3;\r\n                        },\r\n                        value: (card, player, i) => {\r\n                            if (player.hp > 1) {\r\n                                if (i === 0) return 5;\r\n                                return 1;\r\n                            }\r\n                            if (i === 0) return 7.3;\r\n                            return 3;\r\n                        }\r\n                    },\r\n                    order: () => {\r\n                        if (_status.event.dying) return 9;\r\n                        let sha = get.order({ name: 'sha' });\r\n                        if (sha > 0) return sha + 0.2;\r\n                        return 0;\r\n                    },\r\n                    result: {\r\n                        target: (player, target, card) => {\r\n                            if (target && target.isDying()) return 2;\r\n                            if (!target || target._jiu_temp || !target.isPhaseUsing()) return 0;\r\n                            let usable = target.getCardUsable('sha');\r\n                            if (!usable || lib.config.mode === 'stone' && !player.isMin() && player.getActCount() + 1 >= player.actcount || !target.mayHaveSha(player, 'use', card)) return 0;\r\n                            let effs = { order: 0 }, temp;\r\n                            target.getCards('hs', i => {\r\n                                if (get.name(i) !== 'sha' || ui.selected.cards.includes(i)) return false;\r\n                                temp = get.order(i, target);\r\n                                if (temp < effs.order) return false;\r\n                                if (temp > effs.order) effs = { order: temp };\r\n                                effs[i.cardid] = {\r\n                                    card: i,\r\n                                    target: null,\r\n                                    eff: 0\r\n                                };\r\n                            });\r\n                            delete effs.order;\r\n                            for (let i in effs) {\r\n                                if (!lib.filter.filterCard(effs[i].card, target)) continue;\r\n                                game.filterPlayer(current => {\r\n                                    if (get.attitude(target, current) >= 0 || !target.canUse(effs[i].card, current, null, true) || current.hasSkillTag('filterDamage', null, {\r\n                                        player: target,\r\n                                        card: effs[i].card,\r\n                                        jiu: true\r\n                                    })) return false;\r\n                                    temp = get.effect(current, effs[i].card, target, player);\r\n                                    if (temp <= effs[i].eff) return false;\r\n                                    effs[i].target = current;\r\n                                    effs[i].eff = temp;\r\n                                    return false;\r\n                                });\r\n                                if (!effs[i].target) continue;\r\n                                if (target.hasSkillTag('directHit_ai', true, {\r\n                                    target: effs[i].target,\r\n                                    card: i\r\n                                }, true) || usable === 1 && (target.needsToDiscard() > Math.max(0, 3 - target.hp) || !effs[i].target.mayHaveShan(player, 'use', effs[i].target.getCards(i => {\r\n                                    return i.hasGaintag('sha_notshan');\r\n                                })))) {\r\n                                    delete target._jiu_temp;\r\n                                    return 1;\r\n                                }\r\n                            }\r\n                            delete target._jiu_temp;\r\n                            return 0;\r\n                        }\r\n                    },\r\n                    tag: {\r\n                        save: 1,\r\n                        recover: 0.1\r\n                    }\r\n                },\r\n                _priority: 0\r\n            },\r\n            PSzongyu: {\r\n                audio: \"roulin\",\r\n                trigger: {\r\n                    global: \"damageEnd\"\r\n                },\r\n                forced: true,\r\n                filter: function (event, player) {\r\n                    return event.player.isIn() && event.player !== player && event.player.sex === 'female' && event.player.countCards('he');\r\n                },\r\n                logTarget: \"player\",\r\n                content: function () {\r\n                    player.gainPlayerCard(trigger.player, 1, 'he', true);\r\n                },\r\n                group: \"PSzongyu_lose\",\r\n                subSkill: {\r\n                    lose: {\r\n                        audio: \"benghuai\",\r\n                        trigger: {\r\n                            player: \"phaseJieshuBegin\"\r\n                        },\r\n                        forced: true,\r\n                        filter: function (event, player) {\r\n                            return game.hasPlayer(function (current) {\r\n                                return current.sex === 'female';\r\n                            });\r\n                        },\r\n                        content() {\r\n                            \"step 0\"\r\n                            player.chooseControl('baonue_hp', 'baonue_maxHp', function (event, player) {\r\n                                if (player.hp == player.maxHp) return 'baonue_hp';\r\n                                if (player.hp < player.maxHp - 1 || player.hp <= 2) return 'baonue_maxHp';\r\n                                return 'baonue_hp';\r\n                            }).set('prompt', '纵欲：失去1点体力或减1点体力上限');\r\n                            \"step 1\"\r\n                            if (result.control == 'baonue_hp') {\r\n                                player.loseHp();\r\n                            }\r\n                            else {\r\n                                player.loseMaxHp(true);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_qun,\r\n        translate: {\r\n            PSdongzhuo: \"PS董卓\",\r\n            PSlingbao: \"凌暴\",\r\n            PSlingbao_info: \"每阶段限一次，当你于出牌阶段内使用♣或♠牌时，若此牌花色与你于此阶段使用的上一张牌花色相同，你可以令此牌额外结算一次。\",\r\n            PSjiuchi: \"酒池\",\r\n            PSjiuchi_info: \"你可以将一张♠牌当【酒】 使用，你使用【酒】无次数限制。\",\r\n            PSzongyu: \"纵欲\",\r\n            PSzongyu_info: \"锁定技，①当一名女性角色受到伤害后，你获得其一张牌。②结束阶段，若场上有存活的女性角色，你须减一点体力或体力上限。\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PShuangzhong: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"shu\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PSxujin\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“九个陈皮”设计\",\r\n        skills: {\r\n            PSxujin: {\r\n                getUseNumber: function (player) {\r\n                    // player.markSkill('PSxujin');\r\n                    const num = player.storage.PSxujin || 0;\r\n                    return game.getGlobalHistory('useCard').length - num;\r\n                },\r\n                getSuitNumber: function (show) {\r\n                    const suits = [];\r\n                    game.getGlobalHistory('useCard', evt => {\r\n                        if (lib.suit.includes(get.suit(evt.card))) suits.add(get.suit(evt.card));\r\n                    });\r\n                    if (show) return get.translation(suits);\r\n                    return suits.length;\r\n                },\r\n                mod: {\r\n                    targetInRange: function (card, player, target) {\r\n                        if (card.name == 'sha' && lib.skill.PSxujin.getUseNumber(player) >= 1) return true;\r\n                    }\r\n                },\r\n                mark: true,\r\n                intro: {\r\n                    content: function (storage, player) {\r\n                        let str = '<li>本回合已使用花色：';\r\n                        str += lib.skill.PSxujin.getSuitNumber(true);\r\n                        str += '<br><li>本回合已使用花色数：';\r\n                        str += lib.skill.PSxujin.getSuitNumber();\r\n                        str += '<br><li>本回合“蓄劲”计数：';\r\n                        str += lib.skill.PSxujin.getUseNumber(player);\r\n                        return str;\r\n                    },\r\n                    markcount: function (storage, player) {\r\n                        if (player.storage.PSxujin) return game.getGlobalHistory('useCard').length - player.storage.PSxujin;\r\n                        return game.getGlobalHistory('useCard').length;\r\n                    }\r\n                },\r\n                audio: \"xinliegong\",\r\n                trigger: {\r\n                    player: \"useCardToPlayered\",\r\n                    global: [\r\n                        \"phaseEnd\",\r\n                        \"useCard\"\r\n                    ]\r\n                },\r\n                forced: true,\r\n                lastDo: true,\r\n                filter: function (event, player, name) {\r\n                    if (name === 'phaseEnd' || name === 'useCard') {\r\n                        player.markSkill('PSxujin');\r\n                        if (name === 'phaseEnd') delete player.storage.PSxujin;\r\n                        return false;\r\n                    }\r\n                    return get.name(event.card) === 'sha' && lib.skill.PSxujin.getUseNumber(player) >= 2;\r\n                },\r\n                content: function () {\r\n                    trigger.getParent().directHit.addArray(game.players);\r\n                    game.log(trigger.card, '不可被响应');\r\n                    player.when({ source: 'damageBegin2' })\r\n                        .filter(evt => {\r\n                            return evt.getParent(2) === trigger.getParent() && lib.skill.PSxujin.getUseNumber(player) >= 3 && evt.card === trigger.card;\r\n                        })\r\n                        .then(() => {\r\n                            trigger.num += lib.skill.PSxujin.getSuitNumber() - 1;\r\n                            game.log(trigger.card, '造成伤害+', lib.skill.PSxujin.getSuitNumber());\r\n                        });\r\n                    player.when('useCardAfter')\r\n                        .filter(evt => {\r\n                            return get.name(evt.card) === 'sha' && lib.skill.PSxujin.getUseNumber(player) >= 4;\r\n                        })\r\n                        .then(() => {\r\n                            player.drawTo(player.maxHp);\r\n                            player.storage.PSxujin = lib.skill.PSxujin.getUseNumber(player);\r\n                        });\r\n                },\r\n                ai: {\r\n                    directHit_ai: true,\r\n                    skillTagFilter: function (player, tag, arg) {\r\n                        if (!arg || !arg.card || !arg.target || arg.card.name != 'sha' && lib.skill.PSxujin.getUseNumber(player) >= 2) return false;\r\n                        return true;\r\n                    }\r\n                },\r\n                sub: true,\r\n                _priority: 0\r\n            }\r\n        },\r\n        sort: sort.PScharacter_shu,\r\n        translate: {\r\n            PShuangzhong: \"PS黄忠\",\r\n            PSxujin: \"蓄劲\",\r\n            PSxujin_info: \"锁定技，若X：<br>不小于1，你使用【杀】无距离限制；<br>不小于2，你使用【杀】不可被响应；<br>不小于3，你使用【杀】造成伤害+Y。<br>当你使用【杀】结算后，若X不小于4，你将手牌摸至体力上限，记录Z为此时本回合使用过的牌数，然后本回合X修改为本回合使用过的牌数-Z。 (X为本回合使用过的牌数，Y为本回合使用过的花色数-1)\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PSshen_simayi: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"shen\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PSrenjie\",\r\n                \"PSbaiyin\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“九个芒果”设计\",\r\n        skills: {\r\n            PSrenjie: {\r\n                mod: {\r\n                    aiOrder: (player, card, num) => {\r\n                        if (num <= 0 || typeof card !== 'object' || !player.isPhaseUsing()) return num;\r\n                        if (lib.skill.PSrenjie.derivation.filter(skill => !player.hasSkill(skill)).length /* && player.getUseValue(card) < Math.min(4, player.hp * player.hp / 4) */) return 0;\r\n                    }\r\n                },\r\n                audio: \"renjie2\",\r\n                trigger: {\r\n                    player: [\r\n                        \"damageEnd\",\r\n                        \"loseAfter\"\r\n                    ],\r\n                    global: \"loseAsyncAfter\"\r\n                },\r\n                init: function (player, skill) {\r\n                    game.changeSkillAudio('reguicai', player.name, 'jilue_guicai');\r\n                    game.changeSkillAudio('PSfangzhu', player.name, 'jilue_fangzhu');\r\n                    game.changeSkillAudio('PSjizhi', player.name, 'jilue_jizhi');\r\n                    game.changeSkillAudio('PSzhiheng', player.name, 'jilue_zhiheng');\r\n                    game.changeSkillAudio('PSwansha', player.name, 'wansha_shen_simayi');\r\n                },\r\n                derivation: [\r\n                    \"reguicai\",\r\n                    \"PSfangzhu\",\r\n                    \"PSjizhi\",\r\n                    \"PSzhiheng\",\r\n                    \"PSwansha\"\r\n                ],\r\n                forced: true,\r\n                notemp: true,\r\n                filter(event, player, name) {\r\n                    if (!lib.skill.PSrenjie.derivation.filter(skill => !player.hasSkill(skill)).length) return false;\r\n                    if (name === \"damageEnd\") return event.num > 0;\r\n                    else {\r\n                        if (event.type != 'discard' || event.getlx === false) return false;\r\n                        var evt = event.getParent('phaseDiscard'), evt2 = event.getl(player);\r\n                        return evt && evt2 && evt.name == 'phaseDiscard' && evt.player == player && evt2.cards2 && evt2.cards2.length > 0;\r\n                    }\r\n                },\r\n                async content(event, trigger, player) {\r\n                    /**\r\n                     * 旧写法\r\n                     */\r\n                    /* if (!lib.skill.PSrenjie.derivation.filter(skill => !player.hasSkill(skill)).length) return;\r\n                    if (player.storage.PSrenjie === void 0) player.storage.PSrenjie = event.triggername === \"damageEnd\" ? trigger.num : trigger.getl(player).cards2.length;\r\n                    const skills = lib.skill.PSrenjie.derivation.filter(skill => !player.hasSkill(skill));\r\n                    const choiceList = skills.map(skill => get.translation(skill) + '：' + get.translation(skill + '_info'));\r\n                    const { result: { control } } = await player.chooseControl(skills)\r\n                        .set('prompt', '忍戒：选择获得一个技能')\r\n                        .set('choiceList', choiceList).set('displayIndex', false).set('ai', () => get.event().controls.randomGet());\r\n                    await player.addSkills(control);\r\n                    player.storage.PSrenjie--;\r\n                    if (player.storage.PSrenjie > 0) {\r\n                        await lib.skill.PSrenjie.content(event, trigger, player);\r\n                    }\r\n                    player.storage.PSrenjie === 0 && delete player.storage.PSrenjie; */\r\n\r\n                    const num = event.triggername === \"damageEnd\" ? trigger.num : trigger.getl(player).cards2.length;\r\n                    const skills = lib.skill.PSrenjie.derivation.filter(skill => !player.hasSkill(skill));\r\n                    if (num >= skills.length) {\r\n                        player.addSkills(skills);\r\n                        return;\r\n                    };\r\n                    const choiceList = skills.map((skill, i) => [i, get.translation(skill) + '：' + get.translation(skill + '_info')]);\r\n                    const { result: { links } } = await player.chooseButton([\r\n                        `忍戒：请选择获得${get.cnNumber(num)}个技能`, [choiceList, 'textbutton']\r\n                    ])\r\n                        .set('dialog', event.videoId)\r\n                        .set('forced', true)\r\n                        .set('selectButton', num)\r\n                        .set('ai', function (button) {\r\n                            return 1 + Math.random();\r\n                        });\r\n                    player.addSkills(links.map(i => {\r\n                        player.popup(skills[i]);\r\n                        return skills[i];\r\n                    }));\r\n                },\r\n                intro: {\r\n                    name2: \"忍\",\r\n                    content: \"mark\"\r\n                },\r\n                ai: {\r\n                    maixie: true,\r\n                    maixie_hp: true,\r\n                    effect: {\r\n                        target: function (card, player, target) {\r\n                            if (player.hasSkillTag('jueqing', false, target)) return [1, -2];\r\n                            if (get.tag(card, 'damage')) {\r\n                                if (target.hp == target.maxHp) {\r\n                                    if (!target.hasSkill('PSjilue')) {\r\n                                        return [0, 1];\r\n                                    }\r\n                                    return [0.7, 1];\r\n                                }\r\n                                return 0.7;\r\n                            }\r\n                        }\r\n                    }\r\n                },\r\n                _priority: 0\r\n            },\r\n            PSbaiyin: {\r\n                skillAnimation: \"epic\",\r\n                animationColor: \"thunder\",\r\n                juexingji: true,\r\n                trigger: {\r\n                    player: \"changeSkillsAfter\"\r\n                },\r\n                forced: true,\r\n                unique: true,\r\n                audio: \"sbaiyin\",\r\n                derivation: \"lianpo\",\r\n                filter(event, player) {\r\n                    return lib.skill.PSrenjie.derivation.every(skill => player.hasSkill(skill)) && event.getParent(2).skill === 'PSrenjie';\r\n                },\r\n                content: async function (event, trigger, player) {\r\n                    player.awakenSkill('PSbaiyin');\r\n                    player.loseMaxHp();\r\n                    await player.removeSkills('PSrenjie');\r\n                    await player.addSkills('lianpo');\r\n                },\r\n                _priority: 0,\r\n                ai: {\r\n                    combo: \"PSrenjie\"\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_shen,\r\n        translate: {\r\n            PSshen_simayi: \"PS神司马懿\",\r\n            PSrenjie: \"忍戒\",\r\n            PSrenjie_info: \"锁定技，当你受到1点伤害后/于弃牌阶段内每弃置一张牌后，你选择获得{〖鬼才〗、〖放逐〗、〖集智〗、〖制衡〗、〖完杀〗}中的一个技能。\",\r\n            PSbaiyin: \"拜印\",\r\n            PSbaiyin_info: \"觉醒技，当你因〖忍戒〗获得技能后，若你拥有〖忍戒〗的所有衍生技，你减1点体力上限，失去技能〖忍戒〗，然后获得〖连破〗。\"\r\n        },\r\n        rank: rank.epic\r\n    },\r\n    PSyue_caiwenji: {\r\n        info: {\r\n            sex: \"female\",\r\n            group: \"qun\",\r\n            hp: 3,\r\n            skills: [\r\n                \"PSshuangjia\",\r\n                \"dcbeifen\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“神鬼高达”设计\",\r\n        skills: {\r\n            PSshuangjia: {\r\n                audio: \"dcshuangjia\",\r\n                trigger: {\r\n                    global: \"phaseBefore\",\r\n                    player: [\r\n                        \"enterGame\",\r\n                        \"gainBegin\"\r\n                    ]\r\n                },\r\n                forced: true,\r\n                filter: function (event, player) {\r\n                    return (event.name !== 'phase' || game.phaseNumber === 0) && event.getParent(2).skill != 'dcbeifen';\r\n                },\r\n                content: function () {\r\n                    if (event.triggername !== \"gainBegin\") {\r\n                        var cards = player.getCards('h');\r\n                        player.addGaintag(cards, 'dcshuangjia_tag');\r\n                    } else {\r\n                        trigger.gaintag.add('dcshuangjia_tag');\r\n                    }\r\n                },\r\n                sub: true,\r\n                onremove: function (player) {\r\n                    player.removeGaintag(\"dcshuangjia_tag\");\r\n                },\r\n                mod: {\r\n                    ignoredHandcard: function (card, player) {\r\n                        if (card.hasGaintag('dcshuangjia_tag')) {\r\n                            return true;\r\n                        }\r\n                    },\r\n                    cardDiscardable: function (card, player, name) {\r\n                        if (name == 'phaseDiscard' && card.hasGaintag('dcshuangjia_tag')) {\r\n                            return false;\r\n                        }\r\n                    },\r\n                    globalTo: function (from, to, distance) {\r\n                        return distance + Math.min(5, to.countCards('h', card => card.hasGaintag('dcshuangjia_tag')));\r\n                    }\r\n                },\r\n                _priority: 0\r\n            }\r\n        },\r\n        sort: sort.PScharacter_qun,\r\n        translate: {\r\n            PSyue_caiwenji: \"PS乐蔡文姬\",\r\n            PSyue_caiwenji_prefix: \"PS乐\",\r\n            PSshuangjia: \"霜笳\",\r\n            PSshuangjia_info: \"锁定技。①游戏开始时/当你不因〖悲愤〗而获得牌时，你将你的手牌/这些牌标记为“胡笳”。②你的“胡笳”牌不计入手牌上限。③其他角色至你的距离+X（X为你的“胡笳”数且至多为5）。\"\r\n        },\r\n        rank: rank.epic\r\n    },\r\n    PScaopi: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"wei\",\r\n            hp: 3,\r\n            skills: [\r\n                \"PSfangzhu\",\r\n                \"PSxingshang\",\r\n                \"songwei\"\r\n            ],\r\n            dieAudios: [\r\n                \"re_caopi\"\r\n            ],\r\n            isZhugong: true,\r\n            trashBin: []\r\n        },\r\n        intro: \"由“九个芒果”设计\",\r\n        skills: {\r\n            PSfangzhu: {\r\n                mod: {\r\n                    targetEnabled: function (card, player, target, now) {\r\n                        if (target.isTurnedOver() !== player.isTurnedOver() && _status.currentPhase === player) return false;\r\n                    }\r\n                },\r\n                audio: \"refangzhu\",\r\n                trigger: {\r\n                    player: \"damageEnd\"\r\n                },\r\n                direct: true,\r\n                content: function () {\r\n                    \"step 0\"\r\n                    player.chooseTarget(get.prompt2('PSfangzhu'), function (card, player, target) {\r\n                        return true;\r\n                    }).ai = function (target) {\r\n                        if (target.hasSkillTag('noturn')) return 0;\r\n                        var player = _status.event.player;\r\n                        if (get.attitude(_status.event.player, target) == 0) return 0;\r\n                        if (get.attitude(_status.event.player, target) > 0) {\r\n                            if (target.classList.contains('turnedover')) return 1000 - target.countCards('h');\r\n                            return -1;\r\n                        }\r\n                        else {\r\n                            if (target.hp <= 1) return 1000;\r\n                            return 1 + target.countCards('h');\r\n                        }\r\n                    }\r\n                    \"step 1\"\r\n                    if (result.bool) {\r\n                        player.logSkill('PSfangzhu', result.targets);\r\n                        event.target = result.targets[0];\r\n                        const list = ['摸牌翻面', '弃牌扣血'];\r\n                        player.chooseControl(list, function (event, player) {\r\n                            return _status.event.choice;\r\n                        })\r\n                            .set('choice', (get.attitude(player, event.target) > 0 || event.target.hp > 1) ? list[0] : list[1])\r\n                            .set('prompt', `放逐：令${get.translation(event.target)}执行一项`);\r\n                    }\r\n                    else event.finish();\r\n                    \"step 2\"\r\n                    if (result.control) {\r\n                        if (result.control === '摸牌翻面') {\r\n                            event.target.draw();\r\n                            event.target.turnOver();\r\n                        } else {\r\n                            if (event.target.countDiscardableCards(event.target, 'he') > 0) {\r\n                                event.target.chooseToDiscard('he', 1, true).set('ai', function (card) {\r\n                                    return 6 - get.value(card);\r\n                                });\r\n                            }\r\n                            event.target.loseHp();\r\n                        }\r\n                    }\r\n\r\n                },\r\n                ai: {\r\n                    maixie: true,\r\n                    maixie_hp: true,\r\n                    effect: {\r\n                        target: function (card, player, target) {\r\n                            if (get.tag(card, 'damage')) {\r\n                                if (player.hasSkillTag('jueqing', false, target)) return [1, -1.5];\r\n                                if (target.hp <= 1) return;\r\n                                if (!target.hasFriend()) return;\r\n                                var hastarget = false;\r\n                                var turnfriend = false;\r\n                                var players = game.filterPlayer();\r\n                                for (var i = 0; i < players.length; i++) {\r\n                                    if (get.attitude(target, players[i]) < 0 && !players[i].isTurnedOver()) {\r\n                                        hastarget = true;\r\n                                    }\r\n                                    if (get.attitude(target, players[i]) > 0 && players[i].isTurnedOver()) {\r\n                                        hastarget = true;\r\n                                        turnfriend = true;\r\n                                    }\r\n                                }\r\n                                if (get.attitude(player, target) > 0 && !hastarget) return;\r\n                                if (turnfriend || target.hp == target.maxHp) return [0.5, 1];\r\n                                if (target.hp > 1) return [1, 0.5];\r\n                            }\r\n                        }\r\n                    }\r\n                },\r\n                _priority: 0\r\n            },\r\n            PSxingshang: {\r\n                audio: \"rexingshang\",\r\n                trigger: {\r\n                    global: [\r\n                        \"die\",\r\n                        \"turnOverAfter\"\r\n                    ]\r\n                },\r\n                filter: function (event, player) {\r\n                    return true;\r\n                },\r\n                direct: true,\r\n                forced: true,\r\n                content: function () {\r\n                    \"step 0\"\r\n                    player.logSkill(event.name, trigger.player);\r\n                    if (event.triggername === \"turnOverAfter\") {\r\n                        game.asyncDraw([player, trigger.player]);\r\n                        event.finish();\r\n                        return;\r\n                    }\r\n                    player.recover();\r\n                    var choice = ['视为受到过伤害'];\r\n                    if (trigger.player.countCards('he')) choice.push('获得牌');\r\n                    choice.push('cancel2');\r\n                    player.chooseControl(choice).set('prompt', get.prompt2('PSxingshang')).set('ai', function () {\r\n                        if (choice.length == 2) return choice[0];\r\n                        if (get.value(trigger.player.getCards('he')) > 8) return choice[1];\r\n                        return choice[0];\r\n                    });\r\n                    \"step 1\"\r\n                    if (result.control != 'cancel2') {\r\n                        if (result.control == '获得牌') {\r\n                            event.togain = trigger.player.getCards('he');\r\n                            player.gain(event.togain, trigger.player, 'giveAuto', 'bySelf');\r\n                        }\r\n                        else {\r\n                            player.damage('nosource', 'unreal');\r\n                        }\r\n                    }\r\n                },\r\n                _priority: 0\r\n            }\r\n        },\r\n        sort: sort.PScharacter_wei,\r\n        translate: {\r\n            PScaopi: \"PS曹丕\",\r\n            PSfangzhu: \"放逐\",\r\n            PSfangzhu_info: \"①当你受到伤害后，你可以令一名角色：1.摸一张牌并将武将牌翻面；2.失去一点体力并弃置一张牌。②翻面状态与你不同的角色，在其回合内不能对你使用牌。\",\r\n            PSxingshang: \"行殇\",\r\n            PSxingshang_info: \"锁定技。①当一名角色翻面后，你与其各摸一张牌。②当一名角色死亡时，你回复一点体力并选择一项：1.视为受到过一点伤害；2.获得其所有牌。\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PScaoying: {\r\n        info: {\r\n            sex: \"female\",\r\n            group: \"wei\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PSlingren\",\r\n                \"PSfujian\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“九个鲨雕”设计\",\r\n        skills: {\r\n            PSlingren: {\r\n                audio: \"xinfu_lingren\",\r\n                trigger: {\r\n                    global: \"useCardToTargeted\"\r\n                },\r\n                filter(event, player) {\r\n                    return event.player === player && player.getHistory('useCard', evt => evt.targets.includes(event.target)).length === 1;\r\n                },\r\n                direct: true,\r\n                init: function (player, skill) {\r\n                    if (!player.storage.PSlingren_damage) player.storage.PSlingren_damage = [];\r\n                    if (!player.storage.PSlingren_multi) player.storage.PSlingren_multi = [];\r\n                },\r\n                content() {\r\n                    'step 0'\r\n                    player.logSkill('PSlingren', event.target);\r\n                    var target = trigger.target;\r\n                    event.target = target;\r\n                    event.choice = {\r\n                        basic: false,\r\n                        trick: false,\r\n                        equip: false,\r\n                    }\r\n                    player.chooseButton([`凌人：是否猜测${get.translation(target)}有哪些类别的手牌`, [['basic', 'trick', 'equip'], 'vcard']], [0, 3], false).set('ai', function (button) {\r\n                        switch (button.link[2]) {\r\n                            case 'basic':\r\n                                var rand = 0.95;\r\n                                if (!target.countCards('h', { type: ['basic'] })) rand = 0.05;\r\n                                if (!target.countCards('h')) rand = 0;\r\n                                return Math.random() < rand ? true : false;\r\n                            case 'trick':\r\n                                var rand = 0.9;\r\n                                if (!target.countCards('h', { type: ['trick', 'delay'] })) rand = 0.1;\r\n                                if (!target.countCards('h')) rand = 0;\r\n                                return Math.random() < rand ? true : false;\r\n                            case 'equip':\r\n                                var rand = 0.75;\r\n                                if (!target.countCards('h', { type: ['equip'] })) rand = 0.25;\r\n                                if (!target.countCards('h')) rand = 0;\r\n                                return Math.random() < rand ? true : false;\r\n                        }\r\n                    })\r\n                    'step 1'\r\n                    if (result.bool) {\r\n                        var choices = result.links.map(i => i[2]);\r\n                        if (!event.isMine() && !event.isOnline()) game.delayx();\r\n                        var list = [];\r\n                        event.num = 0;\r\n                        ['basic', 'trick', 'equip'].forEach(type => {\r\n                            if (choices.includes(type) == target.countCards('h', card => get.type2(card, target) === type) > 0) event.num++;\r\n                        })\r\n                    } else {\r\n                        event.finish();\r\n                    }\r\n                    'step 2'\r\n                    player.popup('猜对' + get.cnNumber(event.num) + '项');\r\n                    game.log(player, '猜对了' + get.cnNumber(event.num) + '项');\r\n                    const num = event.num;\r\n                    if (num >= 0) {\r\n                        player.draw(2);\r\n                    }\r\n                    if (num >= 1) {\r\n                        player.addTempSkill('PSlingren_damage');\r\n                        player.storage.PSlingren_damage.push(target);\r\n                    }\r\n                    if (num >= 2) {\r\n                        player.addTempSkill('PSlingren_multi', { global: \"roundStart\" });\r\n                        player.storage.PSlingren_multi.push(target);\r\n                    }\r\n                    if (num >= 3) {\r\n                        const skill = lib.skill[event.name].getSkill(player);\r\n                        if (skill !== void 0) {\r\n                            const audioName = ['lingren_xingshang', 'lingren_jianxiong'].randomGet();\r\n                            game.changeSkillAudio(skill, player.name, audioName);\r\n                            player.popup(skill);\r\n                            player.addTempSkill(skill, { player: \"phaseBegin\" });\r\n                        }\r\n                    }\r\n                },\r\n                getSkill: function (player) {\r\n                    var list, skills = [];\r\n                    const banned = [];\r\n                    if (get.mode() == 'guozhan') {\r\n                        list = [];\r\n                        for (var i in lib.characterPack.mode_guozhan) list.push(i);\r\n                    }\r\n                    else if (_status.connectMode) list = get.charactersOL();\r\n                    else {\r\n                        list = [];\r\n                        for (var i in lib.character) {\r\n                            if (lib.filter.characterDisabled2(i) || lib.filter.characterDisabled(i)) continue;\r\n                            list.push(i);\r\n                        }\r\n                    }\r\n                    list = list.filter(char => lib.character[char][4].includes(\"zhu\") && lib.character[char][1] === \"wei\");\r\n                    for (var i of list) {\r\n                        if (i.indexOf('gz_jun') == 0) continue;\r\n                        for (var j of lib.character[i][3]) {\r\n                            var skill = lib.skill[j];\r\n                            if (!skill || banned.includes(j)) continue;\r\n                            if (skill.ai && (skill.ai.combo || skill.ai.notemp || skill.ai.neg)) continue;\r\n                            if (!player.hasSkill(j)) skills.push(j);\r\n                        }\r\n                    }\r\n                    return skills.randomGet();\r\n                },\r\n                subSkill: {\r\n                    damage: {\r\n                        trigger: {\r\n                            source: \"damageBegin1\"\r\n                        },\r\n                        direct: true,\r\n                        popup: false,\r\n                        onremove: function (player, skill) {\r\n                            player.storage.PSlingren_damage = [];\r\n                        },\r\n                        filter: function (event, player) {\r\n                            return player.storage.PSlingren_damage && player.storage.PSlingren_damage.includes(event.player);\r\n                        },\r\n                        async content(event, trigger, player) {\r\n                            const list = ['令此伤害+1', '令此伤害-1', 'cancel2'];\r\n                            const { result: { control } } = await player.chooseControl(list)\r\n                                .set('prompt', `凌人：是否改变对${get.translation(trigger.player)}造成的伤害？`)\r\n                                .set('ai', function () {\r\n                                    const att = get.attitude(_status.event.player, trigger.player);\r\n                                    if (att == 0) return 'cancel2';\r\n                                    if (att > 0) return '令此伤害-1';\r\n                                    return '令此伤害+1';\r\n                                });\r\n                            if (control === '令此伤害+1') trigger.num++;\r\n                            else if (control === '令此伤害-1') trigger.num--;\r\n                        }\r\n                    },\r\n                    multi: {\r\n                        trigger: {\r\n                            global: \"roundStart\"\r\n                        },\r\n                        forced: true,\r\n                        popup: false,\r\n                        onremove: function (player, skill) {\r\n                            player.storage.PSlingren_multi = [];\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            PSfujian: {\r\n                audio: \"xinfu_fujian\",\r\n                trigger: {\r\n                    player: \"phaseJieshuBegin\"\r\n                },\r\n                filter: function (event, player) {\r\n                    return game.hasPlayer(function (current) {\r\n                        return current.countCards('h') !== 0 && current !== player;\r\n                    });\r\n                },\r\n                locked: true,\r\n                async content(event, trigger, player) {\r\n                    const filter = function (target) {\r\n                        return target.countCards('h') !== 0 && player.storage.PSlingren_multi && !player.storage.PSlingren_multi.includes(target) && target !== player;\r\n                    }\r\n                    let Targets = (player.storage.PSlingren_multi || []).slice(0).remove(player);\r\n                    const players = game.filterPlayer(current => filter(current));\r\n                    if (players.length === 1) Targets.addArray(players);\r\n                    else if (players.length > 1) {\r\n                        const { result: { targets } } = await player.chooseTarget(function (card, player, target) {\r\n                            return players.includes(target);\r\n                        }, true).set('ai', function (target) {\r\n                            if (get.attitude(_status.event.player, target) < 0) return 100;\r\n                            return 1;\r\n                        });\r\n                        Targets.addArray(targets);\r\n                    }\r\n                    Targets = Targets.filter(current => current.isAlive() && current.isIn()).sortBySeat();\r\n                    for (let target of Targets) {\r\n                        const num = Math.abs(player.hp - target.hp) || 1;\r\n                        var cards = target.getCards('h').randomGets(num);\r\n                        player.line(target);\r\n                        var content = [get.translation(target) + '的部分手牌', cards];\r\n                        game.log(player, '观看了', target, '的部分手牌');\r\n                        await player.chooseControl('ok').set('dialog', content);\r\n                    }\r\n                },\r\n                _priority: 0\r\n            }\r\n        },\r\n        sort: sort.PScharacter_wei,\r\n        translate: {\r\n            PScaoying: \"PS曹婴\",\r\n            PSlingren: \"凌人\",\r\n            PSlingren_info: \"当一名角色于本回合首次成为你使用牌的目标后，你可以猜测其手牌构成，若猜对：<br>至少0项，你摸两张牌；<br>至少1项，本回合你对其造成伤害时，你可以令此伤害+1或-1；<br>至少2项，直到下一轮开始时，你发动〖伏间〗额外指定其为目标；<br>至少3项，你随机获得魏势力主公武将牌上的一个技能，直到你的回合开始。\",\r\n            PSfujian: \"伏间\",\r\n            PSfujian_info: \"锁定技，结束阶段开始时，你可以观看一名其他角色的随机X张手牌（X为你与其的体力之差且至少为1）。\"\r\n        },\r\n        rank: rank.epic\r\n    },\r\n    PSdian_huanggai: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"wu\",\r\n            hp: 4,\r\n            skills: [\r\n                \"kurou\",\r\n                \"PSshiming\"\r\n            ],\r\n            dieAudios: [\r\n                \"huanggai\"\r\n            ],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“九个陈皮”设计\",\r\n        skills: {\r\n            PSshiming: {\r\n                audio: \"sbkurou\",\r\n                trigger: {\r\n                    player: \"dying\"\r\n                },\r\n                usable: 1,\r\n                forced: true,\r\n                init: function (player) {\r\n                    game.changeSkillAudio(\"xinfu_qinguo\", player.name, \"zhaxiang\");\r\n                    game.changeSkillAudio(\"xinfu_qinguo_recover\", player.name, \"zhaxiang\");\r\n                    game.changeSkillAudio(\"new_repaoxiao\", player.name, \"sbzhaxiang\");\r\n                    game.changeSkillAudio(\"buqu\", player.name, \"rekurou\");\r\n                },\r\n                derivation: [\r\n                    \"xinfu_qinguo\",\r\n                    \"new_repaoxiao\",\r\n                    \"buqu\"\r\n                ],\r\n                filter: function (event, player) {\r\n                    return player.maxHp > 1;\r\n                },\r\n                content: function () {\r\n                    player.loseMaxHp();\r\n                    player.recover();\r\n                    for (var i of lib.skill.PSshiming.derivation) {\r\n                        if (!player.hasSkill(i, null, null, false)) {\r\n                            player.popup(i);\r\n                            player.addSkills(i);\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_wu,\r\n        translate: {\r\n            PSdian_huanggai: \"PS经典黄盖\",\r\n            PSdian_huanggai_prefix: \"PS经典\",\r\n            PSshiming: \"拾命\",\r\n            PSshiming_info: \"锁定技，每回合限一次，当你进入濒死状态时，若你的体力上限大于1，你减1点体力上限并回复一点体力，获得第一个你未拥有的技能:〖勤国〗、〖咆哮〗、〖不屈〗。\"\r\n        },\r\n        rank: rank.legend\r\n    },\r\n    PSliaohua: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"shu\",\r\n            hp: 5,\r\n            maxHp: 6,\r\n            skills: [\r\n                \"PSdangxian\",\r\n                \"PSfuli\"\r\n            ],\r\n            dieAudios: [\r\n                \"xin_liaohua\"\r\n            ],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“mento last”设计\",\r\n        skills: {\r\n            PSdangxian: {\r\n                audio: \"dangxian_re_liaohua1\",\r\n                trigger: {\r\n                    player: \"phaseBegin\"\r\n                },\r\n                forced: true,\r\n                content: function () {\r\n                    trigger.phaseList.splice(trigger.num, 0, 'phaseDraw|xindangxian', 'phaseUse|xindangxian');\r\n                },\r\n                group: [\r\n                    \"PSdangxian_rewrite\",\r\n                    \"PSdangxian_end\"\r\n                ],\r\n                subSkill: {\r\n                    rewrite: {\r\n                        trigger: {\r\n                            player: [\r\n                                \"phaseDrawBegin\",\r\n                                \"phaseUseBegin\"\r\n                            ]\r\n                        },\r\n                        forced: true,\r\n                        popup: false,\r\n                        filter: function (event, player) {\r\n                            return true;\r\n                        },\r\n                        content() {\r\n                            'step 0'\r\n                            var card = get.cardPile2(function (card) {\r\n                                return card.name == 'sha';\r\n                            });\r\n                            if (card) player.gain(card, 'gain2').gaintag = ['PSdangxian'];\r\n                            'step 1'\r\n                            game.updateRoundNumber();\r\n                        },\r\n                        mod: {\r\n                            ignoredHandcard: function (card, player) {\r\n                                if (card.hasGaintag('PSdangxian')) {\r\n                                    return true;\r\n                                }\r\n                            },\r\n                            cardDiscardable: function (card, player, name) {\r\n                                if (name == 'phaseDiscard' && card.hasGaintag('PSdangxian')) {\r\n                                    return false;\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    end: {\r\n                        audio: \"dangxian_re_liaohua1\",\r\n                        trigger: {\r\n                            player: \"phaseEnd\"\r\n                        },\r\n                        forced: true,\r\n                        popup: false,\r\n                        filter: function (event, player) {\r\n                            return player.countCards('h', card => card.hasGaintag('PSdangxian')) > 0;\r\n                        },\r\n                        async content(event, trigger, player) {\r\n                            const hs = player.getCards('h', card => card.hasGaintag('PSdangxian'));\r\n                            await player.discard(hs);\r\n                            await player.loseHp(hs.length);\r\n                            const list = get.inpileVCardList(info => {\r\n                                if (info[0] != 'trick') return false;\r\n                                var name = info[2];\r\n                                return get.tag({ name: name }, 'damage') > 0 && player.hasUseTarget({ name: name, isCard: true });\r\n                            });\r\n                            if (list.length) {\r\n                                const { result: { bool, links } } = await player.chooseButton(['当先：视为使用一张伤害类锦囊牌', [list, 'vcard']], true).set('ai', button => {\r\n                                    return get.player().getUseValue({ name: button.link[2] });\r\n                                });\r\n                                if (bool) {\r\n                                    var name = links[0][2];\r\n                                    player.chooseUseTarget({ name: name, isCard: true }, true, false).logSkill = 'PSdangxian';\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            PSfuli: {\r\n                skillAnimation: true,\r\n                animationColor: \"soil\",\r\n                audio: \"refuli\",\r\n                enable: \"chooseToUse\",\r\n                filter: function (event, player) {\r\n                    if (event.type != 'dying') return false;\r\n                    if (player != event.dying) return false;\r\n                    if (player.maxHp <= 1) return false;\r\n                    if (player.hasSkill('PSfuli_used')) return false;\r\n                    return true;\r\n                },\r\n                async content(event, trigger, player) {\r\n                    await player.loseMaxHp();\r\n                    const hs = player.getCards('h', card => card.hasGaintag('PSdangxian'));\r\n                    if (hs.length) await player.discard(hs);\r\n                    await player.recoverTo(player.maxHp);\r\n                    player.addTempSkill('PSfuli_used', 'roundStart');\r\n                    const next = game.createEvent('chooseToAddSkill');\r\n                    next.player = player;\r\n                    next.setContent(lib.skill.PSfuli.chooseToAddSkill);\r\n                    if (!player.isTurnedOver()) await player.turnOver();\r\n                },\r\n                chooseToAddSkill() {\r\n                    'step 0'\r\n                    var list;\r\n                    if (_status.characterlist) {\r\n                        list = [];\r\n                        for (var i = 0; i < _status.characterlist.length; i++) {\r\n                            var name = _status.characterlist[i];\r\n                            if (true/* lib.character[name][1] == 'shu' */) list.push(name);\r\n                        }\r\n                    }\r\n                    else if (_status.connectMode) {\r\n                        list = get.charactersOL(function (i) {\r\n                            return true;\r\n                            // return lib.character[i][1] != 'shu';\r\n                        });\r\n                    }\r\n                    else {\r\n                        list = get.gainableCharacters(function (info) {\r\n                            return true;\r\n                            // return info[1] == 'shu';\r\n                        });\r\n                    }\r\n                    var players = game.players.concat(game.dead);\r\n                    for (var i = 0; i < players.length; i++) {\r\n                        list.remove(players[i].name);\r\n                        list.remove(players[i].name1);\r\n                        list.remove(players[i].name2);\r\n                    }\r\n                    list = list.randomGets(5);\r\n                    var skills = [];\r\n                    for (var i of list) {\r\n                        skills.addArray((lib.character[i][3] || []).filter(function (skill) {\r\n                            var info = get.info(skill);\r\n                            return info && !info.charlotte;\r\n                        }));\r\n                    }\r\n                    if (!list.length || !skills.length) {\r\n                        event.result = {\r\n                            bool: false,\r\n                            skills: [],\r\n                        };\r\n                        return;\r\n                    }\r\n                    if (player.isUnderControl()) {\r\n                        game.swapPlayerAuto(player);\r\n                    }\r\n                    var switchToAuto = function () {\r\n                        _status.imchoosing = false;\r\n                        event._result = {\r\n                            bool: true,\r\n                            skills: skills.randomGets(1),\r\n                        };\r\n                        if (event.dialog) event.dialog.close();\r\n                        if (event.control) event.control.close();\r\n                    };\r\n                    var chooseButton = function (list, skills) {\r\n                        var event = _status.event;\r\n                        if (!event._result) event._result = {};\r\n                        event._result.skills = [];\r\n                        var rSkill = event._result.skills;\r\n                        var dialog = ui.create.dialog('请选择获得一个技能', [list, 'character'], 'hidden');\r\n                        event.dialog = dialog;\r\n                        var table = document.createElement('div');\r\n                        table.classList.add('add-setting');\r\n                        table.style.margin = '0';\r\n                        table.style.width = '100%';\r\n                        table.style.position = 'relative';\r\n                        for (var i = 0; i < skills.length; i++) {\r\n                            var td = ui.create.div('.shadowed.reduce_radius.pointerdiv.tdnode');\r\n                            td.link = skills[i];\r\n                            table.appendChild(td);\r\n                            td.innerHTML = '<span>' + get.translation(skills[i]) + '</span>';\r\n                            td.addEventListener(lib.config.touchscreen ? 'touchend' : 'click', function () {\r\n                                if (_status.dragged) return;\r\n                                if (_status.justdragged) return;\r\n                                _status.tempNoButton = true;\r\n                                setTimeout(function () {\r\n                                    _status.tempNoButton = false;\r\n                                }, 500);\r\n                                var link = this.link;\r\n                                if (!this.classList.contains('bluebg')) {\r\n                                    if (rSkill.length >= 1) return;\r\n                                    rSkill.add(link);\r\n                                    this.classList.add('bluebg');\r\n                                }\r\n                                else {\r\n                                    this.classList.remove('bluebg');\r\n                                    rSkill.remove(link);\r\n                                }\r\n                            });\r\n                        }\r\n                        dialog.content.appendChild(table);\r\n                        dialog.add('　　');\r\n                        dialog.open();\r\n\r\n                        event.switchToAuto = function () {\r\n                            event.dialog.close();\r\n                            event.control.close();\r\n                            game.resume();\r\n                            _status.imchoosing = false;\r\n                        };\r\n                        event.control = ui.create.control('ok', function (link) {\r\n                            event.dialog.close();\r\n                            event.control.close();\r\n                            game.resume();\r\n                            _status.imchoosing = false;\r\n                        });\r\n                        for (var i = 0; i < event.dialog.buttons.length; i++) {\r\n                            event.dialog.buttons[i].classList.add('selectable');\r\n                        }\r\n                        game.pause();\r\n                        game.countChoose();\r\n                    };\r\n                    if (event.isMine()) {\r\n                        chooseButton(list, skills);\r\n                    }\r\n                    else if (event.isOnline()) {\r\n                        event.player.send(chooseButton, list, skills);\r\n                        event.player.wait();\r\n                        game.pause();\r\n                    }\r\n                    else {\r\n                        switchToAuto();\r\n                    }\r\n                    'step 1'\r\n                    var map = event.result || result;\r\n                    if (map.skills && map.skills.length) {\r\n                        player.popup(map.skills);\r\n                        player.addSkills(map.skills);\r\n                    }\r\n                },\r\n                subSkill: {\r\n                    used: {\r\n                        locked: true,\r\n                        charlotte: true\r\n                    }\r\n                },\r\n                ai: {\r\n                    save: true,\r\n                    skillTagFilter: function (player, arg, target) {\r\n                        return player == target && player.maxHp > 1;\r\n                    },\r\n                    result: {\r\n                        player: 10\r\n                    },\r\n                    threaten: function (player, target) {\r\n                        if (!target.storage.fuli) return 0.9;\r\n                    }\r\n                },\r\n                _priority: 0\r\n            }\r\n        },\r\n        sort: sort.PScharacter_shu,\r\n        translate: {\r\n            PSliaohua: \"PS廖化\",\r\n            PSdangxian: \"当先\",\r\n            PSdangxian_info: \"锁定技，回合开始时，你执行一个额外的摸牌阶段和出牌阶段。摸牌阶段和出牌阶段开始时，你从牌堆中获得一张不计入手牌上限【杀】并记录之。结束阶段，若你有“当先”记录过的杀，弃置之并失去X点体力，然后视为使用一张伤害类锦囊牌。（X为“当先“记录过的杀的数量）\",\r\n            PSfuli: \"伏枥\",\r\n            PSfuli_info: \"每轮限一次，当你处于濒死状态时，你可以减一点体力上限并弃置“当先”记录过的【杀】，再将体力回复至体力上限，然后随机抽取五张武将牌并获得其中一个技能。最后若你的武将牌正面朝上，你翻面。\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PSquyi: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"qun\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PSjiaozi\",\r\n                \"PSfuqi\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“九个陈皮”设计\",\r\n        skills: {\r\n            PSjiaozi: {\r\n                audio: \"jiaozi\",\r\n                trigger: {\r\n                    player: \"damageBegin3\",\r\n                    source: \"damageBegin1\"\r\n                },\r\n                forced: true,\r\n                filter: function (event, player) {\r\n                    if (!event.source) return false;\r\n                    const target = event.source === player ? event.player : event.source;\r\n                    return player.countCards('h') >= target.countCards('h');\r\n                },\r\n                content: function () {\r\n                    trigger.num++;\r\n                },\r\n                ai: {\r\n                    presha: true\r\n                },\r\n                group: \"PSjiaozi_else\",\r\n                subSkill: {\r\n                    else: {\r\n                        audio: \"jiaozi\",\r\n                        trigger: {\r\n                            player: [\r\n                                \"phaseBegin\",\r\n                                \"phaseDiscardBegin\"\r\n                            ]\r\n                        },\r\n                        forced: true,\r\n                        content() {\r\n                            const num = game.countPlayer(current => current.hp <= player.hp);\r\n                            if (event.triggername === \"phaseBegin\") {\r\n                                player.draw(num);\r\n                            } else {\r\n                                player.chooseToDiscard('he', num, true);\r\n                            }\r\n                        }\r\n                    }\r\n                },\r\n                _priority: 0\r\n            },\r\n            PSfuqi: {\r\n                audio: \"fuqi\",\r\n                forced: true,\r\n                trigger: {\r\n                    player: \"useCard\"\r\n                },\r\n                filter: function (event, player) {\r\n                    return event.card && (get.type(event.card) == 'trick' || get.type(event.card) == 'basic' && !['shan', 'tao', 'jiu', 'du'].includes(event.card.name)) && game.hasPlayer(function (current) {\r\n                        return current != player && get.distance(current, player) <= 1;\r\n                    });\r\n                },\r\n                content: function () {\r\n                    trigger.directHit.addArray(game.filterPlayer(function (current) {\r\n                        return current != player && get.distance(current, player) <= 1;\r\n                    }));\r\n                },\r\n                ai: {\r\n                    directHit_ai: true,\r\n                    skillTagFilter: function (player, tag, arg) {\r\n                        return get.distance(arg.target, player) <= 1;\r\n                    }\r\n                },\r\n                mod: {\r\n                    globalFrom: function (from, to, distance) {\r\n                        if (get.distance(to, from) <= 1) return -Infinity;\r\n                    }\r\n                },\r\n                _priority: 0\r\n            }\r\n        },\r\n        sort: sort.PScharacter_qun,\r\n        translate: {\r\n            PSquyi: \"PS麴义\",\r\n            PSjiaozi: \"骄恣\",\r\n            PSjiaozi_info: \"锁定技。①当你造成或受到伤害时，若你的手牌数不小于对方，此伤害+1。②回合开始时/弃牌阶段开始时，你摸/弃置X张牌（X为场上体力值不大于你的角色数）。\",\r\n            PSfuqi: \"伏骑\",\r\n            PSfuqi_info: \"锁定技。①当你使用牌时，你令所有与你距离为1的其他角色不能使用或打出牌响应此牌。②你与所有与你距离为1的角色的距离视为1。\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PSmachao: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"shu\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PStieji\",\r\n                \"PScema\"\r\n            ],\r\n            dieAudios: [\r\n                \"sb_machao\"\r\n            ],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“九个芒果”设计\",\r\n        replace: [\r\n            \"PSmachao\",\r\n            \"PSqun_machao\"\r\n        ],\r\n        skills: {\r\n            PStieji: {\r\n                audio: \"sbtieji\",\r\n                trigger: {\r\n                    player: \"useCardToPlayered\"\r\n                },\r\n                logTarget: \"target\",\r\n                filter: function (event, player) {\r\n                    return player != event.target && event.card.name == 'sha' && event.target.isIn();\r\n                },\r\n                check: function (event, player) {\r\n                    return get.attitude(player, event.target) < 0;\r\n                },\r\n                content: function () {\r\n                    'step 0'\r\n                    var target = trigger.target;\r\n                    event.target = target;\r\n                    if (!target.hasSkill('fengyin')) target.addTempSkill('fengyin');\r\n                    trigger.directHit.add(target);\r\n                    if (player.hasHistory('custom', evt => evt.PStieji_target === target)) {\r\n                        event.finish();\r\n                        return;\r\n                    }\r\n                    player.chooseToDuiben(target).set('title', '谋弈').set('namelist', [\r\n                        '出阵迎战', '拱卫中军', '直取敌营', '扰阵疲敌'\r\n                    ])\r\n                        .set('ai', button => {\r\n                            var source = get.event().getParent().player, target = get.event().getParent().target;\r\n                            if (!target.countCards('he') && button.link[2] == 'db_def2') return 10;\r\n                            if (!target.countCards('he') && get.attitude(target, source) <= 0 && button.link[2] == 'db_atk1') return 10;\r\n                            return 1 + Math.random();\r\n                        })\r\n                        .set('translationList',\r\n                            [\r\n                                `以防止${get.translation(player)}摸两张牌`,\r\n                                `以防止${get.translation(player)}获得你的牌`,\r\n                                `若成功，你获得${get.translation(target)}的一张牌`,\r\n                                `若成功，你摸两张牌`,\r\n                            ]\r\n                        );\r\n                    'step 1'\r\n                    if (result.bool) {\r\n                        target.addTempSkill('fengyin', { player: \"phaseEnd\" });\r\n                        player.addTempSkill('PStieji_mark');\r\n                        player.addMark('PStieji_mark', 1, false);\r\n                        if (result.player == 'db_def1') player.gainPlayerCard(target, 'he', true);\r\n                        else player.draw(2);\r\n                    } else {\r\n                        event.choice = result.player;\r\n                        const str = event.choice === 'db_def1' ? '摸两张牌' : `获得${get.translation(target)}的一张牌`;\r\n                        player.chooseBool(`是否${str}？然后你本回合对${get.translation(target)}发动〖铁骑〗时不能与其进行谋弈`)\r\n                            .set('ai', (event, player) => {\r\n                                if (!player.isPhaseUsing()) return true;\r\n                                const evt = event.getParent('chooseToUse');\r\n                                if (evt && evt.getParent().name === 'phaseUse' && evt.filterCard({ name: 'sha' }, player, evt) && player.countCards('hs', 'sha')) return false;\r\n                                return _status.event.canGain;\r\n                            })\r\n                            .set('canGain', result.player === 'db_def1' || result.player === 'db_def2' && target.countDiscardableCards(player, 'he') > 0);\r\n                    }\r\n                    'step 2'\r\n                    if (event.choice && result.bool && result.confirm) {\r\n                        player.getHistory('custom').push({ PStieji_target: target });\r\n                        if (event.choice === 'db_def1') player.draw(2);\r\n                        else player.gainPlayerCard(target, 'he', true);\r\n                    }\r\n                },\r\n                shaRelated: true,\r\n                ai: {\r\n                    ignoreSkill: true,\r\n                    skillTagFilter: function (player, tag, arg) {\r\n                        if (tag == 'directHit_ai') {\r\n                            return get.attitude(player, arg.target) <= 0;\r\n                        }\r\n                        if (!arg || arg.isLink || !arg.card || arg.card.name != 'sha') return false;\r\n                        if (!arg.target || get.attitude(player, arg.target) >= 0) return false;\r\n                        if (!arg.skill || !lib.skill[arg.skill] || lib.skill[arg.skill].charlotte || get.is.locked(arg.skill) || !arg.target.getSkills(true, false).includes(arg.skill)) return false;\r\n                    },\r\n                    directHit_ai: true\r\n                },\r\n                subSkill: {\r\n                    true1: {\r\n                        audio: true,\r\n                        sub: true,\r\n                        _priority: 0\r\n                    },\r\n                    true2: {\r\n                        audio: true,\r\n                        sub: true,\r\n                        _priority: 0\r\n                    },\r\n                    false: {\r\n                        audio: true,\r\n                        sub: true,\r\n                        _priority: 0\r\n                    },\r\n                    mark: {\r\n                        mod: {\r\n                            cardUsable: function (card, player, num) {\r\n                                if (card.name == 'sha') return num + player.countMark('PStieji_mark');\r\n                            }\r\n                        },\r\n                        charlotte: true,\r\n                        onremove: true,\r\n                        _priority: 0\r\n                    }\r\n                },\r\n                audioname2: {\r\n                    PSshengui: \"retieji_boss_lvbu3\"\r\n                },\r\n                _priority: 0\r\n            },\r\n            PScema: {\r\n                mod: {\r\n                    globalFrom: function (from, to, distance) {\r\n                        return distance - 1;\r\n                    }\r\n                },\r\n                enable: [\r\n                    \"chooseToRespond\",\r\n                    \"chooseToUse\"\r\n                ],\r\n                filterCard: function (card, player) {\r\n                    return get.subtype(card) == 'equip3' || get.subtype(card) == 'equip4' || get.subtype(card) == 'equip6';\r\n                },\r\n                position: \"hes\",\r\n                viewAs: {\r\n                    name: \"sha\"\r\n                },\r\n                shaRelated: true,\r\n                locked: true,\r\n                viewAsFilter(player) {\r\n                    if (!player.countCards('hes', card => {\r\n                        return get.subtype(card) == 'equip3' || get.subtype(card) == 'equip4' || get.subtype(card) == 'equip6'\r\n                    })) return false;\r\n                },\r\n                prompt: \"将一张坐骑牌当杀使用或打出\",\r\n                check: function (card) {\r\n                    const val = get.value(card);\r\n                    if (_status.event.name == 'chooseToRespond') return 1 / Math.max(0.1, val);\r\n                    return 5 - val;\r\n                },\r\n                precontent() {\r\n                    player.when('useCard1')\r\n                        .assign({\r\n                            firstDo: true,\r\n                        })\r\n                        .filter(evt => evt.skill === 'PScema' && evt.card.name === 'sha')\r\n                        .then(() => {\r\n                            trigger.baseDamage = 2;\r\n                        });\r\n                },\r\n                ai: {\r\n                    skillTagFilter(player) {\r\n                        if (!player.countCards('hes', card => {\r\n                            return get.subtype(card) == 'equip3' || get.subtype(card) == 'equip4' || get.subtype(card) == 'equip6'\r\n                        })) return false;\r\n                    },\r\n                    respondSha: true,\r\n                    yingbian: function (card, player, targets, viewer) {\r\n                        if (get.attitude(viewer, player) <= 0) return 0;\r\n                        var base = 0, hit = false;\r\n                        if (get.cardtag(card, 'yingbian_hit')) {\r\n                            hit = true;\r\n                            if (targets.some(target => {\r\n                                return target.mayHaveShan(viewer, 'use', target.getCards('h', i => {\r\n                                    return i.hasGaintag('sha_notshan');\r\n                                })) && get.attitude(viewer, target) < 0 && get.damageEffect(target, player, viewer, get.natureList(card)) > 0;\r\n                            })) base += 5;\r\n                        }\r\n                        if (get.cardtag(card, 'yingbian_add')) {\r\n                            if (game.hasPlayer(function (current) {\r\n                                return !targets.includes(current) && lib.filter.targetEnabled2(card, player, current) && get.effect(current, card, player, player) > 0;\r\n                            })) base += 5;\r\n                        }\r\n                        if (get.cardtag(card, 'yingbian_damage')) {\r\n                            if (targets.some(target => {\r\n                                return get.attitude(player, target) < 0 && (hit || !target.mayHaveShan(viewer, 'use', target.getCards('h', i => {\r\n                                    return i.hasGaintag('sha_notshan');\r\n                                })) || player.hasSkillTag('directHit_ai', true, {\r\n                                    target: target,\r\n                                    card: card,\r\n                                }, true)) && !target.hasSkillTag('filterDamage', null, {\r\n                                    player: player,\r\n                                    card: card,\r\n                                    jiu: true,\r\n                                })\r\n                            })) base += 5;\r\n                        }\r\n                        return base;\r\n                    },\r\n                    canLink: function (player, target, card) {\r\n                        if (!target.isLinked() && !player.hasSkill('wutiesuolian_skill')) return false;\r\n                        if (player.hasSkill('jueqing') || player.hasSkill('gangzhi') || target.hasSkill('gangzhi')) return false;\r\n                        return true;\r\n                    },\r\n                    basic: {\r\n                        useful: [\r\n                            5,\r\n                            3,\r\n                            1\r\n                        ],\r\n                        value: [\r\n                            5,\r\n                            3,\r\n                            1\r\n                        ]\r\n                    },\r\n                    order: function (item, player) {\r\n                        if (player.hasSkillTag('presha', true, null, true)) return 10;\r\n                        if (typeof item === 'object' && game.hasNature(item, 'linked')) {\r\n                            if (game.hasPlayer(function (current) {\r\n                                return current != player && lib.card.sha.ai.canLink(player, current, item) && player.canUse(item, current, null, true) && get.effect(current, item, player, player) > 0;\r\n                            }) && game.countPlayer(function (current) {\r\n                                return current.isLinked() && get.damageEffect(current, player, player, get.nature(item)) > 0;\r\n                            }) > 1) return 3.1;\r\n                            return 3;\r\n                        }\r\n                        return 3.05;\r\n                    },\r\n                    result: {\r\n                        target: function (player, target, card, isLink) {\r\n                            let eff = -1.5, odds = 1.35, num = 1;\r\n                            if (isLink) {\r\n                                let cache = _status.event.getTempCache('sha_result', 'eff');\r\n                                if (typeof cache !== 'object' || cache.card !== get.translation(card)) return eff;\r\n                                if (cache.odds < 1.35 && cache.bool) return 1.35 * cache.eff;\r\n                                return cache.odds * cache.eff;\r\n                            }\r\n                            if (player.hasSkill('jiu') || player.hasSkillTag('damageBonus', true, {\r\n                                target: target,\r\n                                card: card\r\n                            })) {\r\n                                if (target.hasSkillTag('filterDamage', null, {\r\n                                    player: player,\r\n                                    card: card,\r\n                                    jiu: true,\r\n                                })) eff = -0.5;\r\n                                else {\r\n                                    num = 2;\r\n                                    if (get.attitude(player, target) > 0) eff = -7;\r\n                                    else eff = -4;\r\n                                }\r\n                            }\r\n                            if (!player.hasSkillTag('directHit_ai', true, {\r\n                                target: target,\r\n                                card: card,\r\n                            }, true)) odds -= 0.7 * target.mayHaveShan(player, 'use', target.getCards('h', i => {\r\n                                return i.hasGaintag('sha_notshan');\r\n                            }), 'odds');\r\n                            _status.event.putTempCache('sha_result', 'eff', {\r\n                                bool: target.hp > num && get.attitude(player, target) > 0,\r\n                                card: get.translation(card),\r\n                                eff: eff,\r\n                                odds: odds\r\n                            });\r\n                            return odds * eff;\r\n                        }\r\n                    },\r\n                    tag: {\r\n                        respond: 1,\r\n                        respondShan: 1,\r\n                        damage: function (card) {\r\n                            if (game.hasNature(card, 'poison')) return;\r\n                            return 2;\r\n                        },\r\n                        natureDamage: function (card) {\r\n                            if (game.hasNature(card, 'linked')) return 2;\r\n                        },\r\n                        fireDamage: function (card, nature) {\r\n                            if (game.hasNature(card, 'fire')) return 2;\r\n                        },\r\n                        thunderDamage: function (card, nature) {\r\n                            if (game.hasNature(card, 'thunder')) return 2;\r\n                        },\r\n                        poisonDamage: function (card, nature) {\r\n                            if (game.hasNature(card, 'poison')) return 2;\r\n                        }\r\n                    }\r\n                },\r\n                _priority: 0\r\n            }\r\n        },\r\n        sort: sort.PScharacter_shu,\r\n        translate: {\r\n            PSmachao: \"PS马超\",\r\n            PStieji: \"铁骑\",\r\n            PStieji_info: \"当你使用【杀】指定其他角色为目标后，你可以令目标角色不能响应此【杀】，且其非锁定技失效直到回合结束。然后你与其进行谋弈。<br>若你赢，你本回合使用的【杀】次数上限+1，且其非锁定技失效的效果延续至其回合结束。然后你选择的选项为:“直取敌营”，则你获得其一张牌:“扰阵疲敌”，你摸两张牌。<br>若你没赢，你可以执行你选择的另一项，若如此做，你本回合对其发动此技能时不能与其进行谋弈。\",\r\n            PScema: \"策马\",\r\n            PScema_info: \"锁定技，你计算与其他角色的距离时-1，你可以将一张坐骑牌当作伤害基数为2的【杀】使用或打出。\"\r\n        },\r\n        rank: rank.epic\r\n    },\r\n    PSqun_machao: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"qun\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PSzhuiming\",\r\n                \"PSjinge\"\r\n            ],\r\n            dieAudios: [\r\n                \"sp_machao\"\r\n            ],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“九个陈皮”设计\",\r\n        skills: {\r\n            PSzhuiming: {\r\n                audio: \"ol_shichou\",\r\n                trigger: {\r\n                    player: \"useCardToPlayer\"\r\n                },\r\n                shaRelated: true,\r\n                filter: function (event, player) {\r\n                    return event.card.name == 'sha' && get.distance(player, event.target) === 1;\r\n                },\r\n                check: function (event, player) {\r\n                    return get.attitude(player, event.target) <= 0;\r\n                },\r\n                content() {\r\n                    'step 0'\r\n                    const target = trigger.target;\r\n                    event.target = target;\r\n                    var choices = ['选项一'], choiceList = [\r\n                        `令${get.translation(trigger.card)}无视你的防具、对你造成伤害+1，且你不能响应`,\r\n                        `你获得${get.translation(trigger.cards)}，然后${get.translation(player)}获得你两张牌`,\r\n                    ];\r\n                    if (target.countGainableCards(player, 'he')) choices.push('选项二');\r\n                    else choiceList[1] = '<span style=\"opacity:0.5; \">' + choiceList[1] + '</span>';\r\n\r\n                    if (choices.length === 1) event._result = { control: '选项一', index: 0 };\r\n                    else target.chooseControl(choices).set('prompt', '追命：请选择一项').set('choiceList', choiceList).set('ai', () => {\r\n                        const target = _status.event.targetx;\r\n                        const player = _status.event.playerx;\r\n                        if (target.hasSkillTag('maixie') && target.hp > 2) return 0;\r\n                        if (get.damageEffect(target, player, target) >= 0) return 0;\r\n                        return 1;\r\n                    }).set('targetx', target).set('playerx', player);\r\n                    'step 1'\r\n                    if (result.control) {\r\n                        switch (result.index) {\r\n                            case 0:\r\n                                player.markAuto('PSzhuiming', event.target);\r\n                                player.when(\"useCardToPlayered\")\r\n                                    .then(() => {\r\n                                        delete player.storage.PSzhuiming;\r\n                                    });\r\n                                trigger.getParent().directHit.add(event.target);\r\n                                var id = event.target.playerid;\r\n                                var map = trigger.getParent().customArgs;\r\n                                if (!map[id]) map[id] = {};\r\n                                if (typeof map[id].extraDamage != 'number') {\r\n                                    map[id].extraDamage = 0;\r\n                                }\r\n                                map[id].extraDamage++;\r\n                                break;\r\n                            case 1:\r\n                                if (trigger.cards.length && ['o', 'd'].includes(get.position(trigger.cards[0]))) event.target.gain(trigger.cards, 'gain2');\r\n                                player.gainPlayerCard(event.target, 'he', 2, true);\r\n                                break;\r\n                        }\r\n                    }\r\n                },\r\n                ai: {\r\n                    unequip: true,\r\n                    skillTagFilter: function (player, tag, arg) {\r\n                        if (tag == 'unequip') {\r\n                            if (arg && arg.card && arg.card.name === 'sha' && arg.target && player.storage.PSzhuiming && player.storage.PSzhuiming.includes(arg.target)) return false;\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            PSjinge: {\r\n                mod: {\r\n                    globalFrom: function (from, to, distance) {\r\n                        return distance - 2;\r\n                    },\r\n                    cardname: function (card, player, name) {\r\n                        if (get.cardNameLength({ name: card.name }) === 2) return 'sha';\r\n                    },\r\n                    cardUsable: function (card, player, num) {\r\n                        if (card.cards && card.cards.length === 1 && get.name(card) === 'sha' && get.cardNameLength({ name: card.cards[0].name }) === 2) return Infinity;\r\n                    }\r\n                },\r\n                trigger: {\r\n                    player: \"useCard1\"\r\n                },\r\n                forced: true,\r\n                silent: true,\r\n                charlotte: true,\r\n                filter: function (event, player) {\r\n                    if (!event.card.cards || event.card.cards.length !== 1 || event.addCount === false) return false;\r\n                    return get.name(event.card) === 'sha' && get.cardNameLength(event.card.cards[0]) === 2;\r\n                },\r\n                content: function () {\r\n                    trigger.addCount = false;\r\n                    if (player.stat[player.stat.length - 1].card.sha > 0) {\r\n                        player.stat[player.stat.length - 1].card.sha--;\r\n                    }\r\n                },\r\n                popup: false,\r\n                sub: true,\r\n                _priority: 1\r\n            }\r\n        },\r\n        sort: sort.PScharacter_qun,\r\n        translate: {\r\n            PSqun_machao: \"PS群马超\",\r\n            PSzhuiming: \"追命\",\r\n            PSzhuiming_info: \"当你使用【杀】指定距离为1的目标时，你可以令目标角色选择一项：1.此【杀】令其防具无效、不可响应且对其造成伤害+1；2.其获得此【杀】对应的实体牌，然后你获得其两张牌。\",\r\n            PSjinge: \"金戈\",\r\n            PSjinge_info: \"锁定技，你计算与其他角色的距离时-2。你的牌名数为2的牌均视为不计入次数且无次数限制【杀】。\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PSluji: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"wu\",\r\n            hp: 3,\r\n            skills: [\r\n                \"PShuaiju\",\r\n                \"nzry_yili\",\r\n                \"PSzhenglun\"\r\n            ],\r\n            clans: [\r\n                \"吴郡陆氏\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“九个鲨雕”设计\",\r\n        skills: {\r\n            PShuaiju: {\r\n                marktext: \"橘\",\r\n                intro: {\r\n                    name: \"怀橘\",\r\n                    name2: \"橘\",\r\n                    content: \"当前有#个“橘”\"\r\n                },\r\n                onremove: function () {\r\n                    game.players.forEach(current => {\r\n                        if (current.hasMark('nzry_huaiju')) current.removeMark('nzry_huaiju', current.countMark('nzry_huaiju'));\r\n                    });\r\n                },\r\n                audio: \"nzry_huaiju\",\r\n                trigger: {\r\n                    global: \"phaseBefore\",\r\n                    player: \"enterGame\"\r\n                },\r\n                forced: true,\r\n                filter: function (event, player) {\r\n                    return (event.name != 'phase' || game.phaseNumber == 0);\r\n                },\r\n                content: function () {\r\n                    player.addMark('nzry_huaiju', 3);\r\n                    player.addSkill('PShuaiju_ai');\r\n                },\r\n                group: [\r\n                    \"PShuaiju_effect\"\r\n                ],\r\n                subSkill: {\r\n                    effect: {\r\n                        audio: \"nzry_huaiju\",\r\n                        trigger: {\r\n                            global: [\r\n                                \"damageBegin4\",\r\n                                \"drawBegin\"\r\n                            ]\r\n                        },\r\n                        forced: true,\r\n                        filter: function (event, player) {\r\n                            return event.player.hasMark('nzry_huaiju');\r\n                        },\r\n                        content: function () {\r\n                            player.line(trigger.player, 'green');\r\n                            if (trigger.name == 'damage') {\r\n                                trigger.cancel();\r\n                                trigger.player.removeMark('nzry_huaiju', 1);\r\n                            }\r\n                            else trigger.num += trigger.player.countMark('nzry_huaiju');\r\n                        },\r\n                        _priority: 0\r\n                    },\r\n                    ai: {\r\n                        charlotte: true,\r\n                        ai: {\r\n                            filterDamage: true,\r\n                            skillTagFilter: function (player, tag, arg) {\r\n                                if (!player.hasMark('nzry_huaiju')) return false;\r\n                                if (!game.hasPlayer(function (current) {\r\n                                    return current.hasSkill('PShuaiju_effect');\r\n                                })) return false;\r\n                                if (arg && arg.player) {\r\n                                    if (arg.player.hasSkillTag('jueqing', false, player)) return false;\r\n                                }\r\n                            }\r\n                        },\r\n                        _priority: 0\r\n                    }\r\n                },\r\n                _priority: 0\r\n            },\r\n            PSzhenglun: {\r\n                audio: \"nzry_zhenglun\",\r\n                trigger: {\r\n                    player: \"phaseDrawBefore\"\r\n                },\r\n                filter: function (event, player) {\r\n                    return true;\r\n                },\r\n                check: function (event, player) {\r\n                    return player.countCards(\"h\") >= 2 || player.skipList.includes(\"phaseUse\");\r\n                },\r\n                content: function () {\r\n                    trigger.cancel();\r\n                    player.addMark(\"nzry_huaiju\", 1);\r\n                },\r\n                ai: {\r\n                    combo: \"PShuaiju\"\r\n                },\r\n                _priority: 0\r\n            }\r\n        },\r\n        sort: sort.PScharacter_wu,\r\n        translate: {\r\n            PSluji: \"PS陆绩\",\r\n            PShuaiju: \"怀橘\",\r\n            PShuaiju_info: \"锁定技，游戏开始时，你获得3个“橘”标记。（有“橘”的角色受到伤害时，防止此伤害，然后移去一个“橘”；有“橘”的角色摸牌时额外摸其拥有的“橘”标记数张牌）\",\r\n            PSzhenglun: \"整论\",\r\n            PSzhenglun_info: \"你可以跳过摸牌阶段然后获得一个“橘”。\"\r\n        },\r\n        rank: rank.epic\r\n    },\r\n    PSluxun: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"wu\",\r\n            hp: 3,\r\n            skills: [\r\n                \"PSqianxun\",\r\n                \"PSlianying\"\r\n            ],\r\n            clans: [\r\n                \"吴郡陆氏\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“希霞”设计\",\r\n        replace: [\r\n            \"PSluxun\",\r\n            \"PSreluxun\"\r\n        ],\r\n        skills: {\r\n            PSqianxun: {\r\n                mod: {\r\n                    targetEnabled: function (card, player, target, now) {\r\n                        if (card.name == 'shunshou' || get.type(card) === 'delay' || card.name == 'guohe') return false;\r\n                    }\r\n                },\r\n                audio: 2,\r\n                _priority: 0\r\n            },\r\n            PSlianying: {\r\n                audio: \"lianying\",\r\n                trigger: {\r\n                    player: [\r\n                        \"useCard\",\r\n                        \"respond\"\r\n                    ]\r\n                },\r\n                frequent: true,\r\n                getSuitsLength: function (player) {\r\n                    const suits = [];\r\n                    for (let i = 0; i < player.getCards().length; i++) {\r\n                        const suit = get.suit(player.getCards()[i], player);\r\n                        if (!lib.suit.includes(suit) || suits.includes(suit)) continue;\r\n                        suits.add(suit);\r\n                        if (lib.suit.length === suits.length) break;\r\n                    }\r\n                    return suits.length;\r\n                },\r\n                filter: function (event, player) {\r\n                    return 4 - lib.skill.PSlianying.getSuitsLength(player) > 0;\r\n                },\r\n                content: function () {\r\n                    player.draw(4 - lib.skill.PSlianying.getSuitsLength(player));\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_wu,\r\n        translate: {\r\n            PSluxun: \"PS陆逊\",\r\n            PSqianxun: \"谦逊\",\r\n            PSqianxun_info: \"锁定技，你不能成为【过河拆桥】、【顺手牵羊】和延时锦囊牌的目标。\",\r\n            PSlianying: \"连营\",\r\n            PSlianying_info: \"当你使用或打出牌时，你可以摸X张牌（X为4-你的手牌花色数）。\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PSlvbu: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"qun\",\r\n            hp: 5,\r\n            skills: [\r\n                \"PSwushuang\",\r\n                \"PSbaifu\",\r\n                \"PSpanshi\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        skills: {\r\n            PSwushuang: {\r\n                audio: \"wushuang\",\r\n                locked: true,\r\n                derivation: \"wushuangfangtianji\",\r\n                group: [\r\n                    \"PSwushuang_wushuangfangtianji\",\r\n                    \"wushuang1\",\r\n                    \"wushuang2\"\r\n                ],\r\n                subSkill: {\r\n                    wushuangfangtianji: {\r\n                        nobracket: true,\r\n                        equipSkill: true,\r\n                        trigger: {\r\n                            source: \"damageSource\"\r\n                        },\r\n                        filter: function (event, player) {\r\n                            if (!player.hasEmptySlot(1) || !lib.card.wushuangfangtianji) return false;\r\n                            return lib.skill.wushuangfangtianji_skill.filter(event, player);\r\n                        },\r\n                        direct: true,\r\n                        locked: false,\r\n                        content: function () {\r\n                            'step 0'\r\n                            var target = trigger.player;\r\n                            var choices = ['摸一张牌'];\r\n                            if (target.hasCard(function (card) {\r\n                                return lib.filter.canBeDiscarded(card, player, target);\r\n                            }, 'he')) choices.push('弃置' + get.translation(target) + '的一张牌');\r\n                            player.chooseControl('cancel2').set('choiceList', choices).set('prompt', get.prompt('wushuangfangtianji_skill')).set('ai', function () {\r\n                                var player = _status.event.player, target = _status.event.getTrigger().player;\r\n                                if (target.hasCard(function (card) {\r\n                                    return lib.filter.canBeDiscarded(card, player, target);\r\n                                }, 'he') && get.effect(target, { name: 'guohe_copy2' }, player, player) > get.effect(player, { name: 'draw' }, player, player)) return 1;\r\n                                return 0;\r\n                            });\r\n                            'step 1'\r\n                            if (result.control == 'cancel2') return;\r\n                            if (result.index == 0) {\r\n                                player.logSkill('wushuangfangtianji_skill');\r\n                                player.draw();\r\n                            }\r\n                            else {\r\n                                var target = trigger.player;\r\n                                player.logSkill('wushuangfangtianji_skill', target);\r\n                                player.discardPlayerCard(target, 'he', true);\r\n                            }\r\n                        },\r\n                        mod: {\r\n                            attackRange: function (player, num) {\r\n                                if (lib.card.wushuangfangtianji && player.hasEmptySlot(1)) return num - lib.card.wushuangfangtianji.distance.attackFrom;\r\n                            }\r\n                        },\r\n                        sub: true,\r\n                        _priority: -25\r\n                    }\r\n                },\r\n                _priority: 0\r\n            },\r\n            PSbaifu: {\r\n                audio: \"ext:PS武将/audio/skill:2\",\r\n                trigger: {\r\n                    source: \"damageBegin1\"\r\n                },\r\n                logTarget: \"player\",\r\n                log: false,\r\n                check: function (event, player) {\r\n                    const target = game.findPlayer(current => current.storage.PSbaifu_yifu && current.storage.PSbaifu_yifu.includes(player));\r\n                    if (target && get.attitude(player, target) > 0) return false;\r\n                    return true;\r\n                },\r\n                filter: function (event, player) {\r\n                    if (event.player === player) return false;\r\n                    return !event.player.storage.PSbaifu_yifu || !event.player.storage.PSbaifu_yifu.includes(player);\r\n                },\r\n                async content(event, trigger, player) {\r\n                    const yifu = game.filterPlayer(current => current.storage.PSbaifu_yifu && current.storage.PSbaifu_yifu.includes(player));\r\n                    if (yifu.length) {\r\n                        for (let i = 0; i < yifu.length; i++) {\r\n                            await yifu[i].damage('nocard');\r\n                            yifu[i].storage.PSbaifu_yifu.remove(player);\r\n                            yifu[i].markAuto('PSbaifu_yifu');\r\n                        }\r\n                    }\r\n                    if (!trigger.player.hasSkill('PSbaifu_yifu')) trigger.player.addSkill('PSbaifu_yifu');\r\n                    trigger.player.storage.PSbaifu_yifu.add(player);\r\n                    trigger.player.markAuto('PSbaifu_yifu');\r\n                    player.gainPlayerCard(trigger.player, 'he', true);\r\n                    game.playAudio('..', 'extension', 'PS武将/audio/skill', ['PSbaifu1', 'PSbaifu2'].randomGet());\r\n                    trigger.cancel();\r\n                },\r\n                subSkill: {\r\n                    yifu: {\r\n                        intro: {\r\n                            content: function (storage, player) {\r\n                                return player.storage['PSbaifu_yifu'].reduce((a, b) => a + `我儿${get.translation(b)}天下无双！<br>`, '');\r\n                            },\r\n                            markcount: function (storage, player) {\r\n                                return storage.length;\r\n                            }\r\n                        },\r\n                        onremove: true,\r\n                        init: function (player, skill) {\r\n                            if (!player.storage[skill]) player.storage[skill] = [];\r\n                        }\r\n                    }\r\n                },\r\n                _priority: 0\r\n            },\r\n            PSpanshi: {\r\n                audio: \"ext:PS武将/audio/skill:2\",\r\n                trigger: {\r\n                    source: \"damageBegin1\",\r\n                    global: \"useCardBefore\"\r\n                },\r\n                direct: true,\r\n                forced: true,\r\n                filter: function (event, player, name) {\r\n                    if (!event.player.storage.PSbaifu_yifu || !event.player.storage.PSbaifu_yifu.includes(player)) return false;\r\n                    if (name === \"damageBegin1\") return true;\r\n                    if (event.player.hasHistory('custom', evt => evt.PSpanshi_use)) return false;\r\n                    if (!event.targets || event.targets.length === 1 && event.targets[0] === player) return false;\r\n                    if (event.player.hasHistory('useCard', evt => get.tag(evt.card, 'damage') > 0)) return false;\r\n                    return get.tag(event.card, 'damage') > 0;\r\n                },\r\n                logTarget: (event, player) => event.name === 'damage' ? event.player : player,\r\n                content: function () {\r\n                    if (event.triggername === \"damageBegin1\") {\r\n                        trigger.num++;\r\n                        player.when({ source: 'dieBegin' })\r\n                            .filter((evt, player) => evt.player.storage.PSbaifu_yifu && evt.player.storage.PSbaifu_yifu.includes(player))\r\n                            .then(() => {\r\n                                game.playAudio('..', 'extension', 'PS武将/audio/die', ['PSpanshi_kill1', 'PSpanshi_kill2'].randomGet());\r\n                            });\r\n                        game.playAudio('..', 'extension', 'PS武将/audio/skill', ['PSpanshi1', 'PSpanshi2'].randomGet());\r\n                    } else {\r\n                        trigger.player.getHistory('custom').push({ PSpanshi_use: true });\r\n                        trigger.targets.remove(player);\r\n                        if (trigger.targets.every(target => player.canUse(trigger.card, target, true, true))) {\r\n                            trigger.player = player;\r\n                            game.playAudio('..', 'extension', 'PS武将/audio/skill', ['PSpanshi_use1', 'PSpanshi_use2'].randomGet());\r\n                            trigger.noai = true;\r\n                            game.delay(0.5);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_qun,\r\n        translate: {\r\n            PSlvbu: \"PS吕布\",\r\n            PSwushuang: \"无双\",\r\n            PSwushuang_info: \"锁定技。①若你有空置的武器栏，则视为你装备【无双方天戟】。②当你使用【杀】或【决斗】指定目标后，你令此牌需要依次使用或打出两张【闪】或【杀】响应。\",\r\n            PSbaifu: \"拜父\",\r\n            PSbaifu_info: \"当你对一名其他角色A造成伤害时，若其不是“义父”，你可以防止此伤害。若如此做，你对场上的“义父”B造成一点伤害并移去B的“义父”标记，然后你获得A的一张牌并令A获得“义父”标记。\",\r\n            PSpanshi: \"叛弑\",\r\n            PSpanshi_info: \"锁定技。①当“义父”于一回合内首次使用伤害类牌前，若你不是此牌的唯一目标，此牌的目标排除你。然后若你满足使用此牌的合法性，你成为此牌的使用者。②当你对“义父”造成伤害时，此伤害+1。\",\r\n            \"#ext:PS武将/audio/skill/PSpanshi_use1\": \"赴汤蹈火，在所不辞。\",\r\n            \"#ext:PS武将/audio/skill/PSpanshi_use2\": \"相助义父，共图大业。\",\r\n            \"#ext:PS武将/audio/skill/PSpanshi1\": \"老贼，我与你势不两立！\",\r\n            \"#ext:PS武将/audio/skill/PSpanshi2\": \"我堂堂大丈夫，安肯为汝之义子！\",\r\n            \"#ext:PS武将/audio/skill/PSpanshi_kill1\": \"奉先我儿，为何如此啊！\",\r\n            \"#ext:PS武将/audio/skill/PSpanshi_kill2\": \"奉先，何故变心？\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PSshen_zuoci: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"shen\",\r\n            hp: 3,\r\n            skills: [\r\n                \"PSshen_huashen\",\r\n                \"PSshen_jihun\",\r\n                \"PSshen_xinsheng\"\r\n            ],\r\n            dieAudios: [\r\n                \"ext:PS武将/audio/die:true\"\r\n            ],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“九个夜白”设计\",\r\n        substitute: [],\r\n        skills: {\r\n            PSshen_huashen: {\r\n                unique: true,\r\n                audio: \"ext:PS武将/audio/skill:2\",\r\n                trigger: {\r\n                    global: \"phaseBefore\",\r\n                    player: [\r\n                        \"enterGame\",\r\n                        \"phaseAfter\",\r\n                        \"PSshen_huashen\"\r\n                    ]\r\n                },\r\n                filter: function (event, player, name) {\r\n                    if (player.storage.PSshen_huashen.invalid) return false;\r\n                    if (event.name !== 'phase') return true;\r\n                    if (name == 'phaseBefore') return game.phaseNumber == 0 || event.player === player;\r\n                    return player.storage.PSshen_huashen && player.storage.PSshen_huashen.character.length > 0;\r\n                },\r\n                direct: true,\r\n                content: function () {\r\n                    /* \r\n                     player.storage.PSshen_huashen.current //当前化身牌武将id\r\n                     player.storage.PSshen_huashen.current2 //当前化身的技能id数组\r\n                     event.card //选中的化身牌（新化身牌）  \r\n                    */\r\n                    \"step 0\"\r\n                    var name = event.triggername;\r\n                    if (trigger.name != 'phase' || (name == 'phaseBefore' && game.phaseNumber == 0)) {\r\n                        player.logSkill('PSshen_huashen');\r\n                        lib.skill.PSshen_huashen.addHuashens(player, 2);\r\n                        event.logged = true;\r\n                        /* if (name == 'phaseBefore' && game.phaseNumber == 0 && trigger.player !== player) {\r\n                            event.finish();\r\n                            return;\r\n                        } */\r\n                    }\r\n                    _status.noclearcountdown = true;\r\n                    event.videoId = lib.status.videoId++;\r\n                    var cards = player.storage.PSshen_huashen.character.slice(0);\r\n                    if (player.isOnline2()) {\r\n                        player.send(function (cards, id) {\r\n                            var dialog = ui.create.dialog('###是否发动【化身】？###<div class=\"text center\">选择一张“魂”作为你的表象武将</div>', [cards, (item, type, position, noclick, node) => lib.skill.PSshen_huashen.$createButton(item, type, position, noclick, node)]);\r\n                            dialog.videoId = id;\r\n                        }, cards, event.videoId);\r\n                    }\r\n                    event.dialog = ui.create.dialog('###是否发动【化身】？###<div class=\"text center\">选择一张“魂”作为你的表象武将</div>', [cards, (item, type, position, noclick, node) => lib.skill.PSshen_huashen.$createButton(item, type, position, noclick, node)]);\r\n                    event.dialog.videoId = event.videoId;\r\n                    if (!event.isMine()) {\r\n                        event.dialog.style.display = 'none';\r\n                    }\r\n                    if (!event.logged) { player.logSkill('PSshen_huashen'); event.logged = true }\r\n                    var next = player.chooseButton(false).set('dialog', event.videoId);\r\n                    next.set('filterButton', function (button) {\r\n                        return button.link != _status.event.current;\r\n                    });\r\n                    next.set('current', player.storage.PSshen_huashen.current);\r\n                    next.set('ai', function (button) {\r\n                        const rarity = lib.rank.rarity;\r\n                        const num = rarity.legend.includes(button.link) ?\r\n                            4 : rarity.epic.includes(button.link) ?\r\n                                3 : rarity.rare.includes(button.link) ?\r\n                                    2 : 1;\r\n                        return num;\r\n                    });\r\n                    \"step 1\"\r\n                    if (player.isOnline2()) {\r\n                        player.send('closeDialog', event.videoId);\r\n                    }\r\n                    event.dialog.close();\r\n                    delete _status.noclearcountdown;\r\n                    if (!_status.noclearcountdown) {\r\n                        game.stopCountChoose();\r\n                    }\r\n                    if (result.bool) {\r\n                        //切换形象\r\n                        event.card = result.links[0];\r\n                        const old = player.storage.PSshen_huashen.current;\r\n                        player.storage.PSshen_huashen.current = event.card;\r\n                        const name = player.name2 === 'PSshen_zuoci' ? player.name2 : player.name;\r\n                        player.changeSkin(\"PSshen_huashen\", event.card);\r\n                        // player.setAvatar(name, event.card, true, true);\r\n                        game.broadcastAll(function (player, character, old) {\r\n                            player.tempname.remove(old);\r\n                            player.tempname.add(character);\r\n                            player.sex = lib.character[event.card][0];\r\n                        }, player, event.card, old);\r\n                        game.log(player, '将性别变为了', '#y' + get.translation(lib.character[event.card][0]) + '性');\r\n                        player.changeGroup(lib.character[event.card][1]);\r\n                        game.log(player, '将', '#y' + get.translation(event.card), '作为了表象武将');\r\n                        //获得技能\r\n                        const skills = get.character(event.card, 3).filter(function (skill) {\r\n                            const categories = get.skillCategoriesOf(skill);\r\n                            return !categories.some(type => lib.skill.PSshen_huashen.bannedType.includes(type));\r\n                        });\r\n                        if (skills.length) {\r\n                            const old2 = player.storage.PSshen_huashen.current2;\r\n                            player.storage.PSshen_huashen.current2 = skills;\r\n                            player.addAdditionalSkills('PSshen_huashen', skills);\r\n                            player.syncStorage('PSshen_huashen');\r\n                            player.updateMarks('PSshen_huashen');\r\n                        } else {\r\n                            player.removeAdditionalSkill('PSshen_huashen');\r\n                        }\r\n                    }\r\n                },\r\n                group: \"PSshen_huashen_use\",\r\n                subSkill: {\r\n                    use: {\r\n                        audio: \"PSshen_huashen\",\r\n                        enable: \"chooseToUse\",\r\n                        filter: function (event, player) {\r\n                            if (!player.storage.PSshen_huashen.invalid || !player.storage.PSshen_huashen.character.length) return false;\r\n                            for (var i of lib.inpile) {\r\n                                var type = get.type2(i);\r\n                                if ((type == 'basic' || type == 'trick') && !player.hasHistory('custom', evt => evt.PSshen_huashen_use && evt.card && evt.card.name === i) && event.filterCard(get.autoViewAs({ name: i }, 'unsure'), player, event)) return true;\r\n                            }\r\n                            return false;\r\n                        },\r\n                        chooseButton: {\r\n                            dialog: function (event, player) {\r\n                                var list = [];\r\n                                for (var i = 0; i < lib.inpile.length; i++) {\r\n                                    const filter = function (name) {\r\n                                        return !player.hasHistory('custom', evt => evt.PSshen_huashen_use && evt.card && get.name(evt.card) === name);\r\n                                    };\r\n                                    var name = lib.inpile[i];\r\n                                    if (name == 'sha') {\r\n                                        if (event.filterCard(get.autoViewAs({ name }, 'unsure'), player, event) && filter(name)) list.push(['基本', '', 'sha']);\r\n                                        for (var nature of lib.inpile_nature) {\r\n                                            if (event.filterCard(get.autoViewAs({ name, nature }, 'unsure'), player, event)) list.push(['基本', '', 'sha', nature]);\r\n                                        }\r\n                                    }\r\n                                    else if (get.type(name) == 'trick' && filter(name) && event.filterCard(get.autoViewAs({ name }, 'unsure'), player, event)) list.push(['锦囊', '', name]);\r\n                                    else if (get.type(name) == 'basic' && filter(name) && event.filterCard(get.autoViewAs({ name }, 'unsure'), player, event)) list.push(['基本', '', name]);\r\n                                }\r\n                                return ui.create.dialog('化身', [list, 'vcard']);\r\n                            },\r\n                            check: function (button) {\r\n                                if (_status.event.getParent().type != 'phase') return 1;\r\n                                var player = _status.event.player;\r\n                                if (['wugu', 'zhulu_card', 'yiyi', 'lulitongxin', 'lianjunshengyan', 'diaohulishan'].includes(button.link[2])) return 0;\r\n                                return player.getUseValue({\r\n                                    name: button.link[2],\r\n                                    nature: button.link[3],\r\n                                });\r\n                            },\r\n                            backup: function (links, player) {\r\n                                return {\r\n                                    filterCard: () => false,\r\n                                    selectCard: -1,\r\n                                    audio: 'PSshen_huashen',\r\n                                    popname: true,\r\n                                    viewAs: { name: links[0][2], nature: links[0][3], isCard: true },\r\n                                    onuse: function (links, player) {\r\n                                        const next = game.createEvent('chooseHuashenCharacter');\r\n                                        next.player = player;\r\n                                        next.links = links;\r\n                                        next.setContent(lib.skill.PSshen_huashen_use.chooseHuashenCharacter);\r\n                                    },\r\n                                }\r\n                            },\r\n                            prompt: function (links, player) {\r\n                                return '将一张牌当做' + (get.translation(links[0][3]) || '') + get.translation(links[0][2]) + '使用';\r\n                            }\r\n                        },\r\n                        chooseHuashenCharacter: function () {\r\n                            'step 0'\r\n                            const links = event.links;\r\n                            _status.noclearcountdown = true;\r\n                            event.videoId = lib.status.videoId++;\r\n                            var cards = player.storage.PSshen_huashen.character.slice(0);\r\n                            if (player.isOnline2()) {\r\n                                player.send(function (cards, id) {\r\n                                    var dialog = ui.create.dialog('###是否发动【化身】？###<div class=\"text center\">选择展示一张武将牌上的“魂”并将其置入剩余武将牌堆</div>', [cards, (item, type, position, noclick, node) => lib.skill.PSshen_huashen.$createButton(item, type, position, noclick, node)]);\r\n                                    dialog.videoId = id;\r\n                                }, cards, event.videoId);\r\n                            }\r\n                            event.dialog = ui.create.dialog('###是否发动【化身】？###<div class=\"text center\">选择展示一张武将牌上的“魂”并将其置入剩余武将牌堆</div>', [cards, (item, type, position, noclick, node) => lib.skill.PSshen_huashen.$createButton(item, type, position, noclick, node)]);\r\n                            event.dialog.videoId = event.videoId;\r\n                            if (!event.isMine()) {\r\n                                event.dialog.style.display = 'none';\r\n                            }\r\n                            var next = player.chooseButton(true).set('dialog', event.videoId);\r\n                            next.set('ai', function (button) {\r\n                                return 1;\r\n                            });\r\n                            'step 1'\r\n                            if (player.isOnline2()) {\r\n                                player.send('closeDialog', event.videoId);\r\n                            }\r\n                            event.dialog.close();\r\n                            delete _status.noclearcountdown;\r\n                            if (!_status.noclearcountdown) {\r\n                                game.stopCountChoose();\r\n                            }\r\n                            if (result.bool) {\r\n                                player.getHistory('custom').push({ card: event.links.card, PSshen_huashen_use: true });\r\n                                const cardname = 'huashen_card_' + result.links[0];\r\n                                lib.card[cardname] = {\r\n                                    fullimage: true,\r\n                                    image: 'character:' + result.links[0]\r\n                                }\r\n                                lib.translate[cardname] = get.rawName2(result.links[0]);\r\n                                player.showCards(game.createCard(cardname, '', ''));\r\n                                lib.skill.PSshen_huashen.removeHuashen(player, result.links.slice(0));\r\n                                player.syncStorage('PSshen_huashen');\r\n                                player.updateMarks('PSshen_huashen');\r\n                            }\r\n                        },\r\n                        hiddenCard: function (player, name) {\r\n                            if (!lib.inpile.includes(name)) return false;\r\n                            var type = get.type2(name);\r\n                            return (type == 'basic' || type == 'trick') && player.storage.PSshen_huashen.character.length && player.storage.PSshen_huashen.invalid;\r\n                        },\r\n                        ai: {\r\n                            combo: \"PSshen_jihun\",\r\n                            fireAttack: true,\r\n                            respondSha: true,\r\n                            respondShan: true,\r\n                            skillTagFilter: function (player) {\r\n                                if (!player.storage.PSshen_huashen.character.length || !player.storage.PSshen_huashen.invalid) return false;\r\n                            },\r\n                            order: 1,\r\n                            result: {\r\n                                player: function (player) {\r\n                                    if (_status.event.dying) return get.attitude(player, _status.event.dying);\r\n                                    return 1;\r\n                                }\r\n                            }\r\n                        },\r\n                        _priority: 0\r\n                    }\r\n                },\r\n                init: function (player, skill) {\r\n                    if (!player.storage[skill]) player.storage[skill] = {\r\n                        character: [],\r\n                        map: {},\r\n                    }\r\n\r\n                    player.flashAvatar = () => { };\r\n                    player.setAvatar = () => { };\r\n                    player.setAvatarQueue = () => { };\r\n                    player.setBackgroundImage = () => { };\r\n\r\n                    player.when('dieBegin').then(() => {\r\n                        const name = player.name ? player.name : player.name1;\r\n                        if (name) {\r\n                            const sex = get.character(name, 0);\r\n                            const group = get.character(name, 1);\r\n                            if (player.sex != sex) {\r\n                                game.broadcastAll((player, sex) => {\r\n                                    player.sex = sex;\r\n                                }, player, sex);\r\n                                player.changeSkin(\"PSshen_huashen\", \"PSshen_zuoci\");\r\n                                // player.setAvatar('PSshen_zuoci', 'PSshen_zuoci', true, true);\r\n                                game.log(player, '将性别变为了', '#y' + get.translation(sex) + '性');\r\n                            }\r\n                            if (player.group != group) player.changeGroup(group);\r\n                        }\r\n                    });\r\n                },\r\n                banned: [\r\n                    \"lisu\",\r\n                    \"sp_xiahoudun\",\r\n                    \"xushao\",\r\n                    \"jsrg_xushao\",\r\n                    \"zhoutai\",\r\n                    \"old_zhoutai\",\r\n                    \"shixie\",\r\n                    \"xin_zhoutai\",\r\n                    \"dc_shixie\",\r\n                    \"old_shixie\"\r\n                ],\r\n                bannedType: [\r\n                    \"主公技\",\r\n                    \"隐匿技\"\r\n                ],\r\n                addHuashen: function (player) {\r\n                    if (!player.storage.PSshen_huashen) return;\r\n                    if (!_status.characterlist) {\r\n                        lib.skill.pingjian.initList();\r\n                    }\r\n                    _status.characterlist.randomSort();\r\n                    for (let i = 0; i < _status.characterlist.length; i++) {\r\n                        let name = _status.characterlist[i];\r\n                        if (name.indexOf('zuoci') != -1 || name.indexOf('key_') == 0 || name.indexOf('sp_key_') == 0 /* || get.is.double(name) */ || lib.skill.PSshen_huashen.banned.includes(name) || player.storage.PSshen_huashen.character.includes(name)) continue;\r\n                        let skills = lib.character[name][3].filter(skill => {\r\n                            const categories = get.skillCategoriesOf(skill);\r\n                            return !categories.some(type => lib.skill.PSshen_huashen.bannedType.includes(type));\r\n                        })\r\n                        if (skills.length) {\r\n                            player.storage.PSshen_huashen.character.push(name);\r\n                            player.storage.PSshen_huashen.map[name] = skills;\r\n                            _status.characterlist.remove(name);\r\n                            return name;\r\n                        }\r\n                    }\r\n                },\r\n                addHuashens: function (player, num) {\r\n                    var list = [];\r\n                    for (var i = 0; i < num; i++) {\r\n                        var name = lib.skill.PSshen_huashen.addHuashen(player);\r\n                        if (name) list.push(name);\r\n                    }\r\n                    if (list.length) {\r\n                        player.syncStorage('PSshen_huashen');\r\n                        player.updateMarks('PSshen_huashen');\r\n                        game.log(player, '获得了', get.cnNumber(list.length) + '张', '#g魂');\r\n                        lib.skill.PSshen_huashen.drawCharacter(player, list);\r\n                    }\r\n                },\r\n                removeHuashen: function (player, links) {\r\n                    player.storage.PSshen_huashen.character.removeArray(links);\r\n                    _status.characterlist.addArray(links);\r\n                    game.log(player, '移去了', get.cnNumber(links.length) + '张', '#g魂')\r\n                },\r\n                drawCharacter: function (player, list) {\r\n                    game.broadcastAll(function (player, list) {\r\n                        if (player.isUnderControl(true)) {\r\n                            var cards = [];\r\n                            for (var i = 0; i < list.length; i++) {\r\n                                var cardname = 'huashen_card_' + list[i];\r\n                                lib.card[cardname] = {\r\n                                    fullimage: true,\r\n                                    image: 'character:' + list[i]\r\n                                }\r\n                                lib.translate[cardname] = get.rawName2(list[i]);\r\n                                cards.push(game.createCard(cardname, '', ''));\r\n                            }\r\n                            player.$draw(cards, 'nobroadcast');\r\n                        }\r\n                    }, player, list);\r\n                },\r\n                \"$createButton\": function (item, type, position, noclick, node) {\r\n                    node = ui.create.buttonPresets.character(item, 'character', position, noclick);\r\n                    const info = lib.character[item];\r\n                    const skills = info[3].filter(function (skill) {\r\n                        const categories = get.skillCategoriesOf(skill);\r\n                        return !categories.some(type => lib.skill.PSshen_huashen.bannedType.includes(type));\r\n                    });\r\n                    if (skills.length) {\r\n                        const skillstr = skills.map(i => `[${get.translation(i)}]`).join('<br>');\r\n                        const skillnode = ui.create.caption(\r\n                            `<div class=\"text\" data-nature=${get.groupnature(info[1], 'raw')\r\n                            }m style=\"font-family: ${(lib.config.name_font || 'xinwei')\r\n                            },xinwei\">${skillstr}</div>`, node);\r\n                        skillnode.style.left = '2px';\r\n                        skillnode.style.bottom = '2px';\r\n                    }\r\n                    node._customintro = function (uiintro, evt) {\r\n                        const character = node.link, characterInfo = get.character(node.link);\r\n                        let capt = get.translation(character);\r\n                        if (characterInfo) {\r\n                            capt += `&nbsp;&nbsp;${get.translation(characterInfo[0])}`;\r\n                            let charactergroup;\r\n                            const charactergroups = get.is.double(character, true);\r\n                            if (charactergroups) charactergroup = charactergroups.map(i => get.translation(i)).join('/');\r\n                            else charactergroup = get.translation(characterInfo[1]);\r\n                            capt += `&nbsp;&nbsp;${charactergroup}`;\r\n                        }\r\n                        uiintro.add(capt);\r\n\r\n                        if (lib.characterTitle[node.link]) {\r\n                            uiintro.addText(get.colorspan(lib.characterTitle[node.link]));\r\n                        }\r\n                        for (let i = 0; i < skills.length; i++) {\r\n                            if (lib.translate[skills[i] + '_info']) {\r\n                                let translation = lib.translate[skills[i] + '_ab'] || get.translation(skills[i]).slice(0, 2);\r\n                                if (lib.skill[skills[i]] && lib.skill[skills[i]].nobracket) {\r\n                                    uiintro.add('<div><div class=\"skilln\">' + get.translation(skills[i]) + '</div><div>' + get.skillInfoTranslation(skills[i]) + '</div></div>');\r\n                                }\r\n                                else {\r\n                                    uiintro.add('<div><div class=\"skill\">【' + translation + '】</div><div>' + get.skillInfoTranslation(skills[i]) + '</div></div>');\r\n                                }\r\n                                if (lib.translate[skills[i] + '_append']) {\r\n                                    uiintro._place_text = uiintro.add('<div class=\"text\">' + lib.translate[skills[i] + '_append'] + '</div>')\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                    return node;\r\n                },\r\n                mark: true,\r\n                intro: {\r\n                    onunmark: function (storage, player) {\r\n                        _status.characterlist.addArray(storage.character);\r\n                        storage.character = [];\r\n                    },\r\n                    mark: function (dialog, storage, player) {\r\n                        if (storage && storage.current) dialog.addSmall([[storage.current], (item, type, position, noclick, node) => lib.skill.PSshen_huashen.$createButton(item, type, position, noclick, node)]);\r\n                        if (storage && storage.current2) {\r\n                            for (var i = 0; i < storage.current2.length; i++) {\r\n                                dialog.add('<div><div class=\"skill\">【' + get.translation(lib.translate[storage.current2[i] + '_ab'] || get.translation(storage.current2[i]).slice(0, 2)) + '】</div><div>' + get.skillInfoTranslation(storage.current2[i], player) + '</div></div>');\r\n                            }\r\n                        }\r\n                        if (storage && storage.character.length) {\r\n                            if (player.isUnderControl(true)) {\r\n                                dialog.addSmall([storage.character, (item, type, position, noclick, node) => lib.skill.PSshen_huashen.$createButton(item, type, position, noclick, node)]);\r\n                            }\r\n                            else {\r\n                                dialog.addText('共有' + get.cnNumber(storage.character.length) + '张“化身”');\r\n                            }\r\n                        }\r\n                        else {\r\n                            return '没有化身';\r\n                        }\r\n                    },\r\n                    content: function (storage, player) {\r\n                        return '共有' + get.cnNumber(storage.character.length) + '张“化身”'\r\n                    },\r\n                    markcount: function (storage, player) {\r\n                        if (storage && storage.character) return storage.character.length;\r\n                        return 0;\r\n                    }\r\n                },\r\n                _priority: 0\r\n            },\r\n            PSshen_jihun: {\r\n                audio: \"ext:PS武将/audio/skill:2\",\r\n                trigger: {\r\n                    player: \"damageEnd\",\r\n                    global: \"dyingAfter\"\r\n                },\r\n                frequent: true,\r\n                filter: function (event, player, name) {\r\n                    if (!player.hasSkill('PSshen_huashen')) return false;\r\n                    if (name === \"dyingAfter\") return event.player !== player && event.player.isAlive() && !player.storage.PSshen_huashen.dyingAfter;\r\n                    return !player.storage.PSshen_huashen.damage;\r\n                },\r\n                content: function () {\r\n                    lib.skill.PSshen_huashen.addHuashens(player, 1);\r\n                }\r\n            },\r\n            PSshen_xinsheng: {\r\n                audio: \"ext:PS武将/audio/skill:2\",\r\n                trigger: {\r\n                    player: \"dieBefore\"\r\n                },\r\n                forced: true,\r\n                filter: function (event, player) {\r\n                    if (player.maxHp <= 0) return false;\r\n                    const storage = player.storage && player.storage.PSshen_huashen;\r\n                    if (!storage) return false;\r\n                    return !storage.invalid || !storage.damage || !storage.dyingAfter;\r\n                },\r\n                async content(event, trigger, player) {\r\n                    const choices = [], choiceList = [\r\n                        `将表象角色置入剩余武将牌堆，并变为本体武将`,\r\n                        `删去〖汲魂〗第一个获得“魂”的途径（当你受到伤害后）`,\r\n                        `删去〖汲魂〗第二个获得“魂”的途径（其他角色脱离濒死后）`,\r\n                    ];\r\n                    const storage = player.storage.PSshen_huashen;\r\n\r\n                    if (!storage.invalid && storage.current) choices.push('选项一');\r\n                    else choiceList[0] = '<span style=\"opacity:0.5; \">' + choiceList[0] + '</span>';\r\n                    if (!storage.damage) choices.push('选项二');\r\n                    else choiceList[1] = '<span style=\"opacity:0.5; \">' + choiceList[1] + '</span>';\r\n                    if (!storage.dyingAfter) choices.push('选项三');\r\n                    else choiceList[2] = '<span style=\"opacity:0.5; \">' + choiceList[2] + '</span>';\r\n\r\n                    let control;\r\n                    if (choices.length === 1) {\r\n                        control = choices[0];\r\n                    } else if (choices.length > 1) {\r\n                        ({ control } = await player.chooseControl(choices)\r\n                            .set('prompt', '新生：请选择一项')\r\n                            .set('choiceList', choiceList)\r\n                            .set('ai', () => {\r\n                                return choices.length - 1;\r\n                            })\r\n                            .forResult());\r\n                    }\r\n                    switch (control) {\r\n                        case '选项一':\r\n                            player.storage.PSshen_huashen.invalid = true;\r\n                            const name = player.name ? player.name : player.name1;\r\n                            if (name) {\r\n                                const sex = get.character(name, 0);\r\n                                const group = get.character(name, 1);\r\n                                if (player.sex != sex) {\r\n                                    game.broadcastAll((player, sex) => {\r\n                                        player.sex = sex;\r\n                                    }, player, sex);\r\n                                    game.log(player, '将性别变为了', '#y' + get.translation(sex) + '性');\r\n                                }\r\n                                if (player.group != group) await player.changeGroup(group);\r\n                            }\r\n                            player.changeSkin(\"PSshen_huashen\", \"PSshen_zuoci\");\r\n                            // player.setAvatar('PSshen_zuoci', 'PSshen_zuoci', true, true);\r\n                            if (player.additionalSkills.PSshen_huashen && player.additionalSkills.PSshen_huashen.length) {\r\n                                await player.removeAdditionalSkills('PSshen_huashen');\r\n                            }\r\n                            game.log(player, '移去了表象武将', '#y' + get.translation(player.storage.PSshen_huashen.current));\r\n                            delete player.storage.PSshen_huashen.current;\r\n                            delete player.storage.PSshen_huashen.current2;\r\n                            break;\r\n                        case '选项二':\r\n                            player.storage.PSshen_huashen.damage = true;\r\n                            break;\r\n                        case '选项三':\r\n                            player.storage.PSshen_huashen.dyingAfter = true;\r\n                            break;\r\n                    }\r\n                    await player.recoverTo(!storage.disable + !storage.damage + !storage.dyingAfter + 1);\r\n                    trigger.cancel();\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_shen,\r\n        translate: {\r\n            PSshen_zuoci: \"PS神左慈\",\r\n            PSshen_huashen: \"化身\",\r\n            PSshen_huashen_info: \"游戏开始时，你将剩余武将牌堆的两张牌置于武将牌上，称为“魂”，然后你可将一张“魂”作为你的表象武将展示；若表象角色未阵亡，则回合开始前或回合结束后，你可以用一张其他“魂”替换表象角色；若表象角色已阵亡，你可以展示一张武将牌上的“魂”并将其置入剩余武将牌堆，视为使用一张本回合内未以此法使用过的基本牌或普通锦囊牌。\",\r\n            PSshen_jihun: \"汲魂\",\r\n            PSshen_jihun_info: \"当[你受到伤害后]，或[其他角色脱离濒死状态后]，你可以将剩余武将牌堆的一张牌置于武将牌上，称为“魂”\",\r\n            PSshen_xinsheng: \"新生\",\r\n            PSshen_xinsheng_info: \"锁定技，当你即将阵亡时，你须选择一项：①将表象角色置入剩余武将牌堆，并变为本体武将；②删去〖汲魂〗第一个获得“魂”的途径；③删去〖汲魂〗第二个获得“魂”的途径。然后终止阵亡结算并回复体力至剩余选项数+1。\",\r\n            \"#ext:PS武将/audio/skill/PSshen_huashen1\": \"性本如空，化身万千。\",\r\n            \"#ext:PS武将/audio/skill/PSshen_huashen2\": \"一念思量，化身无数。\",\r\n            \"#ext:PS武将/audio/skill/PSshen_jihun1\": \"人死其魂，复归于气，汲其气修吾身。\",\r\n            \"#ext:PS武将/audio/skill/PSshen_jihun2\": \"人有三魂，汲命魂，则敌休命。\",\r\n            \"#ext:PS武将/audio/skill/PSshen_xinsheng1\": \"新生之犊，无求其故。\",\r\n            \"#ext:PS武将/audio/skill/PSshen_xinsheng2\": \"醍醐灌顶，如临新生。\",\r\n            \"#ext:PS武将/audio/die/PSshen_zuoci:die\": \"道家不入轮回。\"\r\n        },\r\n        dynamicTranslate: {\r\n            PSshen_jihun: function (player) {\r\n                let str1 = '你受到伤害后';\r\n                let str2 = '其他角色脱离濒死状态后';\r\n                if (player.storage.PSshen_huashen?.damage) str1 = `<del>${str1}</del>`;\r\n                if (player.storage.PSshen_huashen?.dyingAfter) str2 = `<del>${str2}</del>`;\r\n                return `当[${str1}]，或[${str2}]，你可以将剩余武将牌堆的一张牌置于武将牌上，称为“魂”。`;\r\n            }\r\n        },\r\n        rank: rank.epic\r\n    },\r\n    PSreyuanshu: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"qun\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PSshelian\",\r\n                \"PSjixi\"\r\n            ],\r\n            dieAudios: [\r\n                \"re_yuanshu\"\r\n            ],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“九个陈皮”设计\",\r\n        skills: {\r\n            PSshelian: {\r\n                audio: \"xinyongsi\",\r\n                enable: \"phaseUse\",\r\n                usable: 1,\r\n                filterCard: true,\r\n                selectCard: [\r\n                    1,\r\n                    Infinity\r\n                ],\r\n                discard: false,\r\n                lose: false,\r\n                delay: false,\r\n                position: \"h\",\r\n                complexCard: true,\r\n                check: function (card) {\r\n                    var player = _status.event.player;\r\n                    if (getCardsSuitsLen(ui.selected.cards, player) === 4) return 0;\r\n                    for (var i = 0; i < ui.selected.cards.length; i++) {\r\n                        if (get.suit(card) == get.suit(ui.selected.cards[i])) return 0;\r\n                    }\r\n                    return 1;\r\n                },\r\n                filter: function (event, player) {\r\n                    return player.countCards('h') > 0;\r\n                },\r\n                content() {\r\n                    'step 0'\r\n                    player.showCards(cards, get.translation(player) + '展示了部分手牌');\r\n                    'step 1'\r\n                    const list = Array.from({ length: 8 }, (_, i) => (i + 1).toString());\r\n                    const num = getCardsSuitsLen(cards, player);\r\n                    player.chooseControl(list).set('prompt', '请选择要亮出牌堆顶的牌数').set('ai', () => {\r\n                        return _status.event.choice;\r\n                    }).set('choice', num - 2 + (player.awakenedSkills.includes('PSjixi') && num > 2));\r\n                    'step 2'\r\n                    if (result.control) {\r\n                        event.cardsx = get.cards(+result.control);\r\n                        const bool = getCardsSuitsLen(cards, player) > getCardsSuitsLen(event.cardsx);\r\n                        const prompt = `花色数${bool ? '<span class=\"greentext\">小于</span>' : '<span class=\"firetext\">不小于</span>'}${get.translation(player)}展示的手牌花色数`;\r\n                        player.showCards(event.cardsx, prompt);\r\n                        if (bool) {\r\n                            player.draw(event.cardsx.length);\r\n                        } else {\r\n                            player.loseHp();\r\n                        }\r\n                    }\r\n                },\r\n                ai: {\r\n                    order: 10,\r\n                    result: {\r\n                        player: function (player) {\r\n                            if (getCardsSuitsLen(player.getCards(), player) <= 1) return -1;\r\n                            return 1;\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            PSjixi: {\r\n                derivation: \"rewangzun\",\r\n                audio: \"weidi\",\r\n                trigger: {\r\n                    player: \"phaseJieshuBegin\"\r\n                },\r\n                forced: true,\r\n                filter: function (event, player) {\r\n                    if (player.phaseNumber < 3) return false;\r\n                    var num = 0;\r\n                    for (var i = player.actionHistory.length - 1; i >= 0; i--) {\r\n                        if (!player.actionHistory[i].isMe) continue;\r\n                        if (_status.globalHistory[i].changeHp.some(evt => evt.player == player && evt.getParent().name == 'loseHp' && evt.getParent(2).name == 'PSshelian')) return false;\r\n                        else {\r\n                            num++;\r\n                            if (num >= 3) break;\r\n                        }\r\n                    }\r\n                    return true;\r\n                },\r\n                skillAnimation: true,\r\n                animationColor: \"gray\",\r\n                unique: true,\r\n                juexingji: true,\r\n                content: function () {\r\n                    'step 0'\r\n                    player.awakenSkill('PSjixi');\r\n                    player.gainMaxHp();\r\n                    player.recover();\r\n                    'step 1'\r\n                    var str = '摸两张牌';\r\n                    var mode = get.mode();\r\n                    var choice = '选项一';\r\n                    if (mode == 'identity' || (mode == 'versus' && _status.mode == 'four')) {\r\n                        var list = [];\r\n                        var zhu = get.zhu(player);\r\n                        if (zhu && zhu != player && zhu.skills) {\r\n                            for (var i = 0; i < zhu.skills.length; i++) {\r\n                                if (lib.skill[zhu.skills[i]] && lib.skill[zhu.skills[i]].zhuSkill) {\r\n                                    list.push(zhu.skills[i]);\r\n                                }\r\n                            }\r\n                        }\r\n                        if (list.length) {\r\n                            str += '并获得技能' + get.translation(list);\r\n                            event.list = list;\r\n                            choice = '选项二';\r\n                        }\r\n                    }\r\n                    player.chooseControl(function (event, player) {\r\n                        return _status.event.choice;\r\n                    }).set('choiceList', ['获得技能〖妄尊〗', str]).set('choice', choice);\r\n                    'step 2'\r\n                    if (result.control == '选项一') {\r\n                        player.addSkills('rewangzun');\r\n                    }\r\n                    else {\r\n                        player.draw(2);\r\n                        if (event.list) {\r\n                            player.addSkills(event.list);\r\n                            game.broadcastAll(function (list) {\r\n                                game.expandSkills(list);\r\n                                for (var i of list) {\r\n                                    var info = lib.skill[i];\r\n                                    if (!info) continue;\r\n                                    if (!info.audioname2) info.audioname2 = {};\r\n                                    info.audioname2.old_yuanshu = 'weidi';\r\n                                }\r\n                            }, event.list);\r\n                        }\r\n                    }\r\n                },\r\n                _priority: 0\r\n            }\r\n        },\r\n        sort: sort.PScharacter_qun,\r\n        translate: {\r\n            PSreyuanshu: \"PS袁术\",\r\n            PSshelian: \"奢敛\",\r\n            PSshelian_info: \"出牌阶段限一次，你可以展示至少1张手牌，然后亮出牌堆顶至多8张牌，对比其中的花色数：若展示牌的花色数大于亮出牌的花色数，你摸X张牌（X为此次亮出的牌数）；否则，你失去一点体力。\",\r\n            PSjixi: \"觊玺\",\r\n            PSjixi_info: \"觉醒技，结束阶段，若你连续三回合没有因〖奢敛〗而失去过体力，则你增加1点体力上限并回复1点体力，然后选择一项：获得技能〖妄尊〗：摸两张牌并获得当前主公的主公技。\"\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PSwenyang: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"wei\",\r\n            hp: 5,\r\n            skills: [\r\n                \"PSlvli\",\r\n                \"PSchoujue\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“一顿七只屑狐狸”设计\",\r\n        skills: {\r\n            PSlvli: {\r\n                audio: \"lvli\",\r\n                trigger: {\r\n                    player: \"damageEnd\",\r\n                    source: \"damageSource\"\r\n                },\r\n                filter: function (event, player, name) {\r\n                    if (name == \"damageEnd\" && !player.storage.PSbeishui) return false;\r\n                    var stat = player.getStat().skill;\r\n                    if (!stat.PSlvli) stat.PSlvli = 0;\r\n                    if (stat.PSlvli > 0 && !player.storage.PSchoujue) return false;\r\n                    if (player.hp == player.countCards(\"h\")) return false;\r\n                    if (player.hp < player.countCards(\"h\") && player.isHealthy()) return false;\r\n                    return true;\r\n                },\r\n                content: function () {\r\n                    var stat = player.getStat().skill;\r\n                    stat.PSlvli++;\r\n                    var num = player.hp - player.countCards(\"h\");\r\n                    if (num > 0) player.draw(num);\r\n                    else player.recover(-num);\r\n                },\r\n                _priority: 0\r\n            },\r\n            PSchoujue: {\r\n                audio: \"choujue\",\r\n                derivation: [\r\n                    \"PSbeishui\",\r\n                    \"PSqingjiao\"\r\n                ],\r\n                trigger: {\r\n                    global: \"phaseAfter\"\r\n                },\r\n                skillAnimation: true,\r\n                animationColor: \"water\",\r\n                unique: true,\r\n                juexingji: true,\r\n                forced: true,\r\n                init: function (player, skill) {\r\n                    if (!player.storage[skill]) player.storage[skill] = false;\r\n                },\r\n                filter: function (event, player) {\r\n                    if (player.storage.PSchoujue) return false;\r\n                    return player.maxHp > 4;\r\n                },\r\n                content: function () {\r\n                    player.awakenSkill(\"PSchoujue\");\r\n                    player.storage.PSchoujue = true;\r\n                    player.addSkills(\"PSbeishui\");\r\n                },\r\n                _priority: 0\r\n            },\r\n            PSbeishui: {\r\n                trigger: {\r\n                    player: \"phaseZhunbeiBegin\"\r\n                },\r\n                audio: \"beishui\",\r\n                skillAnimation: \"epic\",\r\n                animationColor: \"thunder\",\r\n                unique: true,\r\n                juexingji: true,\r\n                forced: true,\r\n                init: function (player, skill) {\r\n                    if (!player.storage[skill]) player.storage[skill] = false;\r\n                },\r\n                filter: function (event, player) {\r\n                    if (player.storage.PSbeishui) return false;\r\n                    return player.hp >= 3;\r\n                },\r\n                content: function () {\r\n                    player.awakenSkill(\"PSbeishui\");\r\n                    player.storage.PSbeishui = true;\r\n                    player.addSkills(\"PSqingjiao\");\r\n                },\r\n                _priority: 0\r\n            },\r\n            PSqingjiao: {\r\n                audio: \"qingjiao\",\r\n                trigger: {\r\n                    player: \"phaseDrawBegin2\"\r\n                },\r\n                forced: true,\r\n                preHidden: true,\r\n                filter: function (event, player) {\r\n                    return !event.numFixed;\r\n                },\r\n                content: function () {\r\n                    trigger.num += 2;\r\n                },\r\n                mod: {\r\n                    cardUsable: function (card, player, num) {\r\n                        if (card.name == \"sha\") return num + 1;\r\n                    },\r\n                    targetInRange: function (card) {\r\n                        if (card.name == 'sha') return true;\r\n                    }\r\n                },\r\n                ai: {\r\n                    threaten: 1.5,\r\n                    unequip: true,\r\n                    unequip_ai: true,\r\n                    skillTagFilter: function (player, tag, arg) {\r\n                        if (\r\n                            arg &&\r\n                            arg.name == \"sha\"\r\n                        )\r\n                            return true;\r\n                        return false;\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_wei,\r\n        translate: {\r\n            PSwenyang: \"PS文鸯\",\r\n            PSlvli: \"膂力\",\r\n            PSlvli_info: \"每回合限一次，当你造成伤害后，你可以将手牌摸至与体力值相同或将体力回复至与手牌数相同。\",\r\n            PSchoujue: \"仇决\",\r\n            PSchoujue_info: \"觉醒技，每个回合结束时，若你的体力上限大于4，你获得技能〖背水〗，然后删去〖膂力〗描述中的“每回合限一次。\",\r\n            PSbeishui: \"背水\",\r\n            PSbeishui_info: \"觉醒技，准备阶段，若你的体力值不小于3，你获得〖清剿〗，然后将〖膂力〗改为受到伤害后也可以发动。\",\r\n            PSqingjiao: \"清剿\",\r\n            PSqingjiao_info: \"摸牌阶段，你可以多摸两张牌，且你本回合可以额外使用一张【杀】。你使用的【杀】无距离限制且无视防具。\"\r\n        },\r\n        dynamicTranslate: {\r\n            PSlvli: function (player) {\r\n                const str1 = player.storage.PSchoujue ? '' : '每回合限一次，';\r\n                const str2 = player.storage.PSbeishui ? '或受到' : '';\r\n                return `${str1}当你造成${str2}伤害后，你可以将手牌摸至与体力值相同或将体力回复至与手牌数相同。`;\r\n            }\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PSzhongyan: {\r\n        info: {\r\n            sex: \"female\",\r\n            group: \"jin\",\r\n            hp: 3,\r\n            skills: [\r\n                \"PSrebolan\",\r\n                \"PSguangu\",\r\n                \"clanbaozu\"\r\n            ],\r\n            clans: [\r\n                \"颍川钟氏\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“mento last”设计\",\r\n        skills: {\r\n            PSrebolan: {\r\n                audio: \"bolan\",\r\n                banned: [\r\n                    \"kotomi_chuanxiang\"\r\n                ],\r\n                global: \"PSrebolan_g\",\r\n                initList: function (player) {\r\n                    var list,\r\n                        skills = [];\r\n                    if (get.mode() == \"guozhan\") {\r\n                        list = [];\r\n                        for (var i in lib.characterPack.mode_guozhan) {\r\n                            if (lib.character[i]) list.push(i);\r\n                        }\r\n                    } else if (_status.connectMode) list = get.charactersOL();\r\n                    else {\r\n                        list = [];\r\n                        for (var i in lib.character) {\r\n                            if (lib.filter.characterDisabled2(i) || lib.filter.characterDisabled(i)) continue;\r\n                            list.push(i);\r\n                        }\r\n                    }\r\n                    for (var i of list) {\r\n                        if (i.indexOf(\"gz_jun\") == 0) continue;\r\n                        for (var j of lib.character[i][3]) {\r\n                            if (j == \"PSrebolan\") continue;\r\n                            var skill = lib.skill[j];\r\n                            if (!skill || skill.juexingji || skill.hiddenSkill || skill.zhuSkill || skill.dutySkill || skill.chargeSkill || lib.skill.PSrebolan.banned.includes(j)) continue;\r\n                            if (skill.init || (skill.ai && (skill.ai.combo || skill.ai.notemp || skill.ai.neg))) continue;\r\n                            var info = lib.translate[j + \"_info\"];\r\n                            if (info && info.indexOf(\"出牌阶段\") != -1) skills.add(j);\r\n                        }\r\n                    }\r\n                    player.storage.PSrebolan = skills;\r\n                },\r\n                enable: \"phaseUse\",\r\n                usable: 2,\r\n                async content(event, trigger, player) {\r\n                    if (!player.isIn()) {\r\n                        return;\r\n                    }\r\n                    if (!player.storage.PSrebolan) lib.skill.PSrebolan.initList(player);\r\n                    const list = player.storage.PSrebolan.randomGets(6);\r\n                    if (!list.length) {\r\n                        return;\r\n                    }\r\n                    const { control } = await player\r\n                        .chooseControl(list)\r\n                        .set(\r\n                            \"choiceList\",\r\n                            list.map(function (i) {\r\n                                return '<div class=\"skill\">【' + get.translation(lib.translate[i + \"_ab\"] || get.translation(i).slice(0, 2)) + \"】</div><div>\" + get.skillInfoTranslation(i, player) + \"</div>\";\r\n                            })\r\n                        )\r\n                        .set(\"displayIndex\", false)\r\n                        .set(\"prompt\", \"博览：请选择你要获得的技能\")\r\n                        .set(\"ai\", () => {\r\n                            var list = _status.event.controls.slice();\r\n                            return list.sort((a, b) => {\r\n                                return get.skillRank(b, \"in\") - get.skillRank(a, \"in\");\r\n                            })[0];\r\n                        })\r\n                        .forResult();\r\n                    const { bool, targets } = await player\r\n                        .chooseTarget(`令一名角色获得【${get.translation(control)}】直到其回合结束`, function (card, player, target) {\r\n                            return true;\r\n                        })\r\n                        .set('ai', function (target) {\r\n                            return get.attitude(_status.event.player, target) > 0;\r\n                        })\r\n                        .forResult();\r\n                    if (bool) {\r\n                        targets[0].addTempSkills(control, { player: \"phaseEnd\" });\r\n                        targets[0].popup(control);\r\n                    }\r\n                    // game.log(player,'获得了','#g【'+get.translation(result.control)+'】');\r\n                },\r\n                ai: {\r\n                    threaten: 0.9\r\n                },\r\n                subSkill: {\r\n                    g: {\r\n                        audio: \"bolan\",\r\n                        forceaudio: true,\r\n                        enable: \"phaseUse\",\r\n                        usable: 1,\r\n                        prompt: \"出牌阶段限一次。你可以令一名有〖博览〗的角色从六个描述中包含“出牌阶段”的技能中选择一个，你获得此技能直到此阶段结束。\",\r\n                        filter: function (event, player) {\r\n                            return game.hasPlayer(function (current) {\r\n                                return current != player && current.hasSkill(\"PSrebolan\");\r\n                            });\r\n                        },\r\n                        filterTarget: function (card, player, target) {\r\n                            return player != target && target.hasSkill(\"PSrebolan\");\r\n                        },\r\n                        selectTarget: function () {\r\n                            if (\r\n                                game.countPlayer(current => {\r\n                                    return lib.skill.PSrebolan_g.filterTarget(null, _status.event.player, current);\r\n                                }) == 1\r\n                            )\r\n                                return -1;\r\n                            return 1;\r\n                        },\r\n                        content: function () {\r\n                            \"step 0\";\r\n                            player.loseHp();\r\n                            \"step 1\";\r\n                            if (target.isIn() && player.isIn()) {\r\n                                if (!target.storage.PSrebolan) lib.skill.PSrebolan.initList(target);\r\n                                var list = target.storage.PSrebolan.randomGets(6);\r\n                                if (!list.length) {\r\n                                    event.finish();\r\n                                    return;\r\n                                }\r\n                                target\r\n                                    .chooseControl(list)\r\n                                    .set(\r\n                                        \"choiceList\",\r\n                                        list.map(function (i) {\r\n                                            return '<div class=\"skill\">【' + get.translation(lib.translate[i + \"_ab\"] || get.translation(i).slice(0, 2)) + \"】</div><div>\" + get.skillInfoTranslation(i, player) + \"</div>\";\r\n                                        })\r\n                                    )\r\n                                    .set(\"displayIndex\", false)\r\n                                    .set(\"prompt\", \"博览：请选择令\" + get.translation(player) + \"获得的技能\")\r\n                                    .set(\"ai\", () => {\r\n                                        var list = _status.event.controls.slice();\r\n                                        return list.sort((a, b) => {\r\n                                            return (get.skillRank(b, \"in\") - get.skillRank(a, \"in\")) * get.attitude(_status.event.player, _status.event.getParent().player);\r\n                                        })[0];\r\n                                    });\r\n                            } else event.finish();\r\n                            \"step 2\";\r\n                            target.line(player);\r\n                            player.addTempSkills(result.control, \"phaseUseEnd\");\r\n                            player.popup(result.control);\r\n                        },\r\n                        ai: {\r\n                            order: function (item, player) {\r\n                                if (player.hp >= 5 || player.countCards(\"h\") >= 10) return 10;\r\n                                var list = game.filterPlayer(current => lib.skill.PSrebolan_g.filterTarget(null, player, current));\r\n                                for (var target of list) {\r\n                                    if (get.attitude(target, player) > 0) return 10;\r\n                                }\r\n                                return 4;\r\n                            },\r\n                            result: {\r\n                                player: function (player, target) {\r\n                                    if (player.hasUnknown()) return player.hp + player.countCards(\"h\") / 4 - 5 > 0 ? 1 : 0;\r\n                                    var tao = player.countCards(\"h\", \"tao\");\r\n                                    if (player.hp + tao > 4) return 4 + get.attitude(player, target);\r\n                                    if (player.hp + tao > 3) return get.attitude(player, target) - 2;\r\n                                    return 0;\r\n                                }\r\n                            }\r\n                        },\r\n                        sub: true,\r\n                        _priority: 0\r\n                    }\r\n                },\r\n                _priority: 0\r\n            },\r\n            PSguangu: {\r\n                audio: \"clanguangu\",\r\n                trigger: {\r\n                    global: [\r\n                        \"useSkillAfter\",\r\n                        \"logSkill\"\r\n                    ]\r\n                },\r\n                usable: 1,\r\n                filter(event, player) {\r\n                    if (player.hp <= 0) return false;\r\n                    if (event.type != \"player\") return false;\r\n                    var skill = event.sourceSkill || event.skill;\r\n                    var info = get.info(skill);\r\n                    if (info.charlotte) return false;\r\n                    var translation = get.skillInfoTranslation(skill, event.player);\r\n                    if (!translation) return false;\r\n                    var match = translation.match(/“?出牌阶段/g);\r\n                    if (!match || match.every(value => value != \"出牌阶段\")) return false;\r\n                    return game.hasPlayer(current => {\r\n                        return current.countCards(\"h\");\r\n                    });\r\n                },\r\n                check: function (event, player) {\r\n                    return true;\r\n                },\r\n                async cost(event, trigger, player) {\r\n                    const num = parseInt(player.hp) || 1;\r\n                    event.result = await player\r\n                        .chooseTarget(get.prompt(\"PSguangu\"), `观看一名角色至多${get.cnNumber(num)}张牌`, function (card, player, target) {\r\n                            return target.countCards(\"h\");\r\n                        })\r\n                        .set('ai', function (target) {\r\n                            const att = get.attitude(_status.event.player, target);\r\n                            return 1 + Math.abs(att) - att;\r\n                        })\r\n                        .forResult();\r\n                },\r\n                async content(event, trigger, player) {\r\n                    const target = event.targets[0];\r\n                    const num = parseInt(player.hp) || 1;\r\n\r\n                    const { cards } = await player\r\n                        .choosePlayerCard(target, \"h\", true, [1, num])\r\n                        .set(\"prompt\", `观骨：观看${get.translation(target)}的至多${get.cnNumber(num)}张牌`)\r\n                        .set(\"ai\", button => {\r\n                            if (ui.selected.buttons.length >= _status.event.num) return 0;\r\n                            return Math.random();\r\n                        })\r\n                        .set(\"num\", num)\r\n                        .forResult();\r\n                    event.getParent().viewedCount = cards.length;\r\n\r\n                    const topCards = get.cards(num);\r\n                    const { moved } = await player\r\n                        .chooseToMove(\"观骨：与牌堆顶交换任意牌\")\r\n                        .set('list', [\r\n                            [\"牌堆顶\", topCards],\r\n                            [`${get.translation(target)}的手牌`, cards],\r\n                        ])\r\n                        .set('filterMove', function (from, to) {\r\n                            function handleGaintag(card) {\r\n                                setTimeout(() => {\r\n                                    try {\r\n                                        if (!card || !card.node) return;\r\n                                        const source = card.link;\r\n                                        const gaintag = get.owner(source) === target && _status.event.moved[0].includes(source);\r\n                                        card.node.gaintag.innerHTML = gaintag ? '被交换' : get.owner(source) === target ? '未被交换' : '';\r\n                                    } catch (e) { console.log(e); }\r\n                                }, 0)\r\n                            }\r\n                            handleGaintag(from);\r\n                            handleGaintag(to);\r\n                            return typeof to != 'number';\r\n                        })\r\n                        .set('processAI', function (list) {\r\n                            const player = _status.event.player;\r\n                            const target = _status.event.target;\r\n                            const cards = list[0][1].concat(list[1][1]).sort(function (a, b) {\r\n                                return get.attitude(player, target) >= 0\r\n                                    ? get.useful(a) - get.useful(b)\r\n                                    : get.useful(b) - get.useful(a);\r\n                            }), cards2 = cards.splice(0, _status.event.num);\r\n                            return [cards2, cards];\r\n                        })\r\n                        .set('target', target)\r\n                        .set('num', num)\r\n                        .forResult();\r\n\r\n                    const loses = moved[0].slice(), gains = moved[1].slice();\r\n                    loses.removeArray(topCards);\r\n                    gains.removeArray(cards);\r\n                    if (loses.length) await target.lose(loses, ui.cardPile);\r\n                    if (gains.length) await target.gain(gains, \"draw\");\r\n\r\n                    const filterCards = cards.filter(card => !moved[1].includes(card) && player.hasUseTarget(card, null, false));\r\n                    if (!filterCards.length) {\r\n                        return\r\n                    }\r\n\r\n                    const { bool, links } = await player\r\n                        .chooseButton([\"观骨：是否使用其中一张被交换的手牌？\", filterCards])\r\n                        .set(\"filterButton\", button => {\r\n                            return true;\r\n                        })\r\n                        .set(\"ai\", button => {\r\n                            return get.useful(button.link);\r\n                        })\r\n                        .forResult();\r\n\r\n                    if (bool) {\r\n                        const card = links[0];\r\n                        const cardx = {\r\n                            name: get.name(card, get.owner(card)),\r\n                            nature: get.nature(card, get.owner(card)),\r\n                            cards: [card],\r\n                        };\r\n                        const next = player.chooseUseTarget(cardx, [card], true, false).set(\"oncard\", card => {\r\n                            const owner = _status.event.getParent().owner;\r\n                            if (owner) owner.$throw(card.cards);\r\n                        });\r\n                        if (card.name === cardx.name && get.is.sameNature(card, cardx, true)) next.viewAs = false;\r\n                        const owner = get.owner(card);\r\n                        if (owner != player && get.position(card) == \"h\") {\r\n                            next.throw = false;\r\n                            next.set(\"owner\", owner);\r\n                        }\r\n                    }\r\n                },\r\n                _priority: 0\r\n            }\r\n        },\r\n        sort: sort.PScharacter_jin,\r\n        translate: {\r\n            PSzhongyan: \"PS钟琰\",\r\n            PSrebolan: \"博览\",\r\n            PSrebolan_info: \"出牌阶段限两次，你可以从六个含有“出牌阶段”的技能中选择一个技能，令场上一名角色获得之直到其下回合结束。其他角色的出牌阶段限一次，其可以失去1点体力，令你从六个含有“出牌阶段”的技能中选择一个，其获得此技能直到此阶段结束。\",\r\n            PSguangu: \"观骨\",\r\n            PSguangu_info: \"每名角色每回合限一次，当一名角色发动“出牌阶段”的技能后，你可以观看一名角色至多X张手牌，你可以将这些牌与牌顶堆的X张牌交换。若如此做，你可以使用其中一张被交换的手牌。（X为你体力值）\"\r\n        },\r\n        rank: rank.epic\r\n    },\r\n    PSshen_nanhualaoxian: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"shen\",\r\n            hp: 3,\r\n            skills: [\r\n                \"PSnandou\",\r\n                \"PSbeidou\",\r\n                \"PSwuji\",\r\n                \"PSdaogu\"\r\n            ],\r\n            dieAudios: [\r\n                \"ext:PS武将/audio/die:true\"\r\n            ],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“mento last”设计\",\r\n        skills: {\r\n            PSnandou: {\r\n                audio: \"ext:PS武将/audio/skill:2\",\r\n                enable: [\r\n                    \"chooseToUse\",\r\n                    \"chooseToRespond\"\r\n                ],\r\n                limited: true,\r\n                skillAnimation: true,\r\n                animationColor: \"fire\",\r\n                onremove: true,\r\n                filter: function (event, player) {\r\n                    // if (!player.countMark(\"spwuku\") || !player.countCards(\"hse\") || player.hasSkill(\"spmiewu2\")) return false;\r\n                    if (!player.countCards(\"hse\", card => get.type(card) === \"basic\")) return false;\r\n                    for (var i of lib.inpile) {\r\n                        var type = get.type2(i);\r\n                        if ((type == \"trick\") && event.filterCard(get.autoViewAs({ name: i }, \"unsure\"), player, event)) return true;\r\n                    }\r\n                    return false;\r\n                },\r\n                chooseButton: {\r\n                    dialog: function (event, player) {\r\n                        var list = [];\r\n                        for (var i = 0; i < lib.inpile.length; i++) {\r\n                            var name = lib.inpile[i];\r\n                            if (get.type2(name) == \"trick\" && event.filterCard(get.autoViewAs({ name }, \"unsure\"), player, event)) list.push([\"锦囊\", \"\", name]);\r\n                        }\r\n                        return ui.create.dialog(\"南斗\", [list, \"vcard\"]);\r\n                    },\r\n                    check: function (button) {\r\n                        if (_status.event.getParent().type != \"phase\") return 1;\r\n                        var player = _status.event.player;\r\n                        return player.getUseValue({\r\n                            name: button.link[2],\r\n                            nature: button.link[3],\r\n                        });\r\n                    },\r\n                    backup: function (links, player) {\r\n                        return {\r\n                            filterCard(card, player) {\r\n                                return get.type(card, player) == \"basic\";\r\n                            },\r\n                            // audio: \"PSnandou\",\r\n                            popname: true,\r\n                            log: false,\r\n                            check: function (card) {\r\n                                return 8 - get.value(card);\r\n                            },\r\n                            position: \"hse\",\r\n                            viewAs: { name: links[0][2], nature: links[0][3] },\r\n                            precontent: function () {\r\n                                player.logSkill(\"PSnandou\");\r\n                                if (!player.storage.PSdaogu_nandou) {\r\n                                    player.awakenSkill(\"PSnandou\");\r\n                                }\r\n                            },\r\n                        };\r\n                    },\r\n                    prompt: function (links, player) {\r\n                        return \"将一张基本牌当做\" + (get.translation(links[0][3]) || \"\") + get.translation(links[0][2]) + \"使用\";\r\n                    }\r\n                },\r\n                hiddenCard: function (player, name) {\r\n                    if (!lib.inpile.includes(name)) return false;\r\n                    var type = get.type2(name);\r\n                    return (type == \"trick\") && player.countCards(\"hse\", card => get.type(card) === \"basic\") > 0;\r\n                },\r\n                ai: {\r\n                    fireAttack: true,\r\n                    skillTagFilter: function (player) {\r\n                        if (!player.countCards(\"hse\", card => get.type(card) === \"basic\")) return false;\r\n                    },\r\n                    order: 1,\r\n                    result: {\r\n                        player: function (player) {\r\n                            return 1;\r\n                        }\r\n                    }\r\n                },\r\n                _priority: 0\r\n            },\r\n            PSbeidou: {\r\n                audio: \"ext:PS武将/audio/skill:2\",\r\n                enable: [\r\n                    \"chooseToUse\",\r\n                    \"chooseToRespond\"\r\n                ],\r\n                limited: true,\r\n                skillAnimation: true,\r\n                animationColor: \"water\",\r\n                onremove: true,\r\n                filter: function (event, player) {\r\n                    if (!player.countCards(\"hse\", card => get.type(card) === \"equip\")) return false;\r\n                    for (var i of lib.inpile) {\r\n                        var type = get.type(i);\r\n                        if ((type == \"basic\") && event.filterCard(get.autoViewAs({ name: i }, \"unsure\"), player, event)) return true;\r\n                    }\r\n                    return false;\r\n                },\r\n                chooseButton: {\r\n                    dialog: function (event, player) {\r\n                        var list = [];\r\n                        for (var i = 0; i < lib.inpile.length; i++) {\r\n                            var name = lib.inpile[i];\r\n                            if (name == \"sha\") {\r\n                                if (event.filterCard(get.autoViewAs({ name }, \"unsure\"), player, event)) list.push([\"基本\", \"\", \"sha\"]);\r\n                                for (var nature of lib.inpile_nature) {\r\n                                    if (event.filterCard(get.autoViewAs({ name, nature }, \"unsure\"), player, event)) list.push([\"基本\", \"\", \"sha\", nature]);\r\n                                }\r\n                            } else if (get.type(name) == \"basic\" && event.filterCard(get.autoViewAs({ name }, \"unsure\"), player, event)) list.push([\"基本\", \"\", name]);\r\n                        }\r\n                        return ui.create.dialog(\"北斗\", [list, \"vcard\"]);\r\n                    },\r\n                    check: function (button) {\r\n                        if (_status.event.getParent().type != \"phase\") return 1;\r\n                        var player = _status.event.player;\r\n\r\n                        return player.getUseValue({\r\n                            name: button.link[2],\r\n                            nature: button.link[3],\r\n                        });\r\n                    },\r\n                    backup: function (links, player) {\r\n                        return {\r\n                            filterCard(card, player) {\r\n                                return get.type(card, player) == \"equip\";\r\n                            },\r\n                            // audio: 2,\r\n                            popname: true,\r\n                            log: false,\r\n                            check: function (card) {\r\n                                return 8 - get.value(card);\r\n                            },\r\n                            position: \"hse\",\r\n                            viewAs: { name: links[0][2], nature: links[0][3] },\r\n                            precontent: function () {\r\n                                player.logSkill(\"PSbeidou\");\r\n                                if (!player.storage.PSdaogu_beidou) {\r\n                                    player.awakenSkill(\"PSbeidou\");\r\n                                }\r\n                            },\r\n                        };\r\n                    },\r\n                    prompt: function (links, player) {\r\n                        return \"将一张装备牌当做\" + (get.translation(links[0][3]) || \"\") + get.translation(links[0][2]) + \"使用\";\r\n                    }\r\n                },\r\n                hiddenCard: function (player, name) {\r\n                    if (!lib.inpile.includes(name)) return false;\r\n                    var type = get.type2(name);\r\n                    return (type == \"basic\") && player.countCards(\"hse\", card => get.type(card) === \"equip\") > 0;\r\n                },\r\n                ai: {\r\n                    fireAttack: true,\r\n                    respondSha: true,\r\n                    respondShan: true,\r\n                    skillTagFilter: function (player) {\r\n                        if (!player.countCards(\"hse\", card => get.type(card) === \"equip\")) return false;\r\n                    },\r\n                    order: 1,\r\n                    result: {\r\n                        player: function (player) {\r\n                            if (_status.event.dying) return get.attitude(player, _status.event.dying);\r\n                            return 1;\r\n                        }\r\n                    }\r\n                },\r\n                _priority: 0\r\n            },\r\n            PSwuji: {\r\n                audio: \"ext:PS武将/audio/skill:2\",\r\n                enable: [\r\n                    \"chooseToUse\",\r\n                    \"chooseToRespond\"\r\n                ],\r\n                filter: function (event, player) {\r\n                    if (!player.countCards(\"hse\", card => get.type2(card) === \"trick\")) return false;\r\n                    for (var i of lib.inpile) {\r\n                        var type = get.type(i);\r\n                        if ((type == \"basic\") && event.filterCard(get.autoViewAs({ name: i }, \"unsure\"), player, event)) return true;\r\n                    }\r\n                    return false;\r\n                },\r\n                chooseButton: {\r\n                    dialog: function (event, player) {\r\n                        var list = [];\r\n                        for (var i = 0; i < lib.inpile.length; i++) {\r\n                            var name = lib.inpile[i];\r\n                            const card = get.autoViewAs({ name }, \"unsure\");\r\n                            card.storage.PSwuji = true;\r\n                            if (name == \"sha\") {\r\n                                if (event.filterCard(card, player, event)) list.push([\"基本\", \"\", \"sha\"]);\r\n                                for (var nature of lib.inpile_nature) {\r\n                                    const card = get.autoViewAs({ name, nature }, \"unsure\");\r\n                                    card.storage.PSwuji = true;\r\n                                    if (event.filterCard(card, player, event)) list.push([\"基本\", \"\", \"sha\", nature]);\r\n                                }\r\n                            } else if (get.type(name) == \"basic\" && event.filterCard(card, player, event)) list.push([\"基本\", \"\", name]);\r\n                        }\r\n                        return ui.create.dialog(\"武吉\", [list, \"vcard\"]);\r\n                    },\r\n                    check: function (button) {\r\n                        if (_status.event.getParent().type != \"phase\") return 1;\r\n                        var player = _status.event.player;\r\n\r\n                        return player.getUseValue({\r\n                            name: button.link[2],\r\n                            nature: button.link[3],\r\n                        });\r\n                    },\r\n                    backup: function (links, player) {\r\n                        return {\r\n                            filterCard(card, player) {\r\n                                return get.type2(card, player) == \"trick\";\r\n                            },\r\n                            // audio: 2,\r\n                            popname: true,\r\n                            log: false,\r\n                            check: function (card) {\r\n                                return 8 - get.value(card);\r\n                            },\r\n                            position: \"hse\",\r\n                            viewAs: { name: links[0][2], nature: links[0][3], storage: { PSwuji: true } },\r\n                            precontent: function () {\r\n                                player.logSkill(\"PSwuji\");\r\n                            },\r\n                        };\r\n                    },\r\n                    prompt: function (links, player) {\r\n                        return \"将一张锦囊牌当做\" + (get.translation(links[0][3]) || \"\") + get.translation(links[0][2]) + \"使用（无次数限制）\";\r\n                    }\r\n                },\r\n                hiddenCard: function (player, name) {\r\n                    if (!lib.inpile.includes(name)) return false;\r\n                    var type = get.type2(name);\r\n                    return (type == \"basic\") && player.countCards(\"hse\", card => get.type2(card) === \"trick\") > 0;\r\n                },\r\n                ai: {\r\n                    fireAttack: true,\r\n                    respondSha: true,\r\n                    respondShan: true,\r\n                    skillTagFilter: function (player) {\r\n                        if (!player.countCards(\"hse\", card => get.type2(card) === \"trick\")) return false;\r\n                    },\r\n                    order: 1,\r\n                    result: {\r\n                        player: function (player) {\r\n                            if (_status.event.dying) return get.attitude(player, _status.event.dying);\r\n                            return 1;\r\n                        }\r\n                    }\r\n                },\r\n                mod: {\r\n                    cardUsable: function (card, player, num) {\r\n                        if (card.storage && card.storage.PSwuji) return Infinity;\r\n                    }\r\n                },\r\n                _priority: 0\r\n            },\r\n            PSdaogu: {\r\n                audio: \"ext:PS武将/audio/skill:2\",\r\n                trigger: {\r\n                    player: [\r\n                        \"logSkill\",\r\n                        \"useSkillAfter\"\r\n                    ]\r\n                },\r\n                forced: true,\r\n                init: function (player) {\r\n                    if (!player.storage.PSdaogu_count) player.storage.PSdaogu_count = 3;\r\n                },\r\n                filter(event, player) {\r\n                    const num = player.storage.PSdaogu_count;\r\n                    if (event.skill === \"PSdaogu\") return false;\r\n                    const skills = player.getSkills(true, false, false).filter(skill => !skill.startsWith(\"player_when_\") && skill !== \"PSdaogu\");\r\n                    if (!skills.includes(event.skill)) return false;\r\n                    return player.getAllHistory('useSkill', evt => skills.includes(evt.skill)).length % num === 0;\r\n                },\r\n                getResetableSkills(current) {\r\n                    const skills = current.getSkills(true, false, false).filter(skill => !skill.startsWith(\"player_when_\"));\r\n                    game.expandSkills(skills);\r\n                    const resetSkills = [];\r\n                    const suffixs = [\"used\", \"round\", \"block\", \"blocker\"];\r\n                    for (const skill of skills) {\r\n                        var info = get.info(skill);\r\n                        if (skill === 'PSnandou' && !current.storage.PSdaogu_nandou) {\r\n                            resetSkills.add(skill);\r\n                        }\r\n                        if (skill === 'PSbeidou' && !current.storage.PSdaogu_beidou) {\r\n                            resetSkills.add(skill);\r\n                        }\r\n                        if (typeof info.usable == \"number\") {\r\n                            if (current.hasSkill(\"counttrigger\") && current.storage.counttrigger[skill] && current.storage.counttrigger[skill] >= 1) {\r\n                                resetSkills.add(skill);\r\n                            }\r\n                            if (typeof get.skillCount(skill) == \"number\" && get.skillCount(skill) >= 1) {\r\n                                resetSkills.add(skill);\r\n                            }\r\n                        }\r\n                        if (info.round && current.storage[skill + \"_roundcount\"]) {\r\n                            resetSkills.add(skill);\r\n                        }\r\n                        if (current.storage[`temp_ban_${skill}`]) {\r\n                            resetSkills.add(skill);\r\n                        }\r\n                        if (Object.keys(current.disabledSkills).includes(skill)) {\r\n                            resetSkills.add(skill);\r\n                        }\r\n                        if (current.awakenedSkills.includes(skill)) {\r\n                            resetSkills.add(skill);\r\n                        }\r\n                        for (var suffix of suffixs) {\r\n                            if (current.hasSkill(skill + \"_\" + suffix)) {\r\n                                resetSkills.add(skill);\r\n                            }\r\n                        }\r\n                    }\r\n                    return resetSkills;\r\n                },\r\n                resetSkill: function (player, skill) {\r\n                    const info = get.info(skill);\r\n                    const suffixs = [\"used\", \"round\", \"block\", \"blocker\"];\r\n                    if (typeof info.usable == \"number\") {\r\n                        if (player.hasSkill(\"counttrigger\") && player.storage.counttrigger[skill] && player.storage.counttrigger[skill] >= 1) {\r\n                            delete player.storage.counttrigger[skill];\r\n                        }\r\n                        if (typeof get.skillCount(skill) == \"number\" && get.skillCount(skill) >= 1) {\r\n                            delete player.getStat(\"skill\")[skill];\r\n                        }\r\n                    }\r\n                    if (info.round && player.storage[skill + \"_roundcount\"]) {\r\n                        delete player.storage[skill + \"_roundcount\"];\r\n                    }\r\n                    if (player.storage[`temp_ban_${skill}`]) {\r\n                        delete player.storage[`temp_ban_${skill}`];\r\n                    }\r\n                    if (Object.keys(player.disabledSkills).includes(skill)) {\r\n                        player.enableSkill(skill);\r\n                    }\r\n                    if (player.awakenedSkills.includes(skill)) {\r\n                        player.restoreSkill(skill);\r\n                    }\r\n                    for (var suffix of suffixs) {\r\n                        if (player.hasSkill(skill + \"_\" + suffix)) {\r\n                            player.removeSkill(skill + \"_\" + suffix);\r\n                        }\r\n                    }\r\n                    const str = \"【\" + get.translation(skill) + \"】、\";\r\n                    if (skill === 'PSnandou') {\r\n                        player.storage.PSdaogu_nandou = true;\r\n                    }\r\n                    if (skill === 'PSbeidou') {\r\n                        player.storage.PSdaogu_beidou = true;\r\n                    }\r\n                    /* if (['PSnandou', 'PSbeidou'].includes(skill)) {\r\n                        player.storage.PSdaogu = true;\r\n                    } */\r\n                    game.log(player, \"重置了技能\", \"#g\" + str);\r\n                },\r\n                async content(event, trigger, player) {\r\n                    const choiceList = [\r\n                        `失去你的一个技能，然后令〖道骨〗描述中【】内的数子-1（当前数字：${player.storage.PSdaogu_count}）`,\r\n                        '重置或恢复场上的一个技能（若为〖南斗〗或〖北斗〗，则改为重置并失去限定技标签）',\r\n                        '随机获得场上的一个技能，直到本回合结束',\r\n                    ];\r\n                    const choices = [\r\n                        '选项一',\r\n                        '选项二',\r\n                        '选项三',\r\n                    ];\r\n                    const getResetableSkills = lib.skill[event.name].getResetableSkills;\r\n                    const resetSkill = lib.skill[event.name].resetSkill;\r\n\r\n                    /* if (!player.getSkills(true, false, false).filter(skill => !skill.startsWith(\"player_when_\")).length || player.storage.PSdaogu_count <= 1) {\r\n                        choices.remove('选项一');\r\n                        choiceList[0] = '<span style=\"opacity:0.5; \">' + choiceList[0] + \"</span>\";\r\n                    } */\r\n                    if (game.players.every(cur => getResetableSkills(cur).length === 0)) {\r\n                        choices.remove('选项二');\r\n                        choiceList[1] = '<span style=\"opacity:0.5; \">' + choiceList[1] + \"</span>\";\r\n                    }\r\n                    if (game.players.flatMap(cur => cur.getSkills(true, false, false).filter(skill => !skill.startsWith(\"player_when_\"))).every(skill => player.hasSkill(skill))) {\r\n                        choices.remove('选项三');\r\n                        choiceList[2] = '<span style=\"opacity:0.5; \">' + choiceList[2] + \"</span>\";\r\n                    }\r\n\r\n                    let control;\r\n                    if (choices.length === 1) {\r\n                        control = choices[0];\r\n                    } else if (choices.length > 1) {\r\n                        ({ control } = await player.chooseControl(choices)\r\n                            .set('choiceList', choiceList)\r\n                            .set('ai', () => {\r\n                                if (player.getSkills(true, false, false).filter(skill => !skill.startsWith(\"player_when_\")) >= 3) return '选项一';\r\n                                else if ((!player.storage.PSdaogu_nandou || !player.storage.PSdaogu_beidou) && choices.includes('选项二')) return '选项二';\r\n                                return choices.at(-1);\r\n                            })\r\n                            .forResult());\r\n                    } else {\r\n                        return;\r\n                    }\r\n\r\n                    player.logSkill(event.name);\r\n                    switch (control) {\r\n                        case '选项一': {\r\n                            const { control } = await player\r\n                                .chooseControl(player.getSkills(true, false, false).filter(skill => !skill.startsWith(\"player_when_\")))\r\n                                .set('ai', () => {\r\n                                    const choices = get.event().controls.slice().remove('PSdaogu');\r\n                                    return choices.randomGet();\r\n                                })\r\n                                .set('prompt', '请选择要失去的技能')\r\n                                .forResult();\r\n                            await player.removeSkills(control);\r\n                            if (player.storage.PSdaogu_count > 1) player.storage.PSdaogu_count--;\r\n                            break;\r\n                        }\r\n                        case '选项二': {\r\n                            const { targets } = await player.chooseTarget('请选择要重置或恢复技能的角色', true)\r\n                                .set('filterTarget', (card, player, target) => {\r\n                                    return getResetableSkills(target).length > 0;\r\n                                })\r\n                                .set('ai', (target) => {\r\n                                    const att = get.attitude(player, target);\r\n                                    if (att <= 0) return 0;\r\n                                    return att;\r\n                                })\r\n                                .forResult();\r\n                            const target = targets[0];\r\n                            const { control } = await player\r\n                                .chooseControl(target.getSkills(true, false, false).filter(skill => !skill.startsWith(\"player_when_\")).filter(skill => getResetableSkills(player).includes(skill)))\r\n                                .set('ai', () => {\r\n                                    const choices = get.event().controls;\r\n                                    return choices.randomGet();\r\n                                })\r\n                                .set('prompt', '请选择要重置或恢复技能')\r\n                                .forResult();\r\n                            resetSkill(target, control);\r\n                            break;\r\n                        }\r\n                        case '选项三': {\r\n                            const skill = game.players.flatMap(cur => cur.getSkills(true, false, false).filter(skill => !skill.startsWith(\"player_when_\"))).filter(skill => !player.hasSkill(skill)).randomGet();\r\n                            player.addTempSkills(skill, { player: \"phaseEnd\" }).set('$handle', (player, add, remove, event) => {\r\n                                player.popup(add[0]);\r\n                            });\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_shen,\r\n        translate: {\r\n            PSshen_nanhualaoxian: \"PS神南华老仙\",\r\n            PSnandou: \"南斗\",\r\n            PSnandou_info: \"限定技，你可以将一张基本牌当作锦囊牌使用。\",\r\n            PSbeidou: \"北斗\",\r\n            PSbeidou_info: \"限定技，你可以将一张装备牌当作基本牌使用。\",\r\n            PSwuji: \"武吉\",\r\n            PSwuji_info: \"你可以将一张锦囊牌当作无次数限制的基本牌使用。\",\r\n            PSdaogu: \"道骨\",\r\n            PSdaogu_info: \"锁定技，你每发动过【3】次技能（〖道骨〗除外），你选择一项：1、失去你的一个技能，然后将〖道骨〗描述中【】内的数字减1（至少为1）。2、重置或恢复场上的一个技能（若为〖南斗〗或〖北斗〗，则改为重置并失去限定技标签）。3、随机获得场上的一个技能，直到你下回合结束。\",\r\n            \"#ext:PS武将/audio/skill/PSnandou1\": \"道冲而用之或不盈，似万物之宗。\",\r\n            \"#ext:PS武将/audio/skill/PSnandou2\": \"修行无有，而外其形骸。\",\r\n            \"#ext:PS武将/audio/skill/PSbeidou1\": \"阳气施化，阴气结成，成化相合。\",\r\n            \"#ext:PS武将/audio/skill/PSbeidou2\": \"以有穷之姿，通无穷之变。\",\r\n            \"#ext:PS武将/audio/skill/PSwuji1\": \"此经所书晦涩难明，吾偶有所悟，愿为君陈之。\",\r\n            \"#ext:PS武将/audio/skill/PSwuji2\": \"大音希声，大象无形，天理难明，以经合之。\",\r\n            \"#ext:PS武将/audio/skill/PSdaogu1\": \"含气求道，祸福难料，且与阁下共参之。\",\r\n            \"#ext:PS武将/audio/skill/PSdaogu2\": \"蕴气修德，其理易现，容吾为君讲解一二。\",\r\n            \"#ext:PS武将/audio/die/PSshen_nanhualaoxian:die\": \"吾以天地为棺椁，以日月为连壁。\"\r\n        },\r\n        dynamicTranslate: {\r\n            PSdaogu: function (player) {\r\n                const num = player.storage.PSdaogu_count;\r\n                return `锁定技，你每发动过【${num}】次技能（〖道骨〗除外），你选择一项：1、失去你的一个技能，然后将〖道骨〗描述中【】内的数字减1（至少为1）。2、重置或恢复场上的一个技能（若为〖南斗〗或〖北斗〗，则改为重置并失去限定技标签）。3、随机获得场上的一个技能，直到你下回合结束。`;\r\n            }\r\n        },\r\n        rank: rank.rare\r\n    },\r\n    PShr_caocao: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"wei\",\r\n            hp: 4,\r\n            skills: [\r\n                \"PSfaxiao\"\r\n            ],\r\n            dieAudios: [\r\n                \"sb_caocao\"\r\n            ],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“九个夜白”设计\",\r\n        skills: {\r\n            PSfaxiao: {\r\n                trigger: {\r\n                    player: [\r\n                        \"loseAfter\",\r\n                        \"damageEnd\"\r\n                    ],\r\n                    global: [\r\n                        \"equipAfter\",\r\n                        \"addJudgeAfter\",\r\n                        \"gainAfter\",\r\n                        \"loseAsyncAfter\",\r\n                        \"addToExpansionAfter\"\r\n                    ]\r\n                },\r\n                frequent: true,\r\n                preHidden: true,\r\n                zhuanhuanji: true,\r\n                mark: true,\r\n                marktext: \"☯\",\r\n                intro: {\r\n                    mark: function (dialog, storage, player) {\r\n                        if (storage) {\r\n                            const skill = player.storage.PSfaxiao_pending;\r\n                            if (skill) {\r\n                                dialog.addText(`当你受到伤害后，或当你于回合外失去牌后，你获得技能〖${get.translation(skill)}〗。若已获得该技能，则：若因伤害触发，则对所有其他角色各造成一点伤害，否则弃置所有其他角色各一张牌。`, false);\r\n                                dialog.add('<div><div class=\"skill\">【' + get.translation(lib.translate[skill + \"_ab\"] || get.translation(skill).slice(0, 2)) + \"】</div><div>\" + get.skillInfoTranslation(skill, player) + \"</div></div>\");\r\n                            }\r\n                        } else {\r\n                            return \"当你受到伤害后，或当你于回合外失去牌后，你可以念一句文本包含“哼”、“呵”、“哈”的台词（随机三个自选其一）。\";\r\n                        }\r\n                    }\r\n                },\r\n                onremove: function (player) {\r\n                    delete player.storage.PSfaxiao;\r\n                    delete player.storage.PSfaxiao_pending;\r\n                },\r\n                filter: function (event, player, name) {\r\n                    if (name === \"damageEnd\") return event.num > 0;\r\n                    if (player == _status.currentPhase) return false;\r\n                    if (event.name == \"gain\" && event.player == player) return false;\r\n                    const evt = event.getl(player);\r\n                    return evt && evt.cards2 && evt.cards2.length > 0;\r\n                },\r\n                async content(event, trigger, player) {\r\n                    player.changeZhuanhuanji(\"PSfaxiao\");\r\n                    if (player.storage.PSfaxiao) {\r\n                        const map = lib.skill.PSfaxiao.getMap(),\r\n                            list = Object.keys(map);\r\n                        if (list.length > 0) {\r\n                            const skill = list.randomGet(),\r\n                                voiceMap = game.parseSkillTextMap(skill, map[skill]);\r\n                            player.storage.PSfaxiao_pending = skill;\r\n                            for (let data of voiceMap) {\r\n                                if (!data.text) continue;\r\n                                if (/[哼呵哈]/.test(data.text)) {\r\n                                    player.chat(data.text);\r\n                                    game.broadcastAll(file => game.playAudio(file), data.file);\r\n                                    break;\r\n                                }\r\n                            }\r\n                        }\r\n                    } else {\r\n                        game.broadcastAll(file => game.playAudio(file), '../extension/PS武将/audio/skill/PSfaxiao');\r\n                        const skill = player.storage.PSfaxiao_pending;\r\n                        if (skill) {\r\n                            if (player.hasSkill(skill, null, false)) {\r\n                                const targets = game.filterPlayer(current => current != player).sortBySeat();\r\n                                if (event.triggername === \"damageEnd\") {\r\n                                    player.line(targets, \"fire\");\r\n                                    for (let target of targets) {\r\n                                        if (target.isIn()) await target.damage();\r\n                                    }\r\n                                } else {\r\n                                    player.line(targets, \"thunder\");\r\n                                    for (let target of targets) {\r\n                                        if (target.isIn()) await player.discardPlayerCard('he', target, true);\r\n                                    }\r\n                                }\r\n                            } else {\r\n                                await player.addAdditionalSkills('PSfaxiao', skill, true);\r\n                                player.popup(skill, 'fire');\r\n                            }\r\n                            delete player.storage.PSfaxiao_pending;\r\n                        } else {\r\n                            game.log(player, '没有技能可获得');\r\n                        }\r\n                    }\r\n                },\r\n                getMap() {\r\n                    if (!_status.PSfaxiao_map) {\r\n                        _status.PSfaxiao_map = {};\r\n                        let list;\r\n                        if (_status.connectMode) {\r\n                            list = get.charactersOL();\r\n                        } else {\r\n                            list = get.gainableCharacters();\r\n                        }\r\n                        list.forEach(name => {\r\n                            if (name !== \"PShr_caocao\") {\r\n                                const skills = get.character(name, 3);\r\n                                skills.forEach(skill => {\r\n                                    const info = get.info(skill);\r\n                                    if (!info || (info.ai && info.ai.combo)) return;\r\n                                    const voices = game.parseSkillText(skill, name);\r\n                                    if (skill in _status.PSfaxiao_map) {\r\n                                        return;\r\n                                    }\r\n                                    if (voices.some(text => /[哼呵哈]/.test(text))) {\r\n                                        _status.PSfaxiao_map[skill] = name;\r\n                                    }\r\n                                });\r\n                            }\r\n                        });\r\n                    }\r\n                    return _status.PSfaxiao_map;\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_wei,\r\n        translate: {\r\n            PShr_caocao: \"华容曹操\",\r\n            PSfaxiao: \"发笑\",\r\n            PSfaxiao_info: \"转换技，当你受到伤害后，或当你于回合外失去牌后，阳：你可以念一句文本包含“哼”、“呵”、“哈”的台词（随机三个自选其一）；阴：你获得你上一次所念的台词所属的技能。若已获得该技能，则：若因伤害触发，则对所有其他角色各造成一点伤害，否则弃置所有其他角色各一张牌。\",\r\n            \"#ext:PS武将/audio/skill/PSfaxiao\": \"单笑周瑜无谋，诸葛亮少智。\"\r\n        },\r\n        dynamicTranslate: {\r\n            PSfaxiao: function (player) {\r\n                if (!player.storage.PSfaxiao) return '转换技，当你受到伤害后，或当你于回合外失去牌后，<span class=\"bluetext\">阳：你可以念一句文本包含“哼”、“呵”、“哈”的台词（随机三个自选其一）；</span>阴：你获得你上一次所念的台词所属的技能。若已获得该技能，则：若因伤害触发，则对所有其他角色各造成一点伤害，否则弃置所有其他角色各一张牌。';\r\n                return '转换技，当你受到伤害后，或当你于回合外失去牌后，阳：你可以念一句文本包含“哼”、“呵”、“哈”的台词（随机三个自选其一）；<span class=\"bluetext\">阴：你获得你上一次所念的台词所属的技能。若已获得该技能，则：若因伤害触发，则对所有其他角色各造成一点伤害，否则弃置所有其他角色各一张牌。</span>'\r\n            }\r\n        },\r\n        rank: rank.epic\r\n    },\r\n    PSshenpei: {\r\n        info: {\r\n            sex: \"male\",\r\n            group: \"qun\",\r\n            hp: 3,\r\n            skills: [\r\n                \"PSshouye\",\r\n                \"PSliezhi\"\r\n            ],\r\n            dieAudios: [],\r\n            trashBin: []\r\n        },\r\n        intro: \"由“mento last”设计\",\r\n        skills: {\r\n            PSshouye: {\r\n                audio: \"shouye\",\r\n                trigger: {\r\n                    global: \"roundStart\"\r\n                },\r\n                derivation: \"PSxieshou\",\r\n                direct: true,\r\n                async content(event, trigger, player) {\r\n                    await player.addTempSkills('PSxieshou', { global: \"roundStart\" });\r\n                    const { targets, bool } = await player.chooseTarget('是否令一名其他角色也获得技能〖协守〗？', lib.filter.notMe).set('ai', function (target) {\r\n                        var att = get.attitude(_status.event.player, target);\r\n                        if (att <= 0) return 0;\r\n                        return att;\r\n                    }).forResult();\r\n                    if (bool) {\r\n                        const target = targets[0];\r\n                        player.logSkill('PSshouye', target);\r\n                        await target.addTempSkills('PSxieshou', { global: \"roundStart\" });\r\n                    } else {\r\n                        player.logSkill('PSshouye');\r\n                    }\r\n                },\r\n                group: \"PSshouye_onremove\",\r\n                subSkill: {\r\n                    onremove: {\r\n                        trigger: {\r\n                            global: \"changeSkillsBegin\"\r\n                        },\r\n                        forced: true,\r\n                        filter: function (event, player) {\r\n                            return event.removeSkill.includes(\"PSxieshou\");\r\n                        },\r\n                        content: async function (event, trigger, player) {\r\n                            await trigger.player.recover();\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            PSliezhi: {\r\n                audio: \"liezhi\",\r\n                trigger: {\r\n                    player: [\r\n                        \"phaseBegin\",\r\n                        \"phaseEnd\"\r\n                    ]\r\n                },\r\n                filter: function (event, player) {\r\n                    return player.countDiscardableCards(player, \"h\") > 0 && player.hasUseTarget(\"wanjian\");\r\n                },\r\n                check(event, player) {\r\n                    const friends = player.getFriends();\r\n                    const enemies = game.filterPlayer(cur => cur !== player).removeArray(friends);\r\n                    if (friends.length > enemies.length) return false;\r\n                    if (friends.some(cur => cur.getHp(true) <= 1)) return false;\r\n\r\n                    const basicNum = player.getDiscardableCards(player, \"h\", card => get.type(card) === 'basic').length;\r\n                    const trickNum = player.getDiscardableCards(player, \"h\", card => get.type2(card) === 'trick').length;\r\n                    const equipNum = player.getDiscardableCards(player, \"h\", card => get.type(card) === 'equip').length;\r\n                    const num = Math.min(basicNum, trickNum, equipNum);\r\n                    if (player.hasSkill('PSxieshou')) return num <= enemies.length + player.hp + 1;\r\n                    return num <= enemies.length + 1;\r\n                },\r\n                async content(event, trigger, player) {\r\n                    await player.chooseUseTarget(\"wanjian\", true);\r\n                    const types = [];\r\n                    const basic = player.getDiscardableCards(player, \"h\", card => get.type(card) === 'basic');\r\n                    const trick = player.getDiscardableCards(player, \"h\", card => get.type2(card) === 'trick');\r\n                    const equip = player.getDiscardableCards(player, \"h\", card => get.type(card) === 'equip');\r\n                    if (trick.length) {\r\n                        types.push('trick');\r\n                    }\r\n                    if (equip.length) {\r\n                        types.push('equip');\r\n                    }\r\n                    if (basic.length) {\r\n                        types.push('basic');\r\n                    }\r\n                    const map = new Map([\r\n                        [\"trick\", trick],\r\n                        [\"equip\", equip],\r\n                        [\"basic\", basic]\r\n                    ]);\r\n\r\n                    let control;\r\n                    if (types.length === 1) {\r\n                        control = types[0];\r\n                    } else {\r\n                        ({ control } = await player.chooseControl(types).set('ai', () => {\r\n                            let choices = get.event().controls.slice();\r\n                            choices.sort((a, b) => {\r\n                                map.get(a).length - map.get(b).length\r\n                            })\r\n                            return choices[0];\r\n                        }).set('prompt', '烈直：请弃置一种类型的所有手牌').forResult());\r\n                    }\r\n                    await player.discard(map.get(control));\r\n                }\r\n            },\r\n            PSxieshou: {\r\n                audio: \"beizhan\",\r\n                mod: {\r\n                    targetEnabled: function (card, player, target, now) {\r\n                        if (card.name == \"juedou\") return false;\r\n                    },\r\n                    cardEnabled: function (card) {\r\n                        if (card.name == \"juedou\") return false;\r\n                    }\r\n                },\r\n                locked: true,\r\n                trigger: {\r\n                    player: \"loseAfter\",\r\n                    global: \"loseAsyncAfter\"\r\n                },\r\n                filter: function (event, player, name) {\r\n                    if (event.type != \"discard\" || event.getlx === false) return;\r\n                    var evt = event.getl(player);\r\n                    if (!evt || !evt.hs || !evt.hs.length) return false;\r\n                    for (var i = 0; i < evt.hs.length; i++) {\r\n                        if (get.position(evt.hs[i]) == \"d\") {\r\n                            return true;\r\n                        }\r\n                    }\r\n                    return false;\r\n                },\r\n                async cost(event, trigger, player) {\r\n                    const cards = [];\r\n                    const evt = trigger.getl(player);\r\n                    for (let i = 0; i < evt.hs.length; i++) {\r\n                        if (get.position(evt.hs[i], true) == \"d\") {\r\n                            cards.push(evt.hs[i]);\r\n                        }\r\n                    }\r\n                    const num = Math.min(player.getHp(true), cards.length);\r\n                    const { bool, links } = await player.chooseCardButton(`协守：是否将其中至多${get.cnNumber(num)}张牌交给同势力或拥有〖协守〗的角色`, false, cards, [1, num])\r\n                        .set(\"ai\", function (button) {\r\n                            return 1;\r\n                        })\r\n                        .forResult();\r\n                    event.result = {\r\n                        bool,\r\n                        cards: links,\r\n                    };\r\n                },\r\n                async content(event, trigger, player) {\r\n                    const cards = event.cards;\r\n                    const { targets } = await player.chooseTarget('请选择获得牌的角色', true).set('filterTarget', function (card, player, target) {\r\n                        return target.hasSkill('PSxieshou') || target.group === player.group;\r\n                    })\r\n                        .set('ai', function (target) {\r\n                            return get.attitude(get.event().player, target);\r\n                        })\r\n                        .forResult();\r\n                    if (targets.length) {\r\n                        const target = targets[0];\r\n                        if (player === target) {\r\n                            target.gain(cards, 'gain2');\r\n                        } else {\r\n                            player.give(cards, target, 'giveAuto');\r\n                        }\r\n                    }\r\n                },\r\n                group: \"PSxieshou_else\",\r\n                subSkill: {\r\n                    else: {\r\n                        audio: \"beizhan\",\r\n                        trigger: {\r\n                            player: [\r\n                                \"useCardEnd\",\r\n                                \"respondEnd\"\r\n                            ]\r\n                        },\r\n                        filter(event, player, name) {\r\n                            if (!game.hasPlayer(cur => cur.hasSkill('PSxieshou') && cur !== player)) return false;\r\n                            return name === \"respondEnd\" || (event.card && [\"shan\", \"wuxie\"].includes(get.name(event.card)));\r\n                        },\r\n                        async cost(event, trigger, player) {\r\n                            event.result = await player.chooseTarget('协守：是否令一名拥有〖协守〗的其他角色摸一张牌？').set('filterTarget', function (card, player, target) {\r\n                                return target.hasSkill('PSxieshou') && target !== player;\r\n                            })\r\n                                .set('ai', function (target) {\r\n                                    return get.attitude(get.event().player, target);\r\n                                })\r\n                                .forResult();\r\n                        },\r\n                        content: async function (event, trigger, player) {\r\n                            const target = event.targets[0];\r\n                            await target.draw();\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        sort: sort.PScharacter_qun,\r\n        translate: {\r\n            PSshenpei: \"PS审配\",\r\n            PSshouye: \"守邺\",\r\n            PSshouye_info: \"每一轮开始时，你获得技能〖协守〗并且可以令一名角色获得技能〖协守〗直到下一轮开始。当一名角色失去技能〖协守〗时，其恢复一点体力。\",\r\n            PSliezhi: \"烈直\",\r\n            PSliezhi_info: \"回合开始时或回合结束时，你可以视为使用一张【万箭齐发】，并弃置一种类型的所有手牌。\",\r\n            PSxieshou: \"协守\",\r\n            PSxieshou_info: \"锁定技，你不能成为【决斗】的目标且不能使用【决斗】。当你响应牌后，你可以令一名拥有技能〖协守〗的其他角色摸一张牌；当你弃置手牌后，你可以将其中至多X张弃置牌交给给同势力或拥有〖协守〗的角色（X为你的体力值）。\"\r\n        },\r\n        rank: rank.rare\r\n    }\r\n}","import { lib, game, ui, get, ai, _status } from 'noname'\r\nimport { convertDataToOptions } from \"../../utils/convert.js\"\r\nimport { pack, data } from \"./data.js\"\r\nimport { onContent } from \"../../utils/hooks.js\"\r\n\r\nconst {\r\n\tcharacter,\r\n\tcharacterFilter,\r\n\tcharacterIntro,\r\n\tcharacterReplace,\r\n\tcharacterSubstitute,\r\n\ttranslate,\r\n\tdynamicTranslate,\r\n\trank: { junk, rare, epic, legend },\r\n\tskill,\r\n\tcharacterSort,\r\n} = convertDataToOptions(pack, data);\r\n\r\nawait game.import(\"character\", function () {\r\n\treturn {\r\n\t\tname: pack.name,\r\n\t\tcharacter,\r\n\t\tcharacterFilter,\r\n\t\tcharacterIntro,\r\n\t\tcharacterReplace,\r\n\t\tcharacterSubstitute,\r\n\t\ttranslate,\r\n\t\tdynamicTranslate,\r\n\t\tskill,\r\n\t\tcharacterTitle: {}, //武将称号\r\n\t\tperfectPair: {}, //珠联璧合\r\n\t\tcard: {}, // 卡牌\r\n\t\tcharacterSort,\r\n\t};\r\n});\r\n\r\nonContent(() => {\r\n\tlib.rank.rarity.junk.addArray(junk || []);\r\n\tlib.rank.rarity.rare.addArray(rare || []);\r\n\tlib.rank.rarity.epic.addArray(epic || []);\r\n\tlib.rank.rarity.legend.addArray(legend || []);\r\n});\r\n\r\n"],"names":["getCardsSuitsLen","cards","player","suits","i","length","suit","get","lib","includes","add","sort","PScharacter_wei","PScharacter_shu","PScharacter_wu","PScharacter_qun","PScharacter_jin","PScharacter_shen","PScharacter_db","rank","junk","rare","epic","legend","pack","name","translate","data","PSshouyige","info","sex","group","hp","skills","dieAudios","isBossAllowed","isBoss","trashBin","intro","PSshuangquan","mod","selectTarget","card","range","cardUsable","num","globalFrom","from","to","distance","globalTo","trigger","global","forced","filter","event","game","phaseNumber","hasEnabledSlot","content","equips","expand","equip","countEnabledSlot","countDisabledSlot","expandEquip","_priority","preHidden","subSkill","phase","audio","storage","PSshuangquan_phase","priority","insertPhase","sub","clear","use","direct","allowMultiple","type","targets","multitarget","hasPlayer","current","targetEnabled2","targetInRange","countPlayer","chooseTarget","translation","target","_status","getTrigger","set","effect","result","bool","me","isOnline","delayx","finish","sortBySeat","addArray","niepan","unique","mark","skillAnimation","animationStr","limited","animationColor","PSshuangquan_niepan","cancel","awakenSkill","maxHp","update","recoverTo","ai","order","skillTagFilter","arg","save","countCards","threaten","more","popup","silent","damage","source","triggername","Math","floor","again","getParent","findPlayer2","autoViewAs","canUse","createCard","createCard2","chooseUseTarget","numFixed","PSshuangquan_info","PSrexusheng","PSpojun","shaRelated","say","randomGet","next","gainPlayerCard","min","prompt","button","goon","val","value","link","getEquip","attitude","PSpojun_info","PSsunquan","replace","PSzhiheng","inherit","else","log","usable","prompt2","PSzhiheng_info","check","addedTargets","countDiscardableCards","cost","chooseToDiscard","Infinity","forResult","cost_data","hs","getCards","logSkill","every","draw","PScaocao","isZhugong","PSjianxiong","audioname","position","itemtype","gain","maixie","maixie_hp","hasSkillTag","tag","evt","filterInD","getDamagedHp","PSjianxiong_info","PSdianwei","PSqiangxi","enable","skill","getUseSkillTime","getAllHistory","hasCard","filterCard","filterTarget","subtype","stat","getStat","_PSqiangxi","selectCard","push","markSkill","hasSkill","ui","selected","damageEffect","PSsizhan","dutySkill","locked","derivation","init","changeSkillAudio","defend","history","actionHistory","useSkill","some","index","findLastIndex","splice","currentPhase","achieve","loseMaxHp","addSkills","fail","PSqiangxi_info","PSsizhan_info","PSzhangjiao","PSleiji","judge","judge2","recover","useShan","hastarget","be","color","PSleiji_info","PSsunshangxiang","PSxiaoji","frequent","getl","es","count","chooseBool","all","goto","noe","reverseEquip","cardtag","PSjieyin","hasSex","canEquip","discard","delay","lose","_result","chooseControl","$give","forEach","isHealthy","needsToDiscard","PSxiaoji_info","PSjieyin_info","PSliuzan","PSfenyin","getHistory","PSfenyin_info","PSyuanshu","PSjiwei","identity","zhu","isZhu","logTarget","sf","setIdentity","identityShown","showIdentity","gainMaxHp","PSqifan","mode","players","PSjiwei_info","PSqifan_info","PSzhanghe","PSqiaobian","isMine","aicheck","att","gainMultiple","expose","canMoveCard","moveCard","PSqiaobian_info","PSsh_zhangfei","PSshihuang","PSpaoxiao","firstDo","onremove","audioed","countUsed","addMark","remove","countMark","unequip","PSshihuang_info","PSpaoxiao_info","PStongxiangge","PStongxiang","PStongxiang_info","PSrs_wolong","PSranshang","hasNature","isAlive","randomDiscard","addSkill","name2","marktext","loseHp","PSranshang_info","PShuanggai","PSkurou","PSkurou_info","PSxushao","PSpingjian","initList","list","connectMode","charactersOL","character","characterDisabled2","characterDisabled","countPlayer2","name1","rehuashen","removeArray","characterlist","map","randomSort","indexOf","skills2","j","PSfushi","characterList","list2","expandSkills","k","juexingji","zhuanhuanji","hiddenSkill","Array","isArray","combo","notemp","neg","e","control","addTempSkill","phaseUse_special","PSpingjian_info","PSpingjian_use","PScaoxiu","PSqianju","max","cardname","cardnature","disableEquip","PSqingxi","PSqingxi_damage","getAttackRange","discardPlayerCard","hasMark","removeMark","summer","PSqianju_info","PSqingxi_info","PSshen_zhuge","PSqixing","getExpansions","addToExpansion","gaintag","chooseToMove","concat","a","b","useful","pushs","moved","gains","markcount","dialog","isUnderControl","cnNumber","addAuto","PSkuangfeng","addAdditionalSkill","playerid","markAuto","chooseCardButton","loseToDiscardpile","links","charlotte","getStorage","unmarkAuto","removeAdditionalSkill","PSdawu","isMin","allUse","nofire","nodamage","PSqixing_info","PSkuangfeng_info","PSdawu_info","PShuangyueying","PSjizhi","cardNameLength","showCards","cardsx","cardsDiscard","c","noautowuxie","aiOrder","PSqicai","isUse","evtx","evt2","relatedEvent","now","maxHandcard","numx","getGlobalHistory","discardPile","cards2","PSjizhi_info","PSqicai_info","PSshen_ganning","PSjieying","isTurnedOver","getHandcardLimit","line","give","nokeep","PSjieying_info","PSguanning","PSdunshi","hiddenCard","inpile","str","chooseButton","inpile_nature","create","isCard","getUseValue","backup","popname","viewAs","precontent","PSdunshi_damage","characterPack","mode_guozhan","zhuSkill","bolan","banned","PSdunshi_list","respondSha","respondShan","dunshi","dying","removeSkill","videoId","status","func","id","card2","card3","choiceList","firstChild","addEventListener","config","touchscreen","click","Object","setPrototypeOf","element","Button","prototype","buttons","isOnline2","send","auto","style","display","isDamaged","close","randomGets","addText","controls","broadcastAll","PSdunshi_info","PSzhaoxiang","substitute","removeHTML","text","getAllCharacters","allPack","hasOwnProperty","allList","getPackIdArray","uname","listx","shed","l","PShuashen","chooseToFuHan","list1","TLHasExt","con","document","getElementById","classList","initbg","div","body","TLremoveSkillInfo","initDialog","transform","textContent","topic","TLCreateStand","initBord","cssText","flat","x","TLCreateHead","td","left","top","this","animation","contains","total","TLcreateSkillInfo","switchToAuto","resume","imchoosing","pause","countChoose","wait","newList","audioname2","old_yuanshu","changeSkin","fanghun","gainableCharacters","dead","swapPlayerAuto","rSkill","table","createElement","margin","width","appendChild","innerHTML","dragged","justdragged","tempNoButton","setTimeout","open","isMinHp","PSfushi_info","PSlukang","clans","PSjueyan","chooseToDisable","hasUseTarget","getCardUsable","type2","isDisabled","hasValueTarget","PSjueyan_info","PSliru","PSjuece","awakenedSkills","restoreSkill","PSjuece_info","PScaoang","isAiForbidden","PSkangkai","isIn","chooseCard","PSkangkai_info","PSzuoci","addHuashens","logged","noclearcountdown","slice","cond","skillRank","aiSkills","aiChoice","choice","current2","random","item","noclick","node","$createButton","stopCountChoose","idDialog","childNodes","additionalSkills","removeHuashen","defaultDialog","closeDialog","btn","textNode","querySelector","replaceAll","find","skillName","syncStorage","updateMarks","bannedType","addHuashen","pingjian","skillCategoriesOf","drawCharacter","fullimage","image","rawName2","$draw","buttonPresets","skillstr","join","skillnode","caption","groupnature","name_font","bottom","_customintro","uiintro","characterInfo","capt","charactergroup","charactergroups","is","double","characterTitle","colorspan","nobracket","skillInfoTranslation","_place_text","onunmark","addSmall","change","gender","gender2","group2","old","tempname","flashAvatar","changeGroup","PSxinsheng","blocked","PShuashen_info","PSxinsheng_info","PSzhoutai","PSbuqu","isDying","_PSbuqu","number","mingzhi","PSfenji","discarder","giver","getg","filterPlayer","shift","PSbuqu_info","PSfenji_info","dynamicTranslate","PSerciyuan","PSzanhe","canRecast","recast","PSzanhe_info","PSdahantianzi","PSshengshi","seat","redo","PSluanshi","sum","cardsGotoOrdering","triggeredTargets2","PSshanrang","hasZhuSkill","canCompare","eff","playerExpect","chooseToCompare","zhuSkill_PSshanrang","die","PSshengshi_info","PSluanshi_info","PSshanrang_info","PSnanhualaoxian","PSyufeng","roundNumber","apply","canBeGained","sqrt","target1","target2","swapSeat","PStianshu","equipSkill","noHidden","isFriendOf","countGroup","taipingyaoshu","arguments","nothunder","PSyinshi","phaseList","PSyufeng_info","PStianshu_info","PSyinshi_info","PSzhangsong","PSqiangzhi","subfrequent","choosePlayerCard","PSqiangzhi_draw","addVideo","PSxiantu","xiantu4","PSqiangzhi_info","PSxiantu_info","PSquansun","PShengzhi","countSkill","PSnengwan","PShengzhi_info","PSnengwan_info","PSjiesuanjie","PSzailaiyici","parent","effectCount","PSzailaiyici_info","PSguanyunchang","PSweizhen","getInfo","notLink","damageBonus","hit","directHit","directHit_ai","slist","chongzhu","PSweizhen_info","PSshen_zhaoyun","PSjuejing","PSjuejing_info","PSzhangxuan","PStongli","isFirstTarget","PStongli_info","PScenhun","PSlianhuo","isLinked","PSlianhuo_info","PSshiniangongzhu","PSshanjia","aiValue","sync","PSshanjia_number","updateMark","disvalue","original","useCard","reverseOrder","PSshanjia_info","PScaojinyu","PSyuqi","cards1","pop","cardPile","insertBefore","fix","loseAsync","gain_list","animate","setContent","PSshanshen","hasAllHistory","PSxianjing","PSyuqi_info","PSshanshen_info","PSxianjing_info","PSzhaoyun","PShuwei","online","hasFriend","PShuwei_info","PScaochun","PSreshanjia","nature","nowuxie","PSxiaorui","basic","PSreshanjia_info","PSxiaorui_info","PScaoshuang","PStuogu","getStockSkills","caoshuang","PStuogu_info","PSxian_caozhi","PSluoying","ignoredHandcard","hasGaintag","cardDiscardable","removeGaintag","PSjiushi","jiu","jiu_effect","avatar","jiu2","avatar2","maintain","lastDo","viewAsFilter","isPhaseUsing","getActCount","actcount","shas","hasSha","PSluoying_info","PSjiushi_info","PSsunben","PSbaiban","PSbb_hunzi","removeSkills","PSbaiban_info","PSbb_hunzi_info","PSduyu","PSmiewu","fireAttack","failure","PSqiyang","PSmiewu_info","PSqiyang_info","PSshen_jiangweix","PSjiufa","cardsy","PSkefu","yingbian","viewer","base","hasShan","mayHaveShan","canLink","linked","sha","isLink","respond","natureDamage","fireDamage","thunderDamage","poisonDamage","addCount","PSwantian","num1","num2","PSjiufa_info","PSkefu_info","PSwantian_info","PShs_zhonghui","PSmn_quanji","maxHandcardBase","PSmn_paiyi","contentx","PSmn_paiyi_backup","PSmn_quanji_info","PSmn_paiyi_info","PSzhuangbeidashi","PSshenzhu","he","info1","info2","vanish","cardimage","modTarget","equipCard","onEquip","onLose","equipValue","equipResult","console","PSshenzhu_info","PSboss_lvbu1","PSjingjia1","types","isEmpty","newCard","canBeDiscarded","canBeReplaced","cardEnabled2","blocker","slots","PSaozhan1","wuqi","fangju","zuoji","baowu","baowu2","turnOver","PSbaguan1","enter","rand","updateRoundNumber","bianshen","reinitCharacter","resetSkills","paused","step","roundStart","PSjingjia1_info","PSaozhan1_info","PSbaguan1_info","PSboss_lvbu2","PSshenwei2","PSshenji2","nopup","multi","PSbaguan2","hp_MaxHp","reinit","skillsx","PSjiwu3","startsWith","PSshenwei2_info","PSshenji2_info","PSbaguan2_info","PSboss_lvbu3","PSshenqu3","tao","chooseToUse","qiangxix","superCharlotte","audio1","playAudio","audio2","audio4","audio5","PSshenqu3_info","PSjiwu3_info","PSboss_lvbu4","PSkuangbao4","PSshenfen4","contorl","unmarkSkill","notMe","$gain2","PSkuangbao4_info","PSshenfen4_info","PSshengui","PSshenqu","PSjiwu","PSmn_qiangxix","PSmn_qiangxi","inRange","used","PSshenqu2","PSshenqu_info","PSjiwu_info","PSmn_qiangxi_info","PSzhangrang","PStaoluan","onuse","PStaoluan_info","PSxizhicai","PSxianfu","PSxianfu_target","PSxianfu_info","isDead","PSxianfu_mark","PSchouce","guohe","PSchouce_info","PSxiahoujie","PSdanda","PSdanda_info","PSqun_sunce","PSxiaozhan","kill","drawTo","PSzengxi","PShuju","baseDamage","PSxiaozhan_info","PSzengxi_info","PShuju_info","PSgaoguimingmen","PSluansha","hasHistory","PSluansha_info","PSsishouyige","PShengce","playSkillAudio","PShengce_info","db_PSdaweiwuwang","doubleGroup","PSdwww_zhiheng","expire","PSxiangong","groupSkill","xinyingshi_source","PScuicheng","PSdwww_zhiheng_info","PSxiangong_info","PScuicheng_info","PShw_sunquan","PShuiwan","addGaintag","PShuiwan_info","PSyangbiao","PSzhaohan","PSyizheng","skip","skipList","ts","PSzhaohan_info","PSyizheng_info","PSguosi","PStanbei","PSsidao","getLastUsed","PSsidao_info","window","PStanbei_info","PSshen_huangzhong","PSdingjun","customArgs","extraDamage","changeHujia","PSdingjun_info","PSshen_guojia","PShuishi","numbers","callback","isMaxHandcard","orderingCards","judgeResult","PShuishi_info","PSzhenji","PSluoshen","bottomCards","loseToSpecial","visible","PSqingguo","geti","aiUseful","qingguo","nopop","PSluoshen_info","PSqingguo_info","PSwu_zhangliao","PSwu_tuxi","delayed","copy","setHiddenSkill","createEvent","PSwu_zhenzhan","PSwu_zhangliao_prefix","PSwu_tuxi_info","PSwu_zhenzhan_info","PSsunru","PSyingjian","PSshixin","end","PSyingjian_info","PSshixin_info","PSfuzhijie","PSfuzhi","PSfuzhi_info","PSfx_shen_guanyu","PSshenwu","target_use","nd","keep","tri","side","getEnemy","PShunwu","revive","PSshenwu_info","PShunwu_info","PSpeixiu","PSxingtu","xingtu1","num3","answer","toString","timer","show","countDown","hide","o","clearInterval","controlbars","at","record","HasExtension","marks","disable","PSjuezhi","PSjuezhi_info","PSxingtu_info","PSshen_liubei","PSlongnu","changeZhuanhuanji","nuzhan","yang","yin","halfneg","PSlb_jieying","PSlongnu_info","PSlb_jieying_info","PSjin_duyu","PSsanchen","PSzhaotao","forbid","isDisabledJudge","disableJudge","PSpozhu","complexSelect","complexCard","PSjin_miewu","phaseDraw","PSjin_duyu_prefix","PSsanchen_info","PSzhaotao_info","PSpozhu_info","PSjin_miewu_info","PSsb_xushao","PSsb_pingjian","chooseToPingJian","PSsb_pingjian_temp","onChooseToUse","temp","sourceSkill","PSsb_pingjian_info","PSxushi","PSwengua","PSfuzhu","chooseControlList","insert_card","cardx","$throw","childElementCount","asyncDraw","findPlayer","gaintag_map","onWash","washed","onwash","PSfuzhu_target","cardPile2","ceil","PSwengua_1","PSwengua_info","PSfuzhu_info","PSwengua_1_info","PSjiaxu","PSluanwu","multiline","targetx","PSwansha","PSluanwu_info","PSwansha_info","PSshen_zhangliao","PSduorui","listm","listv","disabledSkills","disableSkill","countDisabled","name3","enableSkill","PSduorui_info","PSguanyu","PSwusheng","shanRequired","PSyijue","parentNode","table2","recoverEffect","PSmashu","PSwusheng_info","PSyijue_info","PSmashu_info","PSshen_zhangfei","PSshencai","getStr","filterx","losehp","weapon","addinfomenu","added","dist","attackFrom","cardPrompt","yingbian_prompt","death","PSxunshi","PSshencai_info","PSxunshi_info","PSmeng_liubei","PStaoyuan","PSshiren","inRangeOf","PSmeng_liubei_prefix","PStaoyuan_info","PSshiren_info","PSshen_dengai","PStuoyu","PSshen_dengai2","cardIsIgnored","tags","_","PSxianjin","PSqijing","forceDie","_isStandardLoop","PStuoyu_info","PSxianjin_info","PSqijing_info","PSshen_xunyu","PSlingce","PSdinghan","PStianzuo","async","washCard","PSzuoding","PSlingce_info","PStianzuo_info","PSdinghan_info","PSzuoding_info","PShaozhao","PSzhengu","abs","buffTarget","PSzhengu_mark","PSzhengu_info","PSxuyou","PSchenglve","PSchenglve_effect","PSshicai","eff1","reverse","PSchenglve_info","PSshicai_info","PSshen_sunquan","PSyuheng","getList","keepSkill","reduce","arr","ele","PSdili","PSyuheng_info","PSdili_info","PSshen_dianwei","PSjuanjia","PSjuanjia_info","PSlvmeng","PSbolan","changeToZero","PSgongxin","PSbolan_info","PSgongxin_info","PSzhonghui","PSquanshu","cs","PSpaiyi","PSpaiyi_backup","PSquanshu_info","PSpaiyi_info","PSlibai","PSjiuxian","hs1","getPingZe","hs2","ignore","PSshixian","PSjiuxian_info","PSshixian_info","PSshixian_ping","PSshixian_ze","PSxie_sunquan","PSzongheng","checkMod","PSxiqu","countGainableCards","PSchengchen","hasJudge","basis","PSzongheng_info","PSxiqu_info","PSchengchen_info","PSshu_sunshangxiang","PSliangzhu","PSfanxiang","forceunique","PSliangzhu_info","PSfanxiang_info","PSmenghuo","PShuoshou","PSxingluan","getNum","damageNum","PShuoshou_info","PSxingluan_info","PSzhugeliang","PSjiqiao","PShuoji","chat","PSpingnan","PSjiqiao_info","PShuoji_info","PSpingnan_info","PSpanzhangmazhong","PSduodao","maixie_defend","PSanjian","targetEnabled","getEquips","PSduodao_info","PSanjian_info","PSlingcao","PSdujin","PSgudan","PSdujin_info","PSgudan_info","PSliubei","PSrende","targetprompt","PSrende_info","PScaoren","PSjushou","chooseUse","PSbianzhen","PSjushou_info","PSbianzhen_info","PSzhangfei","PSrepaoxiao","PSliyong","shaMiss","useCardToPlayered","damageSource","PSliyong_effect","ignoreSkill","getSkills","PSrepaoxiao_info","PSliyong_info","PSreluxun","PSreqianxun","nh","singleCard","PSrelianying","noh","PSreluxun_prefix","PSreqianxun_info","PSrelianying_info","PSxurong","PSxionghuo","effect_use","hasUnknown","card1","playerEnabled","low","PSshajue","PSxionghuo_info","PSshajue_info","PSlifeng","PStunchu","choose","PSshuliang","PStunchu_info","PSshuliang_info","PSchenshi","PSqingbei","p","setStorage","PSqingbei_info","PSben_sunben","PShunzi","PSduwu","PSchoushang","PShuaiji","PSchanhuo","PShunzi_info","PSduwu_info","PSchoushang_info","PShuaiji_info","PSchanhuo_info","PSqun_zhaoyun","PSlongwei","PSqiangshu","odds","cache","getTempCache","putTempCache","natureList","PSlongwei_info","PSqiangshu_info","PSxuzhu","PSluoyi","when","then","wuxie","_trueMe","hsx","PShanzhan","disabledSlots","enableEquip","chooseToEnable","PSluoyi_info","PShanzhan_info","PSgongsunzan","PSdangkou","PSdangkou_info","PSbaima","PSbaima_info","PSdongzhuo","PSlingbao","PSjiuchi","_jiu_temp","mayHaveSha","effs","cardid","PSzongyu","PSlingbao_info","PSjiuchi_info","PSzongyu_info","PShuangzhong","PSxujin","getUseNumber","getSuitNumber","PSxujin_info","PSshen_simayi","PSrenjie","getlx","PSbaiyin","PSrenjie_info","PSbaiyin_info","PSyue_caiwenji","PSshuangjia","PSyue_caiwenji_prefix","PSshuangjia_info","PScaopi","PSfangzhu","turnfriend","PSxingshang","togain","PSfangzhu_info","PSxingshang_info","PScaoying","PSlingren","PSlingren_damage","PSlingren_multi","trick","choices","getSkill","audioName","char","PSfujian","Targets","PSlingren_info","PSfujian_info","PSdian_huanggai","PSshiming","PSdian_huanggai_prefix","PSshiming_info","PSliaohua","PSdangxian","rewrite","inpileVCardList","PSfuli","chooseToAddSkill","fuli","PSdangxian_info","PSfuli_info","PSquyi","PSjiaozi","presha","PSfuqi","PSjiaozi_info","PSfuqi_info","PSmachao","PStieji","PStieji_target","chooseToDuiben","canGain","confirm","true1","true2","false","PScema","assign","PStieji_info","PScema_info","PSqun_machao","PSzhuiming","playerx","PSjinge","PSzhuiming_info","PSjinge_info","PSluji","PShuaiju","filterDamage","PSzhenglun","PShuaiju_info","PSzhenglun_info","PSluxun","PSqianxun","PSlianying","getSuitsLength","PSqianxun_info","PSlianying_info","PSlvbu","PSwushuang","wushuangfangtianji","hasEmptySlot","wushuangfangtianji_skill","attackRange","PSbaifu","PSbaifu_yifu","yifu","PSpanshi","PSpanshi_use","noai","PSwushuang_info","PSbaifu_info","PSpanshi_info","PSshen_zuoci","PSshen_huashen","invalid","rarity","addAdditionalSkills","PSshen_huashen_use","chooseHuashenCharacter","setAvatar","setAvatarQueue","setBackgroundImage","PSshen_jihun","dyingAfter","PSshen_xinsheng","removeAdditionalSkills","PSshen_huashen_info","PSshen_jihun_info","PSshen_xinsheng_info","str1","str2","PSreyuanshu","PSshelian","PSjixi","isMe","globalHistory","changeHp","PSshelian_info","PSjixi_info","PSwenyang","PSlvli","PSbeishui","PSchoujue","PSqingjiao","unequip_ai","PSlvli_info","PSchoujue_info","PSbeishui_info","PSqingjiao_info","PSzhongyan","PSrebolan","chargeSkill","addTempSkills","g","forceaudio","PSrebolan_g","PSguangu","match","parseInt","viewedCount","topCards","handleGaintag","owner","loses","filterCards","sameNature","throw","PSrebolan_info","PSguangu_info","PSshen_nanhualaoxian","PSnandou","PSdaogu_nandou","PSbeidou","PSdaogu_beidou","PSwuji","PSdaogu","PSdaogu_count","getResetableSkills","suffixs","suffix","counttrigger","skillCount","round","keys","resetSkill","cur","flatMap","PSnandou_info","PSbeidou_info","PSwuji_info","PSdaogu_info","PShr_caocao","PSfaxiao","PSfaxiao_pending","getMap","voiceMap","parseSkillTextMap","test","file","PSfaxiao_map","voices","parseSkillText","PSfaxiao_info","PSshenpei","PSshouye","PSliezhi","friends","getFriends","enemies","getHp","basicNum","getDiscardableCards","trickNum","equipNum","Map","PSxieshou","cardEnabled","PSshouye_info","PSliezhi_info","PSxieshou_info","characterFilter","characterIntro","characterReplace","characterSubstitute","characterSort","convertDataToOptions","import","perfectPair","onContent"],"mappings":"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"}