const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["index.js","convert.js","index2.js"])))=>i.map(i=>d[i]);
import{lib as e,get as n,game as t,ui as a}from"noname";let i="2.2.0",s="1.10.12";const o=[],r=[],c={},l={arenaReadyHooks:[],contentHooks:o,prepareHooks:[],precontentHooks:r,configObj:c,helpObj:{}};function u(e){o.push(e)}function d(e){r.push(e)}function p(e){Object.assign(c,e)}function g(n,t,a){"string"==typeof n&&(n=[n]),n.forEach(n=>{"string"==typeof t&&(t=[t]),t.forEach(t=>{e.skill[n]&&(e.skill[n].audioname2||(e.skill[n].audioname2={}),e.skill[n].audioname2[t]=a)})})}d(async()=>{e.namePrefix&&(e.namePrefix.set("PS",{color:"#fdd559",nature:"soilmm",getSpan:(e,n)=>{const t=document.createElement("span"),a=t.style;return a.writingMode=a.webkitWritingMode="horizontal-tb",a.fontFamily="MotoyaLMaru",a.transform="scaleY(0.85)",t.textContent="PS",t.outerHTML}}),e.namePrefix.set("PS神",{getSpan:(e,t)=>`${n.prefixSpan("PS")}${n.prefixSpan("神")}`}),e.namePrefix.set("PS梦",{getSpan:(e,t)=>`${n.prefixSpan("PS")}${n.prefixSpan("梦")}`}),e.namePrefix.set("PS武",{getSpan:(e,t)=>`${n.prefixSpan("PS")}${n.prefixSpan("武")}`}),e.namePrefix.set("PS晋",{getSpan:(e,t)=>`${n.prefixSpan("PS")}${n.prefixSpan("晋")}`}),e.namePrefix.set("PS乐",{getSpan:(e,t)=>`${n.prefixSpan("PS")}${n.prefixSpan("乐")}`}),e.namePrefix.set("PS经典",{getSpan:(e,t)=>`${n.prefixSpan("PS")}${n.prefixSpan("经典")}`}),e.namePrefix.set("PS界",{getSpan:(e,t)=>`${n.prefixSpan("PS")}${n.prefixSpan("界")}`}))}),u(()=>{e.translate.phaseBegin="回合开始阶段",e.translate.phaseZhunbei="准备阶段",e.translate.phaseJudge="判定阶段",e.translate.phaseDraw="摸牌阶段",e.translate.phaseUse="出牌阶段",e.translate.phaseDiscard="弃牌阶段",e.translate.phaseJieshu="回合结束阶段"}),u(()=>{g("qiangxix",["PSboss_lvbu2","PSboss_lvbu3","PSboss_lvbu4"],"qiangxi_boss_lvbu3"),g("rewansha",["PSboss_lvbu2","PSboss_lvbu3","PSboss_lvbu4","PSshengui"],"wansha_boss_lvbu3"),g("retieji",["PSboss_lvbu2","PSboss_lvbu3","PSboss_lvbu4"],"retieji_boss_lvbu3"),g("sbtieji","PSshengui","retieji_boss_lvbu3"),g("decadexuanfeng",["PSboss_lvbu2","PSboss_lvbu3","PSboss_lvbu4","PSshengui"],"xuanfeng_boss_lvbu3"),g("wushuang",["PSboss_lvbu1","PSboss_lvbu2","PSboss_lvbu3","PSboss_lvbu4","PSshengui"],"ext:PS武将/audio/skill:8"),g("hujia","PScaocao","hujia_re_caocao"),g("rejijiang","PSliubei","jijiang1_re_liubei"),g("tiandu","PSxizhicai","tiandu_xizhicai"),g("clanbaozu","PSzhonghui","clanbaozu_clan_zhonghui"),g("clanbaozu","PSzhongyan","clanbaozu_clan_zhongyan"),g("songwei","PScaopi","songwei_re_caopi"),g(["refanghun","ollongdan"],"PSzhaoxiang",["ext:PS武将/audio/skill/PSfanghun1","ext:PS武将/audio/skill/PSfanghun2"]),g(["refanghun","ollongdan"],"PSzhaoxiang2",["ext:PS武将/audio/skill/PSfanghun_PSzhaoxiang21","ext:PS武将/audio/skill/PSfanghun_PSzhaoxiang22"]),g("PSfushi","PSzhaoxiang2",["ext:PS武将/audio/skill/PSfushi_PSzhaoxiang21","ext:PS武将/audio/skill/PSfushi_PSzhaoxiang22"]),g("dccuixin","PSshen_dengai2",["ext:PS武将/audio/skill/cuixin_PSshen_dengai21","ext:PS武将/audio/skill/cuixin_PSshen_dengai22"])}),p({introduce:{name:"扩展介绍",init:"1",unfrequent:!0,intro:"查看扩展介绍",item:{1:"<font color=#2cb625>查看"},textMenu:function(n,t){e.setScroll(n.parentNode),n.parentNode.style.transform="translateY(-100px)",n.parentNode.style.width="350px",n.style.cssText="width: 350px; padding:5px; box-sizing: border-box;",n.innerHTML='<p style="line-height: 1.3; margin:0; padding: 0; text-indent: 2em;">本扩展主要是对本体武将进行不同方向的强化设计，设计方案大部分来自于网友，小部分来自本人（均有备注），强度基本上处<font class="firetext">半阴</font>到<font class="firetext">阴间</font>的范围。如果你在游玩过程中遇到bug，可以通过qq群或b站私信（b站同名）向本人反馈。</p>'}}}),u(()=>{n.mode&&"boss"!==n.mode()&&(e.translate["#boss_lvbu1:die"]="虎牢关，失守了……",e.translate["#xiuluo1"]="准备受死吧！",e.translate["#xiuluo2"]="鼠辈！螳臂当车！",e.translate["#shenwei1"]="萤烛之火，也敢与日月争辉？",e.translate["#shenwei2"]="我不会输给任何人！",e.translate["#shenji1"]="杂鱼们！都去死吧！",e.translate["#shenji2"]="竟想赢我？痴人说梦！",e.translate["#boss_lvbu2:die"]="虎牢关，失守了……",e.translate["#shenqu1"]="别心怀侥幸了，你们不可能赢！",e.translate["#shenqu2"]="虎牢关，我一人镇守足矣！",e.translate["#jiwu1"]="我，是不可战胜的！",e.translate["#jiwu2"]="今天，就让你们感受一下真正的绝望！",e.translate["#qiangxi_boss_lvbu31"]="这么想死，那我就成全你！",e.translate["#qiangxi_boss_lvbu32"]="项上人头，待我来取！",e.translate["#retieji_boss_lvbu31"]="哈哈哈，破绽百出！",e.translate["#retieji_boss_lvbu32"]="我要让这虎牢关下，血流成河！",e.translate["#xuanfeng_boss_lvbu31"]="千钧之势，力贯苍穹！",e.translate["#xuanfeng_boss_lvbu32"]="横扫六合，威震八荒！",e.translate["#wansha_boss_lvbu31"]="蝼蚁，怎容偷生？",e.translate["#wansha_boss_lvbu32"]="沉沦吧，在这无边的恐惧！",e.translate["#boss_lvbu3:die"]="你们的项上人头，我改日再取！")});let f=null;function S(){var i=e.config.extension_PS武将_Background_Music;"0"==i&&(i=(i=n.rand(2,30)).toString()),a.backgroundMusic.pause();var s={2:"一战成名.m4a",3:"逐鹿天下.mp3",4:"三国杀牌局重制版.mp3",5:"争流.mp3",6:"征战虎牢.mp3",7:"决战虎牢关旧版.mp3",8:"决战虎牢关.mp3",9:"洛神赋.mp3",10:"群英会.mp3",11:"逍遥津.mp3",12:"单刀赴会变奏版.mp3",13:"幻化之战.mp3",14:"黄巾之乱.mp3",15:"军争三国.mp3",16:"乱世乾坤.mp3",17:"天书乱斗.mp3",18:"帐前点兵.mp3",19:"许昌.mp3",20:"自走棋.mp3",21:"OL排位.mp3",22:"大闹长坂坡.mp3",23:"烽火连天.mp3",24:"官阶系统.mp3",25:"欢乐三国杀征战.mp3",26:"洛阳.mp3",27:"三国杀烈.mp3",28:"太虚-黄巾之乱.mp3",29:"太虚-进军广宗.mp3",30:"太虚-长设之战.mp3"};s[i]?a.backgroundMusic.src=e.assetURL+"extension/PS武将/audio/BGM/"+s[i]:(t.playBackgroundMusic(),a.backgroundMusic.addEventListener("ended",t.playBackgroundMusic))}d(function(){(function(e,n){function t(e){const n=e.search(new RegExp("(?<=\\d+\\.\\d+\\.\\d+)(\\.)"));return-1===!n&&(e=e.slice(0,n)),e.split(".")}e=t(e),n=t(n);let a=!1;for(let i=0;i<e.length;i++){if(+e[i]>+n[i]){a=!0;break}if(+e[i]!==+n[i])break;if(i===e.length-1){a=!0;break}}return a})(e.version,s)||(alert(`检测到您的本体版本过低，为避免产生不必要的兼容问题，已为您关闭《PS武将》，请及时将本体更新至${s}以上版本。`),t.saveExtensionConfig("PS武将","enable",!1),t.reload()),e.init.promises.json(`${e.assetURL}extension/PS武将/json/updateHistory.json`).then(e=>f=e,e=>alert("JSON 文件解析失败\n"+e)),e.skill._PS_changeLog={charlotte:!0,ruleSkill:!0,trigger:{global:["gameStart","gameDrawAfter","phaseBefore"]},filter:function(n,t){return!e.config.extension_PS武将_PS_version||e.config.extension_PS武将_PS_version!=e.extensionPack.PS武将.version},direct:!0,priority:1919810,async content(){t.saveConfig("extension_PS武将_PS_version",e.extensionPack.PS武将.version),function(n){const i=Object.keys(e.characterPack.PScharacter||{}).concat(Object.keys(e.characterPack.PSsp_character||{}));n=n||e.extensionPack["PS武将"].version;let s=f[e.extensionPack.PS武将.version];var o=a.create.dialog("hidden");for(var r of(o.addText('<div style="font-size:24px;margin-top:5px;text-align:center;">PS武将 '+n+" 版本更新内容</div>"),o.style.left="25%",o.style.width="50%",s.changeLog))switch(r){case"/setPlayer/":o.addText('<div style="font-size:17.5px;text-align:center;">更新角色：</div>'),o.addSmall([s.players,"character"]);break;case"/setCard/":o.addText('<div style="font-size:17.5px;text-align:center;">更新卡牌：</div>'),o.addSmall([s.cards,"vcard"]);break;default:var c=document.createElement("li");r.startsWith("收录了")||i.forEach(n=>{(r.includes(e.translate[n])||r.includes("〖")&&r.includes("〗"))&&(r=r.replace(new RegExp(e.translate[n],"g"),`<font color=#ff9800>${e.translate[n]}</font>`).replace(new RegExp("〖","g"),"<font color=#24c022>〖").replace(new RegExp("〗","g"),"〗</font>"))}),c.innerHTML=r,c.style.textAlign="left",c.style.marginLeft="25px",c.style.marginTop="2.5px",o.content.appendChild(c)}var l=document.createElement("ul");o.content.appendChild(l),o.open();var u=!1;a.auto.classList.contains("hidden")||(a.auto.hide(),u=!0),t.pause();var d=a.create.control("确定",function(){o.close(),d.close(),u&&a.auto.show(),t.resume()})}()}}}),p({versionUpdate:{name:`版本：${i}`,init:"1",unfrequent:!0,intro:"查看此版本更新说明",item:{1:"<font color=#2cb625>更新说明"},textMenu:function(n,t){const a=Object.keys(e.characterPack.PScharacter||{}).concat(Object.keys(e.characterPack.PSsp_character||{}));e.setScroll(n.parentNode),n.parentNode.style.transform="translateY(-100px)",n.parentNode.style.width="350px",n.style.cssText="width: 350px; padding:5px; box-sizing: border-box;";let s="";if(e.extensionPack.PS武将){const t=f[i];if(!t)return void(n.innerHTML="<font color=red>[读取更新说明出现异常]</font>");t.changeLog.slice(0).forEach(n=>{"/setPlayer/"!==n&&"/setCard/"!==n&&(a.forEach(t=>{(n.includes(e.translate[t])||n.includes("〖")&&n.includes("〗"))&&!n.startsWith("收录了")&&(n=n.replace(new RegExp(e.translate[t],"g"),`<font color=#ff9800>${e.translate[t]}</font>`).replace(new RegExp("〖","g"),"<font color=#24c022>〖").replace(new RegExp("〗","g"),"〗</font>"))}),s+=`·${n}<br>`)}),s=`<span style="width:335px; display:block; font-size: 15px">${s}<span>`,n.innerHTML=s}else n.innerHTML="<font color=red>[需要开启本扩展并重启才能查看]</font>"}},bd1:{clear:!0,name:`最低支持本体版本：${s}`,nopointer:!0}}),d(()=>{e.config.extension_PS武将_Background_Music&&"1"!=e.config.extension_PS武将_Background_Music&&e.arenaReady.push(function(){S(),a.backgroundMusic.addEventListener("ended",S)})}),p({Background_Music:{name:`背景音乐<div class="PSmusic-container"><div class="PSneedle" style="background: url(${e.assetURL}extension/PS武将/image/music/needle.png) no-repeat 0 0/cover"></div><div class="PSrecord-box"><div class="PSrecord" style="background: url(${e.assetURL}extension/PS武将/image/music/coverall.png) no-repeat -140px -580px"></div><div class="PSrecord-img" style="background: url(${e.assetURL}extension/PS武将/image/music/${e.config.extension_PS武将_Background_Music||"1"}.jpg) no-repeat 0 0/cover"></div></div></div>`,clear:!0,intro:"背景音乐：可随意点播、切换优质动听的背景音乐",init:void 0===e.config.extension_PS武将_Background_Music?"1":e.config.extension_PS武将_Background_Music,item:{0:"随机播放",1:"默认音乐",2:"一战成名",3:"逐鹿天下",4:"三国杀牌局重制版",5:"争流",6:"征战虎牢",7:"决战虎牢关旧版",8:"决战虎牢关",9:"洛神赋",10:"群英会",11:"逍遥津",12:"单刀赴会变奏版",13:"幻化之战",14:"黄巾之乱",15:"军争三国",16:"乱世乾坤",17:"天书乱斗",18:"帐前点兵",19:"许昌",20:"自走棋",21:"OL排位",22:"大闹长坂坡",23:"烽火连天",24:"官阶系统",25:"欢乐三国杀征战",26:"洛阳",27:"三国杀烈",28:"太虚-黄巾之乱",29:"太虚-进军广宗",30:"太虚-长设之战"},onclick:function(n){document.querySelector(".PSrecord-box .PSrecord-img").style.backgroundImage=`url(${e.assetURL}extension/PS武将/image/music/${n}.jpg)`,t.saveConfig("extension_PS武将_Background_Music",n),S(),a.backgroundMusic.addEventListener("ended",S)},visualMenu:function(n,t){e.setScroll(n.parentNode),n.parentNode.style.cssText="padding: 8px; color: white;",n.style.cssText=`width: 94px; height: 80px; box-sizing: border-box; border-radius: 10px 0 0 10px; margin: 8px; background: url(${e.assetURL}extension/PS武将/image/music/coverall.png) no-repeat -240px -1120px`,n.innerHTML=`<div style="width: 80px; height: 80px; box-sizing: border-box; border-radius: 10px; font-family: xingkai, xinwei; padding: 3px; background:url(${e.assetURL}extension/PS武将/image/music/${t}.jpg) no-repeat right center/cover ">${n.innerText}</div>`}}});const x={},P=function(e,n,t){let a=Promise.resolve();if(n&&n.length>0){let e=function(e){return Promise.all(e.map(e=>Promise.resolve(e).then(e=>({status:"fulfilled",value:e}),e=>({status:"rejected",reason:e}))))};document.getElementsByTagName("link");const t=document.querySelector("meta[property=csp-nonce]"),i=t?.nonce||t?.getAttribute("nonce");a=e(n.map(e=>{if((e=function(e){return"/"+e}(e))in x)return;x[e]=!0;const n=e.endsWith(".css"),t=n?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${t}`))return;const a=document.createElement("link");return a.rel=n?"stylesheet":"modulepreload",n||(a.as="script"),a.crossOrigin="",a.href=e,i&&a.setAttribute("nonce",i),document.head.appendChild(a),n?new Promise((n,t)=>{a.addEventListener("load",n),a.addEventListener("error",()=>t(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function i(e){const n=new Event("vite:preloadError",{cancelable:!0});if(n.payload=e,window.dispatchEvent(n),!n.defaultPrevented)throw e}return a.then(n=>{for(const e of n||[])"rejected"===e.status&&i(e.reason);return e().catch(i)})};d(async()=>{P(()=>import("./index.js"),__vite__mapDeps([0,1])),!0===e.config.extension_PS武将_PS_spCharacter&&P(()=>import("./index2.js"),__vite__mapDeps([2,1]))}),p({PS_spCharacter:{name:"特殊武将",intro:"开启/关闭PS特殊武将包（重启生效）",init:void 0!==e.config.extension_PS武将_PS_spCharacter&&e.config.extension_PS武将_PS_spCharacter,onclick:function(e){t.saveConfig("extension_PS武将_PS_spCharacter",e)}}});let h=null;function _(e){if("string"!=typeof e)return;if("大宛"===e)return"平";if(h.includes(e.at(-1)))return"仄";let t=n.pinyin(e,!0);return t=t.at(-1),["ā","á","ē","é","ī","í","ō","ó","ū","ú","ǖ","ǘ"].some(e=>t.includes(e))?"平":["ǎ","à","ě","è","ǐ","ì","ǒ","ò","ǔ","ù","ǚ","ǜ"].some(e=>t.includes(e))?"仄":void 0}d(()=>{e.init.promises.json(`${e.assetURL}extension/PS武将/json/rusheng.json`).then(e=>h=e,e=>alert("JSON 文件解析失败\n"+e))}),p({pingzeTip:{name:"平仄提示",intro:"开启后使用武将PS李白，手牌会有相应提示（即时生效）",init:void 0!==e.config.extension_PS武将_PS_pingzeTip&&e.config.extension_PS武将_PS_pingzeTip,onclick:function(e){t.saveConfig("extension_PS武将_PS_pingzeTip",e)}}}),e.init.css(e.assetURL+"extension/PS武将/css","extension"),t.import("extension",function(){return{name:"PS武将",arenaReady:function(){l.arenaReadyHooks.forEach(e=>{e()})},content:function(e,n){l.contentHooks.forEach(t=>{t(e,n)})},prepare:function(){l.prepareHooks.forEach(e=>{e()})},precontent:function(){l.precontentHooks.forEach(e=>{e()})},config:{...l.configObj},help:{...l.helpObj},package:{character:{character:{},translate:{}},card:{card:{},translate:{},list:[]},skill:{skill:{},translate:{}},intro:"",author:"九个芒果",diskURL:"",forumURL:"",version:i},files:{character:[],card:[],skill:[],audio:[]},connect:!1}});export{_ as g,u as o};
//# sourceMappingURL=extension.js.map
