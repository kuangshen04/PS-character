{"version":3,"mappings":"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","names":["VERSION","MINVERSION","contentHooks","precontentHooks","configObj","hooks","arenaReadyHooks","prepareHooks","helpObj","onContent","func","push","onPrecontent","setConfig","obj","Object","assign","changeSkillAudio","skillsName","playersName","audioName","forEach","skillName","playerName","lib","skill","audioname2","async","namePrefix","set","color","nature","getSpan","prefix","name","span","document","createElement","style","writingMode","webkitWritingMode","fontFamily","transform","textContent","outerHTML","get","prefixSpan","translate","phaseBegin","phaseZhunbei","phaseJudge","phaseDraw","phaseUse","phaseDiscard","phaseJieshu","introduce","init","unfrequent","intro","item","textMenu","node","link","setScroll","parentNode","width","cssText","innerHTML","mode","updateHistory","playBackgroundMusic","temp","config","rand","toString","ui","backgroundMusic","pause","src","assetURL","game","addEventListener","curVersion","minVersion","getSliceVersion","version","spotIndex","search","RegExp","slice","split","bool","i","length","compareVersion","alert","saveExtensionConfig","reload","promises","json","then","info","err","_PS_changeLog","charlotte","ruleSkill","trigger","global","filter","event","player","extensionPack","direct","priority","content","saveConfig","characters","keys","characterPack","PScharacter","concat","PSsp_character","changeInfo","dialog","create","log","addText","left","changeLog","addSmall","players","cards","li","startsWith","j","includes","replace","textAlign","marginLeft","marginTop","appendChild","ul","open","hidden","auto","classList","contains","hide","control","close","show","resume","showChangeLog","versionUpdate","str","bd1","clear","nopointer","arenaReady","Background_Music","onclick","querySelector","backgroundImage","visualMenu","innerText","__vitePreload","import","PS_spCharacter","rusheng","getPingZe","at","pinyin","some","yin","pingzeTip","css","pack","prepare","precontent","help","package","character","card","list","author","diskURL","forumURL","files","audio","connect"],"ignoreList":[],"sources":["../src/version.js","../src/utils/hooks.js","../src/features/changeVoices.js","../src/features/addNamePrefix.js","../src/features/addTranslation.js","../src/features/extensionIntro.js","../src/features/linesFix.js","../src/features/verifyVersion.js","../src/features/playBGM.js","../src/features/importCharacters.js","../src/features/definePingZe.js","../src/extension.js","../extension.js"],"sourcesContent":["let VERSION = \"2.2.0\";\r\nlet MINVERSION = \"1.10.12\";\r\n\r\nexport { VERSION, MINVERSION }                   \r\n","const arenaReadyHooks = [];\r\nconst contentHooks = [];\r\nconst prepareHooks = [];\r\nconst precontentHooks = [];\r\nconst configObj = {};\r\nconst helpObj = {};\r\nexport const hooks = {\r\n    arenaReadyHooks,\r\n    contentHooks,\r\n    prepareHooks,\r\n    precontentHooks,\r\n    configObj,\r\n    helpObj,\r\n}\r\nexport function onArenaReady(func) {\r\n    arenaReadyHooks.push(func);\r\n}\r\nexport function onContent(func) {\r\n    contentHooks.push(func);\r\n}\r\nexport function onPrepare(func) {\r\n    prepareHooks.push(func);\r\n}\r\nexport function onPrecontent(func) {\r\n    precontentHooks.push(func);\r\n}\r\nexport function setConfig(obj) {\r\n    Object.assign(configObj, obj);\r\n}\r\nexport function setHelp(obj) {\r\n    Object.assign(helpObj, obj);\r\n}\r\n\r\n","import { lib, get, _status, ui, game, ai } from 'noname';\r\nimport { onContent } from \"../utils/hooks.js\"\r\n\r\n/**\r\n * 改变技能配音的函数\r\n * @param { Array | string } skillsName \r\n * @param { HTMLDivElement[] | HTMLDivElement } playersName \r\n * @param { boolean | string | Array | number } audioName \r\n */\r\nfunction changeSkillAudio(skillsName, playersName, audioName) {\r\n    if (typeof skillsName === 'string') {\r\n        skillsName = [skillsName];\r\n    }\r\n    skillsName.forEach(skillName => {\r\n        if (typeof playersName === 'string') {\r\n            playersName = [playersName];\r\n        }\r\n        playersName.forEach(playerName => {\r\n            if (!lib.skill[skillName]) return;\r\n            if (!lib.skill[skillName].audioname2) lib.skill[skillName].audioname2 = {};\r\n            lib.skill[skillName].audioname2[playerName] = audioName;\r\n        })\r\n    })\r\n};\r\n\r\nonContent(() => {\r\n    /* <-------------------------改变部分武将的技能配音-------------------------> */\r\n    //改变虎牢关吕布“强袭”的配音\r\n    changeSkillAudio('qiangxix', ['PSboss_lvbu2', 'PSboss_lvbu3', 'PSboss_lvbu4'], 'qiangxi_boss_lvbu3');\r\n    //改变虎牢关吕布“完杀”的配音\r\n    changeSkillAudio('rewansha', ['PSboss_lvbu2', 'PSboss_lvbu3', 'PSboss_lvbu4', 'PSshengui'], 'wansha_boss_lvbu3');\r\n    //改变虎牢关吕布“铁骑”的配音 \r\n    changeSkillAudio('retieji', ['PSboss_lvbu2', 'PSboss_lvbu3', 'PSboss_lvbu4'], 'retieji_boss_lvbu3');\r\n    changeSkillAudio('sbtieji', 'PSshengui', 'retieji_boss_lvbu3');\r\n    //改变虎牢关吕布“旋风”的配音\r\n    changeSkillAudio('decadexuanfeng', ['PSboss_lvbu2', 'PSboss_lvbu3', 'PSboss_lvbu4', 'PSshengui'], 'xuanfeng_boss_lvbu3');\r\n    //改变虎牢关吕布“无双”的配音\r\n    changeSkillAudio('wushuang', ['PSboss_lvbu1', 'PSboss_lvbu2', 'PSboss_lvbu3', 'PSboss_lvbu4', 'PSshengui'], 'ext:PS武将/audio/skill:8');\r\n    //改变PS曹操“护驾”的配音\r\n    changeSkillAudio('hujia', 'PScaocao', 'hujia_re_caocao');\r\n    //改变PS刘备“激将”的配音\r\n    changeSkillAudio('rejijiang', 'PSliubei', 'jijiang1_re_liubei');\r\n    //改变PS戏志才“天妒”的配音\r\n    changeSkillAudio('tiandu', 'PSxizhicai', 'tiandu_xizhicai');\r\n    //改变PS钟会“保族”的配音\r\n    changeSkillAudio('clanbaozu', 'PSzhonghui', 'clanbaozu_clan_zhonghui');\r\n    //改变PS钟琰“保族”的配音\r\n    changeSkillAudio('clanbaozu', 'PSzhongyan', 'clanbaozu_clan_zhongyan');\r\n    //改变PS曹丕“颂威”的配音\r\n    changeSkillAudio('songwei', 'PScaopi', 'songwei_re_caopi');\r\n    //改变PS赵襄的配音\r\n    changeSkillAudio(['refanghun', 'ollongdan'], 'PSzhaoxiang', ['ext:PS武将/audio/skill/PSfanghun1', 'ext:PS武将/audio/skill/PSfanghun2']);\r\n    changeSkillAudio(['refanghun', 'ollongdan'], 'PSzhaoxiang2', ['ext:PS武将/audio/skill/PSfanghun_PSzhaoxiang21', 'ext:PS武将/audio/skill/PSfanghun_PSzhaoxiang22']);\r\n    changeSkillAudio('PSfushi', 'PSzhaoxiang2', ['ext:PS武将/audio/skill/PSfushi_PSzhaoxiang21', 'ext:PS武将/audio/skill/PSfushi_PSzhaoxiang22']);\r\n    //改变PS神邓艾的配音\r\n    changeSkillAudio('dccuixin', 'PSshen_dengai2', ['ext:PS武将/audio/skill/cuixin_PSshen_dengai21', 'ext:PS武将/audio/skill/cuixin_PSshen_dengai22']);\r\n})","import { lib, get, _status, ui, game, ai } from 'noname';\r\nimport { onPrecontent } from \"../utils/hooks.js\"\r\n\r\nonPrecontent(async () => {\r\n    /* <-------------------------往lib.namePrefix添加武将前缀-------------------------> */\r\n    if (lib.namePrefix) {\r\n        lib.namePrefix.set('PS', {\r\n            color: '#fdd559',\r\n            nature: 'soilmm',\r\n            // showName: '℗',\r\n            getSpan: (prefix, name) => {\r\n                const span = document.createElement('span'), style = span.style;\r\n                style.writingMode = style.webkitWritingMode = 'horizontal-tb';\r\n                style.fontFamily = 'MotoyaLMaru';\r\n                style.transform = 'scaleY(0.85)';\r\n                span.textContent = 'PS';\r\n                return span.outerHTML;\r\n            },\r\n        });\r\n        lib.namePrefix.set('PS神', {\r\n            getSpan: (prefix, name) => {\r\n                return `${get.prefixSpan('PS')}${get.prefixSpan('神')}`;\r\n            },\r\n        });\r\n        lib.namePrefix.set('PS梦', {\r\n            getSpan: (prefix, name) => {\r\n                return `${get.prefixSpan('PS')}${get.prefixSpan('梦')}`;\r\n            },\r\n        });\r\n        lib.namePrefix.set('PS武', {\r\n            getSpan: (prefix, name) => {\r\n                return `${get.prefixSpan('PS')}${get.prefixSpan('武')}`;\r\n            },\r\n        });\r\n        lib.namePrefix.set('PS晋', {\r\n            getSpan: (prefix, name) => {\r\n                return `${get.prefixSpan('PS')}${get.prefixSpan('晋')}`;\r\n            },\r\n        });\r\n        lib.namePrefix.set('PS乐', {\r\n            getSpan: (prefix, name) => {\r\n                return `${get.prefixSpan('PS')}${get.prefixSpan('乐')}`;\r\n            },\r\n        });\r\n        lib.namePrefix.set('PS经典', {\r\n            getSpan: (prefix, name) => {\r\n                return `${get.prefixSpan('PS')}${get.prefixSpan('经典')}`;\r\n            },\r\n        });\r\n        lib.namePrefix.set('PS界', {\r\n            getSpan: (prefix, name) => {\r\n                return `${get.prefixSpan('PS')}${get.prefixSpan('界')}`;\r\n            },\r\n        });\r\n    }\r\n});","import { lib, get, _status, ui, game, ai } from 'noname';\r\nimport { onContent } from \"../utils/hooks.js\"\r\n\r\nonContent(() => {\r\n    /* <-------------------------添加时机翻译-------------------------> */\r\n    lib.translate.phaseBegin = '回合开始阶段';\r\n    lib.translate.phaseZhunbei = '准备阶段';\r\n    lib.translate.phaseJudge = '判定阶段';\r\n    lib.translate.phaseDraw = '摸牌阶段';\r\n    lib.translate.phaseUse = '出牌阶段';\r\n    lib.translate.phaseDiscard = '弃牌阶段';\r\n    lib.translate.phaseJieshu = '回合结束阶段';\r\n})","import { lib, get, _status, ui, game, ai } from 'noname';\r\nimport { setConfig } from \"../utils/hooks.js\"\r\n\r\n//更新说明\r\nsetConfig({\r\n    \"introduce\": {\r\n        name: \"扩展介绍\",\r\n        init: '1',\r\n        unfrequent: true,\r\n        intro: \"查看扩展介绍\",\r\n        \"item\": {\r\n            \"1\": \"<font color=#2cb625>查看\",\r\n            //\"2\": \"<font color=#00FF00>更新说明\",\r\n        },\r\n        \"textMenu\": function (node, link) {\r\n            lib.setScroll(node.parentNode);\r\n            node.parentNode.style.transform = \"translateY(-100px)\";\r\n            //node.parentNode.style.height = \"710px\";\r\n            node.parentNode.style.width = \"350px\";\r\n            node.style.cssText = \"width: 350px; padding:5px; box-sizing: border-box;\";\r\n            node.innerHTML = '<p style=\"line-height: 1.3; margin:0; padding: 0; text-indent: 2em;\">本扩展主要是对本体武将进行不同方向的强化设计，设计方案大部分来自于网友，小部分来自本人（均有备注），强度基本上处<font class=\"firetext\">半阴</font>到<font class=\"firetext\">阴间</font>的范围。如果你在游玩过程中遇到bug，可以通过qq群或b站私信（b站同名）向本人反馈。</p>';\r\n        },\r\n    },\r\n    // \"repository1\": {\r\n    //     clear: true,\r\n    //     name: `点击复制github仓库地址`,\r\n    //     async onclick() {\r\n    //         if (navigator.clipboard && navigator.clipboard.writeText) {\r\n    //             await navigator.clipboard.writeText(\"https://github.com/nonameMaodie/PS-character\");\r\n    //             alert('内容已成功复制到剪贴板');\r\n    //         } else {\r\n    //             alert('复制失败');\r\n    //         }\r\n    //     }\r\n    // },\r\n    // \"repository2\": {\r\n    //     clear: true,\r\n    //     name: `点击复制gitee仓库地址`,\r\n    //     async onclick() {\r\n    //         if (navigator.clipboard && navigator.clipboard.writeText) {\r\n    //             await navigator.clipboard.writeText(\"https://gitee.com/ninemangos/PS-character\");\r\n    //             alert('内容已成功复制到剪贴板');\r\n    //         } else {\r\n    //             alert('复制失败');\r\n    //         }\r\n    //     }\r\n    // },\r\n})","import { lib, get, _status, ui, game, ai } from 'noname';\r\nimport { onContent } from \"../utils/hooks.js\"\r\n\r\nonContent(() => {\r\n    /* <-------------------------台词补充-------------------------> */\r\n    if (get.mode && get.mode() !== 'boss') {\r\n        lib.translate[\"#boss_lvbu1:die\"] = \"虎牢关，失守了……\";\r\n        lib.translate[\"#xiuluo1\"] = \"准备受死吧！\";\r\n        lib.translate[\"#xiuluo2\"] = \"鼠辈！螳臂当车！\";\r\n        lib.translate[\"#shenwei1\"] = \"萤烛之火，也敢与日月争辉？\";\r\n        lib.translate[\"#shenwei2\"] = \"我不会输给任何人！\";\r\n        lib.translate[\"#shenji1\"] = \"杂鱼们！都去死吧！\";\r\n        lib.translate[\"#shenji2\"] = \"竟想赢我？痴人说梦！\";\r\n        lib.translate[\"#boss_lvbu2:die\"] = \"虎牢关，失守了……\";\r\n        lib.translate[\"#shenqu1\"] = \"别心怀侥幸了，你们不可能赢！\";\r\n        lib.translate[\"#shenqu2\"] = \"虎牢关，我一人镇守足矣！\";\r\n        lib.translate[\"#jiwu1\"] = \"我，是不可战胜的！\";\r\n        lib.translate[\"#jiwu2\"] = \"今天，就让你们感受一下真正的绝望！\";\r\n        lib.translate[\"#qiangxi_boss_lvbu31\"] = \"这么想死，那我就成全你！\";\r\n        lib.translate[\"#qiangxi_boss_lvbu32\"] = \"项上人头，待我来取！\";\r\n        lib.translate[\"#retieji_boss_lvbu31\"] = \"哈哈哈，破绽百出！\";\r\n        lib.translate[\"#retieji_boss_lvbu32\"] = \"我要让这虎牢关下，血流成河！\";\r\n        lib.translate[\"#xuanfeng_boss_lvbu31\"] = \"千钧之势，力贯苍穹！\";\r\n        lib.translate[\"#xuanfeng_boss_lvbu32\"] = \"横扫六合，威震八荒！\";\r\n        lib.translate[\"#wansha_boss_lvbu31\"] = \"蝼蚁，怎容偷生？\";\r\n        lib.translate[\"#wansha_boss_lvbu32\"] = \"沉沦吧，在这无边的恐惧！\";\r\n        lib.translate[\"#boss_lvbu3:die\"] = \"你们的项上人头，我改日再取！\";\r\n    }\r\n})","import { lib, get, _status, ui, game, ai } from 'noname';\r\nimport { onPrecontent, setConfig } from \"../utils/hooks.js\"\r\nimport { VERSION, MINVERSION } from \"../version.js\"\r\n\r\nlet updateHistory = null;\r\n\r\n// 弹出更新说明对话框，搬运自“活动武将”\r\nfunction showChangeLog(version) {\r\n    const characters = Object.keys(lib.characterPack.PScharacter || {}).concat(Object.keys(lib.characterPack.PSsp_character || {}))\r\n\r\n    version = version || lib.extensionPack[\"PS武将\"].version;\r\n    let changeInfo = updateHistory[lib.extensionPack.PS武将.version];\r\n    //加载\r\n    var dialog = ui.create.dialog('hidden');\r\n    dialog.addText('<div style=\"font-size:24px;margin-top:5px;text-align:center;\">PS武将 ' + version + ' 版本更新内容</div>');\r\n    dialog.style.left = '25%';\r\n    dialog.style.width = '50%';\r\n    for (var log of changeInfo.changeLog) {\r\n        switch (log) {\r\n            case '/setPlayer/':\r\n                dialog.addText('<div style=\"font-size:17.5px;text-align:center;\">更新角色：</div>')\r\n                dialog.addSmall([changeInfo.players, 'character']);\r\n                break;\r\n            case '/setCard/':\r\n                dialog.addText('<div style=\"font-size:17.5px;text-align:center;\">更新卡牌：</div>')\r\n                dialog.addSmall([changeInfo.cards, 'vcard']);\r\n                break;\r\n            default:\r\n                var li = document.createElement('li');\r\n                if (!log.startsWith('收录了')) {\r\n                    characters.forEach(j => {\r\n                        if (log.includes(lib.translate[j]) || (log.includes('〖') && log.includes('〗'))) {\r\n                            log = log\r\n                                .replace(new RegExp(lib.translate[j], 'g'), `<font color=#ff9800>${lib.translate[j]}</font>`)\r\n                                .replace(new RegExp('〖', 'g'), `<font color=#24c022>〖`)\r\n                                .replace(new RegExp('〗', 'g'), `〗</font>`)\r\n                        }\r\n                    });\r\n                }\r\n                li.innerHTML = log;\r\n                li.style.textAlign = 'left';\r\n                li.style.marginLeft = '25px';\r\n                li.style.marginTop = '2.5px';\r\n                dialog.content.appendChild(li);\r\n        }\r\n    }\r\n    var ul = document.createElement('ul');\r\n    dialog.content.appendChild(ul);\r\n    dialog.open();\r\n    var hidden = false;\r\n    if (!ui.auto.classList.contains('hidden')) {\r\n        ui.auto.hide();\r\n        hidden = true;\r\n    }\r\n    game.pause();\r\n    var control = ui.create.control('确定', function () {\r\n        dialog.close();\r\n        control.close();\r\n        if (hidden) ui.auto.show();\r\n        game.resume();\r\n    });\r\n};\r\n\r\n/**\r\n * 本体版本验证\r\n * @param {string} curVersion 当前版本\r\n * @param {string} minVersion 要求的最小版本\r\n * @returns {boolean} 是否满足最低版本要求\r\n */\r\nfunction compareVersion(curVersion, minVersion) {\r\n    function getSliceVersion(version) {\r\n        const spotIndex = version.search(/(?<=\\d+\\.\\d+\\.\\d+)(\\.)/);\r\n        if (!spotIndex === -1) version = version.slice(0, spotIndex);\r\n        return version.split('.');\r\n    }\r\n    curVersion = getSliceVersion(curVersion);\r\n    minVersion = getSliceVersion(minVersion);\r\n    let bool = false;\r\n    for (let i = 0; i < curVersion.length; i++) {\r\n        if (+curVersion[i] > +minVersion[i]) {\r\n            bool = true;\r\n            break;\r\n        } else if (+curVersion[i] === +minVersion[i]) {\r\n            if (i === curVersion.length - 1) {\r\n                bool = true;\r\n                break;\r\n            }\r\n        } else {\r\n            break;\r\n        }\r\n    }\r\n    return bool;\r\n}\r\n\r\nonPrecontent(function () {\r\n    if (!compareVersion(lib.version, MINVERSION)) {\r\n        alert(`检测到您的本体版本过低，为避免产生不必要的兼容问题，已为您关闭《PS武将》，请及时将本体更新至${MINVERSION}以上版本。`);\r\n        game.saveExtensionConfig('PS武将', 'enable', false);\r\n        game.reload();\r\n    }\r\n\r\n    //将updateHistory.json文件里的更新日志存入updateHistory\r\n    lib.init.promises\r\n        .json(`${lib.assetURL}extension/PS武将/json/updateHistory.json`)\r\n        .then(info => updateHistory = info, err => alert('JSON 文件解析失败\\n' + err))\r\n\r\n    lib.skill._PS_changeLog = {\r\n        charlotte: true,\r\n        ruleSkill: true,\r\n        trigger: {\r\n            global: [/*'chooseButtonBefore',*/'gameStart', 'gameDrawAfter', 'phaseBefore']\r\n        },\r\n        filter: function (event, player) {\r\n            //if(event.name=='chooseButton'&&event.parent.name!='chooseCharacter') return false;\r\n            return !lib.config.extension_PS武将_PS_version || lib.config.extension_PS武将_PS_version != lib.extensionPack.PS武将.version;\r\n        },\r\n        direct: true,\r\n        priority: 1919810,\r\n        async content() {\r\n            game.saveConfig('extension_PS武将_PS_version', lib.extensionPack.PS武将.version);\r\n            showChangeLog();\r\n        },\r\n    };\r\n});\r\n\r\n//更新说明\r\nsetConfig({\r\n    \"versionUpdate\": {\r\n        name: `版本：${VERSION}`,\r\n        init: '1',\r\n        unfrequent: true,\r\n        intro: \"查看此版本更新说明\",\r\n        \"item\": {\r\n            \"1\": \"<font color=#2cb625>更新说明\",\r\n            //\"2\": \"<font color=#00FF00>更新说明\",\r\n        },\r\n        \"textMenu\": function (node, link) {\r\n            const characters = Object.keys(lib.characterPack.PScharacter || {}).concat(Object.keys(lib.characterPack.PSsp_character || {}))\r\n            lib.setScroll(node.parentNode);\r\n            node.parentNode.style.transform = \"translateY(-100px)\";\r\n            //node.parentNode.style.height = \"710px\";\r\n            node.parentNode.style.width = \"350px\";\r\n            node.style.cssText = \"width: 350px; padding:5px; box-sizing: border-box;\";\r\n            let str = '';\r\n            if (!lib.extensionPack.PS武将) {\r\n                node.innerHTML = '<font color=red>[需要开启本扩展并重启才能查看]</font>';\r\n            }\r\n            else {\r\n                const info = updateHistory[VERSION];\r\n                if (!info) {\r\n                    node.innerHTML = '<font color=red>[读取更新说明出现异常]</font>';\r\n                    return;\r\n                }\r\n                const changeLog = info.changeLog.slice(0);\r\n                changeLog.forEach(i => {\r\n                    if (i !== \"/setPlayer/\" && i !== \"/setCard/\") {\r\n                        characters.forEach(j => {\r\n                            if ((i.includes(lib.translate[j]) || (i.includes('〖') && i.includes('〗'))) && !i.startsWith('收录了')) {\r\n                                i = i\r\n                                    .replace(new RegExp(lib.translate[j], 'g'), `<font color=#ff9800>${lib.translate[j]}</font>`)\r\n                                    .replace(new RegExp('〖', 'g'), `<font color=#24c022>〖`)\r\n                                    .replace(new RegExp('〗', 'g'), `〗</font>`)\r\n                            }\r\n                        });\r\n                        str += `·${i}<br>`;\r\n                    }\r\n                });\r\n                str = `<span style=\"width:335px; display:block; font-size: 15px\">${str}<span>`;\r\n                /* '·<span style=\"color:#ffce46\">PS左慈</span>增强，制衡化身时额外获得一张化身牌。',\r\n                '·<span style=\"color:#ffce46\">PS裴秀</span><span style=\"color:#24c022\">【行图】</span>增加了“倒计时”显示。',\r\n                '·优化了<span style=\"color:#ffce46\">PS赵襄、大魏吴王、双倍许劭、PS神张辽</span>选技能时的loading框样式。（需要开启扩展<span style=\"color:#24c022\">“天牢令”</span>，已征得<span style=\"color:#bd6420\">铝宝</span>和<span style=\"color:#bd6420\">雷佬</span>同意）', */\r\n                node.innerHTML = str;\r\n            }\r\n        },\r\n    },\r\n    \"bd1\": {\r\n        clear: true,\r\n        name: `最低支持本体版本：${MINVERSION}`,\r\n        nopointer: true\r\n    },\r\n})","import { lib, get, _status, ui, game, ai } from 'noname';\r\nimport { onPrecontent, setConfig } from \"../utils/hooks.js\"\r\n\r\nfunction playBackgroundMusic() {\r\n    //if(lib.config.background_music=='music_off'){\r\n    //ui.backgroundMusic.src='';\r\n    //}\r\n    //ui.backgroundMusic.autoplay=true;\r\n    var temp = lib.config.extension_PS武将_Background_Music;\r\n    if (temp == '0') {\r\n        temp = get.rand(2, 30);\r\n        //生成一个范围2到30的整数\r\n        temp = temp.toString();\r\n        //转为字符串\r\n    };\r\n    ui.backgroundMusic.pause();\r\n    var item = {\r\n        \"2\": \"一战成名.m4a\",\r\n        \"3\": \"逐鹿天下.mp3\",\r\n        \"4\": \"三国杀牌局重制版.mp3\",\r\n        \"5\": \"争流.mp3\",\r\n        \"6\": \"征战虎牢.mp3\",\r\n        \"7\": \"决战虎牢关旧版.mp3\",\r\n        \"8\": \"决战虎牢关.mp3\",\r\n        \"9\": \"洛神赋.mp3\",\r\n        \"10\": \"群英会.mp3\",\r\n        \"11\": \"逍遥津.mp3\",\r\n        \"12\": \"单刀赴会变奏版.mp3\",\r\n        \"13\": \"幻化之战.mp3\",\r\n        \"14\": \"黄巾之乱.mp3\",\r\n        \"15\": \"军争三国.mp3\",\r\n        \"16\": \"乱世乾坤.mp3\",\r\n        \"17\": \"天书乱斗.mp3\",\r\n        \"18\": \"帐前点兵.mp3\",\r\n        \"19\": \"许昌.mp3\",\r\n        \"20\": \"自走棋.mp3\",\r\n        \"21\": \"OL排位.mp3\",\r\n        \"22\": \"大闹长坂坡.mp3\",\r\n        \"23\": \"烽火连天.mp3\",\r\n        \"24\": \"官阶系统.mp3\",\r\n        \"25\": \"欢乐三国杀征战.mp3\",\r\n        \"26\": \"洛阳.mp3\",\r\n        \"27\": \"三国杀烈.mp3\",\r\n        \"28\": \"太虚-黄巾之乱.mp3\",\r\n        \"29\": \"太虚-进军广宗.mp3\",\r\n        \"30\": \"太虚-长设之战.mp3\",\r\n    };\r\n    if (item[temp]) {\r\n        ui.backgroundMusic.src = lib.assetURL + 'extension/PS武将/audio/BGM/' + item[temp];\r\n    } else {\r\n        game.playBackgroundMusic();\r\n        ui.backgroundMusic.addEventListener('ended', game.playBackgroundMusic);\r\n    }\r\n};\r\n\r\nonPrecontent(() => {\r\n    /* <-------------------------播放BGM函数，搬运自福瑞拓展，已获得原作者允许，感谢钫酸酱-------------------------> */\r\n    if (lib.config.extension_PS武将_Background_Music && lib.config.extension_PS武将_Background_Music != \"1\") {\r\n        lib.arenaReady.push(function () {\r\n            playBackgroundMusic();\r\n            ui.backgroundMusic.addEventListener('ended', playBackgroundMusic);\r\n        });\r\n    };\r\n});\r\n\r\n//切换BGM\r\nsetConfig({\r\n    \"Background_Music\": {\r\n        name: `背景音乐<div class=\"PSmusic-container\"><div class=\"PSneedle\" style=\"background: url(${lib.assetURL}extension/PS武将/image/music/needle.png) no-repeat 0 0/cover\"></div><div class=\"PSrecord-box\"><div class=\"PSrecord\" style=\"background: url(${lib.assetURL}extension/PS武将/image/music/coverall.png) no-repeat -140px -580px\"></div><div class=\"PSrecord-img\" style=\"background: url(${lib.assetURL}extension/PS武将/image/music/${lib.config.extension_PS武将_Background_Music || '1'}.jpg) no-repeat 0 0/cover\"></div></div></div>`,\r\n        clear: true,\r\n        intro: \"背景音乐：可随意点播、切换优质动听的背景音乐\",\r\n        init: lib.config.extension_PS武将_Background_Music === undefined ? \"1\" : lib.config.extension_PS武将_Background_Music,\r\n        item: {\r\n            \"0\": \"随机播放\",\r\n            \"1\": \"默认音乐\",\r\n            \"2\": \"一战成名\",\r\n            \"3\": \"逐鹿天下\",\r\n            \"4\": \"三国杀牌局重制版\",\r\n            \"5\": \"争流\",\r\n            \"6\": \"征战虎牢\",\r\n            \"7\": \"决战虎牢关旧版\",\r\n            \"8\": \"决战虎牢关\",\r\n            \"9\": \"洛神赋\",\r\n            \"10\": \"群英会\",\r\n            \"11\": \"逍遥津\",\r\n            \"12\": \"单刀赴会变奏版\",\r\n            \"13\": \"幻化之战\",\r\n            \"14\": \"黄巾之乱\",\r\n            \"15\": \"军争三国\",\r\n            \"16\": \"乱世乾坤\",\r\n            \"17\": \"天书乱斗\",\r\n            \"18\": \"帐前点兵\",\r\n            \"19\": \"许昌\",\r\n            \"20\": \"自走棋\",\r\n            \"21\": \"OL排位\",\r\n            \"22\": \"大闹长坂坡\",\r\n            \"23\": \"烽火连天\",\r\n            \"24\": \"官阶系统\",\r\n            \"25\": \"欢乐三国杀征战\",\r\n            \"26\": \"洛阳\",\r\n            \"27\": \"三国杀烈\",\r\n            \"28\": \"太虚-黄巾之乱\",\r\n            \"29\": \"太虚-进军广宗\",\r\n            \"30\": \"太虚-长设之战\",\r\n        },\r\n        onclick: function (item) {\r\n            let div = document.querySelector('.PSrecord-box .PSrecord-img');\r\n            div.style.backgroundImage = `url(${lib.assetURL}extension/PS武将/image/music/${item}.jpg)`;\r\n            game.saveConfig('extension_PS武将_Background_Music', item);\r\n            playBackgroundMusic();\r\n            ui.backgroundMusic.addEventListener('ended', playBackgroundMusic);\r\n        },\r\n        \"visualMenu\": function (node, link) {\r\n            lib.setScroll(node.parentNode);\r\n            node.parentNode.style.cssText = \"padding: 8px; color: white;\";\r\n            node.style.cssText = `width: 94px; height: 80px; box-sizing: border-box; border-radius: 10px 0 0 10px; margin: 8px; background: url(${lib.assetURL}extension/PS武将/image/music/coverall.png) no-repeat -240px -1120px`;\r\n            node.innerHTML = `<div style=\"width: 80px; height: 80px; box-sizing: border-box; border-radius: 10px; font-family: xingkai, xinwei; padding: 3px; background:url(${lib.assetURL}extension/PS武将/image/music/${link}.jpg) no-repeat right center/cover \">${node.innerText}</div>`;\r\n        },\r\n    },\r\n})","import { lib, get, _status, ui, game, ai } from 'noname';\r\nimport { onPrecontent, setConfig } from \"../utils/hooks.js\"\r\n\r\nonPrecontent(async () => {\r\n    import('../character/PScharacter/index.js');\r\n    if (lib.config.extension_PS武将_PS_spCharacter === true) import('../character/PSsp_character/index.js');\r\n});\r\n\r\n// 特殊武将开关\r\nsetConfig({\r\n    \"PS_spCharacter\": {\r\n        \"name\": \"特殊武将\",\r\n        \"intro\": '开启/关闭PS特殊武将包（重启生效）',\r\n        \"init\": lib.config.extension_PS武将_PS_spCharacter === undefined ? false : lib.config.extension_PS武将_PS_spCharacter,\r\n        onclick: function (item) {\r\n            game.saveConfig('extension_PS武将_PS_spCharacter', item);\r\n        },\r\n    },\r\n})","import { lib, get, _status, ui, game, ai } from 'noname';\r\nimport { onPrecontent, setConfig } from \"../utils/hooks.js\"\r\n\r\n/* <-------------------------平仄声相关-------------------------> */\r\nlet rusheng = null;\r\nonPrecontent(() => {\r\n    //将rusheng.json文件里的入声字数组存入rusheng\r\n    lib.init.promises\r\n        .json(`${lib.assetURL}extension/PS武将/json/rusheng.json`)\r\n        .then(info => rusheng = info, err => alert('JSON 文件解析失败\\n' + err))\r\n})\r\n\r\nsetConfig({\r\n    \"pingzeTip\": {\r\n        \"name\": \"平仄提示\",\r\n        \"intro\": '开启后使用武将PS李白，手牌会有相应提示（即时生效）',\r\n        \"init\": lib.config.extension_PS武将_PS_pingzeTip === undefined ? false : lib.config.extension_PS武将_PS_pingzeTip,\r\n        onclick: function (item) {\r\n            game.saveConfig('extension_PS武将_PS_pingzeTip', item);\r\n        },\r\n    },\r\n})\r\n\r\n//获取平仄的函数\r\nexport function getPingZe(str) {\r\n    //以平水韵为标准   \r\n    if (typeof str !== 'string') return;\r\n    if (str === '大宛') return '平';\r\n    if (rusheng.includes(str.at(-1))) return '仄';\r\n    const ping = ['ā', 'á', 'ē', 'é', 'ī', 'í', 'ō', 'ó', 'ū', 'ú', 'ǖ', 'ǘ'];\r\n    const ze = ['ǎ', 'à', 'ě', 'è', 'ǐ', 'ì', 'ǒ', 'ò', 'ǔ', 'ù', 'ǚ', 'ǜ'];\r\n    let pinyin = get.pinyin(str, true);\r\n    pinyin = pinyin.at(-1);\r\n    if (ping.some(yin => pinyin.includes(yin))) return '平';\r\n    else if (ze.some(yin => pinyin.includes(yin))) return '仄';\r\n}","import { lib, game, ui, get, ai, _status } from \"noname\";\r\nimport { VERSION } from \"./version.js\"\r\nimport { hooks } from \"./utils/hooks.js\";\r\nimport \"./features/index.js\"\r\n\r\nlib.init.css(lib.assetURL + 'extension/PS武将/css', \"extension\");//调用css样式\r\n\r\nexport const type = \"extension\";\r\nexport default function () {\r\n\treturn {\r\n\t\tname: \"PS武将\", arenaReady: function () {\r\n\t\t\thooks.arenaReadyHooks.forEach(func => {\r\n\t\t\t\tfunc();\r\n\t\t\t});\r\n\t\t}, content: function (config, pack) {\r\n\t\t\thooks.contentHooks.forEach(func => {\r\n\t\t\t\tfunc(config, pack);\r\n\t\t\t});\r\n\t\t}, prepare: function () {\r\n\t\t\thooks.prepareHooks.forEach(func => {\r\n\t\t\t\tfunc();\r\n\t\t\t});\r\n\t\t}, precontent: function () {\r\n\t\t\thooks.precontentHooks.forEach(func => {\r\n\t\t\t\tfunc();\r\n\t\t\t});\r\n\t\t}, config: {\r\n\t\t\t...hooks.configObj\r\n\t\t}, help: {\r\n\t\t\t...hooks.helpObj\r\n\t\t}, package: {\r\n\t\t\tcharacter: {\r\n\t\t\t\tcharacter: {\r\n\t\t\t\t},\r\n\t\t\t\ttranslate: {\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tcard: {\r\n\t\t\t\tcard: {\r\n\t\t\t\t},\r\n\t\t\t\ttranslate: {\r\n\t\t\t\t},\r\n\t\t\t\tlist: [],\r\n\t\t\t},\r\n\t\t\tskill: {\r\n\t\t\t\tskill: {\r\n\t\t\t\t},\r\n\t\t\t\ttranslate: {\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tintro: \"\",\r\n\t\t\tauthor: \"九个芒果\",\r\n\t\t\tdiskURL: \"\",\r\n\t\t\tforumURL: \"\",\r\n\t\t\tversion: VERSION,\r\n\t\t}, files: { \"character\": [], \"card\": [], \"skill\": [], \"audio\": [] }, connect: false\r\n\t}\r\n};\r\n\r\n","import ext from \"./src/extension.js\";\r\nimport { game } from \"noname\";\r\n\r\ngame.import(\"extension\", ext);\r\n"],"file":"extension.js"}